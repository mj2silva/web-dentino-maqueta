/*! For license information please see index.60cfdd798e109f2843c8.js.LICENSE.txt */
!function(){var t={757:function(t,e,n){t.exports=n(666)},224:function(t,e,n){"use strict";var r=n(99),i=n(909),o=n(655),a=n(589),s=n(594);function u(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var c,l=u(r),h=((c={})["already-activated"]="You are trying to activate AppCheck for FirebaseApp {$appName}, while it is already activated. AppCheck can only be activated once.",c["use-before-activation"]="AppCheck is being used before activate() is called for FirebaseApp {$appName}. Please make sure you call activate() before instantiating other Firebase services.",c["fetch-network-error"]="Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",c["fetch-parse-error"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",c["fetch-status-error"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",c["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",c["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",c["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",c["recaptcha-error"]="ReCAPTCHA error.",c),f=new a.ErrorFactory("appCheck","AppCheck",h),d=new Map,p={activated:!1,tokenObservers:[]},v={enabled:!1};function g(t){return d.get(t)||p}function y(t,e){d.set(t,e)}function m(){return v}var _="https://content-firebaseappcheck.googleapis.com/v1beta",b=3e4,w=96e4,I=function(){function t(t,e,n,r,i){if(this.operation=t,this.retryPolicy=e,this.getWaitDuration=n,this.lowerBound=r,this.upperBound=i,this.pending=null,this.nextErrorWaitInterval=r,r>i)throw new Error("Proactive refresh lower bound greater than upper bound!")}return t.prototype.start=function(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch((function(){}))},t.prototype.stop=function(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)},t.prototype.isRunning=function(){return!!this.pending},t.prototype.process=function(t){return o.__awaiter(this,void 0,void 0,(function(){var e;return o.__generator(this,(function(n){switch(n.label){case 0:this.stop(),n.label=1;case 1:return n.trys.push([1,6,,7]),this.pending=new a.Deferred,[4,(r=this.getNextRun(t),new Promise((function(t){setTimeout(t,r)})))];case 2:return n.sent(),this.pending.resolve(),[4,this.pending.promise];case 3:return n.sent(),this.pending=new a.Deferred,[4,this.operation()];case 4:return n.sent(),this.pending.resolve(),[4,this.pending.promise];case 5:return n.sent(),this.process(!0).catch((function(){})),[3,7];case 6:return e=n.sent(),this.retryPolicy(e)?this.process(!1).catch((function(){})):this.stop(),[3,7];case 7:return[2]}var r}))}))},t.prototype.getNextRun=function(t){if(t)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();var e=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),e},t}();function T(){return self.grecaptcha}function E(t){if(!g(t).activated)throw f.create("use-before-activation",{appName:t.name})}function S(t){return a.base64.encodeString(JSON.stringify(t),!1)}function C(t,e){var n=t.url,r=t.body;return o.__awaiter(this,void 0,void 0,(function(){var t,i,a,s,u,c,l,h,d,p;return o.__generator(this,(function(o){switch(o.label){case 0:t={"Content-Type":"application/json"},(i=e.getImmediate({optional:!0}))&&(t["X-Firebase-Client"]=i.getPlatformInfoString()),a={method:"POST",body:JSON.stringify(r),headers:t},o.label=1;case 1:return o.trys.push([1,3,,4]),[4,fetch(n,a)];case 2:return s=o.sent(),[3,4];case 3:throw u=o.sent(),f.create("fetch-network-error",{originalErrorMessage:u.message});case 4:if(200!==s.status)throw f.create("fetch-status-error",{httpStatus:s.status});o.label=5;case 5:return o.trys.push([5,7,,8]),[4,s.json()];case 6:return c=o.sent(),[3,8];case 7:throw l=o.sent(),f.create("fetch-parse-error",{originalErrorMessage:l.message});case 8:if(!(h=c.ttl.match(/^([\d.]+)(s)$/))||!h[2]||isNaN(Number(h[1])))throw f.create("fetch-parse-error",{originalErrorMessage:"ttl field (timeToLive) is not in standard Protobuf Duration format: "+c.ttl});return d=1e3*Number(h[1]),p=Date.now(),[2,{token:c.attestationToken,expireTimeMillis:p+d,issuedAtTimeMillis:p}]}}))}))}function k(t,e){var n=t.options,r=n.projectId,i=n.appId,o=n.apiKey;return{url:_+"/projects/"+r+"/apps/"+i+":exchangeRecaptchaToken?key="+o,body:{recaptcha_token:e}}}function A(t,e){var n=t.options,r=n.projectId,i=n.appId,o=n.apiKey;return{url:_+"/projects/"+r+"/apps/"+i+":exchangeDebugToken?key="+o,body:{debug_token:e}}}var N="firebase-app-check-store",P="debug-token",x=null;function R(){return x||(x=new Promise((function(t,e){try{var n=indexedDB.open("firebase-app-check-database",1);n.onsuccess=function(e){t(e.target.result)},n.onerror=function(t){var n;e(f.create("storage-open",{originalErrorMessage:null===(n=t.target.error)||void 0===n?void 0:n.message}))},n.onupgradeneeded=function(t){var e=t.target.result;switch(t.oldVersion){case 0:e.createObjectStore(N,{keyPath:"compositeKey"})}}}catch(t){e(f.create("storage-open",{originalErrorMessage:t.message}))}})))}function D(t){return L(M(t))}function O(t,e){return o.__awaiter(this,void 0,void 0,(function(){var n,r,i,a;return o.__generator(this,(function(o){switch(o.label){case 0:return[4,R()];case 1:return n=o.sent(),r=n.transaction(N,"readwrite"),i=r.objectStore(N),a=i.put({compositeKey:t,value:e}),[2,new Promise((function(t,e){a.onsuccess=function(e){t()},r.onerror=function(t){var n;e(f.create("storage-set",{originalErrorMessage:null===(n=t.target.error)||void 0===n?void 0:n.message}))}}))]}}))}))}function L(t){return o.__awaiter(this,void 0,void 0,(function(){var e,n,r,i;return o.__generator(this,(function(o){switch(o.label){case 0:return[4,R()];case 1:return e=o.sent(),n=e.transaction(N,"readonly"),r=n.objectStore(N),i=r.get(t),[2,new Promise((function(t,e){i.onsuccess=function(e){var n=e.target.result;t(n?n.value:void 0)},n.onerror=function(t){var n;e(f.create("storage-get",{originalErrorMessage:null===(n=t.target.error)||void 0===n?void 0:n.message}))}}))]}}))}))}function M(t){return t.options.appId+"-"+t.name}var F=new s.Logger("@firebase/app-check");function U(t,e){return a.isIndexedDBAvailable()?function(t,e){return O(M(t),e)}(t,e).catch((function(t){F.warn("Failed to write token to indexeddb. Error: "+t)})):Promise.resolve()}function j(){return o.__awaiter(this,void 0,void 0,(function(){var t,e;return o.__generator(this,(function(n){switch(n.label){case 0:t=void 0,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,L(P)];case 2:return t=n.sent(),[3,4];case 3:return n.sent(),[3,4];case 4:return t?[2,t]:(e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})),(r=e,O(P,r)).catch((function(t){return F.warn("Failed to persist debug token to indexeddb. Error: "+t)})),console.log("AppCheck debug token: "+e+". You will need to whitelist it in the Firebase console for it to work"),[2,e])}var r}))}))}function q(){return o.__awaiter(this,void 0,void 0,(function(){var t;return o.__generator(this,(function(e){if((t=m()).enabled&&t.token)return[2,t.token.promise];throw Error("\n            Can't get debug token in production mode.\n        ")}))}))}var V={error:"UNKNOWN_ERROR"};function B(t,e,n){return void 0===n&&(n=!1),o.__awaiter(this,void 0,void 0,(function(){var r,i,a,s,u,c,l,h,f,d;return o.__generator(this,(function(p){switch(p.label){case 0:return E(t),r=g(t),i=r.token,a=void 0,i?[3,2]:[4,r.cachedTokenPromise];case 1:(s=p.sent())&&G(s)&&(i=s,y(t,o.__assign(o.__assign({},r),{token:i})),H(t,{token:i.token})),p.label=2;case 2:return!n&&i&&G(i)?[2,{token:i.token}]:m().enabled?(c=C,l=A,h=[t],[4,q()]):[3,6];case 3:return[4,c.apply(void 0,[l.apply(void 0,h.concat([p.sent()])),e])];case 4:return u=p.sent(),[4,U(t,u)];case 5:return p.sent(),y(t,o.__assign(o.__assign({},r),{token:u})),[2,{token:u.token}];case 6:return p.trys.push([6,8,,9]),[4,r.provider.getToken()];case 7:return i=p.sent(),[3,9];case 8:return f=p.sent(),F.error(f),a=f,[3,9];case 9:return i?[3,10]:(d=function(t){return{token:S(V),error:t}}(a),[3,12]);case 10:return d={token:i.token},y(t,o.__assign(o.__assign({},r),{token:i})),[4,U(t,i)];case 11:p.sent(),p.label=12;case 12:return H(t,d),[2,d]}}))}))}function K(t,e,n,r,i){var a=g(t),s={next:r,error:i,type:n},u=o.__assign(o.__assign({},a),{tokenObservers:o.__spreadArray(o.__spreadArray([],a.tokenObservers),[s])});if(!u.tokenRefresher){var c=function(t,e){var n=this;return new I((function(){return o.__awaiter(n,void 0,void 0,(function(){var n;return o.__generator(this,(function(r){switch(r.label){case 0:return g(t).token?[3,2]:[4,B(t,e)];case 1:return n=r.sent(),[3,4];case 2:return[4,B(t,e,!0)];case 3:n=r.sent(),r.label=4;case 4:if(n.error)throw n.error;return[2]}}))}))}),(function(){return!0}),(function(){var e=g(t);if(e.token){var n=e.token.issuedAtTimeMillis+.5*(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)+3e5,r=e.token.expireTimeMillis-3e5;return n=Math.min(n,r),Math.max(0,n-Date.now())}return 0}),b,w)}(t,e);u.tokenRefresher=c}if(!u.tokenRefresher.isRunning()&&a.isTokenAutoRefreshEnabled&&u.tokenRefresher.start(),a.token&&G(a.token)){var l=a.token;Promise.resolve().then((function(){return r({token:l.token})})).catch((function(){}))}else null==a.token&&a.cachedTokenPromise.then((function(t){t&&G(t)&&r({token:t.token})})).catch((function(){}));y(t,u)}function W(t,e){var n=g(t),r=n.tokenObservers.filter((function(t){return t.next!==e}));0===r.length&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),y(t,o.__assign(o.__assign({},n),{tokenObservers:r}))}function H(t,e){for(var n=0,r=g(t).tokenObservers;n<r.length;n++){var i=r[n];try{"EXTERNAL"===i.type&&null!=e.error?i.error(e.error):i.next(e)}catch(t){}}}function G(t){return t.expireTimeMillis-Date.now()>0}var z="https://www.google.com/recaptcha/api.js";function Q(t,e){var n=g(t),r=new a.Deferred;y(t,o.__assign(o.__assign({},n),{reCAPTCHAState:{initialized:r}}));var i="fire_app_check_"+t.name,s=document.createElement("div");s.id=i,s.style.display="none",document.body.appendChild(s);var u,c,l=T();return l?l.ready((function(){X(t,e,l,i),r.resolve(l)})):(u=function(){var n=T();if(!n)throw new Error("no recaptcha");n.ready((function(){X(t,e,n,i),r.resolve(n)}))},(c=document.createElement("script")).src=""+z,c.onload=u,document.head.appendChild(c)),r.promise}function Y(t){return o.__awaiter(this,void 0,void 0,(function(){var e;return o.__generator(this,(function(n){switch(n.label){case 0:return E(t),[4,g(t).reCAPTCHAState.initialized.promise];case 1:return e=n.sent(),[2,new Promise((function(n,r){var i=g(t).reCAPTCHAState;e.ready((function(){n(e.execute(i.widgetId,{action:"fire_app_check"}))}))}))]}}))}))}function X(t,e,n,r){var i=n.render(r,{sitekey:e,size:"invisible"}),a=g(t);y(t,o.__assign(o.__assign({},a),{reCAPTCHAState:o.__assign(o.__assign({},a.reCAPTCHAState),{widgetId:i})}))}var $=function(){function t(t){this._siteKey=t}return t.prototype.getToken=function(){return o.__awaiter(this,void 0,void 0,(function(){var t;return o.__generator(this,(function(e){switch(e.label){case 0:if(!this._app||!this._platformLoggerProvider)throw f.create("use-before-activation",{appName:""});e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Y(this._app)];case 2:return t=e.sent(),[3,4];case 3:throw e.sent(),f.create("recaptcha-error");case 4:return[2,C(k(this._app,t),this._platformLoggerProvider)]}}))}))},t.prototype.initialize=function(t,e){this._app=t,this._platformLoggerProvider=e,Q(t,this._siteKey).catch((function(){}))},t}(),J=function(){function t(t){this._customProviderOptions=t}return t.prototype.getToken=function(){return o.__awaiter(this,void 0,void 0,(function(){var t,e,n;return o.__generator(this,(function(r){switch(r.label){case 0:if(!this._app)throw f.create("use-before-activation",{appName:""});return[4,this._customProviderOptions.getToken()];case 1:return t=r.sent(),e=a.issuedAtTime(t.token),n=null!==e&&e<Date.now()&&e>0?1e3*e:Date.now(),[2,o.__assign(o.__assign({},t),{issuedAtTimeMillis:n})]}}))}))},t.prototype.initialize=function(t){this._app=t},t}();function Z(t,e,n,r){var i=g(t);if(i.activated)throw f.create("already-activated",{appName:t.name});var s=o.__assign(o.__assign({},i),{activated:!0});s.cachedTokenPromise=function(t){return o.__awaiter(this,void 0,void 0,(function(){var e,n;return o.__generator(this,(function(r){switch(r.label){case 0:if(!a.isIndexedDBAvailable())return[3,5];e=void 0,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,D(t)];case 2:return e=r.sent(),[3,4];case 3:return n=r.sent(),F.warn("Failed to read token from indexeddb. Error: "+n),[3,4];case 4:return[2,e];case 5:return[2,void 0]}}))}))}(t).then((function(e){return e&&G(e)&&y(t,o.__assign(o.__assign({},g(t)),{token:e})),e})),s.provider="string"==typeof e?new $(e):e instanceof $||e instanceof J?e:new J({getToken:e.getToken}),s.isTokenAutoRefreshEnabled=void 0===r?t.automaticDataCollectionEnabled:r,y(t,s),s.provider.initialize(t,n)}function tt(t,e){return{app:t,activate:function(n,r){return Z(t,n,e,r)},setTokenAutoRefreshEnabled:function(e){return function(t,e){var n=g(t);n.tokenRefresher&&(!0===e?n.tokenRefresher.start():n.tokenRefresher.stop()),y(t,o.__assign(o.__assign({},n),{isTokenAutoRefreshEnabled:e}))}(t,e)},getToken:function(n){return function(t,e,n){return o.__awaiter(this,void 0,void 0,(function(){var r;return o.__generator(this,(function(i){switch(i.label){case 0:return[4,B(t,e,n)];case 1:if((r=i.sent()).error)throw r.error;return[2,{token:r.token}]}}))}))}(t,e,n)},onTokenChanged:function(n,r,i){return function(t,e,n,r,i){var o=function(){},a=function(){};return o=null!=n.next?n.next.bind(n):n,null!=n.error?a=n.error.bind(n):r&&(a=r),K(t,e,"EXTERNAL",o,a),function(){return W(t,o)}}(t,e,n,r)},INTERNAL:{delete:function(){for(var e=0,n=g(t).tokenObservers;e<n.length;e++){var r=n[e];W(t,r.next)}return Promise.resolve()}}}}var et="app-check-internal";!function(t){t.INTERNAL.registerComponent(new i.Component("appCheck",(function(t){return tt(t.getProvider("app").getImmediate(),t.getProvider("platform-logger"))}),"PUBLIC").setServiceProps({ReCaptchaV3Provider:$,CustomProvider:J}).setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((function(t,e,n){t.getProvider(et).initialize()}))),t.INTERNAL.registerComponent(new i.Component(et,(function(t){return function(t,e){return{getToken:function(n){return B(t,e,n)},addTokenListener:function(n){return K(t,e,"INTERNAL",n)},removeTokenListener:function(e){return W(t,e)}}}(t.getProvider("app").getImmediate(),t.getProvider("platform-logger"))}),"PUBLIC").setInstantiationMode("EXPLICIT")),t.registerVersion("@firebase/app-check","0.3.2")}(l.default),function(){var t=a.getGlobal();if("string"==typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN||!0===t.FIREBASE_APPCHECK_DEBUG_TOKEN){var e=m();e.enabled=!0;var n=new a.Deferred;e.token=n,"string"==typeof t.FIREBASE_APPCHECK_DEBUG_TOKEN?n.resolve(t.FIREBASE_APPCHECK_DEBUG_TOKEN):n.resolve(j())}}()},99:function(t,e,n){"use strict";n.r(e),n.d(e,{firebase:function(){return b}});var r,i,o=n(655),a=n(589),s=n(909),u=n(594),c=((r={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",r["bad-app-name"]="Illegal App name: '{$appName}",r["duplicate-app"]="Firebase App named '{$appName}' already exists",r["app-deleted"]="Firebase App named '{$appName}' already deleted",r["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",r["invalid-log-argument"]="First argument to `onLog` must be null or a function.",r),l=new a.ErrorFactory("app","Firebase",c),h="@firebase/app",f="[DEFAULT]",d=((i={})[h]="fire-core",i["@firebase/analytics"]="fire-analytics",i["@firebase/app-check"]="fire-app-check",i["@firebase/auth"]="fire-auth",i["@firebase/database"]="fire-rtdb",i["@firebase/functions"]="fire-fn",i["@firebase/installations"]="fire-iid",i["@firebase/messaging"]="fire-fcm",i["@firebase/performance"]="fire-perf",i["@firebase/remote-config"]="fire-rc",i["@firebase/storage"]="fire-gcs",i["@firebase/firestore"]="fire-fst",i["fire-js"]="fire-js",i["firebase-wrapper"]="fire-js-all",i),p=new u.Logger("@firebase/app"),v=function(){function t(t,e,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=(0,a.deepCopy)(t),this.container=new s.ComponentContainer(e.name),this._addComponent(new s.Component("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(t){return r._addComponent(t)}))}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise((function(e){t.checkDestroyed_(),e()})).then((function(){return t.firebase_.INTERNAL.removeApp(t.name_),Promise.all(t.container.getProviders().map((function(t){return t.delete()})))})).then((function(){t.isDeleted_=!0}))},t.prototype._getService=function(t,e){var n;void 0===e&&(e=f),this.checkDestroyed_();var r=this.container.getProvider(t);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:e})},t.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=f),this.container.getProvider(t).clearInstance(e)},t.prototype._addComponent=function(t){try{this.container.addComponent(t)}catch(e){p.debug("Component "+t.name+" failed to register with FirebaseApp "+this.name,e)}},t.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw l.create("app-deleted",{appName:this.name_})},t}();v.prototype.name&&v.prototype.options||v.prototype.delete||console.log("dc");var g=function t(){var e=function(t){var e={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={}),"object"==typeof i&&null!==i||(i={name:i});var o=i;void 0===o.name&&(o.name=f);var s=o.name;if("string"!=typeof s||!s)throw l.create("bad-app-name",{appName:String(s)});if((0,a.contains)(e,s))throw l.create("duplicate-app",{appName:s});var u=new t(n,o,r);return e[s]=u,u},app:i,registerVersion:function(t,e,n){var r,i=null!==(r=d[t])&&void 0!==r?r:t;n&&(i+="-"+n);var a=i.match(/\s|\//),u=e.match(/\s|\//);if(a||u){var c=['Unable to register library "'+i+'" with version "'+e+'":'];return a&&c.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),a&&u&&c.push("and"),u&&c.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void p.warn(c.join(" "))}o(new s.Component(i+"-version",(function(){return{library:i,version:e}}),"VERSION"))},setLogLevel:u.setLogLevel,onLog:function(t,e){if(null!==t&&"function"!=typeof t)throw l.create("invalid-log-argument");(0,u.setUserLogHandler)(t,e)},apps:null,SDK_VERSION:"8.10.0",INTERNAL:{registerComponent:o,removeApp:function(t){delete e[t]},components:n,useAsService:function(t,e){return"serverAuth"===e?null:e}}};function i(t){if(t=t||f,!(0,a.contains)(e,t))throw l.create("no-app",{appName:t});return e[t]}function o(o){var s=o.name;if(n.has(s))return p.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===o.type?r[s]:null;if(n.set(s,o),"PUBLIC"===o.type){var u=function(t){if(void 0===t&&(t=i()),"function"!=typeof t[s])throw l.create("invalid-app-argument",{appName:s});return t[s]()};void 0!==o.serviceProps&&(0,a.deepExtend)(u,o.serviceProps),r[s]=u,t.prototype[s]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._getService.bind(this,s).apply(this,o.multipleInstances?t:[])}}for(var c=0,h=Object.keys(e);c<h.length;c++){var f=h[c];e[f]._addComponent(o)}return"PUBLIC"===o.type?r[s]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(e).map((function(t){return e[t]}))}}),i.App=t,r}(v);return e.INTERNAL=(0,o.__assign)((0,o.__assign)({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){(0,a.deepExtend)(e,t)},createSubscribe:a.createSubscribe,ErrorFactory:a.ErrorFactory,deepExtend:a.deepExtend}),e}(),y=function(){function t(t){this.container=t}return t.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(t){if(function(t){var e=t.getComponent();return"VERSION"===(null==e?void 0:e.type)}(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null})).filter((function(t){return t})).join(" ")},t}();if((0,a.isBrowser)()&&void 0!==self.firebase){p.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var m=self.firebase.SDK_VERSION;m&&m.indexOf("LITE")>=0&&p.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var _=g.initializeApp;g.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0,a.isNode)()&&p.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),_.apply(void 0,t)};var b=g;!function(t,e){t.INTERNAL.registerComponent(new s.Component("platform-logger",(function(t){return new y(t)}),"PRIVATE")),t.registerVersion(h,"0.6.30",e),t.registerVersion("fire-js","")}(b),e.default=b},909:function(t,e,n){"use strict";n.r(e),n.d(e,{Component:function(){return o},ComponentContainer:function(){return u},Provider:function(){return s}});var r=n(655),i=n(589),o=function(){function t(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},t.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},t.prototype.setServiceProps=function(t){return this.serviceProps=t,this},t.prototype.setInstanceCreatedCallback=function(t){return this.onInstanceCreated=t,this},t}(),a="[DEFAULT]",s=function(){function t(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return t.prototype.get=function(t){var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new i.Deferred;if(this.instancesDeferred.set(e,n),this.isInitialized(e)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:e});r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},t.prototype.getImmediate=function(t){var e,n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),r=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(t){if(r)return null;throw t}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=t,this.shouldAutoInitialize()){if(function(t){return"EAGER"===t.instantiationMode}(t))try{this.getOrInitializeService({instanceIdentifier:a})}catch(t){}try{for(var i=(0,r.__values)(this.instancesDeferred.entries()),o=i.next();!o.done;o=i.next()){var s=(0,r.__read)(o.value,2),u=s[0],c=s[1],l=this.normalizeInstanceIdentifier(u);try{var h=this.getOrInitializeService({instanceIdentifier:l});c.resolve(h)}catch(t){}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}}},t.prototype.clearInstance=function(t){void 0===t&&(t=a),this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)},t.prototype.delete=function(){return(0,r.__awaiter)(this,void 0,void 0,(function(){var t;return(0,r.__generator)(this,(function(e){switch(e.label){case 0:return t=Array.from(this.instances.values()),[4,Promise.all((0,r.__spreadArray)((0,r.__spreadArray)([],(0,r.__read)(t.filter((function(t){return"INTERNAL"in t})).map((function(t){return t.INTERNAL.delete()})))),(0,r.__read)(t.filter((function(t){return"_delete"in t})).map((function(t){return t._delete()})))))];case 1:return e.sent(),[2]}}))}))},t.prototype.isComponentSet=function(){return null!=this.component},t.prototype.isInitialized=function(t){return void 0===t&&(t=a),this.instances.has(t)},t.prototype.getOptions=function(t){return void 0===t&&(t=a),this.instancesOptions.get(t)||{}},t.prototype.initialize=function(t){var e,n;void 0===t&&(t={});var i=t.options,o=void 0===i?{}:i,a=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(a))throw Error(this.name+"("+a+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var s=this.getOrInitializeService({instanceIdentifier:a,options:o});try{for(var u=(0,r.__values)(this.instancesDeferred.entries()),c=u.next();!c.done;c=u.next()){var l=(0,r.__read)(c.value,2),h=l[0],f=l[1];a===this.normalizeInstanceIdentifier(h)&&f.resolve(s)}}catch(t){e={error:t}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}return s},t.prototype.onInit=function(t,e){var n,r=this.normalizeInstanceIdentifier(e),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(t),this.onInitCallbacks.set(r,i);var o=this.instances.get(r);return o&&t(o,r),function(){i.delete(t)}},t.prototype.invokeOnInitCallbacks=function(t,e){var n,i,o=this.onInitCallbacks.get(e);if(o)try{for(var a=(0,r.__values)(o),s=a.next();!s.done;s=a.next()){var u=s.value;try{u(t,e)}catch(t){}}}catch(t){n={error:t}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}},t.prototype.getOrInitializeService=function(t){var e,n=t.instanceIdentifier,r=t.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(e=n,e===a?void 0:e),options:i}),this.instances.set(n,o),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(o,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(t){}return o||null},t.prototype.normalizeInstanceIdentifier=function(t){return void 0===t&&(t=a),this.component?this.component.multipleInstances?t:a:t},t.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},t}();var u=function(){function t(t){this.name=t,this.providers=new Map}return t.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},t.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},t.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new s(t,this);return this.providers.set(t,e),e},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}()},446:function(t,e,n){"use strict";var r=n(99),i=n(909),o=n(589),a=n(655),s=n(594);t=n.hmd(t);var u="";function c(t){u=t}var l,h=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),(0,o.stringify)(e))},t.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:(0,o.jsonEval)(e)},t.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},t.prototype.prefixedName_=function(t){return this.prefix_+t},t.prototype.toString=function(){return this.domStorage_.toString()},t}(),f=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},t.prototype.get=function(t){return(0,o.contains)(this.cache_,t)?this.cache_[t]:null},t.prototype.remove=function(t){delete this.cache_[t]},t}(),d=function(t){try{if("undefined"!=typeof window&&void 0!==window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new h(e)}}catch(t){}return new f},p=d("localStorage"),v=d("sessionStorage"),g=new s.Logger("@firebase/database"),y=(l=1,function(){return l++}),m=function(t){var e=(0,o.stringToByteArray)(t),n=new o.Sha1;n.update(e);var r=n.digest();return o.base64.encodeByteArray(r)},_=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",r=0;r<t.length;r++){var i=t[r];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?n+=_.apply(null,i):n+="object"==typeof i?(0,o.stringify)(i):i,n+=" "}return n},b=null,w=!0,I=function(t,e){(0,o.assert)(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(g.logLevel=s.LogLevel.VERBOSE,b=g.log.bind(g),e&&v.set("logging_enabled",!0)):"function"==typeof t?b=t:(b=null,v.remove("logging_enabled"))},T=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!0===w&&(w=!1,null===b&&!0===v.get("logging_enabled")&&I(!0)),b){var n=_.apply(null,t);b(n)}},E=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];T.apply(void 0,(0,a.__spreadArray)([t],(0,a.__read)(e)))}},S=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE INTERNAL ERROR: "+_.apply(void 0,(0,a.__spreadArray)([],(0,a.__read)(t)));g.error(n)},C=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE FATAL ERROR: "+_.apply(void 0,(0,a.__spreadArray)([],(0,a.__read)(t)));throw g.error(n),new Error(n)},k=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE WARNING: "+_.apply(void 0,(0,a.__spreadArray)([],(0,a.__read)(t)));g.warn(n)},A=function(t){return"number"==typeof t&&(t!=t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},N="[MIN_NAME]",P="[MAX_NAME]",x=function(t,e){if(t===e)return 0;if(t===N||e===P)return-1;if(e===N||t===P)return 1;var n=V(t),r=V(e);return null!==n?null!==r?n-r==0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1},R=function(t,e){return t===e?0:t<e?-1:1},D=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+(0,o.stringify)(e))},O=function(t){if("object"!=typeof t||null===t)return(0,o.stringify)(t);var e=[];for(var n in t)e.push(n);e.sort();for(var r="{",i=0;i<e.length;i++)0!==i&&(r+=","),r+=(0,o.stringify)(e[i]),r+=":",r+=O(t[e[i]]);return r+="}"},L=function(t,e){var n=t.length;if(n<=e)return[t];for(var r=[],i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function M(t,e){for(var n in t)t.hasOwnProperty(n)&&e(n,t[n])}var F=function(t){(0,o.assert)(!A(t),"Invalid JSON number");var e,n,r,i,a,s=1023;0===t?(n=0,r=0,e=1/t==-1/0?1:0):(e=t<0,(t=Math.abs(t))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(t)/Math.LN2),s))+s,r=Math.round(t*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(t/Math.pow(2,-1074))));var u=[];for(a=52;a;a-=1)u.push(r%2?1:0),r=Math.floor(r/2);for(a=11;a;a-=1)u.push(n%2?1:0),n=Math.floor(n/2);u.push(e?1:0),u.reverse();var c=u.join(""),l="";for(a=0;a<64;a+=8){var h=parseInt(c.substr(a,8),2).toString(16);1===h.length&&(h="0"+h),l+=h}return l.toLowerCase()};var U=new RegExp("^-?(0*)\\d{1,10}$"),j=-2147483648,q=2147483647,V=function(t){if(U.test(t)){var e=Number(t);if(e>=j&&e<=q)return e}return null},B=function(t){try{t()}catch(t){setTimeout((function(){var e=t.stack||"";throw k("Exception was thrown by user callback.",e),t}),Math.floor(0))}},K=function(t,e){var n=setTimeout(t,e);return"object"==typeof n&&n.unref&&n.unref(),n},W=function(){function t(t,e){var n=this;this.appName_=t,this.appCheckProvider=e,this.appCheck=null==e?void 0:e.getImmediate({optional:!0}),this.appCheck||null==e||e.get().then((function(t){return n.appCheck=t}))}return t.prototype.getToken=function(t){var e=this;return this.appCheck?this.appCheck.getToken(t):new Promise((function(n,r){setTimeout((function(){e.appCheck?e.getToken(t).then(n,r):n(null)}),0)}))},t.prototype.addTokenChangeListener=function(t){var e;null===(e=this.appCheckProvider)||void 0===e||e.get().then((function(e){return e.addTokenListener(t)}))},t.prototype.notifyForInvalidToken=function(){k('Provided AppCheck credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly.')},t}(),H=function(){function t(t,e,n){var r=this;this.appName_=t,this.firebaseOptions_=e,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit((function(t){return r.auth_=t}))}return t.prototype.getToken=function(t){var e=this;return this.auth_?this.auth_.getToken(t).catch((function(t){return t&&"auth/token-not-initialized"===t.code?(T("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)})):new Promise((function(n,r){setTimeout((function(){e.auth_?e.getToken(t).then(n,r):n(null)}),0)}))},t.prototype.addTokenChangeListener=function(t){this.auth_?this.auth_.addAuthTokenListener(t):this.authProvider_.get().then((function(e){return e.addAuthTokenListener(t)}))},t.prototype.removeTokenChangeListener=function(t){this.authProvider_.get().then((function(e){return e.removeAuthTokenListener(t)}))},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',k(t)},t}(),G=function(){function t(t){this.accessToken=t}return t.prototype.getToken=function(t){return Promise.resolve({accessToken:this.accessToken})},t.prototype.addTokenChangeListener=function(t){t(this.accessToken)},t.prototype.removeTokenChangeListener=function(t){},t.prototype.notifyForInvalidToken=function(){},t.OWNER="owner",t}(),z="5",Q=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Y="websocket",X="long_polling",$=function(){function t(t,e,n,r,i,o,a){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===a&&(a=!1),this.secure=e,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this._host=t.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=p.get("host:"+t)||this._host}return t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain},Object.defineProperty(t.prototype,"host",{get:function(){return this._host},set:function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&p.set("host:"+this._host,this.internalHost))},enumerable:!1,configurable:!0}),t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){var t=this.secure?"https://":"http://",e=this.includeNamespaceInQueryParams?"?ns="+this.namespace:"";return""+t+this.host+"/"+e},t}();function J(t,e,n){var r;if((0,o.assert)("string"==typeof e,"typeof type must == string"),(0,o.assert)("object"==typeof n,"typeof params must == object"),e===Y)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else{if(e!==X)throw new Error("Unknown connection type: "+e);r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?"}(function(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams})(t)&&(n.ns=t.namespace);var i=[];return M(n,(function(t,e){i.push(t+"="+e)})),r+i.join("&")}var Z=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),(0,o.contains)(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},t.prototype.get=function(){return(0,o.deepCopy)(this.counters_)},t}(),tt={},et={};function nt(t){var e=t.toString();return tt[e]||(tt[e]=new Z),tt[e]}var rt=function(){function t(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;for(var r=function(){var t=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var e=function(e){t[e]&&B((function(){n.onMessage_(t[e])}))},r=0;r<t.length;++r)e(r);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum];){if("break"===r())break}},t}(),it="start",ot="close",at=function(){function t(t,e,n,r,i,o,a){var s=this;this.connId=t,this.repoInfo=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=E(t),this.stats_=nt(e),this.urlFn=function(t){return s.appCheckToken&&(t.ac=s.appCheckToken),J(e,X,t)}}return t.prototype.open=function(t,e){var n=this;this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new rt(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(3e4)),function(t){if((0,o.isNodeSdk)()||"complete"===document.readyState)t();else{var e=!1,n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((function(){if(!n.isClosed_){n.scriptTagHolder=new st((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=(0,a.__read)(t,5),i=r[0],o=r[1],s=r[2];if(r[3],r[4],n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,i===it)n.id=o,n.password=s;else{if(i!==ot)throw new Error("Unrecognized command received: "+i);o?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(o,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=(0,a.__read)(t,2),i=r[0],o=r[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(i,o)}),(function(){n.onClosed_()}),n.urlFn);var t={start:"t"};t.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=n.scriptTagHolder.uniqueCallbackIdentifier),t.v=z,n.transportSessionId&&(t.s=n.transportSessionId),n.lastSessionId&&(t.ls=n.lastSessionId),n.applicationId&&(t.p=n.applicationId),n.appCheckToken&&(t.ac=n.appCheckToken),"undefined"!=typeof location&&location.hostname&&Q.test(location.hostname)&&(t.r="f");var e=n.urlFn(t);n.log_("Connecting via long-poll to "+e),n.scriptTagHolder.addTag(e,(function(){}))}}))},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return!(0,o.isNodeSdk)()&&(!!t.forceAllow_||!(t.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=(0,o.stringify)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n=(0,o.base64Encode)(e),r=L(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,e){if(!(0,o.isNodeSdk)()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},t.prototype.incrementIncomingBytes_=function(t){var e=(0,o.stringify)(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},t}(),st=function(){function t(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,o.isNodeSdk)())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=y(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();var a="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length))a='<script>document.domain="'+document.domain+'";<\/script>';var s="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(s),this.myIFrame.doc.close()}catch(t){T("frame writing exception"),t.stack&&T(t.stack),T(t)}}}return t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||T("No IE domain setting required")}catch(n){var e=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+e+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},t.prototype.close=function(){var t=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==t.myIFrame&&(document.body.removeChild(t.myIFrame),t.myIFrame=null)}),Math.floor(0)));var e=this.onDisconnect;e&&(this.onDisconnect=null,e())},t.prototype.startLongPoll=function(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););},t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;for(var e=this.urlFn(t),n="",r=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return e+=n,this.addLongPollTag_(e,this.currentSerial),!0}return!1},t.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e);var r=function(){n.outstandingRequests.delete(e),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(t,(function(){clearTimeout(i),r()}))},t.prototype.addTag=function(t,e){var n=this;(0,o.isNodeSdk)()?this.doNodeLongPoll(t,e):setTimeout((function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){var t=r.readyState;t&&"loaded"!==t&&"complete"!==t||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),e())},r.onerror=function(){T("Long-poll script failed to load: "+t),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(t){}}),Math.floor(1))},t}(),ut=null;"undefined"!=typeof MozWebSocket?ut=MozWebSocket:"undefined"!=typeof WebSocket&&(ut=WebSocket);var ct=function(){function t(e,n,r,i,o,a,s){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=E(this.connId),this.stats_=nt(n),this.connURL=t.connectionURL_(n,a,s,i),this.nodeAdmin=n.nodeAdmin}return t.connectionURL_=function(t,e,n,r){var i={};return i.v=z,!(0,o.isNodeSdk)()&&"undefined"!=typeof location&&location.hostname&&Q.test(location.hostname)&&(i.r="f"),e&&(i.s=e),n&&(i.ls=n),r&&(i.ac=r),J(t,Y,i)},t.prototype.open=function(t,e){var n=this;this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,p.set("previous_websocket_failure",!0);try{if((0,o.isNodeSdk)()){var r=this.nodeAdmin?"AdminNode":"Node",i={headers:{"User-Agent":"Firebase/5/"+u+"/"+process.platform+"/"+r,"X-Firebase-GMPID":this.applicationId||""}};this.authToken&&(i.headers.Authorization="Bearer "+this.authToken),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);var a=process.env,s=0===this.connURL.indexOf("wss://")?a.HTTPS_PROXY||a.https_proxy:a.HTTP_PROXY||a.http_proxy;s&&(i.proxy={origin:s}),this.mySock=new ut(this.connURL,[],i)}else{i={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}};this.mySock=new ut(this.connURL,[],i)}}catch(t){this.log_("Error instantiating WebSocket.");var c=t.message||t.data;return c&&this.log_(c),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(t){n.handleIncomingFrame(t)},this.mySock.onerror=function(t){n.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&n.log_(e),n.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==ut&&!t.forceDisallow_},t.previouslyFailed=function(){return p.isInMemoryStorage||!0===p.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){p.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length===this.totalFrames){var e=this.frames.join("");this.frames=null;var n=(0,o.jsonEval)(e);this.onMessage(n)}},t.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},t.prototype.extractFrameCount_=function(t){if((0,o.assert)(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},t.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},t.prototype.send=function(t){this.resetKeepAlive();var e=(0,o.stringify)(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=L(e,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()}),Math.floor(45e3))},t.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}(),lt=function(){function t(t){this.initTransports_(t)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[at,ct]},enumerable:!1,configurable:!0}),t.prototype.initTransports_=function(e){var n,r,i=ct&&ct.isAvailable(),o=i&&!ct.previouslyFailed();if(e.webSocketOnly&&(i||k("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[ct];else{var s=this.transports_=[];try{for(var u=(0,a.__values)(t.ALL_TRANSPORTS),c=u.next();!c.done;c=u.next()){var l=c.value;l&&l.isAvailable()&&s.push(l)}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}},t.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},t.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},t}(),ht=function(){function t(t,e,n,r,i,o,a,s,u,c){this.id=t,this.repoInfo_=e,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=s,this.onKill_=u,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=E("c:"+this.id+":"),this.transportManager_=new lt(e),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){t.conn_&&t.conn_.open(n,r)}),Math.floor(0));var i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=K((function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&t.conn_.bytesReceived>102400?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&t.conn_.bytesSent>10240?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))}),Math.floor(i)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(t){var e=this;return function(n){t===e.conn_?e.onConnectionLost_(n):t===e.secondaryConn_?(e.log_("Secondary connection lost."),e.onSecondaryConnectionLost_()):e.log_("closing an old connection")}},t.prototype.connReceiver_=function(t){var e=this;return function(n){2!==e.state_&&(t===e.rx_?e.onPrimaryMessageReceived_(n):t===e.secondaryConn_?e.onSecondaryMessageReceived_(n):e.log_("message on old connection"))}},t.prototype.sendRequest=function(t){var e={t:"d",d:t};this.sendData_(e)},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(t){if("t"in t){var e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(t){var e=D("t",t),n=D("d",t);if("c"===e)this.onSecondaryControl_(n);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(t){var e=D("t",t),n=D("d",t);"c"===e?this.onControl_(n):"d"===e&&this.onDataMessage_(n)},t.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},t.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},t.prototype.onControl_=function(t){var e=D("t",t);if("d"in t){var n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?S("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):S("Unknown control packet command: "+e)}},t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),z!==n&&k("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},t.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),K((function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())}),Math.floor(6e4))},t.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.host=t,1===this.state_?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):K((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()},t.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(p.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},t.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},t.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}(),ft=function(){function t(){}return t.prototype.put=function(t,e,n,r){},t.prototype.merge=function(t,e,n,r){},t.prototype.refreshAuthToken=function(t){},t.prototype.refreshAppCheckToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}(),dt=function(){function t(t){this.allowedEvents_=t,this.listeners_={},(0,o.assert)(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var r=(0,a.__spreadArray)([],(0,a.__read)(this.listeners_[t])),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,e)},t.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var r=this.getInitialEvent(t);r&&e.apply(n,r)},t.prototype.off=function(t,e,n){this.validateEventType_(t);for(var r=this.listeners_[t]||[],i=0;i<r.length;i++)if(r[i].callback===e&&(!n||n===r[i].context))return void r.splice(i,1)},t.prototype.validateEventType_=function(t){(0,o.assert)(this.allowedEvents_.find((function(e){return e===t})),"Unknown event: "+t)},t}(),pt=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||(0,o.isMobileCordova)()||(window.addEventListener("online",(function(){e.online_||(e.online_=!0,e.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){e.online_&&(e.online_=!1,e.trigger("online",!1))}),!1)),e}return(0,a.__extends)(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return(0,o.assert)("online"===t,"Unknown event type: "+t),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(dt),vt=function(){function t(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}return t.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},t}();function gt(){return new vt("")}function yt(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function mt(t){return t.pieces_.length-t.pieceNum_}function _t(t){var e=t.pieceNum_;return e<t.pieces_.length&&e++,new vt(t.pieces_,e)}function bt(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function wt(t,e){return void 0===e&&(e=0),t.pieces_.slice(t.pieceNum_+e)}function It(t){if(t.pieceNum_>=t.pieces_.length)return null;for(var e=[],n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new vt(e,0)}function Tt(t,e){for(var n=[],r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof vt)for(r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{var i=e.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new vt(n,0)}function Et(t){return t.pieceNum_>=t.pieces_.length}function St(t,e){var n=yt(t),r=yt(e);if(null===n)return e;if(n===r)return St(_t(t),_t(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function Ct(t,e){for(var n=wt(t,0),r=wt(e,0),i=0;i<n.length&&i<r.length;i++){var o=x(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1}function kt(t,e){if(mt(t)!==mt(e))return!1;for(var n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function At(t,e){var n=t.pieceNum_,r=e.pieceNum_;if(mt(t)>mt(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var Nt=function(t,e){this.errorPrefix_=e,this.parts_=wt(t,0),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=(0,o.stringLength)(this.parts_[n]);Pt(this)};function Pt(t){if(t.byteLength_>768)throw new Error(t.errorPrefix_+"has a key path longer than 768 bytes ("+t.byteLength_+").");if(t.parts_.length>32)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+xt(t))}function xt(t){return 0===t.parts_.length?"":"in property '"+t.parts_.join(".")+"'"}var Rt,Dt,Ot=function(t){function e(){var e,n,r=t.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",e="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",e="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,(function(){var t=!document[e];t!==r.visible_&&(r.visible_=t,r.trigger("visible",t))}),!1),r}return(0,a.__extends)(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return(0,o.assert)("visible"===t,"Unknown event type: "+t),[this.visible_]},e}(dt),Lt=1e3,Mt=function(t){function e(n,r,i,a,s,u,c,l){var h=t.call(this)||this;if(h.repoInfo_=n,h.applicationId_=r,h.onDataUpdate_=i,h.onConnectStatus_=a,h.onServerInfoUpdate_=s,h.authTokenProvider_=u,h.appCheckTokenProvider_=c,h.authOverride_=l,h.id=e.nextPersistentConnectionId_++,h.log_=E("p:"+h.id+":"),h.interruptReasons_={},h.listens=new Map,h.outstandingPuts_=[],h.outstandingGets_=[],h.outstandingPutCount_=0,h.outstandingGetCount_=0,h.onDisconnectRequestQueue_=[],h.connected_=!1,h.reconnectDelay_=Lt,h.maxReconnectDelay_=3e5,h.securityDebugCallback_=null,h.lastSessionId=null,h.establishConnectionTimer_=null,h.visible_=!1,h.requestCBHash_={},h.requestNumber_=0,h.realtime_=null,h.authToken_=null,h.appCheckToken_=null,h.forceTokenRefresh_=!1,h.invalidAuthTokenCount_=0,h.invalidAppCheckTokenCount_=0,h.firstConnection_=!0,h.lastConnectionAttemptTime_=null,h.lastConnectionEstablishedTime_=null,l&&!(0,o.isNodeSdk)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return Ot.getInstance().on("visible",h.onVisible_,h),-1===n.host.indexOf("fblocal")&&pt.getInstance().on("online",h.onOnline_,h),h}return(0,a.__extends)(e,t),e.prototype.sendRequest=function(t,e,n){var r=++this.requestNumber_,i={r:r,a:t,b:e};this.log_((0,o.stringify)(i)),(0,o.assert)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},e.prototype.get=function(t){var e=this;this.initConnection_();var n=new o.Deferred,r={p:t._path.toString(),q:t._queryObject},i={action:"g",request:r,onComplete:function(t){var i=t.d;"ok"===t.s?(e.onDataUpdate_(r.p,i,!1,null),n.resolve(i)):n.reject(i)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;var a=this.outstandingGets_.length-1;return this.connected_||setTimeout((function(){var t=e.outstandingGets_[a];void 0!==t&&i===t&&(delete e.outstandingGets_[a],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),e.log_("get "+a+" timed out on connection"),n.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(a),n.promise},e.prototype.listen=function(t,e,n,r){this.initConnection_();var i=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+i),this.listens.has(a)||this.listens.set(a,new Map),(0,o.assert)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,o.assert)(!this.listens.get(a).has(i),"listen() called twice for same path/queryId.");var s={onComplete:r,hashFn:e,query:t,tag:n};this.listens.get(a).set(i,s),this.connected_&&this.sendListen_(s)},e.prototype.sendGet_=function(t){var e=this,n=this.outstandingGets_[t];this.sendRequest("g",n.request,(function(r){delete e.outstandingGets_[t],e.outstandingGetCount_--,0===e.outstandingGetCount_&&(e.outstandingGets_=[]),n.onComplete&&n.onComplete(r)}))},e.prototype.sendListen_=function(t){var n=this,r=t.query,i=r._path.toString(),o=r._queryIdentifier;this.log_("Listen on "+i+" for "+o);var a={p:i};t.tag&&(a.q=r._queryObject,a.t=t.tag),a.h=t.hashFn(),this.sendRequest("q",a,(function(a){var s=a.d,u=a.s;e.warnOnListenWarnings_(s,r),(n.listens.get(i)&&n.listens.get(i).get(o))===t&&(n.log_("listen response",a),"ok"!==u&&n.removeListen_(i,o),t.onComplete&&t.onComplete(u,s))}))},e.warnOnListenWarnings_=function(t,e){if(t&&"object"==typeof t&&(0,o.contains)(t,"w")){var n=(0,o.safeGet)(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+e._queryParams.getIndex().toString()+'"',i=e._path.toString();k("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},e.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(t)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(t){(t&&40===t.length||(0,o.isAdmin)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},e.prototype.refreshAppCheckToken=function(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},(function(){}))},e.prototype.tryAuth=function(){var t=this;if(this.connected_&&this.authToken_){var e=this.authToken_,n=(0,o.isValidFormat)(e)?"auth":"gauth",r={cred:e};null===this.authOverride_?r.noauth=!0:"object"==typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,(function(n){var r=n.s,i=n.d||"error";t.authToken_===e&&("ok"===r?t.invalidAuthTokenCount_=0:t.onAuthRevoked_(r,i))}))}},e.prototype.tryAppCheck=function(){var t=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},(function(e){var n=e.s,r=e.d||"error";"ok"===n?t.invalidAppCheckTokenCount_=0:t.onAppCheckRevoked_(n,r)}))},e.prototype.unlisten=function(t,e){var n=t._path.toString(),r=t._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),(0,o.assert)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,t._queryObject,e)},e.prototype.sendUnlisten_=function(t,e,n,r){this.log_("Unlisten on "+t+" for "+e);var i={p:t};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},e.prototype.onDisconnectPut=function(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},e.prototype.onDisconnectMerge=function(t,e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},e.prototype.onDisconnectCancel=function(t,e){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},e.prototype.sendOnDisconnect_=function(t,e,n,r){var i={p:e,d:n};this.log_("onDisconnect "+t,i),this.sendRequest(t,i,(function(t){r&&setTimeout((function(){r(t.s,t.d)}),Math.floor(0))}))},e.prototype.put=function(t,e,n,r){this.putInternal("p",t,e,n,r)},e.prototype.merge=function(t,e,n,r){this.putInternal("m",t,e,n,r)},e.prototype.putInternal=function(t,e,n,r,i){this.initConnection_();var o={p:e,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++;var a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+e)},e.prototype.sendPut_=function(t){var e=this,n=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,r,(function(r){e.log_(n+" response",r),delete e.outstandingPuts_[t],e.outstandingPutCount_--,0===e.outstandingPutCount_&&(e.outstandingPuts_=[]),i&&i(r.s,r.d)}))},e.prototype.reportStats=function(t){var e=this;if(this.connected_){var n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,(function(t){if("ok"!==t.s){var n=t.d;e.log_("reportStats","Error sending stats: "+n)}}))}},e.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+(0,o.stringify)(t));var e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}},e.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"apc"===t?this.onAppCheckRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):S("Unrecognized action received from server: "+(0,o.stringify)(t)+"\nAre you using the latest client?")},e.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(t){var e=this;(0,o.assert)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){e.establishConnectionTimer_=null,e.establishConnection_()}),Math.floor(t))},e.prototype.initConnection_=function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)},e.prototype.onVisible_=function(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Lt,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},e.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=Lt,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=Lt),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var t=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){return(0,a.__awaiter)(this,void 0,void 0,(function(){var t,n,r,i,s,u,c,l,h,f,d,p,v,g,y=this;return(0,a.__generator)(this,(function(m){switch(m.label){case 0:if(!this.shouldReconnect_())return[3,4];this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null,t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+e.nextConnectionId_++,s=this.lastSessionId,u=!1,c=null,l=function(){c?c.close():(u=!0,r())},h=function(t){(0,o.assert)(c,"sendRequest call when we're not connected not allowed."),c.sendRequest(t)},this.realtime_={close:l,sendRequest:h},f=this.forceTokenRefresh_,this.forceTokenRefresh_=!1,m.label=1;case 1:return m.trys.push([1,3,,4]),[4,Promise.all([this.authTokenProvider_.getToken(f),this.appCheckTokenProvider_.getToken(f)])];case 2:return d=a.__read.apply(void 0,[m.sent(),2]),p=d[0],v=d[1],u?T("getToken() completed but was canceled"):(T("getToken() completed. Creating connection."),this.authToken_=p&&p.accessToken,this.appCheckToken_=v&&v.token,c=new ht(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,t,n,r,(function(t){k(t+" ("+y.repoInfo_.toString()+")"),y.interrupt("server_kill")}),s)),[3,4];case 3:return g=m.sent(),this.log_("Failed to get token: "+g),u||(this.repoInfo_.nodeAdmin&&k(g),l()),[3,4];case 4:return[2]}}))}))},e.prototype.interrupt=function(t){T("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(t){T("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,o.isEmpty)(this.interruptReasons_)&&(this.reconnectDelay_=Lt,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(t){var e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},e.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(t,e){var n;n=e?e.map((function(t){return O(t)})).join("$"):"default";var r=this.removeListen_(t,n);r&&r.onComplete&&r.onComplete("permission_denied")},e.prototype.removeListen_=function(t,e){var n,r=new vt(t).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(e),i.delete(e),0===i.size&&this.listens.delete(r)}else n=void 0;return n},e.prototype.onAuthRevoked_=function(t,e){T("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},e.prototype.onAppCheckRevoked_=function(t,e){T("App check token revoked: "+t+"/"+e),this.appCheckToken_=null,this.forceTokenRefresh_=!0,"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())},e.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))},e.prototype.restoreState_=function(){var t,e,n,r;this.tryAuth(),this.tryAppCheck();try{for(var i=(0,a.__values)(this.listens.values()),o=i.next();!o.done;o=i.next()){var s=o.value;try{for(var u=(n=void 0,(0,a.__values)(s.values())),c=u.next();!c.done;c=u.next()){var l=c.value;this.sendListen_(l)}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}for(var h=0;h<this.outstandingPuts_.length;h++)this.outstandingPuts_[h]&&this.sendPut_(h);for(;this.onDisconnectRequestQueue_.length;){var f=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(f.action,f.pathString,f.data,f.onComplete)}for(h=0;h<this.outstandingGets_.length;h++)this.outstandingGets_[h]&&this.sendGet_(h)},e.prototype.sendConnectStats_=function(){var t={},e="js";(0,o.isNodeSdk)()&&(e=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+e+"."+u.replace(/\./g,"-")]=1,(0,o.isMobileCordova)()?t["framework.cordova"]=1:(0,o.isReactNative)()&&(t["framework.reactnative"]=1),this.reportStats(t)},e.prototype.shouldReconnect_=function(){var t=pt.getInstance().currentlyOnline();return(0,o.isEmpty)(this.interruptReasons_)&&t},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(ft),Ft=function(){function t(t,e){this.name=t,this.node=e}return t.Wrap=function(e,n){return new t(e,n)},t}(),Ut=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new Ft(N,t),r=new Ft(N,e);return 0!==this.compare(n,r)},t.prototype.minPost=function(){return Ft.MIN},t}(),jt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,a.__extends)(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return Rt},set:function(t){Rt=t},enumerable:!1,configurable:!0}),e.prototype.compare=function(t,e){return x(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw(0,o.assertionError)("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return Ft.MIN},e.prototype.maxPost=function(){return new Ft(P,Rt)},e.prototype.makePost=function(t,e){return(0,o.assert)("string"==typeof t,"KeyIndex indexValue must always be a string."),new Ft(t,Rt)},e.prototype.toString=function(){return".key"},e}(Ut),qt=new jt,Vt=function(){function t(t,e,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(t=t,o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return t.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},t.prototype.hasNext=function(){return this.nodeStack_.length>0},t.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},t}(),Bt=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:Wt.EMPTY_NODE,this.right=null!=o?o:Wt.EMPTY_NODE}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return Wt.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),(t=t.copy(null,null,null,t.left.removeMin_(),null)).fixUp_()},t.prototype.remove=function(t,e){var n,r;if(e(t,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return Wt.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},t.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight_())).rotateLeft_()).colorFlip_()),t},t.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=(t=t.rotateRight_()).colorFlip_()),t},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth_=function(){var t=this.check_();return Math.pow(2,t)<=this.count()+1},t.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},t.RED=!0,t.BLACK=!1,t}(),Kt=function(){function t(){}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Bt(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}(),Wt=function(){function t(e,n){void 0===n&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Bt.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Bt.BLACK,null,null))},t.prototype.get=function(t){for(var e,n=this.root_;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key)))return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null},t.prototype.getPredecessorKey=function(t){for(var e,n=this.root_,r=null;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},t.prototype.getIterator=function(t){return new Vt(this.root_,null,this.comparator_,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new Vt(this.root_,t,this.comparator_,!1,e)},t.prototype.getReverseIteratorFrom=function(t,e){return new Vt(this.root_,t,this.comparator_,!0,e)},t.prototype.getReverseIterator=function(t){return new Vt(this.root_,null,this.comparator_,!0,t)},t.EMPTY_NODE=new Kt,t}();function Ht(t,e){return x(t.name,e.name)}function Gt(t,e){return x(t,e)}var zt,Qt,Yt,Xt=function(t){return"number"==typeof t?"number:"+F(t):"string:"+t},$t=function(t){if(t.isLeafNode()){var e=t.val();(0,o.assert)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,o.contains)(e,".sv"),"Priority must be a string or number.")}else(0,o.assert)(t===Dt||t.isEmpty(),"priority of unexpected type.");(0,o.assert)(t===Dt||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},Jt=function(){function t(e,n){void 0===n&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,(0,o.assert)(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),$t(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return zt},set:function(t){zt=t},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return Et(e)?this:".priority"===yt(e)?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(t,e){return null},t.prototype.updateImmediateChild=function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var r=yt(e);return null===r?n:n.isEmpty()&&".priority"!==r?this:((0,o.assert)(".priority"!==r||1===mt(e),".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(_t(e),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(t,e){return!1},t.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+Xt(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":",t+="number"===e?F(this.value_):this.value_,this.lazyHash_=m(t)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:((0,o.assert)(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,r=typeof this.value_,i=t.VALUE_TYPE_ORDER.indexOf(n),a=t.VALUE_TYPE_ORDER.indexOf(r);return(0,o.assert)(i>=0,"Unknown leaf type: "+n),(0,o.assert)(a>=0,"Unknown leaf type: "+r),i===a?"object"===r?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:a-i},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode()){var e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}();var Zt,te,ee=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,a.__extends)(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),r=e.node.getPriority(),i=n.compareTo(r);return 0===i?x(t.name,e.name):i},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return Ft.MIN},e.prototype.maxPost=function(){return new Ft(P,new Jt("[PRIORITY-POST]",Yt))},e.prototype.makePost=function(t,e){var n=Qt(t);return new Ft(e,new Jt("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(Ut)),ne=Math.log(2),re=function(){function t(t){var e;this.count=(e=t+1,parseInt(Math.log(e)/ne,10)),this.current_=this.count-1;var n,r=(n=this.count,parseInt(Array(n+1).join("1"),2));this.bits_=t+1&r}return t.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},t}(),ie=function(t,e,n,r){t.sort(e);var i=function(e,r){var o,a,s=r-e;if(0===s)return null;if(1===s)return o=t[e],a=n?n(o):o,new Bt(a,o.node,Bt.BLACK,null,null);var u=parseInt(s/2,10)+e,c=i(e,u),l=i(u+1,r);return o=t[u],a=n?n(o):o,new Bt(a,o.node,Bt.BLACK,c,l)},o=function(e){for(var r=null,o=null,a=t.length,s=function(e,r){var o=a-e,s=a;a-=e;var c=i(o+1,s),l=t[o],h=n?n(l):l;u(new Bt(h,l.node,r,null,c))},u=function(t){r?(r.left=t,r=t):(o=t,r=t)},c=0;c<e.count;++c){var l=e.nextBitIsOne(),h=Math.pow(2,e.count-(c+1));l?s(h,Bt.BLACK):(s(h,Bt.BLACK),s(h,Bt.RED))}return o}(new re(t.length));return new Wt(r||e,o)},oe={},ae=function(){function t(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(t,"Default",{get:function(){return(0,o.assert)(oe&&ee,"ChildrenNode.ts has not been loaded"),Zt=Zt||new t({".priority":oe},{".priority":ee})},enumerable:!1,configurable:!0}),t.prototype.get=function(t){var e=(0,o.safeGet)(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof Wt?e:null},t.prototype.hasIndex=function(t){return(0,o.contains)(this.indexSet_,t.toString())},t.prototype.addIndex=function(e,n){(0,o.assert)(e!==qt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],s=!1,u=n.getIterator(Ft.Wrap),c=u.getNext();c;)s=s||e.isDefinedOn(c.node),i.push(c),c=u.getNext();r=s?ie(i,e.getCompare()):oe;var l=e.toString(),h=(0,a.__assign)({},this.indexSet_);h[l]=e;var f=(0,a.__assign)({},this.indexes_);return f[l]=r,new t(f,h)},t.prototype.addToIndexes=function(e,n){var r=this;return new t((0,o.map)(this.indexes_,(function(t,i){var a=(0,o.safeGet)(r.indexSet_,i);if((0,o.assert)(a,"Missing index implementation for "+i),t===oe){if(a.isDefinedOn(e.node)){for(var s=[],u=n.getIterator(Ft.Wrap),c=u.getNext();c;)c.name!==e.name&&s.push(c),c=u.getNext();return s.push(e),ie(s,a.getCompare())}return oe}var l=n.get(e.name),h=t;return l&&(h=h.remove(new Ft(e.name,l))),h.insert(e,e.node)})),this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){return new t((0,o.map)(this.indexes_,(function(t){if(t===oe)return t;var r=n.get(e.name);return r?t.remove(new Ft(e.name,r)):t})),this.indexSet_)},t}(),se=function(){function t(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&$t(this.priorityNode_),this.children_.isEmpty()&&(0,o.assert)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return te||(te=new t(new Wt(Gt),null,ae.Default))},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||te},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?te:e},t.prototype.getChild=function(t){var e=yt(t);return null===e?this:this.getImmediateChild(e).getChild(_t(t))},t.prototype.hasChild=function(t){return null!==this.children_.get(t)},t.prototype.updateImmediateChild=function(e,n){if((0,o.assert)(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var r=new Ft(e,n),i=void 0,a=void 0;n.isEmpty()?(i=this.children_.remove(e),a=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,n),a=this.indexMap_.addToIndexes(r,this.children_));var s=i.isEmpty()?te:this.priorityNode_;return new t(i,s,a)},t.prototype.updateChild=function(t,e){var n=yt(t);if(null===n)return e;(0,o.assert)(".priority"!==yt(t)||1===mt(t),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(_t(t),e);return this.updateImmediateChild(n,r)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(ee,(function(a,s){n[a]=s.val(e),r++,o&&t.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1})),!e&&o&&i<2*r){var a=[];for(var s in n)a[s]=n[s];return a}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.getPriority().isEmpty()||(t+="priority:"+Xt(this.getPriority().val())+":"),this.forEachChild(ee,(function(e,n){var r=n.hash();""!==r&&(t+=":"+e+":"+r)})),this.lazyHash_=""===t?"":m(t)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(t,e,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new Ft(t,e));return i?i.name:null}return this.children_.getPredecessorKey(t)},t.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},t.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new Ft(e,this.children_.get(e)):null},t.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.maxKey();return n&&n.name}return this.children_.maxKey()},t.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new Ft(e,this.children_.get(e)):null},t.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal((function(t){return e(t.name,t.node)})):this.children_.inorderTraversal(e)},t.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},t.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,(function(t){return t}));for(var r=this.children_.getIteratorFrom(t.name,Ft.Wrap),i=r.peek();null!=i&&e.compare(i,t)<0;)r.getNext(),i=r.peek();return r},t.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},t.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,(function(t){return t}));for(var r=this.children_.getReverseIteratorFrom(t.name,Ft.Wrap),i=r.peek();null!=i&&e.compare(i,t)>0;)r.getNext(),i=r.peek();return r},t.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===ue?-1:0},t.prototype.withIndex=function(e){if(e===qt||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(t){return t===qt||this.indexMap_.hasIndex(t)},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){for(var n=this.getIterator(ee),r=e.getIterator(ee),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},t.prototype.resolveIndex_=function(t){return t===qt?null:this.indexMap_.get(t.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}(),ue=new(function(t){function e(){return t.call(this,new Wt(Gt),se.EMPTY_NODE,ae.Default)||this}return(0,a.__extends)(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return se.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(se));Object.defineProperties(Ft,{MIN:{value:new Ft(N,se.EMPTY_NODE)},MAX:{value:new Ft(P,ue)}}),jt.__EMPTY_NODE=se.EMPTY_NODE,Jt.__childrenNodeConstructor=se,Dt=ue,function(t){Yt=t}(ue);function ce(t,e){if(void 0===e&&(e=null),null===t)return se.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),(0,o.assert)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t)return new Jt(t,ce(e));if(t instanceof Array){var n=se.EMPTY_NODE;return M(t,(function(e,r){if((0,o.contains)(t,e)&&"."!==e.substring(0,1)){var i=ce(r);!i.isLeafNode()&&i.isEmpty()||(n=n.updateImmediateChild(e,i))}})),n.updatePriority(ce(e))}var r=[],i=!1;if(M(t,(function(t,e){if("."!==t.substring(0,1)){var n=ce(e);n.isEmpty()||(i=i||!n.getPriority().isEmpty(),r.push(new Ft(t,n)))}})),0===r.length)return se.EMPTY_NODE;var a=ie(r,Ht,(function(t){return t.name}),Gt);if(i){var s=ie(r,ee.getCompare());return new se(a,ce(e),new ae({".priority":s},{".priority":ee}))}return new se(a,ce(e),ae.Default)}!function(t){Qt=t}(ce);var le,he,fe=function(t){function e(e){var n=t.call(this)||this;return n.indexPath_=e,(0,o.assert)(!Et(e)&&".priority"!==yt(e),"Can't create PathIndex with empty path or .priority key"),n}return(0,a.__extends)(e,t),e.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(t,e){var n=this.extractChild(t.node),r=this.extractChild(e.node),i=n.compareTo(r);return 0===i?x(t.name,e.name):i},e.prototype.makePost=function(t,e){var n=ce(t),r=se.EMPTY_NODE.updateChild(this.indexPath_,n);return new Ft(e,r)},e.prototype.maxPost=function(){var t=se.EMPTY_NODE.updateChild(this.indexPath_,ue);return new Ft(P,t)},e.prototype.toString=function(){return wt(this.indexPath_,0).join("/")},e}(Ut),de=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,a.__extends)(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?x(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return Ft.MIN},e.prototype.maxPost=function(){return Ft.MAX},e.prototype.makePost=function(t,e){var n=ce(t);return new Ft(e,n)},e.prototype.toString=function(){return".value"},e}(Ut)),pe="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",ve=(le=0,he=[],function(t){var e,n=t===le;le=t;var r=new Array(8);for(e=7;e>=0;e--)r[e]=pe.charAt(t%64),t=Math.floor(t/64);(0,o.assert)(0===t,"Cannot push at time == 0");var i=r.join("");if(n){for(e=11;e>=0&&63===he[e];e--)he[e]=0;he[e]++}else for(e=0;e<12;e++)he[e]=Math.floor(64*Math.random());for(e=0;e<12;e++)i+=pe.charAt(he[e]);return(0,o.assert)(20===i.length,"nextPushId: Length should be 20."),i}),ge=function(t){if("2147483647"===t)return"-";var e=V(t);if(null!=e)return""+(e+1);for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t.charAt(r);if(n.length<786)return n.push("-"),n.join("");for(var i=n.length-1;i>=0&&"z"===n[i];)i--;if(-1===i)return P;var o=n[i],a=pe.charAt(pe.indexOf(o)+1);return n[i]=a,n.slice(0,i+1).join("")},ye=function(t){if("-2147483648"===t)return N;var e=V(t);if(null!=e)return""+(e-1);for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t.charAt(r);return"-"===n[n.length-1]?1===n.length?"2147483647":(delete n[n.length-1],n.join("")):(n[n.length-1]=pe.charAt(pe.indexOf(n[n.length-1])-1),n.join("")+"z".repeat(786-n.length))};function me(t){return{type:"value",snapshotNode:t}}function _e(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function be(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function we(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}var Ie=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,r,i,a){(0,o.assert)(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var s=t.getImmediateChild(e);return s.getChild(r).equals(n.getChild(r))&&s.isEmpty()===n.isEmpty()?t:(null!=a&&(n.isEmpty()?t.hasChild(e)?a.trackChildChange(be(e,s)):(0,o.assert)(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):s.isEmpty()?a.trackChildChange(_e(e,n)):a.trackChildChange(we(e,n,s))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},t.prototype.updateFullNode=function(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(ee,(function(t,r){e.hasChild(t)||n.trackChildChange(be(t,r))})),e.isLeafNode()||e.forEachChild(ee,(function(e,r){if(t.hasChild(e)){var i=t.getImmediateChild(e);i.equals(r)||n.trackChildChange(we(e,r,i))}else n.trackChildChange(_e(e,r))}))),e.withIndex(this.index_)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?se.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}(),Te=function(){function t(e){this.indexedFilter_=new Ie(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0},t.prototype.updateChild=function(t,e,n,r,i,o){return this.matches(new Ft(e,n))||(n=se.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,r,i,o)},t.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=se.EMPTY_NODE);var r=e.withIndex(this.index_);r=r.updatePriority(se.EMPTY_NODE);var i=this;return e.forEachChild(ee,(function(t,e){i.matches(new Ft(t,e))||(r=r.updateImmediateChild(t,se.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},t.getEndPost_=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},t}(),Ee=function(){function t(t){this.rangedFilter_=new Te(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,r,i,o){return this.rangedFilter_.matches(new Ft(e,n))||(n=se.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,r,i,o):this.fullLimitUpdateChild_(t,e,n,i,o)},t.prototype.updateFullNode=function(t,e,n){var r;if(e.isLeafNode()||e.isEmpty())r=se.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){r=se.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var a=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(a.name,a.node),o++}}else{r=(r=e.withIndex(this.index_)).updatePriority(se.EMPTY_NODE);var s=void 0,u=void 0,c=void 0;i=void 0;if(this.reverse_){i=r.getReverseIterator(this.index_),s=this.rangedFilter_.getEndPost(),u=this.rangedFilter_.getStartPost();var l=this.index_.getCompare();c=function(t,e){return l(e,t)}}else i=r.getIterator(this.index_),s=this.rangedFilter_.getStartPost(),u=this.rangedFilter_.getEndPost(),c=this.index_.getCompare();o=0;for(var h=!1;i.hasNext();){a=i.getNext();!h&&c(s,a)<=0&&(h=!0),h&&o<this.limit_&&c(a,u)<=0?o++:r=r.updateImmediateChild(a.name,se.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,r,i){var a;if(this.reverse_){var s=this.index_.getCompare();a=function(t,e){return s(e,t)}}else a=this.index_.getCompare();var u=t;(0,o.assert)(u.numChildren()===this.limit_,"");var c=new Ft(e,n),l=this.reverse_?u.getFirstChild(this.index_):u.getLastChild(this.index_),h=this.rangedFilter_.matches(c);if(u.hasChild(e)){for(var f=u.getImmediateChild(e),d=r.getChildAfterChild(this.index_,l,this.reverse_);null!=d&&(d.name===e||u.hasChild(d.name));)d=r.getChildAfterChild(this.index_,d,this.reverse_);var p=null==d?1:a(d,c);if(h&&!n.isEmpty()&&p>=0)return null!=i&&i.trackChildChange(we(e,n,f)),u.updateImmediateChild(e,n);null!=i&&i.trackChildChange(be(e,f));var v=u.updateImmediateChild(e,se.EMPTY_NODE);return null!=d&&this.rangedFilter_.matches(d)?(null!=i&&i.trackChildChange(_e(d.name,d.node)),v.updateImmediateChild(d.name,d.node)):v}return n.isEmpty()?t:h&&a(l,c)>=0?(null!=i&&(i.trackChildChange(be(l.name,l.node)),i.trackChildChange(_e(e,n))),u.updateImmediateChild(e,n).updateImmediateChild(l.name,se.EMPTY_NODE)):t},t}(),Se=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=ee}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.hasStartAfter=function(){return this.startAfterSet_},t.prototype.hasEndBefore=function(){return this.endBeforeSet_},t.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_},t.prototype.getIndexStartValue=function(){return(0,o.assert)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return(0,o.assert)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:N},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return(0,o.assert)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return(0,o.assert)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:P},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},t.prototype.getLimit=function(){return(0,o.assert)(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===ee},t.prototype.copy=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t}();function Ce(t,e,n){var r=t.copy();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function ke(t,e,n){var r=t.copy();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function Ae(t,e){var n=t.copy();return n.index_=e,n}function Ne(t){var e,n={};return t.isDefault()||(t.index_===ee?e="$priority":t.index_===de?e="$value":t.index_===qt?e="$key":((0,o.assert)(t.index_ instanceof fe,"Unrecognized index type!"),e=t.index_.toString()),n.orderBy=(0,o.stringify)(e),t.startSet_&&(n.startAt=(0,o.stringify)(t.indexStartValue_),t.startNameSet_&&(n.startAt+=","+(0,o.stringify)(t.indexStartName_))),t.endSet_&&(n.endAt=(0,o.stringify)(t.indexEndValue_),t.endNameSet_&&(n.endAt+=","+(0,o.stringify)(t.indexEndName_))),t.limitSet_&&(t.isViewFromLeft()?n.limitToFirst=t.limit_:n.limitToLast=t.limit_)),n}function Pe(t){var e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_)),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_)),t.limitSet_){e.l=t.limit_;var n=t.viewFrom_;""===n&&(n=t.isViewFromLeft()?"l":"r"),e.vf=n}return t.index_!==ee&&(e.i=t.index_.toString()),e}var xe=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.repoInfo_=e,o.onDataUpdate_=n,o.authTokenProvider_=r,o.appCheckTokenProvider_=i,o.log_=E("p:rest:"),o.listens_={},o}return(0,a.__extends)(e,t),e.prototype.reportStats=function(t){throw new Error("Method not implemented.")},e.getListenId_=function(t,e){return void 0!==e?"tag$"+e:((0,o.assert)(t._queryParams.isDefault(),"should have a tag if it's not a default query."),t._path.toString())},e.prototype.listen=function(t,n,r,i){var a=this,s=t._path.toString();this.log_("Listen called for "+s+" "+t._queryIdentifier);var u=e.getListenId_(t,r),c={};this.listens_[u]=c;var l=Ne(t._queryParams);this.restRequest_(s+".json",l,(function(t,e){var n=e;(404===t&&(n=null,t=null),null===t&&a.onDataUpdate_(s,n,!1,r),(0,o.safeGet)(a.listens_,u)===c)&&i(t?401===t?"permission_denied":"rest_error:"+t:"ok",null)}))},e.prototype.unlisten=function(t,n){var r=e.getListenId_(t,n);delete this.listens_[r]},e.prototype.get=function(t){var e=this,n=Ne(t._queryParams),r=t._path.toString(),i=new o.Deferred;return this.restRequest_(r+".json",n,(function(t,n){var o=n;404===t&&(o=null,t=null),null===t?(e.onDataUpdate_(r,o,!1,null),i.resolve(o)):i.reject(new Error(o))})),i.promise},e.prototype.refreshAuthToken=function(t){},e.prototype.restRequest_=function(t,e,n){var r=this;return void 0===e&&(e={}),e.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then((function(i){var s=(0,a.__read)(i,2),u=s[0],c=s[1];u&&u.accessToken&&(e.auth=u.accessToken),c&&c.token&&(e.ac=c.token);var l=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+t+"?ns="+r.repoInfo_.namespace+(0,o.querystring)(e);r.log_("Sending REST request for "+l);var h=new XMLHttpRequest;h.onreadystatechange=function(){if(n&&4===h.readyState){r.log_("REST Response for "+l+" received. status:",h.status,"response:",h.responseText);var t=null;if(h.status>=200&&h.status<300){try{t=(0,o.jsonEval)(h.responseText)}catch(t){k("Failed to parse JSON response for "+l+": "+h.responseText)}n(null,t)}else 401!==h.status&&404!==h.status&&k("Got unsuccessful REST response for "+l+" Status: "+h.status),n(h.status);n=null}},h.open("GET",l,!0),h.send()}))},e}(ft),Re=function(){function t(){this.rootNode_=se.EMPTY_NODE}return t.prototype.getNode=function(t){return this.rootNode_.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},t}();function De(){return{value:null,children:new Map}}function Oe(t,e,n){if(Et(e))t.value=n,t.children.clear();else if(null!==t.value)t.value=t.value.updateChild(e,n);else{var r=yt(e);t.children.has(r)||t.children.set(r,De()),Oe(t.children.get(r),e=_t(e),n)}}function Le(t,e){if(Et(e))return t.value=null,t.children.clear(),!0;if(null!==t.value){if(t.value.isLeafNode())return!1;var n=t.value;return t.value=null,n.forEachChild(ee,(function(e,n){Oe(t,new vt(e),n)})),Le(t,e)}if(t.children.size>0){var r=yt(e);if(e=_t(e),t.children.has(r))Le(t.children.get(r),e)&&t.children.delete(r);return 0===t.children.size}return!0}function Me(t,e,n){null!==t.value?n(e,t.value):function(t,e){t.children.forEach((function(t,n){e(n,t)}))}(t,(function(t,r){Me(r,new vt(e.toString()+"/"+t),n)}))}var Fe,Ue=function(){function t(t){this.collection_=t,this.last_=null}return t.prototype.get=function(){var t=this.collection_.get(),e=(0,a.__assign)({},t);return this.last_&&M(this.last_,(function(t,n){e[t]=e[t]-n})),this.last_=t,e},t}(),je=function(){function t(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new Ue(t);var n=1e4+2e4*Math.random();K(this.reportStats_.bind(this),Math.floor(n))}return t.prototype.reportStats_=function(){var t=this,e=this.statsListener_.get(),n={},r=!1;M(e,(function(e,i){i>0&&(0,o.contains)(t.statsToReport_,e)&&(n[e]=i,r=!0)})),r&&this.server_.reportStats(n),K(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},t}();function qe(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}!function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Fe||(Fe={}));var Ve,Be=function(){function t(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=Fe.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return t.prototype.operationForChild=function(e){if(Et(this.path)){if(null!=this.affectedTree.value)return(0,o.assert)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new vt(e));return new t(gt(),n,this.revert)}return(0,o.assert)(yt(this.path)===e,"operationForChild called for unrelated child."),new t(_t(this.path),this.affectedTree,this.revert)},t}(),Ke=function(){function t(t,e){this.source=t,this.path=e,this.type=Fe.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return Et(this.path)?new t(this.source,gt()):new t(this.source,_t(this.path))},t}(),We=function(){function t(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=Fe.OVERWRITE}return t.prototype.operationForChild=function(e){return Et(this.path)?new t(this.source,gt(),this.snap.getImmediateChild(e)):new t(this.source,_t(this.path),this.snap)},t}(),He=function(){function t(t,e,n){this.source=t,this.path=e,this.children=n,this.type=Fe.MERGE}return t.prototype.operationForChild=function(e){if(Et(this.path)){var n=this.children.subtree(new vt(e));return n.isEmpty()?null:n.value?new We(this.source,gt(),n.value):new t(this.source,gt(),n)}return(0,o.assert)(yt(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,_t(this.path),this.children)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}(),Ge=function(){function t(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(t){if(Et(t))return this.isFullyInitialized()&&!this.filtered_;var e=yt(t);return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},t.prototype.getNode=function(){return this.node_},t}(),ze=function(t){this.query_=t,this.index_=this.query_._queryParams.getIndex()};function Qe(t,e,n,r,i,a){var s=r.filter((function(t){return t.type===n}));s.sort((function(e,n){return function(t,e,n){if(null==e.childName||null==n.childName)throw(0,o.assertionError)("Should only compare child_ events.");var r=new Ft(e.childName,e.snapshotNode),i=new Ft(n.childName,n.snapshotNode);return t.index_.compare(r,i)}(t,e,n)})),s.forEach((function(n){var r=function(t,e,n){return"value"===e.type||"child_removed"===e.type||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}(t,n,a);i.forEach((function(i){i.respondsTo(n.type)&&e.push(i.createEvent(r,t.query_))}))}))}function Ye(t,e){return{eventCache:t,serverCache:e}}function Xe(t,e,n,r){return Ye(new Ge(e,n,r),t.serverCache)}function $e(t,e,n,r){return Ye(t.eventCache,new Ge(e,n,r))}function Je(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Ze(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var tn=function(){function t(t,e){void 0===e&&(Ve||(Ve=new Wt(R)),e=Ve),this.value=t,this.children=e}return t.fromObject=function(e){var n=new t(null);return M(e,(function(t,e){n=n.set(new vt(t),e)})),n},t.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:gt(),value:this.value};if(Et(t))return null;var n=yt(t),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(_t(t),e);return null!=i?{path:Tt(new vt(n),i.path),value:i.value}:null}return null},t.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,(function(){return!0}))},t.prototype.subtree=function(e){if(Et(e))return this;var n=yt(e),r=this.children.get(n);return null!==r?r.subtree(_t(e)):new t(null)},t.prototype.set=function(e,n){if(Et(e))return new t(n,this.children);var r=yt(e),i=(this.children.get(r)||new t(null)).set(_t(e),n),o=this.children.insert(r,i);return new t(this.value,o)},t.prototype.remove=function(e){if(Et(e))return this.children.isEmpty()?new t(null):new t(null,this.children);var n=yt(e),r=this.children.get(n);if(r){var i=r.remove(_t(e)),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?new t(null):new t(this.value,o)}return this},t.prototype.get=function(t){if(Et(t))return this.value;var e=yt(t),n=this.children.get(e);return n?n.get(_t(t)):null},t.prototype.setTree=function(e,n){if(Et(e))return n;var r=yt(e),i=(this.children.get(r)||new t(null)).setTree(_t(e),n),o=void 0;return o=i.isEmpty()?this.children.remove(r):this.children.insert(r,i),new t(this.value,o)},t.prototype.fold=function(t){return this.fold_(gt(),t)},t.prototype.fold_=function(t,e){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(Tt(t,r),e)})),e(t,this.value,n)},t.prototype.findOnPath=function(t,e){return this.findOnPath_(t,gt(),e)},t.prototype.findOnPath_=function(t,e,n){var r=!!this.value&&n(e,this.value);if(r)return r;if(Et(t))return null;var i=yt(t),o=this.children.get(i);return o?o.findOnPath_(_t(t),Tt(e,i),n):null},t.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,gt(),e)},t.prototype.foreachOnPath_=function(e,n,r){if(Et(e))return this;this.value&&r(n,this.value);var i=yt(e),o=this.children.get(i);return o?o.foreachOnPath_(_t(e),Tt(n,i),r):new t(null)},t.prototype.foreach=function(t){this.foreach_(gt(),t)},t.prototype.foreach_=function(t,e){this.children.inorderTraversal((function(n,r){r.foreach_(Tt(t,n),e)})),this.value&&e(t,this.value)},t.prototype.foreachChild=function(t){this.children.inorderTraversal((function(e,n){n.value&&t(e,n.value)}))},t}(),en=function(){function t(t){this.writeTree_=t}return t.empty=function(){return new t(new tn(null))},t}();function nn(t,e,n){if(Et(e))return new en(new tn(n));var r=t.writeTree_.findRootMostValueAndPath(e);if(null!=r){var i=r.path,o=r.value,a=St(i,e);return o=o.updateChild(a,n),new en(t.writeTree_.set(i,o))}var s=new tn(n),u=t.writeTree_.setTree(e,s);return new en(u)}function rn(t,e,n){var r=t;return M(n,(function(t,n){r=nn(r,Tt(e,t),n)})),r}function on(t,e){if(Et(e))return en.empty();var n=t.writeTree_.setTree(e,new tn(null));return new en(n)}function an(t,e){return null!=sn(t,e)}function sn(t,e){var n=t.writeTree_.findRootMostValueAndPath(e);return null!=n?t.writeTree_.get(n.path).getChild(St(n.path,e)):null}function un(t){var e=[],n=t.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(ee,(function(t,n){e.push(new Ft(t,n))})):t.writeTree_.children.inorderTraversal((function(t,n){null!=n.value&&e.push(new Ft(t,n.value))})),e}function cn(t,e){if(Et(e))return t;var n=sn(t,e);return new en(null!=n?new tn(n):t.writeTree_.subtree(e))}function ln(t){return t.writeTree_.isEmpty()}function hn(t,e){return fn(gt(),t.writeTree_,e)}function fn(t,e,n){if(null!=e.value)return n.updateChild(t,e.value);var r=null;return e.children.inorderTraversal((function(e,i){".priority"===e?((0,o.assert)(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=fn(Tt(t,e),i,n)})),n.getChild(t).isEmpty()||null===r||(n=n.updateChild(Tt(t,".priority"),r)),n}function dn(t,e){return Cn(e,t)}function pn(t,e){var n=t.allWrites.findIndex((function(t){return t.writeId===e}));(0,o.assert)(n>=0,"removeWrite called with nonexistent writeId.");var r=t.allWrites[n];t.allWrites.splice(n,1);for(var i=r.visible,a=!1,s=t.allWrites.length-1;i&&s>=0;){var u=t.allWrites[s];u.visible&&(s>=n&&vn(u,r.path)?i=!1:At(r.path,u.path)&&(a=!0)),s--}if(i){if(a)return function(t){t.visibleWrites=yn(t.allWrites,gn,gt()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}(t),!0;r.snap?t.visibleWrites=on(t.visibleWrites,r.path):M(r.children,(function(e){t.visibleWrites=on(t.visibleWrites,Tt(r.path,e))}));return!0}return!1}function vn(t,e){if(t.snap)return At(t.path,e);for(var n in t.children)if(t.children.hasOwnProperty(n)&&At(Tt(t.path,n),e))return!0;return!1}function gn(t){return t.visible}function yn(t,e,n){for(var r=en.empty(),i=0;i<t.length;++i){var a=t[i];if(e(a)){var s=a.path,u=void 0;if(a.snap)At(n,s)?r=nn(r,u=St(n,s),a.snap):At(s,n)&&(u=St(s,n),r=nn(r,gt(),a.snap.getChild(u)));else{if(!a.children)throw(0,o.assertionError)("WriteRecord should have .snap or .children");if(At(n,s))r=rn(r,u=St(n,s),a.children);else if(At(s,n))if(Et(u=St(s,n)))r=rn(r,gt(),a.children);else{var c=(0,o.safeGet)(a.children,yt(u));if(c){var l=c.getChild(_t(u));r=nn(r,gt(),l)}}}}}return r}function mn(t,e,n,r,i){if(r||i){var o=cn(t.visibleWrites,e);if(!i&&ln(o))return n;if(i||null!=n||an(o,gt())){return hn(yn(t.allWrites,(function(t){return(t.visible||i)&&(!r||!~r.indexOf(t.writeId))&&(At(t.path,e)||At(e,t.path))}),e),n||se.EMPTY_NODE)}return null}var a=sn(t.visibleWrites,e);if(null!=a)return a;var s=cn(t.visibleWrites,e);return ln(s)?n:null!=n||an(s,gt())?hn(s,n||se.EMPTY_NODE):null}function _n(t,e,n,r){return mn(t.writeTree,t.treePath,e,n,r)}function bn(t,e){return function(t,e,n){var r=se.EMPTY_NODE,i=sn(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(ee,(function(t,e){r=r.updateImmediateChild(t,e)})),r;if(n){var o=cn(t.visibleWrites,e);return n.forEachChild(ee,(function(t,e){var n=hn(cn(o,new vt(t)),e);r=r.updateImmediateChild(t,n)})),un(o).forEach((function(t){r=r.updateImmediateChild(t.name,t.node)})),r}return un(cn(t.visibleWrites,e)).forEach((function(t){r=r.updateImmediateChild(t.name,t.node)})),r}(t.writeTree,t.treePath,e)}function wn(t,e,n,r){return function(t,e,n,r,i){(0,o.assert)(r||i,"Either existingEventSnap or existingServerSnap must exist");var a=Tt(e,n);if(an(t.visibleWrites,a))return null;var s=cn(t.visibleWrites,a);return ln(s)?i.getChild(n):hn(s,i.getChild(n))}(t.writeTree,t.treePath,e,n,r)}function In(t,e){return function(t,e){return sn(t.visibleWrites,e)}(t.writeTree,Tt(t.treePath,e))}function Tn(t,e,n,r,i,o){return function(t,e,n,r,i,o,a){var s,u=cn(t.visibleWrites,e),c=sn(u,gt());if(null!=c)s=c;else{if(null==n)return[];s=hn(u,n)}if((s=s.withIndex(a)).isEmpty()||s.isLeafNode())return[];for(var l=[],h=a.getCompare(),f=o?s.getReverseIteratorFrom(r,a):s.getIteratorFrom(r,a),d=f.getNext();d&&l.length<i;)0!==h(d,r)&&l.push(d),d=f.getNext();return l}(t.writeTree,t.treePath,e,n,r,i,o)}function En(t,e,n){return function(t,e,n,r){var i=Tt(e,n),o=sn(t.visibleWrites,i);return null!=o?o:r.isCompleteForChild(n)?hn(cn(t.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(t.writeTree,t.treePath,e,n)}function Sn(t,e){return Cn(Tt(t.treePath,e),t.writeTree)}function Cn(t,e){return{treePath:t,writeTree:e}}var kn=function(){function t(){this.changeMap=new Map}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;(0,o.assert)("child_added"===e||"child_changed"===e||"child_removed"===e,"Only child changes supported for tracking"),(0,o.assert)(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===e&&"child_removed"===i)this.changeMap.set(n,we(n,t.snapshotNode,r.snapshotNode));else if("child_removed"===e&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===e&&"child_changed"===i)this.changeMap.set(n,be(n,r.oldSnap));else if("child_changed"===e&&"child_added"===i)this.changeMap.set(n,_e(n,t.snapshotNode));else{if("child_changed"!==e||"child_changed"!==i)throw(0,o.assertionError)("Illegal combination of changes: "+t+" occurred after "+r);this.changeMap.set(n,we(n,t.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,t)},t.prototype.getChanges=function(){return Array.from(this.changeMap.values())},t}(),An=new(function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}()),Nn=function(){function t(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}return t.prototype.getCompleteChild=function(t){var e=this.viewCache_.eventCache;if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new Ge(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return En(this.writes_,t,n)},t.prototype.getChildAfterChild=function(t,e,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Ze(this.viewCache_),i=Tn(this.writes_,r,e,1,n,t);return 0===i.length?null:i[0]},t}();function Pn(t,e,n,r,i){var a,s,u=new kn;if(n.type===Fe.OVERWRITE){var c=n;c.source.fromUser?a=Dn(t,e,c.path,c.snap,r,i,u):((0,o.assert)(c.source.fromServer,"Unknown source."),s=c.source.tagged||e.serverCache.isFiltered()&&!Et(c.path),a=Rn(t,e,c.path,c.snap,r,i,s,u))}else if(n.type===Fe.MERGE){var l=n;l.source.fromUser?a=function(t,e,n,r,i,o,a){var s=e;return r.foreach((function(r,u){var c=Tt(n,r);On(e,yt(c))&&(s=Dn(t,s,c,u,i,o,a))})),r.foreach((function(r,u){var c=Tt(n,r);On(e,yt(c))||(s=Dn(t,s,c,u,i,o,a))})),s}(t,e,l.path,l.children,r,i,u):((0,o.assert)(l.source.fromServer,"Unknown source."),s=l.source.tagged||e.serverCache.isFiltered(),a=Mn(t,e,l.path,l.children,r,i,s,u))}else if(n.type===Fe.ACK_USER_WRITE){var h=n;a=h.revert?function(t,e,n,r,i,a){var s;if(null!=In(r,n))return e;var u=new Nn(r,e,i),c=e.eventCache.getNode(),l=void 0;if(Et(n)||".priority"===yt(n)){var h=void 0;if(e.serverCache.isFullyInitialized())h=_n(r,Ze(e));else{var f=e.serverCache.getNode();(0,o.assert)(f instanceof se,"serverChildren would be complete if leaf node"),h=bn(r,f)}h=h,l=t.filter.updateFullNode(c,h,a)}else{var d=yt(n),p=En(r,d,e.serverCache);null==p&&e.serverCache.isCompleteForChild(d)&&(p=c.getImmediateChild(d)),(l=null!=p?t.filter.updateChild(c,d,p,_t(n),u,a):e.eventCache.getNode().hasChild(d)?t.filter.updateChild(c,d,se.EMPTY_NODE,_t(n),u,a):c).isEmpty()&&e.serverCache.isFullyInitialized()&&(s=_n(r,Ze(e))).isLeafNode()&&(l=t.filter.updateFullNode(l,s,a))}return s=e.serverCache.isFullyInitialized()||null!=In(r,gt()),Xe(e,l,s,t.filter.filtersNodes())}(t,e,h.path,r,i,u):function(t,e,n,r,i,o,a){if(null!=In(i,n))return e;var s=e.serverCache.isFiltered(),u=e.serverCache;if(null!=r.value){if(Et(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return Rn(t,e,n,u.getNode().getChild(n),i,o,s,a);if(Et(n)){var c=new tn(null);return u.getNode().forEachChild(qt,(function(t,e){c=c.set(new vt(t),e)})),Mn(t,e,n,c,i,o,s,a)}return e}var l=new tn(null);return r.foreach((function(t,e){var r=Tt(n,t);u.isCompleteForPath(r)&&(l=l.set(t,u.getNode().getChild(r)))})),Mn(t,e,n,l,i,o,s,a)}(t,e,h.path,h.affectedTree,r,i,u)}else{if(n.type!==Fe.LISTEN_COMPLETE)throw(0,o.assertionError)("Unknown operation type: "+n.type);a=function(t,e,n,r,i){var o=e.serverCache,a=$e(e,o.getNode(),o.isFullyInitialized()||Et(n),o.isFiltered());return xn(t,a,n,r,An,i)}(t,e,n.path,r,u)}var f=u.getChanges();return function(t,e,n){var r=e.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=Je(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(me(Je(e)))}}(e,a,f),{viewCache:a,changes:f}}function xn(t,e,n,r,i,a){var s=e.eventCache;if(null!=In(r,n))return e;var u=void 0,c=void 0;if(Et(n))if((0,o.assert)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){var l=Ze(e),h=bn(r,l instanceof se?l:se.EMPTY_NODE);u=t.filter.updateFullNode(e.eventCache.getNode(),h,a)}else{var f=_n(r,Ze(e));u=t.filter.updateFullNode(e.eventCache.getNode(),f,a)}else{var d=yt(n);if(".priority"===d){(0,o.assert)(1===mt(n),"Can't have a priority with additional path components");var p=s.getNode(),v=wn(r,n,p,c=e.serverCache.getNode());u=null!=v?t.filter.updatePriority(p,v):s.getNode()}else{var g=_t(n),y=void 0;if(s.isCompleteForChild(d)){c=e.serverCache.getNode();var m=wn(r,n,s.getNode(),c);y=null!=m?s.getNode().getImmediateChild(d).updateChild(g,m):s.getNode().getImmediateChild(d)}else y=En(r,d,e.serverCache);u=null!=y?t.filter.updateChild(s.getNode(),d,y,g,i,a):s.getNode()}}return Xe(e,u,s.isFullyInitialized()||Et(n),t.filter.filtersNodes())}function Rn(t,e,n,r,i,o,a,s){var u,c=e.serverCache,l=a?t.filter:t.filter.getIndexedFilter();if(Et(n))u=l.updateFullNode(c.getNode(),r,null);else if(l.filtersNodes()&&!c.isFiltered()){var h=c.getNode().updateChild(n,r);u=l.updateFullNode(c.getNode(),h,null)}else{var f=yt(n);if(!c.isCompleteForPath(n)&&mt(n)>1)return e;var d=_t(n),p=c.getNode().getImmediateChild(f).updateChild(d,r);u=".priority"===f?l.updatePriority(c.getNode(),p):l.updateChild(c.getNode(),f,p,d,An,null)}var v=$e(e,u,c.isFullyInitialized()||Et(n),l.filtersNodes());return xn(t,v,n,i,new Nn(i,v,o),s)}function Dn(t,e,n,r,i,o,a){var s,u,c=e.eventCache,l=new Nn(i,e,o);if(Et(n))u=t.filter.updateFullNode(e.eventCache.getNode(),r,a),s=Xe(e,u,!0,t.filter.filtersNodes());else{var h=yt(n);if(".priority"===h)u=t.filter.updatePriority(e.eventCache.getNode(),r),s=Xe(e,u,c.isFullyInitialized(),c.isFiltered());else{var f=_t(n),d=c.getNode().getImmediateChild(h),p=void 0;if(Et(f))p=r;else{var v=l.getCompleteChild(h);p=null!=v?".priority"===bt(f)&&v.getChild(It(f)).isEmpty()?v:v.updateChild(f,r):se.EMPTY_NODE}if(d.equals(p))s=e;else s=Xe(e,t.filter.updateChild(c.getNode(),h,p,f,l,a),c.isFullyInitialized(),t.filter.filtersNodes())}}return s}function On(t,e){return t.eventCache.isCompleteForChild(e)}function Ln(t,e,n){return n.foreach((function(t,n){e=e.updateChild(t,n)})),e}function Mn(t,e,n,r,i,o,a,s){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;var u,c=e;u=Et(n)?r:new tn(null).setTree(n,r);var l=e.serverCache.getNode();return u.children.inorderTraversal((function(n,r){if(l.hasChild(n)){var u=Ln(0,e.serverCache.getNode().getImmediateChild(n),r);c=Rn(t,c,new vt(n),u,i,o,a,s)}})),u.children.inorderTraversal((function(n,r){var u=!e.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!l.hasChild(n)&&!u){var h=Ln(0,e.serverCache.getNode().getImmediateChild(n),r);c=Rn(t,c,new vt(n),h,i,o,a,s)}})),c}var Fn,Un=function(){function t(t,e){this.query_=t,this.eventRegistrations_=[];var n,r=this.query_._queryParams,i=new Ie(r.getIndex()),o=(n=r).loadsAllData()?new Ie(n.getIndex()):n.hasLimit()?new Ee(n):new Te(n);this.processor_=function(t){return{filter:t}}(o);var a=e.serverCache,s=e.eventCache,u=i.updateFullNode(se.EMPTY_NODE,a.getNode(),null),c=o.updateFullNode(se.EMPTY_NODE,s.getNode(),null),l=new Ge(u,a.isFullyInitialized(),i.filtersNodes()),h=new Ge(c,s.isFullyInitialized(),o.filtersNodes());this.viewCache_=Ye(h,l),this.eventGenerator_=new ze(this.query_)}return Object.defineProperty(t.prototype,"query",{get:function(){return this.query_},enumerable:!1,configurable:!0}),t}();function jn(t,e){var n=Ze(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!Et(e)&&!n.getImmediateChild(yt(e)).isEmpty())?n.getChild(e):null}function qn(t){return 0===t.eventRegistrations_.length}function Vn(t,e,n){var r=[];if(n){(0,o.assert)(null==e,"A cancel should cancel all event registrations.");var i=t.query._path;t.eventRegistrations_.forEach((function(t){var e=t.createCancelEvent(n,i);e&&r.push(e)}))}if(e){for(var a=[],s=0;s<t.eventRegistrations_.length;++s){var u=t.eventRegistrations_[s];if(u.matches(e)){if(e.hasAnyCallback()){a=a.concat(t.eventRegistrations_.slice(s+1));break}}else a.push(u)}t.eventRegistrations_=a}else t.eventRegistrations_=[];return r}function Bn(t,e,n,r){e.type===Fe.MERGE&&null!==e.source.queryId&&((0,o.assert)(Ze(t.viewCache_),"We should always have a full cache before handling merges"),(0,o.assert)(Je(t.viewCache_),"Missing event cache, even though we have a server cache"));var i,a,s=t.viewCache_,u=Pn(t.processor_,s,e,n,r);return i=t.processor_,a=u.viewCache,(0,o.assert)(a.eventCache.getNode().isIndexed(i.filter.getIndex()),"Event snap not indexed"),(0,o.assert)(a.serverCache.getNode().isIndexed(i.filter.getIndex()),"Server snap not indexed"),(0,o.assert)(u.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=u.viewCache,Kn(t,u.changes,u.viewCache.eventCache.getNode(),null)}function Kn(t,e,n,r){var i=r?[r]:t.eventRegistrations_;return function(t,e,n,r){var i=[],o=[];return e.forEach((function(e){var n;"child_changed"===e.type&&t.index_.indexedValueChanged(e.oldSnap,e.snapshotNode)&&o.push((n=e.childName,{type:"child_moved",snapshotNode:e.snapshotNode,childName:n}))})),Qe(t,i,"child_removed",e,r,n),Qe(t,i,"child_added",e,r,n),Qe(t,i,"child_moved",o,r,n),Qe(t,i,"child_changed",e,r,n),Qe(t,i,"value",e,r,n),i}(t.eventGenerator_,e,n,i)}var Wn,Hn=function(){this.views=new Map};function Gn(t,e,n,r){var i,s,u=e.source.queryId;if(null!==u){var c=t.views.get(u);return(0,o.assert)(null!=c,"SyncTree gave us an op for an invalid query."),Bn(c,e,n,r)}var l=[];try{for(var h=(0,a.__values)(t.views.values()),f=h.next();!f.done;f=h.next()){c=f.value;l=l.concat(Bn(c,e,n,r))}}catch(t){i={error:t}}finally{try{f&&!f.done&&(s=h.return)&&s.call(h)}finally{if(i)throw i.error}}return l}function zn(t,e,n,r,i){var o=e._queryIdentifier,a=t.views.get(o);if(!a){var s=_n(n,i?r:null),u=!1;s?u=!0:r instanceof se?(s=bn(n,r),u=!1):(s=se.EMPTY_NODE,u=!1);var c=Ye(new Ge(s,u,!1),new Ge(r,i,!1));return new Un(e,c)}return a}function Qn(t,e,n,r,i,o){var a=zn(t,e,r,i,o);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,a),function(t,e){t.eventRegistrations_.push(e)}(a,n),function(t,e){var n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(ee,(function(t,e){r.push(_e(t,e))})),n.isFullyInitialized()&&r.push(me(n.getNode())),Kn(t,r,n.getNode(),e)}(a,n)}function Yn(t,e,n,r){var i,s,u=e._queryIdentifier,c=[],l=[],h=tr(t);if("default"===u)try{for(var f=(0,a.__values)(t.views.entries()),d=f.next();!d.done;d=f.next()){var p=(0,a.__read)(d.value,2),v=p[0],g=p[1];l=l.concat(Vn(g,n,r)),qn(g)&&(t.views.delete(v),g.query._queryParams.loadsAllData()||c.push(g.query))}}catch(t){i={error:t}}finally{try{d&&!d.done&&(s=f.return)&&s.call(f)}finally{if(i)throw i.error}}else(g=t.views.get(u))&&(l=l.concat(Vn(g,n,r)),qn(g)&&(t.views.delete(u),g.query._queryParams.loadsAllData()||c.push(g.query)));return h&&!tr(t)&&c.push(new((0,o.assert)(Fn,"Reference.ts has not been loaded"),Fn)(e._repo,e._path)),{removed:c,events:l}}function Xn(t){var e,n,r=[];try{for(var i=(0,a.__values)(t.views.values()),o=i.next();!o.done;o=i.next()){var s=o.value;s.query._queryParams.loadsAllData()||r.push(s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function $n(t,e){var n,r,i=null;try{for(var o=(0,a.__values)(t.views.values()),s=o.next();!s.done;s=o.next()){var u=s.value;i=i||jn(u,e)}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}function Jn(t,e){if(e._queryParams.loadsAllData())return er(t);var n=e._queryIdentifier;return t.views.get(n)}function Zn(t,e){return null!=Jn(t,e)}function tr(t){return null!=er(t)}function er(t){var e,n;try{for(var r=(0,a.__values)(t.views.values()),i=r.next();!i.done;i=r.next()){var o=i.value;if(o.query._queryParams.loadsAllData())return o}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return null}var nr=1,rr=function(t){this.listenProvider_=t,this.syncPointTree_=new tn(null),this.pendingWriteTree_={visibleWrites:en.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map};function ir(t,e,n,r,i){return function(t,e,n,r,i){(0,o.assert)(r>t.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=nn(t.visibleWrites,e,n)),t.lastWriteId=r}(t.pendingWriteTree_,e,n,r,i),i?fr(t,new We({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,n)):[]}function or(t,e,n,r){!function(t,e,n,r){(0,o.assert)(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=rn(t.visibleWrites,e,n),t.lastWriteId=r}(t.pendingWriteTree_,e,n,r);var i=tn.fromObject(n);return fr(t,new He({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,i))}function ar(t,e,n){void 0===n&&(n=!1);var r=function(t,e){for(var n=0;n<t.allWrites.length;n++){var r=t.allWrites[n];if(r.writeId===e)return r}return null}(t.pendingWriteTree_,e);if(pn(t.pendingWriteTree_,e)){var i=new tn(null);return null!=r.snap?i=i.set(gt(),!0):M(r.children,(function(t){i=i.set(new vt(t),!0)})),fr(t,new Be(r.path,i,n))}return[]}function sr(t,e,n){return fr(t,new We({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,n))}function ur(t,e,n,r){var i=e._path,o=t.syncPointTree_.get(i),a=[];if(o&&("default"===e._queryIdentifier||Zn(o,e))){var s=Yn(o,e,n,r);0===o.views.size&&(t.syncPointTree_=t.syncPointTree_.remove(i));var u=s.removed;a=s.events;var c=-1!==u.findIndex((function(t){return t._queryParams.loadsAllData()})),l=t.syncPointTree_.findOnPath(i,(function(t,e){return tr(e)}));if(c&&!l){var h=t.syncPointTree_.subtree(i);if(!h.isEmpty())for(var f=function(t){return t.fold((function(t,e,n){if(e&&tr(e))return[er(e)];var r=[];return e&&(r=Xn(e)),M(n,(function(t,e){r=r.concat(e)})),r}))}(h),d=0;d<f.length;++d){var p=f[d],v=p.query,g=vr(t,p);t.listenProvider_.startListening(wr(v),gr(t,v),g.hashFn,g.onComplete)}}if(!l&&u.length>0&&!r)if(c){t.listenProvider_.stopListening(wr(e),null)}else u.forEach((function(e){var n=t.queryToTagMap.get(yr(e));t.listenProvider_.stopListening(wr(e),n)}));!function(t,e){for(var n=0;n<e.length;++n){var r=e[n];if(!r._queryParams.loadsAllData()){var i=yr(r),o=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(o)}}}(t,u)}return a}function cr(t,e,n){var r=e._path,i=null,a=!1;t.syncPointTree_.foreachOnPath(r,(function(t,e){var n=St(t,r);i=i||$n(e,n),a=a||tr(e)}));var s,u=t.syncPointTree_.get(r);(u?(a=a||tr(u),i=i||$n(u,gt())):(u=new Hn,t.syncPointTree_=t.syncPointTree_.set(r,u)),null!=i)?s=!0:(s=!1,i=se.EMPTY_NODE,t.syncPointTree_.subtree(r).foreachChild((function(t,e){var n=$n(e,gt());n&&(i=i.updateImmediateChild(t,n))})));var c=Zn(u,e);if(!c&&!e._queryParams.loadsAllData()){var l=yr(e);(0,o.assert)(!t.queryToTagMap.has(l),"View does not exist, but we have a tag");var h=nr++;t.queryToTagMap.set(l,h),t.tagToQueryMap.set(h,l)}var f=Qn(u,e,n,dn(t.pendingWriteTree_,r),i,s);if(!c&&!a){var d=Jn(u,e);f=f.concat(function(t,e,n){var r=e._path,i=gr(t,e),a=vr(t,n),s=t.listenProvider_.startListening(wr(e),i,a.hashFn,a.onComplete),u=t.syncPointTree_.subtree(r);if(i)(0,o.assert)(!tr(u.value),"If we're adding a query, it shouldn't be shadowed");else for(var c=u.fold((function(t,e,n){if(!Et(t)&&e&&tr(e))return[er(e).query];var r=[];return e&&(r=r.concat(Xn(e).map((function(t){return t.query})))),M(n,(function(t,e){r=r.concat(e)})),r})),l=0;l<c.length;++l){var h=c[l];t.listenProvider_.stopListening(wr(h),gr(t,h))}return s}(t,e,d))}return f}function lr(t,e,n){var r=t.pendingWriteTree_,i=t.syncPointTree_.findOnPath(e,(function(t,n){var r=$n(n,St(t,e));if(r)return r}));return mn(r,e,i,n,!0)}function hr(t,e){var n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(function(t,e){var i=St(t,n);r=r||$n(e,i)}));var i=t.syncPointTree_.get(n);i?r=r||$n(i,gt()):(i=new Hn,t.syncPointTree_=t.syncPointTree_.set(n,i));var o=null!=r,a=o?new Ge(r,!0,!1):null;return function(t){return Je(t.viewCache_)}(zn(i,e,dn(t.pendingWriteTree_,e._path),o?a.getNode():se.EMPTY_NODE,o))}function fr(t,e){return dr(e,t.syncPointTree_,null,dn(t.pendingWriteTree_,gt()))}function dr(t,e,n,r){if(Et(t.path))return pr(t,e,n,r);var i=e.get(gt());null==n&&null!=i&&(n=$n(i,gt()));var o=[],a=yt(t.path),s=t.operationForChild(a),u=e.children.get(a);if(u&&s){var c=n?n.getImmediateChild(a):null,l=Sn(r,a);o=o.concat(dr(s,u,c,l))}return i&&(o=o.concat(Gn(i,t,r,n))),o}function pr(t,e,n,r){var i=e.get(gt());null==n&&null!=i&&(n=$n(i,gt()));var o=[];return e.children.inorderTraversal((function(e,i){var a=n?n.getImmediateChild(e):null,s=Sn(r,e),u=t.operationForChild(e);u&&(o=o.concat(pr(u,i,a,s)))})),i&&(o=o.concat(Gn(i,t,r,n))),o}function vr(t,e){var n=e.query,r=gr(t,n);return{hashFn:function(){return(function(t){return t.viewCache_.serverCache.getNode()}(e)||se.EMPTY_NODE).hash()},onComplete:function(e){if("ok"===e)return r?function(t,e,n){var r=mr(t,n);if(r){var i=_r(r),o=i.path,a=i.queryId,s=St(o,e);return br(t,o,new Ke(qe(a),s))}return[]}(t,n._path,r):function(t,e){return fr(t,new Ke({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(t,n._path);var i=function(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?n="Client doesn't have permission to access the desired data.":"unavailable"===t&&(n="The service is unavailable");var r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}(e,n);return ur(t,n,null,i)}}}function gr(t,e){var n=yr(e);return t.queryToTagMap.get(n)}function yr(t){return t._path.toString()+"$"+t._queryIdentifier}function mr(t,e){return t.tagToQueryMap.get(e)}function _r(t){var e=t.indexOf("$");return(0,o.assert)(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new vt(t.substr(0,e))}}function br(t,e,n){var r=t.syncPointTree_.get(e);return(0,o.assert)(r,"Missing sync point for query tag that we're tracking"),Gn(r,n,dn(t.pendingWriteTree_,e),null)}function wr(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new((0,o.assert)(Wn,"Reference.ts has not been loaded"),Wn)(t._repo,t._path):t}var Ir=function(){function t(t){this.node_=t}return t.prototype.getImmediateChild=function(e){return new t(this.node_.getImmediateChild(e))},t.prototype.node=function(){return this.node_},t}(),Tr=function(){function t(t,e){this.syncTree_=t,this.path_=e}return t.prototype.getImmediateChild=function(e){var n=Tt(this.path_,e);return new t(this.syncTree_,n)},t.prototype.node=function(){return lr(this.syncTree_,this.path_)},t}(),Er=function(t,e,n){return t&&"object"==typeof t?((0,o.assert)(".sv"in t,"Unexpected leaf node or priority contents"),"string"==typeof t[".sv"]?Sr(t[".sv"],e,n):"object"==typeof t[".sv"]?Cr(t[".sv"],e):void(0,o.assert)(!1,"Unexpected server value: "+JSON.stringify(t,null,2))):t},Sr=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:(0,o.assert)(!1,"Unexpected server value: "+t)}},Cr=function(t,e,n){t.hasOwnProperty("increment")||(0,o.assert)(!1,"Unexpected server value: "+JSON.stringify(t,null,2));var r=t.increment;"number"!=typeof r&&(0,o.assert)(!1,"Unexpected increment value: "+r);var i=e.node();if((0,o.assert)(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var a=i.getValue();return"number"!=typeof a?r:a+r},kr=function(t,e,n,r){return Nr(e,new Tr(n,t),r)},Ar=function(t,e,n){return Nr(t,new Ir(e),n)};function Nr(t,e,n){var r,i=t.getPriority().val(),o=Er(i,e.getImmediateChild(".priority"),n);if(t.isLeafNode()){var a=t,s=Er(a.getValue(),e,n);return s!==a.getValue()||o!==a.getPriority().val()?new Jt(s,ce(o)):t}var u=t;return r=u,o!==u.getPriority().val()&&(r=r.updatePriority(new Jt(o))),u.forEachChild(ee,(function(t,i){var o=Nr(i,e.getImmediateChild(t),n);o!==i&&(r=r.updateImmediateChild(t,o))})),r}var Pr=function(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n={children:{},childCount:0}),this.name=t,this.parent=e,this.node=n};function xr(t,e){for(var n=e instanceof vt?e:new vt(e),r=t,i=yt(n);null!==i;){var a=(0,o.safeGet)(r.node.children,i)||{children:{},childCount:0};r=new Pr(i,r,a),i=yt(n=_t(n))}return r}function Rr(t){return t.node.value}function Dr(t,e){t.node.value=e,Ur(t)}function Or(t){return t.node.childCount>0}function Lr(t,e){M(t.node.children,(function(n,r){e(new Pr(n,t,r))}))}function Mr(t,e,n,r){n&&!r&&e(t),Lr(t,(function(t){Mr(t,e,!0,r)})),n&&r&&e(t)}function Fr(t){return new vt(null===t.parent?t.name:Fr(t.parent)+"/"+t.name)}function Ur(t){null!==t.parent&&function(t,e,n){var r=function(t){return void 0===Rr(t)&&!Or(t)}(n),i=(0,o.contains)(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,Ur(t)):r||i||(t.node.children[e]=n.node,t.node.childCount++,Ur(t))}(t.parent,t.name,t)}var jr=/[\[\].#$\/\u0000-\u001F\u007F]/,qr=/[\[\].#$\u0000-\u001F\u007F]/,Vr=10485760,Br=function(t){return"string"==typeof t&&0!==t.length&&!jr.test(t)},Kr=function(t){return"string"==typeof t&&0!==t.length&&!qr.test(t)},Wr=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!A(t)||t&&"object"==typeof t&&(0,o.contains)(t,".sv")},Hr=function(t,e,n,r){r&&void 0===e||Gr((0,o.errorPrefix)(t,"value"),e,n)},Gr=function(t,e,n){var r=n instanceof vt?new Nt(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+xt(r));if("function"==typeof e)throw new Error(t+"contains a function "+xt(r)+" with contents = "+e.toString());if(A(e))throw new Error(t+"contains "+e.toString()+" "+xt(r));if("string"==typeof e&&e.length>Vr/3&&(0,o.stringLength)(e)>Vr)throw new Error(t+"contains a string greater than "+"10485760 utf8 bytes "+xt(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){var i=!1,a=!1;if(M(e,(function(e,n){if(".value"===e)i=!0;else if(".priority"!==e&&".sv"!==e&&(a=!0,!Br(e)))throw new Error(t+" contains an invalid key ("+e+") "+xt(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');var s,u;!function(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=(0,o.stringLength)(e),Pt(t)}(r,e),Gr(t,n,r),u=(s=r).parts_.pop(),s.byteLength_-=(0,o.stringLength)(u),s.parts_.length>0&&(s.byteLength_-=1)})),i&&a)throw new Error(t+' contains ".value" child '+xt(r)+" in addition to actual children.")}},zr=function(t,e,n,r){if(!r||void 0!==e){var i=(0,o.errorPrefix)(t,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");var a=[];M(e,(function(t,e){var r=new vt(t);if(Gr(i,e,Tt(n,r)),".priority"===bt(r)&&!Wr(e))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(r)})),function(t,e){var n,r;for(n=0;n<e.length;n++)for(var i=wt(r=e[n]),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!Br(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');e.sort(Ct);var a=null;for(n=0;n<e.length;n++){if(r=e[n],null!==a&&At(a,r))throw new Error(t+"contains a path "+a.toString()+" that is ancestor of another path "+r.toString());a=r}}(i,a)}},Qr=function(t,e,n){if(!n||void 0!==e){if(A(e))throw new Error((0,o.errorPrefix)(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Wr(e))throw new Error((0,o.errorPrefix)(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Yr=function(t,e,n){if(!n||void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,o.errorPrefix)(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},Xr=function(t,e,n,r){if(!(r&&void 0===n||Br(n)))throw new Error((0,o.errorPrefix)(t,e)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},$r=function(t,e,n,r){if(!(r&&void 0===n||Kr(n)))throw new Error((0,o.errorPrefix)(t,e)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Jr=function(t,e){if(".info"===yt(e))throw new Error(t+" failed = Can't modify data under /.info/")},Zr=function(t,e){var n=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!Br(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==n.length&&!function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Kr(t)}(n))throw new Error((0,o.errorPrefix)(t,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},ti=function(t,e,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error((0,o.errorPrefix)(t,e)+"must be a boolean.")},ei=function(){this.eventLists_=[],this.recursionDepth_=0};function ni(t,e){for(var n=null,r=0;r<e.length;r++){var i=e[r],o=i.getPath();null===n||kt(o,n.path)||(t.eventLists_.push(n),n=null),null===n&&(n={events:[],path:o}),n.events.push(i)}n&&t.eventLists_.push(n)}function ri(t,e,n){ni(t,n),oi(t,(function(t){return kt(t,e)}))}function ii(t,e,n){ni(t,n),oi(t,(function(t){return At(t,e)||At(e,t)}))}function oi(t,e){t.recursionDepth_++;for(var n=!0,r=0;r<t.eventLists_.length;r++){var i=t.eventLists_[r];if(i)e(i.path)?(ai(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}n&&(t.eventLists_=[]),t.recursionDepth_--}function ai(t){for(var e=0;e<t.events.length;e++){var n=t.events[e];if(null!==n){t.events[e]=null;var r=n.getEventRunner();b&&T("event: "+n.toString()),B(r)}}}var si="repo_interrupt",ui=function(){function t(t,e,n,r){this.repoInfo_=t,this.forceRestClient_=e,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new ei,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=De(),this.transactionQueueTree_=new Pr,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t}();function ci(t,e,n){if(t.stats_=nt(t.repoInfo_),t.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)t.server_=new xe(t.repoInfo_,(function(e,n,r,i){fi(t,e,n,r,i)}),t.authTokenProvider_,t.appCheckProvider_),setTimeout((function(){return di(t,!0)}),0);else{if(null!=n){if("object"!=typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,o.stringify)(n)}catch(t){throw new Error("Invalid authOverride provided: "+t)}}t.persistentConnection_=new Mt(t.repoInfo_,e,(function(e,n,r,i){fi(t,e,n,r,i)}),(function(e){di(t,e)}),(function(e){!function(t,e){M(e,(function(e,n){pi(t,e,n)}))}(t,e)}),t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}var r,i,a;t.authTokenProvider_.addTokenChangeListener((function(e){t.server_.refreshAuthToken(e)})),t.appCheckProvider_.addTokenChangeListener((function(e){t.server_.refreshAppCheckToken(e.token)})),t.statsReporter_=(r=t.repoInfo_,i=function(){return new je(t.stats_,t.server_)},a=r.toString(),et[a]||(et[a]=i()),et[a]),t.infoData_=new Re,t.infoSyncTree_=new rr({startListening:function(e,n,r,i){var o=[],a=t.infoData_.getNode(e._path);return a.isEmpty()||(o=sr(t.infoSyncTree_,e._path,a),setTimeout((function(){i("ok")}),0)),o},stopListening:function(){}}),pi(t,"connected",!1),t.serverSyncTree_=new rr({startListening:function(e,n,r,i){return t.server_.listen(e,r,n,(function(n,r){var o=i(n,r);ii(t.eventQueue_,e._path,o)})),[]},stopListening:function(e,n){t.server_.unlisten(e,n)}})}function li(t){var e=t.infoData_.getNode(new vt(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+e}function hi(t){return(e=(e={timestamp:li(t)})||{}).timestamp=e.timestamp||(new Date).getTime(),e;var e}function fi(t,e,n,r,i){t.dataUpdateCount++;var a=new vt(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;var s=[];if(i)if(r){var u=(0,o.map)(n,(function(t){return ce(t)}));s=function(t,e,n,r){var i=mr(t,r);if(i){var o=_r(i),a=o.path,s=o.queryId,u=St(a,e),c=tn.fromObject(n);return br(t,a,new He(qe(s),u,c))}return[]}(t.serverSyncTree_,a,u,i)}else{var c=ce(n);s=function(t,e,n,r){var i=mr(t,r);if(null!=i){var o=_r(i),a=o.path,s=o.queryId,u=St(a,e);return br(t,a,new We(qe(s),u,n))}return[]}(t.serverSyncTree_,a,c,i)}else if(r){var l=(0,o.map)(n,(function(t){return ce(t)}));s=function(t,e,n){var r=tn.fromObject(n);return fr(t,new He({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(t.serverSyncTree_,a,l)}else{var h=ce(n);s=sr(t.serverSyncTree_,a,h)}var f=a;s.length>0&&(f=Si(t,a)),ii(t.eventQueue_,f,s)}function di(t,e){pi(t,"connected",e),!1===e&&function(t){wi(t,"onDisconnectEvents");var e=hi(t),n=De();Me(t.onDisconnect_,gt(),(function(r,i){var o=kr(r,i,t.serverSyncTree_,e);Oe(n,r,o)}));var r=[];Me(n,gt(),(function(e,n){r=r.concat(sr(t.serverSyncTree_,e,n));var i=Pi(t,e);Si(t,i)})),t.onDisconnect_=De(),ii(t.eventQueue_,gt(),r)}(t)}function pi(t,e,n){var r=new vt("/.info/"+e),i=ce(n);t.infoData_.updateSnapshot(r,i);var o=sr(t.infoSyncTree_,r,i);ii(t.eventQueue_,r,o)}function vi(t){return t.nextWriteId_++}function gi(t,e,n,r,i){wi(t,"set",{path:e.toString(),value:n,priority:r});var o=hi(t),a=ce(n,r),s=lr(t.serverSyncTree_,e),u=Ar(a,s,o),c=vi(t),l=ir(t.serverSyncTree_,e,u,c,!0);ni(t.eventQueue_,l),t.server_.put(e.toString(),a.val(!0),(function(n,r){var o="ok"===n;o||k("set at "+e+" failed: "+n);var a=ar(t.serverSyncTree_,c,!o);ii(t.eventQueue_,e,a),Ii(t,i,n,r)}));var h=Pi(t,e);Si(t,h),ii(t.eventQueue_,h,[])}function yi(t,e,n){t.server_.onDisconnectCancel(e.toString(),(function(r,i){"ok"===r&&Le(t.onDisconnect_,e),Ii(t,n,r,i)}))}function mi(t,e,n,r){var i=ce(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(function(n,o){"ok"===n&&Oe(t.onDisconnect_,e,i),Ii(t,r,n,o)}))}function _i(t,e,n){var r;r=".info"===yt(e._path)?ur(t.infoSyncTree_,e,n):ur(t.serverSyncTree_,e,n),ri(t.eventQueue_,e._path,r)}function bi(t){t.persistentConnection_&&t.persistentConnection_.interrupt(si)}function wi(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r="";t.persistentConnection_&&(r=t.persistentConnection_.id+":"),T.apply(void 0,(0,a.__spreadArray)([r],(0,a.__read)(e)))}function Ii(t,e,n,r){e&&B((function(){if("ok"===n)e(null);else{var t=(n||"error").toUpperCase(),i=t;r&&(i+=": "+r);var o=new Error(i);o.code=t,e(o)}}))}function Ti(t,e,n){return lr(t.serverSyncTree_,e,n)||se.EMPTY_NODE}function Ei(t,e){if(void 0===e&&(e=t.transactionQueueTree_),e||Ni(t,e),Rr(e)){var n=ki(t,e);(0,o.assert)(n.length>0,"Sending zero length transaction queue"),n.every((function(t){return 0===t.status}))&&function(t,e,n){for(var r=n.map((function(t){return t.currentWriteId})),i=Ti(t,e,r),a=i,s=i.hash(),u=0;u<n.length;u++){var c=n[u];(0,o.assert)(0===c.status,"tryToSendTransactionQueue_: items in queue should all be run."),c.status=1,c.retryCount++;var l=St(e,c.path);a=a.updateChild(l,c.currentOutputSnapshotRaw)}var h=a.val(!0),f=e;t.server_.put(f.toString(),h,(function(r){wi(t,"transaction put response",{path:f.toString(),status:r});var i=[];if("ok"===r){for(var o=[],a=function(e){n[e].status=2,i=i.concat(ar(t.serverSyncTree_,n[e].currentWriteId)),n[e].onComplete&&o.push((function(){return n[e].onComplete(null,!0,n[e].currentOutputSnapshotResolved)})),n[e].unwatcher()},s=0;s<n.length;s++)a(s);Ni(t,xr(t.transactionQueueTree_,e)),Ei(t,t.transactionQueueTree_),ii(t.eventQueue_,e,i);for(s=0;s<o.length;s++)B(o[s])}else{if("datastale"===r)for(s=0;s<n.length;s++)3===n[s].status?n[s].status=4:n[s].status=0;else{k("transaction at "+f.toString()+" failed: "+r);for(s=0;s<n.length;s++)n[s].status=4,n[s].abortReason=r}Si(t,e)}}),s)}(t,Fr(e),n)}else Or(e)&&Lr(e,(function(e){Ei(t,e)}))}function Si(t,e){var n=Ci(t,e),r=Fr(n);return function(t,e,n){if(0===e.length)return;for(var r=[],i=[],a=e.filter((function(t){return 0===t.status})).map((function(t){return t.currentWriteId})),s=function(s){var u,c,l=e[s],h=St(n,l.path),f=!1;if((0,o.assert)(null!==h,"rerunTransactionsUnderNode_: relativePath should not be null."),4===l.status)f=!0,u=l.abortReason,i=i.concat(ar(t.serverSyncTree_,l.currentWriteId,!0));else if(0===l.status)if(l.retryCount>=25)f=!0,u="maxretry",i=i.concat(ar(t.serverSyncTree_,l.currentWriteId,!0));else{var d=Ti(t,l.path,a);l.currentInputSnapshot=d;var p=e[s].update(d.val());if(void 0!==p){Gr("transaction failed: Data returned ",p,l.path);var v=ce(p);"object"==typeof p&&null!=p&&(0,o.contains)(p,".priority")||(v=v.updatePriority(d.getPriority()));var g=l.currentWriteId,y=hi(t),m=Ar(v,d,y);l.currentOutputSnapshotRaw=v,l.currentOutputSnapshotResolved=m,l.currentWriteId=vi(t),a.splice(a.indexOf(g),1),i=(i=i.concat(ir(t.serverSyncTree_,l.path,m,l.currentWriteId,l.applyLocally))).concat(ar(t.serverSyncTree_,g,!0))}else f=!0,u="nodata",i=i.concat(ar(t.serverSyncTree_,l.currentWriteId,!0))}ii(t.eventQueue_,n,i),i=[],f&&(e[s].status=2,c=e[s].unwatcher,setTimeout(c,Math.floor(0)),e[s].onComplete&&("nodata"===u?r.push((function(){return e[s].onComplete(null,!1,e[s].currentInputSnapshot)})):r.push((function(){return e[s].onComplete(new Error(u),!1,null)}))))},u=0;u<e.length;u++)s(u);Ni(t,t.transactionQueueTree_);for(u=0;u<r.length;u++)B(r[u]);Ei(t,t.transactionQueueTree_)}(t,ki(t,n),r),r}function Ci(t,e){var n,r=t.transactionQueueTree_;for(n=yt(e);null!==n&&void 0===Rr(r);)r=xr(r,n),n=yt(e=_t(e));return r}function ki(t,e){var n=[];return Ai(t,e,n),n.sort((function(t,e){return t.order-e.order})),n}function Ai(t,e,n){var r=Rr(e);if(r)for(var i=0;i<r.length;i++)n.push(r[i]);Lr(e,(function(e){Ai(t,e,n)}))}function Ni(t,e){var n=Rr(e);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,Dr(e,n.length>0?n:void 0)}Lr(e,(function(e){Ni(t,e)}))}function Pi(t,e){var n=Fr(Ci(t,e)),r=xr(t.transactionQueueTree_,e);return function(t,e,n){for(var r=n?t:t.parent;null!==r;){if(e(r))return!0;r=r.parent}}(r,(function(e){xi(t,e)})),xi(t,r),Mr(r,(function(e){xi(t,e)})),n}function xi(t,e){var n=Rr(e);if(n){for(var r=[],i=[],a=-1,s=0;s<n.length;s++)3===n[s].status||(1===n[s].status?((0,o.assert)(a===s-1,"All SENT items should be at beginning of queue."),a=s,n[s].status=3,n[s].abortReason="set"):((0,o.assert)(0===n[s].status,"Unexpected transaction status in abort"),n[s].unwatcher(),i=i.concat(ar(t.serverSyncTree_,n[s].currentWriteId,!0)),n[s].onComplete&&r.push(n[s].onComplete.bind(null,new Error("set"),!1,null))));-1===a?Dr(e,void 0):n.length=a+1,ii(t.eventQueue_,Fr(e),i);for(s=0;s<r.length;s++)B(r[s])}}var Ri=function(t,e){var n=Di(t),r=n.namespace;"firebase.com"===n.domain&&C(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||C("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&k("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new $(n.host,n.secure,r,e,i,"",r!==n.subdomain),path:new vt(n.pathString)}},Di=function(t){var e="",n="",r="",i="",o="",s=!0,u="https",c=443;if("string"==typeof t){var l=t.indexOf("//");l>=0&&(u=t.substring(0,l-1),t=t.substring(l+2));var h=t.indexOf("/");-1===h&&(h=t.length);var f=t.indexOf("?");-1===f&&(f=t.length),e=t.substring(0,Math.min(h,f)),h<f&&(i=function(t){for(var e="",n=t.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(t){}e+="/"+i}return e}(t.substring(h,f)));var d=function(t){var e,n,r={};"?"===t.charAt(0)&&(t=t.substring(1));try{for(var i=(0,a.__values)(t.split("&")),o=i.next();!o.done;o=i.next()){var s=o.value;if(0!==s.length){var u=s.split("=");2===u.length?r[decodeURIComponent(u[0])]=decodeURIComponent(u[1]):k("Invalid query segment '"+s+"' in query '"+t+"'")}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}(t.substring(Math.min(t.length,f)));(l=e.indexOf(":"))>=0?(s="https"===u||"wss"===u,c=parseInt(e.substring(l+1),10)):l=e.length;var p=e.slice(0,l);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{var v=e.indexOf(".");r=e.substring(0,v).toLowerCase(),n=e.substring(v+1),o=r}"ns"in d&&(o=d.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:s,scheme:u,pathString:i,namespace:o}},Oi=function(){function t(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}return t.prototype.getPath=function(){var t=this.snapshot.ref;return"value"===this.eventType?t._path:t.parent._path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+(0,o.stringify)(this.snapshot.exportVal())},t}(),Li=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}(),Mi=function(){function t(t,e){this.snapshotCallback=t,this.cancelCallback=e}return t.prototype.onValue=function(t,e){this.snapshotCallback.call(null,t,e)},t.prototype.onCancel=function(t){return(0,o.assert)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,t)},Object.defineProperty(t.prototype,"hasCancelCallback",{get:function(){return!!this.cancelCallback},enumerable:!1,configurable:!0}),t.prototype.matches=function(t){return this.snapshotCallback===t.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===t.snapshotCallback.userCallback&&this.snapshotCallback.context===t.snapshotCallback.context},t}(),Fi=function(){function t(t,e){this._repo=t,this._path=e}return t.prototype.cancel=function(){var t=new o.Deferred;return yi(this._repo,this._path,t.wrapCallback((function(){}))),t.promise},t.prototype.remove=function(){Jr("OnDisconnect.remove",this._path);var t=new o.Deferred;return mi(this._repo,this._path,null,t.wrapCallback((function(){}))),t.promise},t.prototype.set=function(t){Jr("OnDisconnect.set",this._path),Hr("OnDisconnect.set",t,this._path,!1);var e=new o.Deferred;return mi(this._repo,this._path,t,e.wrapCallback((function(){}))),e.promise},t.prototype.setWithPriority=function(t,e){Jr("OnDisconnect.setWithPriority",this._path),Hr("OnDisconnect.setWithPriority",t,this._path,!1),Qr("OnDisconnect.setWithPriority",e,!1);var n=new o.Deferred;return function(t,e,n,r,i){var o=ce(n,r);t.server_.onDisconnectPut(e.toString(),o.val(!0),(function(n,r){"ok"===n&&Oe(t.onDisconnect_,e,o),Ii(0,i,n,r)}))}(this._repo,this._path,t,e,n.wrapCallback((function(){}))),n.promise},t.prototype.update=function(t){Jr("OnDisconnect.update",this._path),zr("OnDisconnect.update",t,this._path,!1);var e=new o.Deferred;return function(t,e,n,r){if((0,o.isEmpty)(n))return T("onDisconnect().update() called with empty data.  Don't do anything."),void Ii(0,r,"ok",void 0);t.server_.onDisconnectMerge(e.toString(),n,(function(i,o){"ok"===i&&M(n,(function(n,r){var i=ce(r);Oe(t.onDisconnect_,Tt(e,n),i)})),Ii(0,r,i,o)}))}(this._repo,this._path,t,e.wrapCallback((function(){}))),e.promise},t}(),Ui=function(){function t(t,e,n,r){this._repo=t,this._path=e,this._queryParams=n,this._orderByCalled=r}return Object.defineProperty(t.prototype,"key",{get:function(){return Et(this._path)?null:bt(this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Bi(this._repo,this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_queryIdentifier",{get:function(){var t=Pe(this._queryParams),e=O(t);return"{}"===e?"default":e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_queryObject",{get:function(){return Pe(this._queryParams)},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){if(!((e=(0,o.getModularInstance)(e))instanceof t))return!1;var n=this._repo===e._repo,r=kt(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i},t.prototype.toJSON=function(){return this.toString()},t.prototype.toString=function(){return this._repo.toString()+function(t){for(var e="",n=t.pieceNum_;n<t.pieces_.length;n++)""!==t.pieces_[n]&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}(this._path)},t}();function ji(t,e){if(!0===t._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function qi(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===qt){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==N)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==P)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(t.getIndex()===ee){if(null!=e&&!Wr(e)||null!=n&&!Wr(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,o.assert)(t.getIndex()instanceof fe||t.getIndex()===de,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Vi(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var Bi=function(t){function e(e,n){return t.call(this,e,n,new Se,!1)||this}return(0,a.__extends)(e,t),Object.defineProperty(e.prototype,"parent",{get:function(){var t=It(this._path);return null===t?null:new e(this._repo,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){for(var t=this;null!==t.parent;)t=t.parent;return t},enumerable:!1,configurable:!0}),e}(Ui),Ki=function(){function t(t,e,n){this._node=t,this.ref=e,this._index=n}return Object.defineProperty(t.prototype,"priority",{get:function(){return this._node.getPriority().val()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this.ref.key},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._node.numChildren()},enumerable:!1,configurable:!0}),t.prototype.child=function(e){var n=new vt(e),r=Gi(this.ref,e);return new t(this._node.getChild(n),r,ee)},t.prototype.exists=function(){return!this._node.isEmpty()},t.prototype.exportVal=function(){return this._node.val(!0)},t.prototype.forEach=function(e){var n=this;return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(function(r,i){return e(new t(i,Gi(n.ref,r),ee))}))},t.prototype.hasChild=function(t){var e=new vt(t);return!this._node.getChild(e).isEmpty()},t.prototype.hasChildren=function(){return!this._node.isLeafNode()&&!this._node.isEmpty()},t.prototype.toJSON=function(){return this.exportVal()},t.prototype.val=function(){return this._node.val()},t}();function Wi(t,e){return(t=(0,o.getModularInstance)(t))._checkNotDeleted("ref"),void 0!==e?Gi(t._root,e):t._root}function Hi(t,e){(t=(0,o.getModularInstance)(t))._checkNotDeleted("refFromURL");var n=Ri(e,t._repo.repoInfo_.nodeAdmin);Zr("refFromURL",n);var r=n.repoInfo;return t._repo.repoInfo_.isCustomHost()||r.host===t._repo.repoInfo_.host||C("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),Wi(t,n.path.toString())}function Gi(t,e){var n,r,i,a;return null===yt((t=(0,o.getModularInstance)(t))._path)?(n="child",r="path",a=!1,(i=e)&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),$r(n,r,i,a)):$r("child","path",e,!1),new Bi(t._repo,Tt(t._path,e))}function zi(t,e){t=(0,o.getModularInstance)(t),Jr("push",t._path),Hr("push",e,t._path,!0);var n,r=li(t._repo),i=ve(r),a=Gi(t,i),s=Gi(t,i);return n=null!=e?Yi(s,e).then((function(){return s})):Promise.resolve(s),a.then=n.then.bind(n),a.catch=n.then.bind(n,void 0),a}function Qi(t){return Jr("remove",t._path),Yi(t,null)}function Yi(t,e){t=(0,o.getModularInstance)(t),Jr("set",t._path),Hr("set",e,t._path,!1);var n=new o.Deferred;return gi(t._repo,t._path,e,null,n.wrapCallback((function(){}))),n.promise}function Xi(t,e){t=(0,o.getModularInstance)(t),Jr("setPriority",t._path),Qr("setPriority",e,!1);var n=new o.Deferred;return gi(t._repo,Tt(t._path,".priority"),e,null,n.wrapCallback((function(){}))),n.promise}function $i(t,e,n){if(Jr("setWithPriority",t._path),Hr("setWithPriority",e,t._path,!1),Qr("setWithPriority",n,!1),".length"===t.key||".keys"===t.key)throw"setWithPriority failed: "+t.key+" is a read-only object.";var r=new o.Deferred;return gi(t._repo,t._path,e,n,r.wrapCallback((function(){}))),r.promise}function Ji(t,e){zr("update",e,t._path,!1);var n=new o.Deferred;return function(t,e,n,r){wi(t,"update",{path:e.toString(),value:n});var i=!0,o=hi(t),a={};if(M(n,(function(n,r){i=!1,a[n]=kr(Tt(e,n),ce(r),t.serverSyncTree_,o)})),i)T("update() called with empty data.  Don't do anything."),Ii(0,r,"ok",void 0);else{var s=vi(t),u=or(t.serverSyncTree_,e,a,s);ni(t.eventQueue_,u),t.server_.merge(e.toString(),n,(function(n,i){var o="ok"===n;o||k("update at "+e+" failed: "+n);var a=ar(t.serverSyncTree_,s,!o),u=a.length>0?Si(t,e):e;ii(t.eventQueue_,u,a),Ii(0,r,n,i)})),M(n,(function(n){var r=Pi(t,Tt(e,n));Si(t,r)})),ii(t.eventQueue_,e,[])}}(t._repo,t._path,e,n.wrapCallback((function(){}))),n.promise}function Zi(t){return function(t,e){var n=hr(t.serverSyncTree_,e);return null!=n?Promise.resolve(n):t.server_.get(e).then((function(n){var r=ce(n).withIndex(e._queryParams.getIndex()),i=sr(t.serverSyncTree_,e._path,r);return ri(t.eventQueue_,e._path,i),Promise.resolve(r)}),(function(n){return wi(t,"get for query "+(0,o.stringify)(e)+" failed: "+n),Promise.reject(new Error(n))}))}((t=(0,o.getModularInstance)(t))._repo,t).then((function(e){return new Ki(e,new Bi(t._repo,t._path),t._queryParams.getIndex())}))}var to=function(){function t(t){this.callbackContext=t}return t.prototype.respondsTo=function(t){return"value"===t},t.prototype.createEvent=function(t,e){var n=e._queryParams.getIndex();return new Oi("value",this,new Ki(t.snapshotNode,new Bi(e._repo,e._path),n))},t.prototype.getEventRunner=function(t){var e=this;return"cancel"===t.getEventType()?function(){return e.callbackContext.onCancel(t.error)}:function(){return e.callbackContext.onValue(t.snapshot,null)}},t.prototype.createCancelEvent=function(t,e){return this.callbackContext.hasCancelCallback?new Li(this,t,e):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))},t.prototype.hasAnyCallback=function(){return null!==this.callbackContext},t}(),eo=function(){function t(t,e){this.eventType=t,this.callbackContext=e}return t.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,this.eventType===e},t.prototype.createCancelEvent=function(t,e){return this.callbackContext.hasCancelCallback?new Li(this,t,e):null},t.prototype.createEvent=function(t,e){(0,o.assert)(null!=t.childName,"Child events should have a childName.");var n=Gi(new Bi(e._repo,e._path),t.childName),r=e._queryParams.getIndex();return new Oi(t.type,this,new Ki(t.snapshotNode,n,r),t.prevName)},t.prototype.getEventRunner=function(t){var e=this;return"cancel"===t.getEventType()?function(){return e.callbackContext.onCancel(t.error)}:function(){return e.callbackContext.onValue(t.snapshot,t.prevName)}},t.prototype.matches=function(e){return e instanceof t&&(this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)))},t.prototype.hasAnyCallback=function(){return!!this.callbackContext},t}();function no(t,e,n,r,i){var o;if("object"==typeof r&&(o=void 0,i=r),"function"==typeof r&&(o=r),i&&i.onlyOnce){var a=n,s=function(e,n){_i(t._repo,t,c),a(e,n)};s.userCallback=n.userCallback,s.context=n.context,n=s}var u=new Mi(n,o||void 0),c="value"===e?new to(u):new eo(e,u);return function(t,e,n){var r;r=".info"===yt(e._path)?cr(t.infoSyncTree_,e,n):cr(t.serverSyncTree_,e,n),ri(t.eventQueue_,e._path,r)}(t._repo,t,c),function(){return _i(t._repo,t,c)}}function ro(t,e,n,r){return no(t,"value",e,n,r)}function io(t,e,n,r){return no(t,"child_added",e,n,r)}function oo(t,e,n,r){return no(t,"child_changed",e,n,r)}function ao(t,e,n,r){return no(t,"child_moved",e,n,r)}function so(t,e,n,r){return no(t,"child_removed",e,n,r)}function uo(t,e,n){var r=null,i=n?new Mi(n):null;"value"===e?r=new to(i):e&&(r=new eo(e,i)),_i(t._repo,t,r)}var co=function(){},lo=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return(0,a.__extends)(e,t),e.prototype._apply=function(t){Hr("endAt",this._value,t._path,!0);var e=ke(t._queryParams,this._value,this._key);if(Vi(e),qi(e),t._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Ui(t._repo,t._path,e,t._orderByCalled)},e}(co);function ho(t,e){return Xr("endAt","key",e,!0),new lo(t,e)}var fo=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return(0,a.__extends)(e,t),e.prototype._apply=function(t){Hr("endBefore",this._value,t._path,!1);var e,n,r,i,o=(e=t._queryParams,n=this._value,r=this._key,e.index_===qt?("string"==typeof n&&(n=ye(n)),i=ke(e,n,r)):i=ke(e,n,null==r?N:ye(r)),i.endBeforeSet_=!0,i);if(Vi(o),qi(o),t._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Ui(t._repo,t._path,o,t._orderByCalled)},e}(co);function po(t,e){return Xr("endBefore","key",e,!0),new fo(t,e)}var vo=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return(0,a.__extends)(e,t),e.prototype._apply=function(t){Hr("startAt",this._value,t._path,!0);var e=Ce(t._queryParams,this._value,this._key);if(Vi(e),qi(e),t._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Ui(t._repo,t._path,e,t._orderByCalled)},e}(co);function go(t,e){return void 0===t&&(t=null),Xr("startAt","key",e,!0),new vo(t,e)}var yo=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return(0,a.__extends)(e,t),e.prototype._apply=function(t){Hr("startAfter",this._value,t._path,!1);var e=function(t,e,n){var r;t.index_===qt?("string"==typeof e&&(e=ge(e)),r=Ce(t,e,n)):r=Ce(t,e,null==n?P:ge(n));return r.startAfterSet_=!0,r}(t._queryParams,this._value,this._key);if(Vi(e),qi(e),t._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Ui(t._repo,t._path,e,t._orderByCalled)},e}(co);function mo(t,e){return Xr("startAfter","key",e,!0),new yo(t,e)}var _o=function(t){function e(e){var n=t.call(this)||this;return n._limit=e,n}return(0,a.__extends)(e,t),e.prototype._apply=function(t){if(t._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Ui(t._repo,t._path,(e=t._queryParams,n=this._limit,(r=e.copy()).limitSet_=!0,r.limit_=n,r.viewFrom_="l",r),t._orderByCalled);var e,n,r},e}(co);function bo(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new _o(t)}var wo=function(t){function e(e){var n=t.call(this)||this;return n._limit=e,n}return(0,a.__extends)(e,t),e.prototype._apply=function(t){if(t._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Ui(t._repo,t._path,(e=t._queryParams,n=this._limit,(r=e.copy()).limitSet_=!0,r.limit_=n,r.viewFrom_="r",r),t._orderByCalled);var e,n,r},e}(co);function Io(t){if("number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new wo(t)}var To=function(t){function e(e){var n=t.call(this)||this;return n._path=e,n}return(0,a.__extends)(e,t),e.prototype._apply=function(t){ji(t,"orderByChild");var e=new vt(this._path);if(Et(e))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");var n=new fe(e),r=Ae(t._queryParams,n);return qi(r),new Ui(t._repo,t._path,r,!0)},e}(co);function Eo(t){if("$key"===t)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===t)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===t)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return $r("orderByChild","path",t,!1),new To(t)}var So=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,a.__extends)(e,t),e.prototype._apply=function(t){ji(t,"orderByKey");var e=Ae(t._queryParams,qt);return qi(e),new Ui(t._repo,t._path,e,!0)},e}(co);function Co(){return new So}var ko=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,a.__extends)(e,t),e.prototype._apply=function(t){ji(t,"orderByPriority");var e=Ae(t._queryParams,ee);return qi(e),new Ui(t._repo,t._path,e,!0)},e}(co);function Ao(){return new ko}var No=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,a.__extends)(e,t),e.prototype._apply=function(t){ji(t,"orderByValue");var e=Ae(t._queryParams,de);return qi(e),new Ui(t._repo,t._path,e,!0)},e}(co);function Po(){return new No}var xo=function(t){function e(e,n){var r=t.call(this)||this;return r._value=e,r._key=n,r}return(0,a.__extends)(e,t),e.prototype._apply=function(t){if(Hr("equalTo",this._value,t._path,!1),t._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(t._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new lo(this._value,this._key)._apply(new vo(this._value,this._key)._apply(t))},e}(co);function Ro(t,e){return Xr("equalTo","key",e,!0),new xo(t,e)}function Do(t){for(var e,n,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var s=(0,o.getModularInstance)(t);try{for(var u=(0,a.__values)(r),c=u.next();!c.done;c=u.next()){var l=c.value;s=l._apply(s)}}catch(t){e={error:t}}finally{try{c&&!c.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}return s}!function(t){(0,o.assert)(!Fn,"__referenceConstructor has already been defined"),Fn=t}(Bi),function(t){(0,o.assert)(!Wn,"__referenceConstructor has already been defined"),Wn=t}(Bi);var Oo={},Lo=!1;function Mo(t,e,n,r,i){var o=r||t.options.databaseURL;void 0===o&&(t.options.projectId||C("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),T("Using default host for project ",t.options.projectId),o=t.options.projectId+"-default-rtdb.firebaseio.com");var a,s=Ri(o,i),u=s.repoInfo,c=void 0;"undefined"!=typeof process&&(c=process.env.FIREBASE_DATABASE_EMULATOR_HOST),c?(a=!0,o="http://"+c+"?ns="+u.namespace,u=(s=Ri(o,i)).repoInfo):a=!s.repoInfo.secure;var l=i&&a?new G(G.OWNER):new H(t.name,t.options,e);Zr("Invalid Firebase Database URL",s),Et(s.path)||C("Database URL must point to the root of a Firebase Database (not including a child path).");var h=function(t,e,n,r){var i=Oo[e.name];i||(i={},Oo[e.name]=i);var o=i[t.toURLString()];o&&C("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return o=new ui(t,Lo,n,r),i[t.toURLString()]=o,o}(u,t,l,new W(t.name,n));return new Fo(h,t)}var Fo=function(){function t(t,e){this._repoInternal=t,this.app=e,this.type="database",this._instanceStarted=!1}return Object.defineProperty(t.prototype,"_repo",{get:function(){return this._instanceStarted||(ci(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_root",{get:function(){return this._rootInternal||(this._rootInternal=new Bi(this._repo,gt())),this._rootInternal},enumerable:!1,configurable:!0}),t.prototype._delete=function(){var t,e,n;return null!==this._rootInternal&&(t=this._repo,e=this.app.name,(n=Oo[e])&&n[t.key]===t||C("Database "+e+"("+t.repoInfo_+") has already been deleted."),bi(t),delete n[t.key],this._repoInternal=null,this._rootInternal=null),Promise.resolve()},t.prototype._checkNotDeleted=function(t){null===this._rootInternal&&C("Cannot call "+t+" on a deleted database.")},t}();function Uo(t,e,n,r){void 0===r&&(r={}),(t=(0,o.getModularInstance)(t))._checkNotDeleted("useEmulator"),t._instanceStarted&&C("Cannot call useEmulator() after instance has already been initialized.");var i=t._repoInternal,a=void 0;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&C('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new G(G.OWNER);else if(r.mockUserToken){var s="string"==typeof r.mockUserToken?r.mockUserToken:(0,o.createMockUserToken)(r.mockUserToken,t.app.options.projectId);a=new G(s)}!function(t,e,n,r){t.repoInfo_=new $(e+":"+n,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams),r&&(t.authTokenProvider_=r)}(i,e,n,a)}function jo(t){(t=(0,o.getModularInstance)(t))._checkNotDeleted("goOffline"),bi(t._repo)}function qo(t){var e;(t=(0,o.getModularInstance)(t))._checkNotDeleted("goOnline"),(e=t._repo).persistentConnection_&&e.persistentConnection_.resume(si)}var Vo={".sv":"timestamp"};var Bo=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}();function Ko(t,e,n){var r;if(t=(0,o.getModularInstance)(t),Jr("Reference.transaction",t._path),".length"===t.key||".keys"===t.key)throw"Reference.transaction failed: "+t.key+" is a read-only object.";var i=null===(r=null==n?void 0:n.applyLocally)||void 0===r||r,a=new o.Deferred,s=ro(t,(function(){}));return function(t,e,n,r,i,a){wi(t,"transaction on "+e);var s={path:e,update:n,onComplete:r,status:null,order:y(),applyLocally:a,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},u=Ti(t,e,void 0);s.currentInputSnapshot=u;var c=s.update(u.val());if(void 0===c)s.unwatcher(),s.currentOutputSnapshotRaw=null,s.currentOutputSnapshotResolved=null,s.onComplete&&s.onComplete(null,!1,s.currentInputSnapshot);else{Gr("transaction failed: Data returned ",c,s.path),s.status=0;var l=xr(t.transactionQueueTree_,e),h=Rr(l)||[];h.push(s),Dr(l,h);var f=void 0;"object"==typeof c&&null!==c&&(0,o.contains)(c,".priority")?(f=(0,o.safeGet)(c,".priority"),(0,o.assert)(Wr(f),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):f=(lr(t.serverSyncTree_,e)||se.EMPTY_NODE).getPriority().val();var d=hi(t),p=ce(c,f),v=Ar(p,u,d);s.currentOutputSnapshotRaw=p,s.currentOutputSnapshotResolved=v,s.currentWriteId=vi(t);var g=ir(t.serverSyncTree_,e,v,s.currentWriteId,s.applyLocally);ii(t.eventQueue_,e,g),Ei(t,t.transactionQueueTree_)}}(t._repo,t._path,e,(function(e,n,r){var i=null;e?a.reject(e):(i=new Ki(r,new Bi(t._repo,t._path),ee),a.resolve(new Bo(n,i)))}),s,i),a.promise}var Wo=function(){function t(t){this._delegate=t}return t.prototype.cancel=function(t){(0,o.validateArgCount)("OnDisconnect.cancel",0,1,arguments.length),(0,o.validateCallback)("OnDisconnect.cancel","onComplete",t,!0);var e=this._delegate.cancel();return t&&e.then((function(){return t(null)}),(function(e){return t(e)})),e},t.prototype.remove=function(t){(0,o.validateArgCount)("OnDisconnect.remove",0,1,arguments.length),(0,o.validateCallback)("OnDisconnect.remove","onComplete",t,!0);var e=this._delegate.remove();return t&&e.then((function(){return t(null)}),(function(e){return t(e)})),e},t.prototype.set=function(t,e){(0,o.validateArgCount)("OnDisconnect.set",1,2,arguments.length),(0,o.validateCallback)("OnDisconnect.set","onComplete",e,!0);var n=this._delegate.set(t);return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n},t.prototype.setWithPriority=function(t,e,n){(0,o.validateArgCount)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,o.validateCallback)("OnDisconnect.setWithPriority","onComplete",n,!0);var r=this._delegate.setWithPriority(t,e);return n&&r.then((function(){return n(null)}),(function(t){return n(t)})),r},t.prototype.update=function(t,e){if((0,o.validateArgCount)("OnDisconnect.update",1,2,arguments.length),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,k("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,o.validateCallback)("OnDisconnect.update","onComplete",e,!0);var i=this._delegate.update(t);return e&&i.then((function(){return e(null)}),(function(t){return e(t)})),i},t}(),Ho=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return(0,o.validateArgCount)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}(),Go=function(){function t(t,e){this._database=t,this._delegate=e}return t.prototype.val=function(){return(0,o.validateArgCount)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()},t.prototype.exportVal=function(){return(0,o.validateArgCount)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()},t.prototype.toJSON=function(){return(0,o.validateArgCount)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()},t.prototype.exists=function(){return(0,o.validateArgCount)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()},t.prototype.child=function(e){return(0,o.validateArgCount)("DataSnapshot.child",0,1,arguments.length),e=String(e),$r("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))},t.prototype.hasChild=function(t){return(0,o.validateArgCount)("DataSnapshot.hasChild",1,1,arguments.length),$r("DataSnapshot.hasChild","path",t,!1),this._delegate.hasChild(t)},t.prototype.getPriority=function(){return(0,o.validateArgCount)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority},t.prototype.forEach=function(e){var n=this;return(0,o.validateArgCount)("DataSnapshot.forEach",1,1,arguments.length),(0,o.validateCallback)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach((function(r){return e(new t(n._database,r))}))},t.prototype.hasChildren=function(){return(0,o.validateArgCount)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()},Object.defineProperty(t.prototype,"key",{get:function(){return this._delegate.key},enumerable:!1,configurable:!0}),t.prototype.numChildren=function(){return(0,o.validateArgCount)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size},t.prototype.getRef=function(){return(0,o.validateArgCount)("DataSnapshot.ref",0,0,arguments.length),new Qo(this._database,this._delegate.ref)},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),t}(),zo=function(){function t(t,e){this.database=t,this._delegate=e}return t.prototype.on=function(e,n,r,i){var a,s=this;(0,o.validateArgCount)("Query.on",2,4,arguments.length),(0,o.validateCallback)("Query.on","callback",n,!1);var u=t.getCancelAndContextArgs_("Query.on",r,i),c=function(t,e){n.call(u.context,new Go(s.database,t),e)};c.userCallback=n,c.context=u.context;var l=null===(a=u.cancel)||void 0===a?void 0:a.bind(u.context);switch(e){case"value":return ro(this._delegate,c,l),n;case"child_added":return io(this._delegate,c,l),n;case"child_removed":return so(this._delegate,c,l),n;case"child_changed":return oo(this._delegate,c,l),n;case"child_moved":return ao(this._delegate,c,l),n;default:throw new Error((0,o.errorPrefix)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},t.prototype.off=function(t,e,n){if((0,o.validateArgCount)("Query.off",0,3,arguments.length),Yr("Query.off",t,!0),(0,o.validateCallback)("Query.off","callback",e,!0),(0,o.validateContextObject)("Query.off","context",n,!0),e){var r=function(){};r.userCallback=e,r.context=n,uo(this._delegate,t,r)}else uo(this._delegate,t)},t.prototype.get=function(){var t=this;return Zi(this._delegate).then((function(e){return new Go(t.database,e)}))},t.prototype.once=function(e,n,r,i){var a=this;(0,o.validateArgCount)("Query.once",1,4,arguments.length),(0,o.validateCallback)("Query.once","callback",n,!0);var s=t.getCancelAndContextArgs_("Query.once",r,i),u=new o.Deferred,c=function(t,e){var r=new Go(a.database,t);n&&n.call(s.context,r,e),u.resolve(r)};c.userCallback=n,c.context=s.context;var l=function(t){s.cancel&&s.cancel.call(s.context,t),u.reject(t)};switch(e){case"value":ro(this._delegate,c,l,{onlyOnce:!0});break;case"child_added":io(this._delegate,c,l,{onlyOnce:!0});break;case"child_removed":so(this._delegate,c,l,{onlyOnce:!0});break;case"child_changed":oo(this._delegate,c,l,{onlyOnce:!0});break;case"child_moved":ao(this._delegate,c,l,{onlyOnce:!0});break;default:throw new Error((0,o.errorPrefix)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return u.promise},t.prototype.limitToFirst=function(e){return(0,o.validateArgCount)("Query.limitToFirst",1,1,arguments.length),new t(this.database,Do(this._delegate,bo(e)))},t.prototype.limitToLast=function(e){return(0,o.validateArgCount)("Query.limitToLast",1,1,arguments.length),new t(this.database,Do(this._delegate,Io(e)))},t.prototype.orderByChild=function(e){return(0,o.validateArgCount)("Query.orderByChild",1,1,arguments.length),new t(this.database,Do(this._delegate,Eo(e)))},t.prototype.orderByKey=function(){return(0,o.validateArgCount)("Query.orderByKey",0,0,arguments.length),new t(this.database,Do(this._delegate,Co()))},t.prototype.orderByPriority=function(){return(0,o.validateArgCount)("Query.orderByPriority",0,0,arguments.length),new t(this.database,Do(this._delegate,Ao()))},t.prototype.orderByValue=function(){return(0,o.validateArgCount)("Query.orderByValue",0,0,arguments.length),new t(this.database,Do(this._delegate,Po()))},t.prototype.startAt=function(e,n){return void 0===e&&(e=null),(0,o.validateArgCount)("Query.startAt",0,2,arguments.length),new t(this.database,Do(this._delegate,go(e,n)))},t.prototype.startAfter=function(e,n){return void 0===e&&(e=null),(0,o.validateArgCount)("Query.startAfter",0,2,arguments.length),new t(this.database,Do(this._delegate,mo(e,n)))},t.prototype.endAt=function(e,n){return void 0===e&&(e=null),(0,o.validateArgCount)("Query.endAt",0,2,arguments.length),new t(this.database,Do(this._delegate,ho(e,n)))},t.prototype.endBefore=function(e,n){return void 0===e&&(e=null),(0,o.validateArgCount)("Query.endBefore",0,2,arguments.length),new t(this.database,Do(this._delegate,po(e,n)))},t.prototype.equalTo=function(e,n){return(0,o.validateArgCount)("Query.equalTo",1,2,arguments.length),new t(this.database,Do(this._delegate,Ro(e,n)))},t.prototype.toString=function(){return(0,o.validateArgCount)("Query.toString",0,0,arguments.length),this._delegate.toString()},t.prototype.toJSON=function(){return(0,o.validateArgCount)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()},t.prototype.isEqual=function(e){if((0,o.validateArgCount)("Query.isEqual",1,1,arguments.length),!(e instanceof t)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)},t.getCancelAndContextArgs_=function(t,e,n){var r={cancel:void 0,context:void 0};if(e&&n)r.cancel=e,(0,o.validateCallback)(t,"cancel",r.cancel,!0),r.context=n,(0,o.validateContextObject)(t,"context",r.context,!0);else if(e)if("object"==typeof e&&null!==e)r.context=e;else{if("function"!=typeof e)throw new Error((0,o.errorPrefix)(t,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=e}return r},Object.defineProperty(t.prototype,"ref",{get:function(){return new Qo(this.database,new Bi(this._delegate._repo,this._delegate._path))},enumerable:!1,configurable:!0}),t}(),Qo=function(t){function e(e,n){var r=t.call(this,e,new Ui(n._repo,n._path,new Se,!1))||this;return r.database=e,r._delegate=n,r}return(0,a.__extends)(e,t),e.prototype.getKey=function(){return(0,o.validateArgCount)("Reference.key",0,0,arguments.length),this._delegate.key},e.prototype.child=function(t){return(0,o.validateArgCount)("Reference.child",1,1,arguments.length),"number"==typeof t&&(t=String(t)),new e(this.database,Gi(this._delegate,t))},e.prototype.getParent=function(){(0,o.validateArgCount)("Reference.parent",0,0,arguments.length);var t=this._delegate.parent;return t?new e(this.database,t):null},e.prototype.getRoot=function(){return(0,o.validateArgCount)("Reference.root",0,0,arguments.length),new e(this.database,this._delegate.root)},e.prototype.set=function(t,e){(0,o.validateArgCount)("Reference.set",1,2,arguments.length),(0,o.validateCallback)("Reference.set","onComplete",e,!0);var n=Yi(this._delegate,t);return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n},e.prototype.update=function(t,e){if((0,o.validateArgCount)("Reference.update",1,2,arguments.length),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,k("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Jr("Reference.update",this._delegate._path),(0,o.validateCallback)("Reference.update","onComplete",e,!0);var i=Ji(this._delegate,t);return e&&i.then((function(){return e(null)}),(function(t){return e(t)})),i},e.prototype.setWithPriority=function(t,e,n){(0,o.validateArgCount)("Reference.setWithPriority",2,3,arguments.length),(0,o.validateCallback)("Reference.setWithPriority","onComplete",n,!0);var r=$i(this._delegate,t,e);return n&&r.then((function(){return n(null)}),(function(t){return n(t)})),r},e.prototype.remove=function(t){(0,o.validateArgCount)("Reference.remove",0,1,arguments.length),(0,o.validateCallback)("Reference.remove","onComplete",t,!0);var e=Qi(this._delegate);return t&&e.then((function(){return t(null)}),(function(e){return t(e)})),e},e.prototype.transaction=function(t,e,n){var r=this;(0,o.validateArgCount)("Reference.transaction",1,3,arguments.length),(0,o.validateCallback)("Reference.transaction","transactionUpdate",t,!1),(0,o.validateCallback)("Reference.transaction","onComplete",e,!0),ti("Reference.transaction","applyLocally",n,!0);var i=Ko(this._delegate,t,{applyLocally:n}).then((function(t){return new Ho(t.committed,new Go(r.database,t.snapshot))}));return e&&i.then((function(t){return e(null,t.committed,t.snapshot)}),(function(t){return e(t,!1,null)})),i},e.prototype.setPriority=function(t,e){(0,o.validateArgCount)("Reference.setPriority",1,2,arguments.length),(0,o.validateCallback)("Reference.setPriority","onComplete",e,!0);var n=Xi(this._delegate,t);return e&&n.then((function(){return e(null)}),(function(t){return e(t)})),n},e.prototype.push=function(t,n){var r=this;(0,o.validateArgCount)("Reference.push",0,2,arguments.length),(0,o.validateCallback)("Reference.push","onComplete",n,!0);var i=zi(this._delegate,t),a=i.then((function(t){return new e(r.database,t)}));n&&a.then((function(){return n(null)}),(function(t){return n(t)}));var s=new e(this.database,i);return s.then=a.then.bind(a),s.catch=a.catch.bind(a,void 0),s},e.prototype.onDisconnect=function(){return Jr("Reference.onDisconnect",this._delegate._path),new Wo(new Fi(this._delegate._repo,this._delegate._path))},Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),e}(zo),Yo=function(){function t(t,e){var n=this;this._delegate=t,this.app=e,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),Uo(this._delegate,t,e,n)},t.prototype.ref=function(t){if((0,o.validateArgCount)("database.ref",0,1,arguments.length),t instanceof Qo){var e=Hi(this._delegate,t.toString());return new Qo(this,e)}e=Wi(this._delegate,t);return new Qo(this,e)},t.prototype.refFromURL=function(t){var e="database.refFromURL";(0,o.validateArgCount)(e,1,1,arguments.length);var n=Hi(this._delegate,t);return new Qo(this,n)},t.prototype.goOffline=function(){return(0,o.validateArgCount)("database.goOffline",0,0,arguments.length),jo(this._delegate)},t.prototype.goOnline=function(){return(0,o.validateArgCount)("database.goOnline",0,0,arguments.length),qo(this._delegate)},t.ServerValue={TIMESTAMP:Vo,increment:function(t){return function(t){return{".sv":{increment:t}}}(t)}},t}();var Xo=Object.freeze({__proto__:null,forceLongPolling:function(){ct.forceDisallow(),at.forceAllow()},forceWebSockets:function(){at.forceDisallow()},isWebSocketsAvailable:function(){return ct.isAvailable()},setSecurityDebugCallback:function(t,e){t._delegate._repo.persistentConnection_.securityDebugCallback_=e},stats:function(t,e){!function(t,e){if(void 0===e&&(e=!1),"undefined"!=typeof console){var n;e?(t.statsListener_||(t.statsListener_=new Ue(t.stats_)),n=t.statsListener_.get()):n=t.stats_.get();var r=Object.keys(n).reduce((function(t,e){return Math.max(e.length,t)}),0);M(n,(function(t,e){for(var n=t,i=t.length;i<r+2;i++)n+=" ";console.log(n+e)}))}}(t._delegate._repo,e)},statsIncrementCounter:function(t,e){!function(t,e){var n,r;t.stats_.incrementCounter(e),n=t.statsReporter_,r=e,n.statsToReport_[r]=!0}(t._delegate._repo,e)},dataUpdateCount:function(t){return t._delegate._repo.dataUpdateCount},interceptServerData:function(t,e){return function(t,e){t.interceptServerDataCallback_=e}(t._delegate._repo,e)},initStandalone:function(t){var e=t.app,n=t.url,r=t.version,o=t.customAuthImpl,a=t.namespace,s=t.nodeAdmin,u=void 0!==s&&s;c(r);var l=new i.Provider("auth-internal",new i.ComponentContainer("database-standalone"));return l.setComponent(new i.Component("auth-internal",(function(){return o}),"PRIVATE")),{instance:new Yo(Mo(e,l,void 0,n,u),e),namespace:a}}}),$o=Mt;Mt.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},Mt.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var Jo=ht,Zo=$,ta=Object.freeze({__proto__:null,DataConnection:$o,RealTimeConnection:Jo,hijackHash:function(t){var e=Mt.prototype.put;return Mt.prototype.put=function(n,r,i,o){void 0!==o&&(o=t()),e.call(this,n,r,i,o)},function(){Mt.prototype.put=e}},ConnectionTarget:Zo,queryIdentifier:function(t){return t._delegate._queryIdentifier},forceRestClient:function(t){!function(t){Lo=t}(t)}}),ea=Yo.ServerValue;!function(e){c(e.SDK_VERSION);var n=e.INTERNAL.registerComponent(new i.Component("database",(function(t,e){var n=e.instanceIdentifier,r=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),o=t.getProvider("app-check-internal");return new Yo(Mo(r,i,o,n),r)}),"PUBLIC").setServiceProps({Reference:Qo,Query:zo,Database:Yo,DataSnapshot:Go,enableLogging:I,INTERNAL:Xo,ServerValue:ea,TEST_ACCESS:ta}).setMultipleInstances(!0));e.registerVersion("@firebase/database","0.11.0"),(0,o.isNodeSdk)()&&(t.exports=n)}(r.default)},594:function(t,e,n){"use strict";function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}var i;n.r(e),n.d(e,{LogLevel:function(){return o},Logger:function(){return h},setLogLevel:function(){return f},setUserLogHandler:function(){return d}});var o,a=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(o||(o={}));var s={debug:o.DEBUG,verbose:o.VERBOSE,info:o.INFO,warn:o.WARN,error:o.ERROR,silent:o.SILENT},u=o.INFO,c=((i={})[o.DEBUG]="log",i[o.VERBOSE]="log",i[o.INFO]="info",i[o.WARN]="warn",i[o.ERROR]="error",i),l=function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var o=(new Date).toISOString(),a=c[e];if(!a)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[a].apply(console,r(["["+o+"]  "+t.name+":"],n))}},h=function(){function t(t){this.name=t,this._logLevel=u,this._logHandler=l,this._userLogHandler=null,a.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in o))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?s[t]:t},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.DEBUG],t)),this._logHandler.apply(this,r([this,o.DEBUG],t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.VERBOSE],t)),this._logHandler.apply(this,r([this,o.VERBOSE],t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.INFO],t)),this._logHandler.apply(this,r([this,o.INFO],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.WARN],t)),this._logHandler.apply(this,r([this,o.WARN],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.ERROR],t)),this._logHandler.apply(this,r([this,o.ERROR],t))},t}();function f(t){a.forEach((function(e){e.setLogLevel(t)}))}function d(t,e){for(var n=function(n){var r=null;e&&e.level&&(r=s[e.level]),n.userLogHandler=null===t?null:function(e,n){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];var s=i.map((function(t){if(null==t)return null;if("string"==typeof t)return t;if("number"==typeof t||"boolean"==typeof t)return t.toString();if(t instanceof Error)return t.message;try{return JSON.stringify(t)}catch(t){return null}})).filter((function(t){return t})).join(" ");n>=(null!=r?r:e.logLevel)&&t({level:o[n].toLowerCase(),message:s,args:i,type:e.name})}},r=0,i=a;r<i.length;r++){n(i[r])}}},589:function(t,e,n){"use strict";n.r(e),n.d(e,{CONSTANTS:function(){return i},Deferred:function(){return p},ErrorFactory:function(){return R},FirebaseError:function(){return x},MAX_VALUE_MILLIS:function(){return ct},RANDOM_FACTOR:function(){return lt},Sha1:function(){return $},areCookiesEnabled:function(){return N},assert:function(){return o},assertionError:function(){return a},async:function(){return tt},base64:function(){return u},base64Decode:function(){return h},base64Encode:function(){return c},base64urlEncodeWithoutPadding:function(){return l},calculateBackoffMillis:function(){return ht},contains:function(){return B},createMockUserToken:function(){return v},createSubscribe:function(){return J},decode:function(){return F},deepCopy:function(){return f},deepEqual:function(){return G},deepExtend:function(){return d},errorPrefix:function(){return rt},extractQuerystring:function(){return X},getGlobal:function(){return P},getModularInstance:function(){return dt},getUA:function(){return g},isAdmin:function(){return V},isBrowser:function(){return _},isBrowserExtension:function(){return b},isElectron:function(){return I},isEmpty:function(){return W},isIE:function(){return T},isIndexedDBAvailable:function(){return k},isMobileCordova:function(){return y},isNode:function(){return m},isNodeSdk:function(){return S},isReactNative:function(){return w},isSafari:function(){return C},isUWP:function(){return E},isValidFormat:function(){return q},isValidTimestamp:function(){return U},issuedAtTime:function(){return j},jsonEval:function(){return L},map:function(){return H},ordinal:function(){return ft},querystring:function(){return Q},querystringDecode:function(){return Y},safeGet:function(){return K},stringLength:function(){return ut},stringToByteArray:function(){return st},stringify:function(){return M},validateArgCount:function(){return nt},validateCallback:function(){return ot},validateContextObject:function(){return at},validateIndexedDBOpenable:function(){return A},validateNamespace:function(){return it}});var r=n(655),i={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(t,e){if(!t)throw a(e)},a=function(t){return new Error("Firebase Database ("+i.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)},s=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},u={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],a=i+1<t.length,s=a?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,l=o>>2,h=(3&o)<<4|s>>4,f=(15&s)<<2|c>>6,d=63&c;u||(d=64,a||(f=64)),r.push(n[l],n[h],n[f],n[d])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(s(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var a=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(s=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(a>>10)),e[r++]=String.fromCharCode(56320+(1023&a))}else{o=t[n++];var s=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0,s=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==u)throw Error();var c=o<<2|a>>4;if(r.push(c),64!==s){var l=a<<4&240|s>>2;if(r.push(l),64!==u){var h=s<<6&192|u;r.push(h)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},c=function(t){var e=s(t);return u.encodeByteArray(e,!0)},l=function(t){return c(t).replace(/\./g,"")},h=function(t){try{return u.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function f(t){return d(void 0,t)}function d(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&"__proto__"!==n&&(t[n]=d(t[n],e[n]));return t}var p=function(){function t(){var t=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"==typeof t&&(e.promise.catch((function(){})),1===t.length?t(n):t(n,r))}},t}();function v(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n=e||"demo-project",i=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var a=(0,r.__assign)({iss:"https://securetoken.google.com/"+n,aud:n,iat:i,exp:i+3600,auth_time:i,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t);return[l(JSON.stringify({alg:"none",type:"JWT"})),l(JSON.stringify(a)),""].join(".")}function g(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function y(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(g())}function m(){try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}function _(){return"object"==typeof self&&self.self===self}function b(){var t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function w(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function I(){return g().indexOf("Electron/")>=0}function T(){var t=g();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function E(){return g().indexOf("MSAppHost/")>=0}function S(){return!0===i.NODE_CLIENT||!0===i.NODE_ADMIN}function C(){return!m()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function k(){return"indexedDB"in self&&null!=indexedDB}function A(){return new Promise((function(t,e){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var t;e((null===(t=i.error)||void 0===t?void 0:t.message)||"")}}catch(t){e(t)}}))}function N(){return!(!navigator||!navigator.cookieEnabled)}function P(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}var x=function(t){function e(n,r,i){var o=t.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,R.prototype.create),o}return(0,r.__extends)(e,t),e}(Error),R=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n}return t.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],a=o?D(o,r):"Error",s=this.serviceName+": "+a+" ("+i+").",u=new x(i,s,r);return u},t}();function D(t,e){return t.replace(O,(function(t,n){var r=e[n];return null!=r?String(r):"<"+n+"?>"}))}var O=/\{\$([^}]+)}/g;function L(t){return JSON.parse(t)}function M(t){return JSON.stringify(t)}var F=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=L(h(o[0])||""),n=L(h(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(t){}return{header:e,claims:n,data:r,signature:i}},U=function(t){var e=F(t).claims,n=Math.floor((new Date).getTime()/1e3),r=0,i=0;return"object"==typeof e&&(e.hasOwnProperty("nbf")?r=e.nbf:e.hasOwnProperty("iat")&&(r=e.iat),i=e.hasOwnProperty("exp")?e.exp:r+86400),!!n&&!!r&&!!i&&n>=r&&n<=i},j=function(t){var e=F(t).claims;return"object"==typeof e&&e.hasOwnProperty("iat")?e.iat:null},q=function(t){var e=F(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")},V=function(t){var e=F(t).claims;return"object"==typeof e&&!0===e.admin};function B(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function K(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function W(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function H(t,e,n){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}function G(t,e){if(t===e)return!0;for(var n=Object.keys(t),r=Object.keys(e),i=0,o=n;i<o.length;i++){var a=o[i];if(!r.includes(a))return!1;var s=t[a],u=e[a];if(z(s)&&z(u)){if(!G(s,u))return!1}else if(s!==u)return!1}for(var c=0,l=r;c<l.length;c++){a=l[c];if(!n.includes(a))return!1}return!0}function z(t){return null!==t&&"object"==typeof t}function Q(t){for(var e=[],n=function(t,n){Array.isArray(n)?n.forEach((function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))})):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))},r=0,i=Object.entries(t);r<i.length;r++){var o=i[r];n(o[0],o[1])}return e.length?"&"+e.join("&"):""}function Y(t){var e={};return t.replace(/^\?/,"").split("&").forEach((function(t){if(t){var n=t.split("="),r=n[0],i=n[1];e[decodeURIComponent(r)]=decodeURIComponent(i)}})),e}function X(t){var e=t.indexOf("?");if(!e)return"";var n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}var $=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],l=this.chain_[3],h=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=l^u&(c^l),a=1518500249):(o=u^c^l,a=1859775393):r<60?(o=u&c|l&(u|c),a=2400959708):(o=u^c^l,a=3395469782);i=(s<<5|s>>>27)+o+h+a+n[r]&4294967295;h=l,l=c,c=4294967295&(u<<30|u>>>2),u=s,s=i}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},t.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},t.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},t}();function J(t,e){var n=new Z(t,e);return n.subscribe.bind(n)}var Z=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then((function(){t(n)})).catch((function(t){n.error(t)}))}return t.prototype.next=function(t){this.forEachObserver((function(e){e.next(t)}))},t.prototype.error=function(t){this.forEachObserver((function(e){e.error(t)})),this.close(t)},t.prototype.complete=function(){this.forEachObserver((function(t){t.complete()})),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=et),void 0===r.error&&(r.error=et),void 0===r.complete&&(r.complete=et);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}})),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}}))},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then((function(){e.observers=void 0,e.onNoObservers=void 0})))},t}();function tt(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then((function(){t.apply(void 0,n)})).catch((function(t){e&&e(t)}))}}function et(){}var nt=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function rt(t,e){return t+" failed: "+e+" argument "}function it(t,e,n){if((!n||e)&&"string"!=typeof e)throw new Error(rt(t,"namespace")+"must be a valid firebase namespace.")}function ot(t,e,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(rt(t,e)+"must be a valid function.")}function at(t,e,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(rt(t,e)+"must be a valid context object.")}var st=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i>=55296&&i<=56319){var a=i-55296;r++,o(r<t.length,"Surrogate pair missing trail surrogate."),i=65536+(a<<10)+(t.charCodeAt(r)-56320)}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},ut=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e},ct=144e5,lt=.5;function ht(t,e,n){void 0===e&&(e=1e3),void 0===n&&(n=2);var r=e*Math.pow(n,t),i=Math.round(lt*r*(Math.random()-.5)*2);return Math.min(ct,r+i)}function ft(t){return Number.isFinite(t)?t+function(t){var e=(t=Math.abs(t))%100;if(e>=10&&e<=20)return"th";var n=t%10;if(1===n)return"st";if(2===n)return"nd";if(3===n)return"rd";return"th"}(t):""+t}function dt(t){return t&&t._delegate?t._delegate:t}},676:function(t,e){!function(t){"use strict";function e(t){return Array.prototype.slice.call(t)}function n(t){return new Promise((function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}}))}function r(t,e,r){var i,o=new Promise((function(o,a){n(i=t[e].apply(t,r)).then(o,a)}));return o.request=i,o}function i(t,e,n){var i=r(t,e,n);return i.then((function(t){if(t)return new l(t,i.request)}))}function o(t,e,n){n.forEach((function(n){Object.defineProperty(t.prototype,n,{get:function(){return this[e][n]},set:function(t){this[e][n]=t}})}))}function a(t,e,n,i){i.forEach((function(i){i in n.prototype&&(t.prototype[i]=function(){return r(this[e],i,arguments)})}))}function s(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return this[e][r].apply(this[e],arguments)})}))}function u(t,e,n,r){r.forEach((function(r){r in n.prototype&&(t.prototype[r]=function(){return i(this[e],r,arguments)})}))}function c(t){this._index=t}function l(t,e){this._cursor=t,this._request=e}function h(t){this._store=t}function f(t){this._tx=t,this.complete=new Promise((function(e,n){t.oncomplete=function(){e()},t.onerror=function(){n(t.error)},t.onabort=function(){n(t.error)}}))}function d(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new f(n)}function p(t){this._db=t}function v(t,e,n){var i=r(indexedDB,"open",[t,e]),o=i.request;return o&&(o.onupgradeneeded=function(t){n&&n(new d(o.result,t.oldVersion,o.transaction))}),i.then((function(t){return new p(t)}))}function g(t){return r(indexedDB,"deleteDatabase",[t])}o(c,"_index",["name","keyPath","multiEntry","unique"]),a(c,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),u(c,"_index",IDBIndex,["openCursor","openKeyCursor"]),o(l,"_cursor",["direction","key","primaryKey","value"]),a(l,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(t){t in IDBCursor.prototype&&(l.prototype[t]=function(){var e=this,r=arguments;return Promise.resolve().then((function(){return e._cursor[t].apply(e._cursor,r),n(e._request).then((function(t){if(t)return new l(t,e._request)}))}))})})),h.prototype.createIndex=function(){return new c(this._store.createIndex.apply(this._store,arguments))},h.prototype.index=function(){return new c(this._store.index.apply(this._store,arguments))},o(h,"_store",["name","keyPath","indexNames","autoIncrement"]),a(h,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),u(h,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),s(h,"_store",IDBObjectStore,["deleteIndex"]),f.prototype.objectStore=function(){return new h(this._tx.objectStore.apply(this._tx,arguments))},o(f,"_tx",["objectStoreNames","mode"]),s(f,"_tx",IDBTransaction,["abort"]),d.prototype.createObjectStore=function(){return new h(this._db.createObjectStore.apply(this._db,arguments))},o(d,"_db",["name","version","objectStoreNames"]),s(d,"_db",IDBDatabase,["deleteObjectStore","close"]),p.prototype.transaction=function(){return new f(this._db.transaction.apply(this._db,arguments))},o(p,"_db",["name","version","objectStoreNames"]),s(p,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(t){[h,c].forEach((function(n){t in n.prototype&&(n.prototype[t.replace("open","iterate")]=function(){var n=e(arguments),r=n[n.length-1],i=this._store||this._index,o=i[t].apply(i,n.slice(0,-1));o.onsuccess=function(){r(o.result)}})}))})),[c,h].forEach((function(t){t.prototype.getAll||(t.prototype.getAll=function(t,e){var n=this,r=[];return new Promise((function(i){n.iterateCursor(t,(function(t){t?(r.push(t.value),void 0===e||r.length!=e?t.continue():i(r)):i(r)}))}))})})),t.openDb=v,t.deleteDb=g,Object.defineProperty(t,"__esModule",{value:!0})}(e)},666:function(t){var e=function(t){"use strict";var e,n=Object.prototype,r=n.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var i=e&&e.prototype instanceof g?e:g,o=Object.create(i.prototype),a=new A(r||[]);return o._invoke=function(t,e,n){var r=h;return function(i,o){if(r===d)throw new Error("Generator is already running");if(r===p){if("throw"===i)throw o;return P()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=S(a,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var u=l(t,e,n);if("normal"===u.type){if(r=n.done?p:f,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r=p,n.method="throw",n.arg=u.arg)}}}(t,n,a),o}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var h="suspendedStart",f="suspendedYield",d="executing",p="completed",v={};function g(){}function y(){}function m(){}var _={};_[o]=function(){return this};var b=Object.getPrototypeOf,w=b&&b(b(N([])));w&&w!==n&&r.call(w,o)&&(_=w);var I=m.prototype=g.prototype=Object.create(_);function T(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function n(i,o,a,s){var u=l(t[i],t,o);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==typeof h&&r.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,a,s)}),(function(t){n("throw",t,a,s)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return n("throw",t,a,s)}))}s(u.arg)}var i;this._invoke=function(t,r){function o(){return new e((function(e,i){n(t,r,e,i)}))}return i=i?i.then(o,o):o()}}function S(t,n){var r=t.iterator[n.method];if(r===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,S(t,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=l(r,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var o=i.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function N(t){if(t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,a=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}return{next:P}}function P(){return{value:e,done:!0}}return y.prototype=I.constructor=m,m.constructor=y,y.displayName=u(m,s,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,u(t,s,"GeneratorFunction")),t.prototype=Object.create(I),t},t.awrap=function(t){return{__await:t}},T(E.prototype),E.prototype[a]=function(){return this},t.AsyncIterator=E,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new E(c(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},T(I),u(I,s,"Generator"),I[o]=function(){return this},I.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=N,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;k(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:N(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),v}},t}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}},655:function(t,e,n){"use strict";n.r(e),n.d(e,{__extends:function(){return i},__assign:function(){return o},__rest:function(){return a},__decorate:function(){return s},__param:function(){return u},__metadata:function(){return c},__awaiter:function(){return l},__generator:function(){return h},__createBinding:function(){return f},__exportStar:function(){return d},__values:function(){return p},__read:function(){return v},__spread:function(){return g},__spreadArrays:function(){return y},__spreadArray:function(){return m},__await:function(){return _},__asyncGenerator:function(){return b},__asyncDelegator:function(){return w},__asyncValues:function(){return I},__makeTemplateObject:function(){return T},__importStar:function(){return S},__importDefault:function(){return C},__classPrivateFieldGet:function(){return k},__classPrivateFieldSet:function(){return A}});var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function a(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n}function s(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}function u(t,e){return function(n,r){e(n,r,t)}}function c(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function l(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}u((r=r.apply(t,e||[])).next())}))}function h(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var f=Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]};function d(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||f(e,t,n)}function p(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function g(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(v(arguments[e]));return t}function y(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}function m(t,e){for(var n=0,r=e.length,i=t.length;n<r;n++,i++)t[i]=e[n];return t}function _(t){return this instanceof _?(this.v=t,this):new _(t)}function b(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},a("next"),a("throw"),a("return"),r[Symbol.asyncIterator]=function(){return this},r;function a(t){i[t]&&(r[t]=function(e){return new Promise((function(n,r){o.push([t,e,n,r])>1||s(t,e)}))})}function s(t,e){try{(n=i[t](e)).value instanceof _?Promise.resolve(n.value.v).then(u,c):l(o[0][2],n)}catch(t){l(o[0][3],t)}var n}function u(t){s("next",t)}function c(t){s("throw",t)}function l(t,e){t(e),o.shift(),o.length&&s(o[0][0],o[0][1])}}function w(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:_(t[r](e)),done:"return"===r}:i?i(e):e}:i}}function I(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=p(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,i){(function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)})(r,i,(e=t[n](e)).done,e.value)}))}}}function T(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var E=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e};function S(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&f(e,t,n);return E(e,t),e}function C(t){return t&&t.__esModule?t:{default:t}}function k(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)}function A(t,e,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(t,n):i?i.value=n:e.set(t,n),n}}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={id:r,loaded:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,{a:e}),e},n.d=function(t,e){for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.hmd=function(t){return(t=Object.create(t)).children||(t.children=[]),Object.defineProperty(t,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+t.id)}}),t},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},function(){"use strict";function t(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function r(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,n):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e,n,r,i,o,a){try{var s=t[o](a),u=s.value}catch(t){return void n(t)}s.done?e(u):Promise.resolve(u).then(r,i)}function o(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function s(t){i(a,r,o,s,u,"next",t)}function u(t){i(a,r,o,s,u,"throw",t)}s(void 0)}))}}var a=n(757),s=n.n(a),u=n(99);(function(){var t,e="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)};var r=function(t){t=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof n.g&&n.g,t];for(var e=0;e<t.length;++e){var r=t[e];if(r&&r.Math==Math)return r}return globalThis}(this);function i(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function o(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:i(t)}}!function(t,n){if(n){var i=r;t=t.split(".");for(var o=0;o<t.length-1;o++){var a=t[o];a in i||(i[a]={}),i=i[a]}(n=n(o=i[t=t[t.length-1]]))!=o&&null!=n&&e(i,t,{configurable:!0,writable:!0,value:n})}}("Promise",(function(t){function e(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(t){e.reject(t)}}function n(){this.a=null}function i(t){return t instanceof e?t:new e((function(e){e(t)}))}if(t)return t;n.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c((function(){e.g()}))}this.a.push(t)};var a=r.setTimeout;n.prototype.c=function(t){a(t,0)},n.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(t){this.f(t)}}}this.a=null},n.prototype.f=function(t){this.c((function(){throw t}))},e.prototype.f=function(){function t(t){return function(r){n||(n=!0,t.call(e,r))}}var e=this,n=!1;return{resolve:t(this.m),reject:t(this.g)}},e.prototype.m=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof e)this.s(t);else{t:switch(typeof t){case"object":var n=null!=t;break t;case"function":n=!0;break t;default:n=!1}n?this.v(t):this.h(t)}},e.prototype.v=function(t){var e=void 0;try{e=t.then}catch(t){return void this.g(t)}"function"==typeof e?this.u(e,t):this.h(t)},e.prototype.g=function(t){this.i(2,t)},e.prototype.h=function(t){this.i(1,t)},e.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.l()},e.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)s.b(this.a[t]);this.a=null}};var s=new n;return e.prototype.s=function(t){var e=this.f();t.Ra(e.resolve,e.reject)},e.prototype.u=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(t){n.reject(t)}},e.prototype.then=function(t,n){function r(t,e){return"function"==typeof t?function(e){try{i(t(e))}catch(t){o(t)}}:e}var i,o,a=new e((function(t,e){i=t,o=e}));return this.Ra(r(t,i),r(n,o)),a},e.prototype.catch=function(t){return this.then(void 0,t)},e.prototype.Ra=function(t,e){function n(){switch(r.b){case 1:t(r.c);break;case 2:e(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?s.b(n):this.a.push(n)},e.resolve=i,e.reject=function(t){return new e((function(e,n){n(t)}))},e.race=function(t){return new e((function(e,n){for(var r=o(t),a=r.next();!a.done;a=r.next())i(a.value).Ra(e,n)}))},e.all=function(t){var n=o(t),r=n.next();return r.done?i([]):new e((function(t,e){function o(e){return function(n){a[e]=n,0==--s&&t(a)}}var a=[],s=0;do{a.push(void 0),s++,i(r.value).Ra(o(a.length-1),e),r=n.next()}while(!r.done)}))},e}));var a=a||{},s=this||self,c=/^[\w+/_-]+[=]{0,2}$/,l=null;function h(t){return(t=t.querySelector&&t.querySelector("script[nonce]"))&&(t=t.nonce||t.getAttribute("nonce"))&&c.test(t)?t:""}function f(){}function d(t){var e=typeof t;return"object"!=e?e:t?Array.isArray(t)?"array":e:"null"}function p(t){var e=d(t);return"array"==e||"object"==e&&"number"==typeof t.length}function v(t){return"function"==d(t)}function g(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function y(t){return Object.prototype.hasOwnProperty.call(t,m)&&t[m]||(t[m]=++_)}var m="closure_uid_"+(1e9*Math.random()>>>0),_=0;function b(t,e,n){return t.call.apply(t.bind,arguments)}function w(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function I(t,e,n){return(I=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?b:w).apply(null,arguments)}function T(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}var E=Date.now;function S(t,e){function n(){}n.prototype=e.prototype,t.bb=e.prototype,t.prototype=new n,t.prototype.constructor=t}function C(t){return t}function k(t,e,n){this.code=P+t,this.message=e||x[t]||"",this.a=n||null}function A(t){var e=t&&t.code;return e?new k(e.substring(P.length),t.message,t.serverResponse):null}S(k,Error),k.prototype.w=function(){var t={code:this.code,message:this.message};return this.a&&(t.serverResponse=this.a),t},k.prototype.toJSON=function(){return this.w()};var N,P="auth/",x={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},R={ld:{Ua:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},sd:{Ua:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://securetoken.googleapis.com/v1/token",Xa:"https://identitytoolkit.googleapis.com/v2/",id:"p"},ud:{Ua:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},vd:{Ua:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",$a:"https://test-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function D(t){for(var e in R)if(R[e].id===t)return{firebaseEndpoint:(t=R[e]).Ua,secureTokenEndpoint:t.$a,identityPlatformEndpoint:t.Xa};return null}function O(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(t){return!1}}function L(t){if(Error.captureStackTrace)Error.captureStackTrace(this,L);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function M(t,e){for(var n="",r=(t=t.split("%s")).length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");L.call(this,n+t[r])}function F(t,e){throw new M("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function U(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function j(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function q(){this.b=this.a=null}N=D("__EID__")?"__EID__":void 0,S(L,Error),L.prototype.name="CustomError",S(M,L),M.prototype.name="AssertionError",U.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var V=new U((function(){return new K}),(function(t){t.reset()}));function B(){var t=we,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function K(){this.next=this.b=this.a=null}q.prototype.add=function(t,e){var n=V.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},K.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},K.prototype.reset=function(){this.next=this.b=this.a=null};var W=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},H=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};var G=Array.prototype.filter?function(t,e){return Array.prototype.filter.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=[],i=0,o="string"==typeof t?t.split(""):t,a=0;a<n;a++)if(a in o){var s=o[a];e.call(void 0,s,a,t)&&(r[i++]=s)}return r},z=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),i="string"==typeof t?t.split(""):t,o=0;o<n;o++)o in i&&(r[o]=e.call(void 0,i[o],o,t));return r},Q=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t))return!0;return!1};function Y(t,e){return 0<=W(t,e)}function X(t,e){var n;return(n=0<=(e=W(t,e)))&&Array.prototype.splice.call(t,e,1),n}function $(t,e){!function(t,e){for(var n="string"==typeof t?t.split(""):t,r=t.length-1;0<=r;--r)r in n&&e.call(void 0,n[r],r,t)}(t,(function(n,r){e.call(void 0,n,r,t)&&1==Array.prototype.splice.call(t,r,1).length&&0}))}function J(t){return Array.prototype.concat.apply([],arguments)}function Z(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}var tt,et=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},nt=/&/g,rt=/</g,it=/>/g,ot=/"/g,at=/'/g,st=/\x00/g,ut=/[\x00&<>"']/;function ct(t,e){return-1!=t.indexOf(e)}function lt(t,e){return t<e?-1:t>e?1:0}t:{var ht=s.navigator;if(ht){var ft=ht.userAgent;if(ft){tt=ft;break t}}tt=""}function dt(t){return ct(tt,t)}function pt(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function vt(t){for(var e in t)return!1;return!0}function gt(t){var e,n={};for(e in t)n[e]=t[e];return n}var yt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function mt(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<yt.length;o++)n=yt[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function _t(t,e){t:{try{var n=t&&t.ownerDocument,r=n&&(n.defaultView||n.parentWindow);if((r=r||s).Element&&r.Location){var i=r;break t}}catch(t){}i=null}if(i&&void 0!==i[e]&&(!t||!(t instanceof i[e])&&(t instanceof i.Location||t instanceof i.Element))){if(g(t))try{var o=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(t){o="<object could not be stringified>"}else o=void 0===t?"undefined":null===t?"null":typeof t;F("Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,o)}}function bt(t,e){this.a=t===Et&&e||"",this.b=Tt}function wt(t){return t instanceof bt&&t.constructor===bt&&t.b===Tt?t.a:(F("expected object of type Const, got '"+t+"'"),"type_error:Const")}bt.prototype.ta=!0,bt.prototype.sa=function(){return this.a},bt.prototype.toString=function(){return"Const{"+this.a+"}"};var It,Tt={},Et={};function St(){if(void 0===It){var t=null,e=s.trustedTypes;if(e&&e.createPolicy){try{t=e.createPolicy("goog#html",{createHTML:C,createScript:C,createScriptURL:C})}catch(t){s.console&&s.console.error(t.message)}It=t}else It=t}return It}function Ct(t,e){this.a=e===xt?t:""}function kt(t){return t instanceof Ct&&t.constructor===Ct?t.a:(F("expected object of type TrustedResourceUrl, got '"+t+"' of type "+d(t)),"type_error:TrustedResourceUrl")}function At(t,e){var n=wt(t);if(!Pt.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return function(t){var e=St();return new Ct(t=e?e.createScriptURL(t):t,xt)}(t=n.replace(Nt,(function(t,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return(t=e[r])instanceof bt?wt(t):encodeURIComponent(String(t))})))}Ct.prototype.ta=!0,Ct.prototype.sa=function(){return this.a.toString()},Ct.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var Nt=/%{(\w+)}/g,Pt=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,xt={};function Rt(t,e){this.a=e===jt?t:""}function Dt(t){return t instanceof Rt&&t.constructor===Rt?t.a:(F("expected object of type SafeUrl, got '"+t+"' of type "+d(t)),"type_error:SafeUrl")}Rt.prototype.ta=!0,Rt.prototype.sa=function(){return this.a.toString()},Rt.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Ot=/^(?:audio\/(?:3gpp2|3gpp|aac|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-matroska|x-wav|wav|webm)|font\/\w+|image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon)|text\/csv|video\/(?:mpeg|mp4|ogg|webm|quicktime|x-matroska))(?:;\w+=(?:\w+|"[\w;,= ]+"))*$/i,Lt=/^data:(.*);base64,[a-z0-9+\/]+=*$/i,Mt=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Ft(t){if(t instanceof Rt)return t;if(t="object"==typeof t&&t.ta?t.sa():String(t),Mt.test(t))t=new Rt(t,jt);else{var e=(t=(t=String(t)).replace(/(%0A|%0D)/g,"")).match(Lt);t=e&&Ot.test(e[1])?new Rt(t,jt):null}return t}function Ut(t){return t instanceof Rt?t:(t="object"==typeof t&&t.ta?t.sa():String(t),Mt.test(t)||(t="about:invalid#zClosurez"),new Rt(t,jt))}var jt={},qt=new Rt("about:invalid#zClosurez",jt);function Vt(t,e,n){this.a=n===Bt?t:""}Vt.prototype.ta=!0,Vt.prototype.sa=function(){return this.a.toString()},Vt.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Bt={};function Kt(t,e,n,r){return t=t instanceof Rt?t:Ut(t),e=e||s,n=n instanceof bt?wt(n):n||"",e.open(Dt(t),n,r,void 0)}function Wt(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function Ht(t){return ut.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(nt,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(rt,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(it,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(ot,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(at,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(st,"&#0;"))),t}function Gt(t){return Gt[" "](t),t}Gt[" "]=f;var zt,Qt,Yt=dt("Opera"),Xt=dt("Trident")||dt("MSIE"),$t=dt("Edge"),Jt=$t||Xt,Zt=dt("Gecko")&&!(ct(tt.toLowerCase(),"webkit")&&!dt("Edge"))&&!(dt("Trident")||dt("MSIE"))&&!dt("Edge"),te=ct(tt.toLowerCase(),"webkit")&&!dt("Edge");function ee(){var t=s.document;return t?t.documentMode:void 0}t:{var ne="",re=(Qt=tt,Zt?/rv:([^\);]+)(\)|;)/.exec(Qt):$t?/Edge\/([\d\.]+)/.exec(Qt):Xt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Qt):te?/WebKit\/(\S+)/.exec(Qt):Yt?/(?:Version)[ \/]?(\S+)/.exec(Qt):void 0);if(re&&(ne=re?re[1]:""),Xt){var ie=ee();if(null!=ie&&ie>parseFloat(ne)){zt=String(ie);break t}}zt=ne}var oe,ae={};function se(t){return function(t,e){var n=ae;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(t,(function(){for(var e=0,n=et(String(zt)).split("."),r=et(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=lt(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||lt(0==a[2].length,0==s[2].length)||lt(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e}))}if(s.document&&Xt){var ue=ee();oe=ue||(parseInt(zt,10)||void 0)}else oe=void 0;var ce=oe;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch(Qt){}var le=!Xt||9<=Number(ce);function he(t){var e=document;return"string"==typeof t?e.getElementById(t):t}function fe(t,e){pt(e,(function(e,n){e&&"object"==typeof e&&e.ta&&(e=e.sa()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:ve.hasOwnProperty(n)?t.setAttribute(ve[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e}))}var de,pe,ve={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function ge(t,e,n){function r(n){n&&e.appendChild("string"==typeof n?t.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];if(!p(o)||g(o)&&0<o.nodeType)r(o);else{t:{if(o&&"number"==typeof o.length){if(g(o)){var a="function"==typeof o.item||"string"==typeof o.item;break t}if(v(o)){a="function"==typeof o.item;break t}}a=!1}H(a?Z(o):o,r)}}}function ye(t,e){return e=String(e),"application/xhtml+xml"===t.contentType&&(e=e.toLowerCase()),t.createElement(e)}function me(t){s.setTimeout((function(){throw t}),0)}function _e(t,e){pe||function(){if(s.Promise&&s.Promise.resolve){var t=s.Promise.resolve(void 0);pe=function(){t.then(Ie)}}else pe=function(){var t=Ie;!v(s.setImmediate)||s.Window&&s.Window.prototype&&!dt("Edge")&&s.Window.prototype.setImmediate==s.setImmediate?(de||(de=function(){var t=s.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!dt("Presto")&&(t=function(){var t=ye(document,"IFRAME");t.style.display="none",document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=I((function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()}),this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),void 0!==t&&!dt("Trident")&&!dt("MSIE")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).Hb;n.Hb=null,t()}},function(t){r.next={Hb:t},r=r.next,e.port2.postMessage(0)}}return function(t){s.setTimeout(t,0)}}()),de(t)):s.setImmediate(t)}}(),be||(pe(),be=!0),we.add(t,e)}var be=!1,we=new q;function Ie(){for(var t;t=B();){try{t.a.call(t.b)}catch(t){me(t)}j(V,t)}be=!1}function Te(t,e){if(this.a=Ee,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=f)try{var n=this;t.call(e,(function(t){Fe(n,Se,t)}),(function(t){if(!(t instanceof We))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(t){}Fe(n,Ce,t)}))}catch(t){Fe(this,Ce,t)}}var Ee=0,Se=2,Ce=3;function ke(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}ke.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Ae=new U((function(){return new ke}),(function(t){t.reset()}));function Ne(t,e,n){var r=Ae.get();return r.g=t,r.b=e,r.f=n,r}function Pe(t){if(t instanceof Te)return t;var e=new Te(f);return Fe(e,Se,t),e}function xe(t){return new Te((function(e,n){n(t)}))}function Re(t,e,n){Ue(t,e,n,null)||_e(T(e,t))}function De(t){return new Te((function(e){var n=t.length,r=[];if(n)for(var i=function(t,i,o){n--,r[t]=i?{Qb:!0,value:o}:{Qb:!1,reason:o},0==n&&e(r)},o=0;o<t.length;o++)Re(t[o],T(i,o,!0),T(i,o,!1));else e(r)}))}function Oe(t,e){if(t.a==Ee)if(t.c){var n=t.c;if(n.b){for(var r=0,i=null,o=null,a=n.b;a&&(a.c||(r++,a.a==t&&(i=a),!(i&&1<r)));a=a.next)i||(o=a);i&&(n.a==Ee&&1==r?Oe(n,e):(o?((r=o).next==n.f&&(n.f=r),r.next=r.next.next):qe(n),Ve(n,i,Ce,e)))}t.c=null}else Fe(t,Ce,e)}function Le(t,e){t.b||t.a!=Se&&t.a!=Ce||je(t),t.f?t.f.next=e:t.b=e,t.f=e}function Me(t,e,n,r){var i=Ne(null,null,null);return i.a=new Te((function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(t){o(t)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof We?o(e):t(i)}catch(t){o(t)}}:o})),i.a.c=t,Le(t,i),i.a}function Fe(t,e,n){t.a==Ee&&(t===n&&(e=Ce,n=new TypeError("Promise cannot resolve to itself")),t.a=1,Ue(n,t.$c,t.ad,t)||(t.i=n,t.a=e,t.c=null,je(t),e!=Ce||n instanceof We||function(t,e){t.g=!0,_e((function(){t.g&&Ke.call(null,e)}))}(t,n)))}function Ue(t,e,n,r){if(t instanceof Te)return Le(t,Ne(e||f,n||null,r)),!0;if(O(t))return t.then(e,n,r),!0;if(g(t))try{var i=t.then;if(v(i))return function(t,e,n,r,i){function o(t){s||(s=!0,r.call(i,t))}function a(t){s||(s=!0,n.call(i,t))}var s=!1;try{e.call(t,a,o)}catch(t){o(t)}}(t,i,e,n,r),!0}catch(t){return n.call(r,t),!0}return!1}function je(t){t.h||(t.h=!0,_e(t.gc,t))}function qe(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function Ve(t,e,n,r){if(n==Ce&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,Be(e,n,r);else try{e.c?e.g.call(e.f):Be(e,n,r)}catch(t){Ke.call(null,t)}j(Ae,e)}function Be(t,e,n){e==Se?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}Te.prototype.then=function(t,e,n){return Me(this,v(t)?t:null,v(e)?e:null,n)},Te.prototype.$goog_Thenable=!0,(t=Te.prototype).oa=function(t,e){return(t=Ne(t,t,e)).c=!0,Le(this,t),this},t.o=function(t,e){return Me(this,null,t,e)},t.cancel=function(t){if(this.a==Ee){var e=new We(t);_e((function(){Oe(this,e)}),this)}},t.$c=function(t){this.a=Ee,Fe(this,Se,t)},t.ad=function(t){this.a=Ee,Fe(this,Ce,t)},t.gc=function(){for(var t;t=qe(this);)Ve(this,t,this.a,this.i);this.h=!1};var Ke=me;function We(t){L.call(this,t)}function He(){0!=Ge&&(ze[y(this)]=this),this.ya=this.ya,this.pa=this.pa}S(We,L),We.prototype.name="cancel";var Ge=0,ze={};function Qe(t){if(!t.ya&&(t.ya=!0,t.Da(),0!=Ge)){var e=y(t);if(0!=Ge&&t.pa&&0<t.pa.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete ze[e]}}He.prototype.ya=!1,He.prototype.Da=function(){if(this.pa)for(;this.pa.length;)this.pa.shift()()};var Ye=Object.freeze||function(t){return t},Xe=!Xt||9<=Number(ce),$e=Xt&&!se("9"),Je=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{s.addEventListener("test",f,e),s.removeEventListener("test",f,e)}catch(t){}return t}();function Ze(t,e){this.type=t,this.b=this.target=e,this.defaultPrevented=!1}function tn(t,e){if(Ze.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(Zt){t:{try{Gt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:en[t.pointerType]||"",this.a=t,t.defaultPrevented&&this.preventDefault()}}Ze.prototype.preventDefault=function(){this.defaultPrevented=!0},S(tn,Ze);var en=Ye({2:"touch",3:"pen",4:"mouse"});tn.prototype.preventDefault=function(){tn.bb.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,$e)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}},tn.prototype.g=function(){return this.a};var nn="closure_listenable_"+(1e6*Math.random()|0),rn=0;function on(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.Wa=i,this.key=++rn,this.wa=this.Qa=!1}function an(t){t.wa=!0,t.listener=null,t.proxy=null,t.src=null,t.Wa=null}function sn(t){this.src=t,this.a={},this.b=0}function un(t,e){var n=e.type;n in t.a&&X(t.a[n],e)&&(an(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function cn(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.wa&&o.listener==e&&o.capture==!!n&&o.Wa==r)return i}return-1}sn.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=cn(t,e,r,i);return-1<a?(e=t[a],n||(e.Qa=!1)):((e=new on(e,this.src,o,!!r,i)).Qa=n,t.push(e)),e};var ln="closure_lm_"+(1e6*Math.random()|0),hn={};function fn(t,e,n,r,i){if(r&&r.once)pn(t,e,n,r,i);else if(Array.isArray(e))for(var o=0;o<e.length;o++)fn(t,e[o],n,r,i);else n=Tn(n),t&&t[nn]?Sn(t,e,n,g(r)?!!r.capture:!!r,i):dn(t,e,n,!1,r,i)}function dn(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=g(i)?!!i.capture:!!i,s=wn(t);if(s||(t[ln]=s=new sn(t)),!(n=s.add(e,n,r,a,o)).proxy){if(r=function(){var t=bn,e=Xe?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Je||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(yn(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}0}}function pn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)pn(t,e[o],n,r,i);else n=Tn(n),t&&t[nn]?Cn(t,e,n,g(r)?!!r.capture:!!r,i):dn(t,e,n,!0,r,i)}function vn(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)vn(t,e[o],n,r,i);else r=g(r)?!!r.capture:!!r,n=Tn(n),t&&t[nn]?(t=t.v,(e=String(e).toString())in t.a&&(-1<(n=cn(o=t.a[e],n,r,i))&&(an(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=wn(t))&&(e=t.a[e.toString()],t=-1,e&&(t=cn(e,n,r,i)),(n=-1<t?e[t]:null)&&gn(n))}function gn(t){if("number"!=typeof t&&t&&!t.wa){var e=t.src;if(e&&e[nn])un(e.v,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(yn(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=wn(e))?(un(n,t),0==n.b&&(n.src=null,e[ln]=null)):an(t)}}}function yn(t){return t in hn?hn[t]:hn[t]="on"+t}function mn(t,e,n,r){var i=!0;if((t=wn(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.wa&&(o=_n(o,r),i=i&&!1!==o)}return i}function _n(t,e){var n=t.listener,r=t.Wa||t.src;return t.Qa&&gn(t),n.call(r,e)}function bn(t,e){if(t.wa)return!0;if(!Xe){if(!e)t:{e=["window","event"];for(var n=s,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(e=new tn(r=e,this),n=!0,!(0>r.keyCode||null!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(t){i=!0}(i||null==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var o=mn(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.b=r[i],o=mn(r[i],t,!1,e),n=n&&o}return n}return _n(t,new tn(e,this))}function wn(t){return(t=t[ln])instanceof sn?t:null}var In="__closure_events_fn_"+(1e9*Math.random()>>>0);function Tn(t){return v(t)?t:(t[In]||(t[In]=function(e){return t.handleEvent(e)}),t[In])}function En(){He.call(this),this.v=new sn(this),this.bc=this,this.hb=null}function Sn(t,e,n,r,i){t.v.add(String(e),n,!1,r,i)}function Cn(t,e,n,r,i){t.v.add(String(e),n,!0,r,i)}function kn(t,e,n,r){if(!(e=t.v.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.wa&&a.capture==n){var s=a.listener,u=a.Wa||a.src;a.Qa&&un(t.v,a),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}function An(t,e,n){if(v(t))n&&(t=I(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=I(t.handleEvent,t)}return 2147483647<Number(e)?-1:s.setTimeout(t,e||0)}function Nn(t){var e=null;return new Te((function(n,r){-1==(e=An((function(){n(void 0)}),t))&&r(Error("Failed to schedule timer."))})).o((function(t){throw s.clearTimeout(e),t}))}function Pn(t){if(t.X&&"function"==typeof t.X)return t.X();if("string"==typeof t)return t.split("");if(p(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function xn(t){if(t.Y&&"function"==typeof t.Y)return t.Y();if(!t.X||"function"!=typeof t.X){if(p(t)||"string"==typeof t){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}function Rn(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Rn)for(n=t.Y(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Dn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];On(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)On(i,r=t.a[e])||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function On(t,e){return Object.prototype.hasOwnProperty.call(t,e)}S(En,He),En.prototype[nn]=!0,En.prototype.addEventListener=function(t,e,n,r){fn(this,t,e,n,r)},En.prototype.removeEventListener=function(t,e,n,r){vn(this,t,e,n,r)},En.prototype.dispatchEvent=function(t){var e,n=this.hb;if(n)for(e=[];n;n=n.hb)e.push(n);n=this.bc;var r=t.type||t;if("string"==typeof t)t=new Ze(t,n);else if(t instanceof Ze)t.target=t.target||n;else{var i=t;mt(t=new Ze(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.b=e[o];i=kn(a,r,!0,t)&&i}if(i=kn(a=t.b=n,r,!0,t)&&i,i=kn(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=kn(a=t.b=e[o],r,!1,t)&&i;return i},En.prototype.Da=function(){if(En.bb.Da.call(this),this.v){var t,e=this.v;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)an(n[r]);delete e.a[t],e.b--}}this.hb=null},(t=Rn.prototype).X=function(){Dn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},t.Y=function(){return Dn(this),this.a.concat()},t.clear=function(){this.b={},this.c=this.a.length=0},t.get=function(t,e){return On(this.b,t)?this.b[t]:e},t.set=function(t,e){On(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},t.forEach=function(t,e){for(var n=this.Y(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ln=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Mn(t,e){var n;this.a=this.l=this.c="",this.g=null,this.h=this.f="",this.i=!1,t instanceof Mn?(this.i=void 0!==e?e:t.i,Fn(this,t.c),this.l=t.l,this.a=t.a,Un(this,t.g),this.f=t.f,jn(this,ir(t.b)),this.h=t.h):t&&(n=String(t).match(Ln))?(this.i=!!e,Fn(this,n[1]||"",!0),this.l=Wn(n[2]||""),this.a=Wn(n[3]||"",!0),Un(this,n[4]),this.f=Wn(n[5]||"",!0),jn(this,n[6]||"",!0),this.h=Wn(n[7]||"")):(this.i=!!e,this.b=new Jn(null,this.i))}function Fn(t,e,n){t.c=n?Wn(e,!0):e,t.c&&(t.c=t.c.replace(/:$/,""))}function Un(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.g=e}else t.g=null}function jn(t,e,n){e instanceof Jn?(t.b=e,function(t,e){e&&!t.f&&(Zn(t),t.c=null,t.a.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(er(this,e),rr(this,n,t))}),t)),t.f=e}(t.b,t.i)):(n||(e=Hn(e,Xn)),t.b=new Jn(e,t.i))}function qn(t,e,n){t.b.set(e,n)}function Vn(t,e){return t.b.get(e)}function Bn(t){return t instanceof Mn?new Mn(t):new Mn(t,void 0)}function Kn(t,e,n,r){var i=new Mn(null,void 0);return t&&Fn(i,t),e&&(i.a=e),n&&Un(i,n),r&&(i.f=r),i}function Wn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Hn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Gn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Gn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Mn.prototype.toString=function(){var t=[],e=this.c;e&&t.push(Hn(e,zn,!0),":");var n=this.a;return(n||"file"==e)&&(t.push("//"),(e=this.l)&&t.push(Hn(e,zn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.g)&&t.push(":",String(n))),(n=this.f)&&(this.a&&"/"!=n.charAt(0)&&t.push("/"),t.push(Hn(n,"/"==n.charAt(0)?Yn:Qn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.h)&&t.push("#",Hn(n,$n)),t.join("")},Mn.prototype.resolve=function(t){var e=new Mn(this),n=!!t.c;n?Fn(e,t.c):n=!!t.l,n?e.l=t.l:n=!!t.a,n?e.a=t.a:n=null!=t.g;var r=t.f;if(n)Un(e,t.g);else if(n=!!t.f){if("/"!=r.charAt(0))if(this.a&&!this.f)r="/"+r;else{var i=e.f.lastIndexOf("/");-1!=i&&(r=e.f.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(ct(i,"./")||ct(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.f=r:n=""!==t.b.toString(),n?jn(e,ir(t.b)):n=!!t.h,n&&(e.h=t.h),e};var zn=/[#\/\?@]/g,Qn=/[#\?:]/g,Yn=/[#\?]/g,Xn=/[#\?@]/g,$n=/#/g;function Jn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Zn(t){t.a||(t.a=new Rn,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.c,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function tr(t){var e=xn(t);if(void 0===e)throw Error("Keys are undefined");var n=new Jn(null,void 0);t=Pn(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];Array.isArray(o)?rr(n,i,o):n.add(i,o)}return n}function er(t,e){Zn(t),e=or(t,e),On(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,On((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Dn(t)))}function nr(t,e){return Zn(t),e=or(t,e),On(t.a.b,e)}function rr(t,e,n){er(t,e),0<n.length&&(t.c=null,t.a.set(or(t,e),Z(n)),t.b+=n.length)}function ir(t){var e=new Jn;return e.c=t.c,t.a&&(e.a=new Rn(t.a),e.b=t.b),e}function or(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function ar(t){var e=[];return ur(new sr,t,e),e.join("")}function sr(){}function ur(t,e,n){if(null==e)n.push("null");else{if("object"==typeof e){if(Array.isArray(e)){var r=e;e=r.length,n.push("[");for(var i="",o=0;o<e;o++)n.push(i),ur(t,r[o],n),i=",";return void n.push("]")}if(!(e instanceof String||e instanceof Number||e instanceof Boolean)){for(r in n.push("{"),i="",e)Object.prototype.hasOwnProperty.call(e,r)&&("function"!=typeof(o=e[r])&&(n.push(i),hr(r,n),n.push(":"),ur(t,o,n),i=","));return void n.push("}")}e=e.valueOf()}switch(typeof e){case"string":hr(e,n);break;case"number":n.push(isFinite(e)&&!isNaN(e)?String(e):"null");break;case"boolean":n.push(String(e));break;case"function":n.push("null");break;default:throw Error("Unknown type: "+typeof e)}}}(t=Jn.prototype).add=function(t,e){Zn(this),this.c=null,t=or(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},t.clear=function(){this.a=this.c=null,this.b=0},t.forEach=function(t,e){Zn(this),this.a.forEach((function(n,r){H(n,(function(n){t.call(e,n,r,this)}),this)}),this)},t.Y=function(){Zn(this);for(var t=this.a.X(),e=this.a.Y(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},t.X=function(t){Zn(this);var e=[];if("string"==typeof t)nr(this,t)&&(e=J(e,this.a.get(or(this,t))));else{t=this.a.X();for(var n=0;n<t.length;n++)e=J(e,t[n])}return e},t.set=function(t,e){return Zn(this),this.c=null,nr(this,t=or(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},t.get=function(t,e){return t&&0<(t=this.X(t)).length?String(t[0]):e},t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.Y(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.X(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var cr={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},lr=/\uffff/.test("")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function hr(t,e){e.push('"',t.replace(lr,(function(t){var e=cr[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),cr[t]=e),e})),'"')}function fr(){var t=Rr();return Xt&&!!ce&&11==ce||/Edge\/\d+/.test(t)}function dr(){return s.window&&s.window.location.href||self&&self.location&&self.location.href||""}function pr(t,e){e=e||s.window;var n="about:blank";t&&(n=Dt(Ft(t)||qt)),e.location.href=n}function vr(t,e){var n,r=[];for(n in t)n in e?typeof t[n]!=typeof e[n]?r.push(n):"object"==typeof t[n]&&null!=t[n]&&null!=e[n]?0<vr(t[n],e[n]).length&&r.push(n):t[n]!==e[n]&&r.push(n):r.push(n);for(n in e)n in t||r.push(n);return r}function gr(t){return!!((t=(t||Rr()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function yr(t){t=t||s.window;try{t.close()}catch(t){}}function mr(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(a in e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=Rr().toLowerCase(),r&&(e.target=r,ct(n,"crios/")&&(e.target="_blank")),Nr(Rr())==kr&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),r=window,e=n instanceof Rt?n:Ft(void 0!==n.href?n.href:String(n))||qt,n=t.target||n.target,i=[],t)switch(a){case"width":case"height":case"top":case"left":i.push(a+"="+t[a]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(a+"="+(t[a]?1:0))}var a=i.join(",");if((dt("iPhone")&&!dt("iPod")&&!dt("iPad")||dt("iPad")||dt("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(_t(a=ye(document,"A"),"HTMLAnchorElement"),e=e instanceof Rt?e:Ut(e),a.href=Dt(e),a.setAttribute("target",n),t.noreferrer&&a.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),a.dispatchEvent(t),a={}):t.noreferrer?(a=Kt("",r,n,a),t=Dt(e),a&&(Jt&&ct(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),a.opener=null,t='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+Ht(t)+'">',t=new Vt(t=(r=St())?r.createHTML(t):t,null,Bt),r=a.document)&&(r.write(function(t){return t instanceof Vt&&t.constructor===Vt?t.a:(F("expected object of type SafeHtml, got '"+t+"' of type "+d(t)),"type_error:SafeHtml")}(t)),r.close())):(a=Kt(e,r,n,a))&&t.noopener&&(a.opener=null),a)try{a.focus()}catch(t){}return a}var _r=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,br=/^[^@]+@[^@]+$/;function wr(){var t=null;return new Te((function(e){"complete"==s.document.readyState?e():(t=function(){e()},pn(window,"load",t))})).o((function(e){throw vn(window,"load",t),e}))}function Ir(t){return t=t||Rr(),!("file:"!==Fr()&&"ionic:"!==Fr()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function Tr(){var t=s.window;try{return!(!t||t==t.top)}catch(t){return!1}}function Er(){return void 0!==s.WorkerGlobalScope&&"function"==typeof s.importScripts}function Sr(){return u.default.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":u.default.INTERNAL.hasOwnProperty("node")?"Node":Er()?"Worker":"Browser"}function Cr(){var t=Sr();return"ReactNative"===t||"Node"===t}var kr="Firefox",Ar="Chrome";function Nr(t){var e=t.toLowerCase();return ct(e,"opera/")||ct(e,"opr/")||ct(e,"opios/")?"Opera":ct(e,"iemobile")?"IEMobile":ct(e,"msie")||ct(e,"trident/")?"IE":ct(e,"edge/")?"Edge":ct(e,"firefox/")?kr:ct(e,"silk/")?"Silk":ct(e,"blackberry")?"Blackberry":ct(e,"webos")?"Webos":!ct(e,"safari/")||ct(e,"chrome/")||ct(e,"crios/")||ct(e,"android")?!ct(e,"chrome/")&&!ct(e,"crios/")||ct(e,"edge/")?ct(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":Ar:"Safari"}var Pr={md:"FirebaseCore-web",od:"FirebaseUI-web"};function xr(t,e){e=e||[];var n,r=[],i={};for(n in Pr)i[Pr[n]]=!0;for(n=0;n<e.length;n++)void 0!==i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),(e=r).length||(e=["FirebaseCore-web"]),"Browser"===(r=Sr())?r=Nr(i=Rr()):"Worker"===r&&(r=Nr(i=Rr())+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function Rr(){return s.navigator&&s.navigator.userAgent||""}function Dr(t,e){t=t.split("."),e=e||s;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function Or(){try{var t=s.localStorage,e=Br();if(t)return t.setItem(e,"1"),t.removeItem(e),!fr()||!!s.indexedDB}catch(t){return Er()&&!!s.indexedDB}return!1}function Lr(){return(Mr()||"chrome-extension:"===Fr()||Ir())&&!Cr()&&Or()&&!Er()}function Mr(){return"http:"===Fr()||"https:"===Fr()}function Fr(){return s.location&&s.location.protocol||null}function Ur(t){return!gr(t=t||Rr())&&Nr(t)!=kr}function jr(t){return void 0===t?null:ar(t)}function qr(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function Vr(t){if(null!==t)return JSON.parse(t)}function Br(t){return t||Math.floor(1e9*Math.random()).toString()}function Kr(t){return"Safari"!=Nr(t=t||Rr())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Wr(){var t=s.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Hr(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=Rr(),e=Sr(),this.b=gr(t)||"ReactNative"===e}function Gr(){var t=s.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function zr(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(t){}return null}function Qr(){return!(!Dr("fireauth.oauthhelper",s)&&!Dr("fireauth.iframe",s))}Hr.prototype.get=function(){var t=s.navigator;return!t||"boolean"!=typeof t.onLine||!Mr()&&"chrome-extension:"!==Fr()&&void 0===t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Yr,Xr={};function $r(t){Xr[t]||(Xr[t]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t))}try{var Jr={};Object.defineProperty(Jr,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Jr,"abcd",{configurable:!0,enumerable:!0,value:2}),Yr=2==Jr.abcd}catch(Qt){Yr=!1}function Zr(t,e,n){Yr?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function ti(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&Zr(t,n,e[n])}function ei(t){var e={};return ti(e,t),e}function ni(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)Zr(e,n,ni(t[n]));return e}function ri(t){var e=t&&(t[ui]?"phone":null);if(!(e&&t&&t[si]))throw new k("internal-error","Internal assert: invalid MultiFactorInfo object");Zr(this,"uid",t[si]),Zr(this,"displayName",t[oi]||null);var n=null;t[ai]&&(n=new Date(t[ai]).toUTCString()),Zr(this,"enrollmentTime",n),Zr(this,"factorId",e)}function ii(t){try{var e=new ci(t)}catch(t){e=null}return e}ri.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var oi="displayName",ai="enrolledAt",si="mfaEnrollmentId",ui="phoneInfo";function ci(t){ri.call(this,t),Zr(this,"phoneNumber",t[ui])}function li(t){var e={},n=t[pi],r=t[gi],i=t[yi];if(t=ii(t[vi]),!i||i!=fi&&i!=di&&!n||i==di&&!r||i==hi&&!t)throw Error("Invalid checkActionCode response!");i==di?(e[_i]=n||null,e[wi]=n||null,e[mi]=r):(e[_i]=r||null,e[wi]=r||null,e[mi]=n||null),e[bi]=t||null,Zr(this,Ti,i),Zr(this,Ii,ni(e))}S(ci,ri),ci.prototype.w=function(){var t=ci.bb.w.call(this);return t.phoneNumber=this.phoneNumber,t};var hi="REVERT_SECOND_FACTOR_ADDITION",fi="EMAIL_SIGNIN",di="VERIFY_AND_CHANGE_EMAIL",pi="email",vi="mfaInfo",gi="newEmail",yi="requestType",mi="email",_i="fromEmail",bi="multiFactorInfo",wi="previousEmail",Ii="data",Ti="operation";function Ei(t){var e=Vn(t=Bn(t),Si)||null,n=Vn(t,Ci)||null,r=Vn(t,Ni)||null;if(r=r&&xi[r]||null,!e||!n||!r)throw new k("argument-error",Si+", "+Ci+"and "+Ni+" are required in a valid action code URL.");ti(this,{apiKey:e,operation:r,code:n,continueUrl:Vn(t,ki)||null,languageCode:Vn(t,Ai)||null,tenantId:Vn(t,Pi)||null})}var Si="apiKey",Ci="oobCode",ki="continueUrl",Ai="languageCode",Ni="mode",Pi="tenantId",xi={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:hi,signIn:fi,verifyAndChangeEmail:di,verifyEmail:"VERIFY_EMAIL"};function Ri(t){try{return new Ei(t)}catch(t){return null}}function Di(t){var e=t[Ui];if(void 0===e)throw new k("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new k("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[Oi];if(n&&"object"==typeof n){e=n[Vi];var r=n[ji];if(n=n[qi],"string"==typeof e&&e.length){if(this.a=e,void 0!==r&&"boolean"!=typeof r)throw new k("argument-error",ji+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new k("argument-error",qi+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==e)throw new k("argument-error",Vi+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new k("missing-android-pkg-name")}}else if(void 0!==n)throw new k("argument-error",Oi+" property must be a non null object when specified.");if(this.f=null,(e=t[Fi])&&"object"==typeof e){if("string"==typeof(e=e[Bi])&&e.length)this.f=e;else if(void 0!==e)throw new k("argument-error",Bi+" property must be a non empty string when specified.")}else if(void 0!==e)throw new k("argument-error",Fi+" property must be a non null object when specified.");if(void 0!==(e=t[Mi])&&"boolean"!=typeof e)throw new k("argument-error",Mi+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[Li])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new k("argument-error",Li+" property must be a non empty string when specified.");this.i=t||null}var Oi="android",Li="dynamicLinkDomain",Mi="handleCodeInApp",Fi="iOS",Ui="url",ji="installApp",qi="minimumVersion",Vi="packageName",Bi="bundleId";function Ki(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var Wi=null;function Hi(t){var e=[];return function(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=Wi[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}!function(){if(!Wi){Wi={};for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++)for(var r=t.concat(e[n].split("")),i=0;i<r.length;i++){var o=r[i];void 0===Wi[o]&&(Wi[o]=i)}}}();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;e(i<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}(t,(function(t){e.push(t)})),e}function Gi(t){var e=Qi(t);if(!(e&&e.sub&&e.iss&&e.aud&&e.exp))throw Error("Invalid JWT");this.h=t,this.a=e.exp,this.i=e.sub,t=Date.now()/1e3,this.g=e.iat||(t>this.a?this.a:t),this.b=e.provider_id||e.firebase&&e.firebase.sign_in_provider||null,this.f=e.firebase&&e.firebase.tenant||null,this.c=!!e.is_anonymous||"anonymous"==this.b}function zi(t){try{return new Gi(t)}catch(t){return null}}function Qi(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{var r=Hi(t);for(t=[],n=e=0;e<r.length;){var i=r[e++];if(128>i)t[n++]=String.fromCharCode(i);else if(191<i&&224>i){var o=r[e++];t[n++]=String.fromCharCode((31&i)<<6|63&o)}else if(239<i&&365>i){o=r[e++];var a=r[e++],s=((7&i)<<18|(63&o)<<12|(63&a)<<6|63&r[e++])-65536;t[n++]=String.fromCharCode(55296+(s>>10)),t[n++]=String.fromCharCode(56320+(1023&s))}else o=r[e++],a=r[e++],t[n++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}return JSON.parse(t.join(""))}catch(t){}return null}Gi.prototype.T=function(){return this.f},Gi.prototype.l=function(){return this.c},Gi.prototype.toString=function(){return this.h};var Yi="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),Xi=["client_id","response_type","scope","redirect_uri","state"],$i={nd:{Ja:"locale",va:700,ua:600,fa:"facebook.com",Ya:Xi},pd:{Ja:null,va:500,ua:750,fa:"github.com",Ya:Xi},qd:{Ja:"hl",va:515,ua:680,fa:"google.com",Ya:Xi},wd:{Ja:"lang",va:485,ua:705,fa:"twitter.com",Ya:Yi},kd:{Ja:"locale",va:640,ua:600,fa:"apple.com",Ya:[]}};function Ji(t){for(var e in $i)if($i[e].fa==t)return $i[e];return null}function Zi(t){var e={};e["facebook.com"]=io,e["google.com"]=ao,e["github.com"]=oo,e["twitter.com"]=so;var n=t&&t[eo];try{if(n)return e[n]?new e[n](t):new ro(t);if(void 0!==t[to])return new no(t)}catch(t){}return null}var to="idToken",eo="providerId";function no(t){var e=t[eo];if(!e&&t[to]){var n=zi(t[to]);n&&n.b&&(e=n.b)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),Zr(this,"providerId",e),Zr(this,"isNewUser",n)}function ro(t){no.call(this,t),Zr(this,"profile",ni((t=Vr(t.rawUserInfo||"{}"))||{}))}function io(t){if(ro.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function oo(t){if(ro.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Zr(this,"username",this.profile&&this.profile.login||null)}function ao(t){if(ro.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function so(t){if(ro.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Zr(this,"username",t.screenName||null)}function uo(t){var e=Bn(t),n=Vn(e,"link"),r=Vn(Bn(n),"link");return e=Vn(e,"deep_link_id"),Vn(Bn(e),"link")||e||r||n||t}function co(t,e){if(!t&&!e)throw new k("internal-error","Internal assert: no raw session string available");if(t&&e)throw new k("internal-error","Internal assert: unable to determine the session type");this.a=t||null,this.b=e||null,this.type=this.a?lo:ho}S(ro,no),S(io,ro),S(oo,ro),S(ao,ro),S(so,ro);var lo="enroll",ho="signin";function fo(){}function po(t,e){return t.then((function(t){if(t[ns]){var n=zi(t[ns]);if(!n||e!=n.i)throw new k("user-mismatch");return t}throw new k("user-mismatch")})).o((function(t){throw t&&t.code&&t.code==P+"user-not-found"?new k("user-mismatch"):t}))}function vo(t,e){if(!e)throw new k("internal-error","failed to construct a credential");this.a=e,Zr(this,"providerId",t),Zr(this,"signInMethod",t)}function go(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function yo(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new vo(t.providerId,t.pendingToken)}catch(t){}return null}function mo(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&Zr(this,"idToken",e.idToken),e.accessToken&&Zr(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&Zr(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new k("internal-error","failed to construct a credential");Zr(this,"accessToken",e.oauthToken),Zr(this,"secret",e.oauthTokenSecret)}Zr(this,"providerId",t),Zr(this,"signInMethod",n)}function _o(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:tr(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function bo(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new mo(t.providerId,e,t.signInMethod)}catch(t){}}return null}function wo(t,e){this.Qc=e||[],ti(this,{providerId:t,isOAuthProvider:!0}),this.Jb={},this.qb=(Ji(t)||{}).Ja||null,this.pb=null}function Io(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new k("argument-error",'SAML provider IDs must be prefixed with "saml."');wo.call(this,t,[])}function To(t){wo.call(this,t,Xi),this.a=[]}function Eo(){To.call(this,"facebook.com")}function So(t){if(!t)throw new k("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return g(t)&&(e=t.accessToken),(new Eo).credential({accessToken:e})}function Co(){To.call(this,"github.com")}function ko(t){if(!t)throw new k("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return g(t)&&(e=t.accessToken),(new Co).credential({accessToken:e})}function Ao(){To.call(this,"google.com"),this.Ca("profile")}function No(t,e){var n=t;return g(t)&&(n=t.idToken,e=t.accessToken),(new Ao).credential({idToken:n,accessToken:e})}function Po(){wo.call(this,"twitter.com",Yi)}function xo(t,e){var n=t;if(g(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new k("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new mo("twitter.com",n,"twitter.com")}function Ro(t,e,n){this.a=t,this.f=e,Zr(this,"providerId","password"),Zr(this,"signInMethod",n===Oo.EMAIL_LINK_SIGN_IN_METHOD?Oo.EMAIL_LINK_SIGN_IN_METHOD:Oo.EMAIL_PASSWORD_SIGN_IN_METHOD)}function Do(t){return t&&t.email&&t.password?new Ro(t.email,t.password,t.signInMethod):null}function Oo(){ti(this,{providerId:"password",isOAuthProvider:!1})}function Lo(t,e){if(!(e=Mo(e)))throw new k("argument-error","Invalid email link!");return new Ro(t,e.code,Oo.EMAIL_LINK_SIGN_IN_METHOD)}function Mo(t){return(t=Ri(t=uo(t)))&&t.operation===fi?t:null}function Fo(t){if(!(t.fb&&t.eb||t.La&&t.ea))throw new k("internal-error");this.a=t,Zr(this,"providerId","phone"),this.fa="phone",Zr(this,"signInMethod","phone")}function Uo(t){if(t&&"phone"===t.providerId&&(t.verificationId&&t.verificationCode||t.temporaryProof&&t.phoneNumber)){var e={};return H(["verificationId","verificationCode","temporaryProof","phoneNumber"],(function(n){t[n]&&(e[n]=t[n])})),new Fo(e)}return null}function jo(t){return t.a.La&&t.a.ea?{temporaryProof:t.a.La,phoneNumber:t.a.ea}:{sessionInfo:t.a.fb,code:t.a.eb}}function qo(t){try{this.a=t||u.default.auth()}catch(t){throw new k("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}ti(this,{providerId:"phone",isOAuthProvider:!1})}function Vo(t,e){if(!t)throw new k("missing-verification-id");if(!e)throw new k("missing-verification-code");return new Fo({fb:t,eb:e})}function Bo(t){if(t.temporaryProof&&t.phoneNumber)return new Fo({La:t.temporaryProof,ea:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret,i=t&&t.nonce,o=t&&t.oauthIdToken,a=t&&t.pendingToken;try{switch(e){case"google.com":return No(o,n);case"facebook.com":return So(n);case"github.com":return ko(n);case"twitter.com":return xo(n,r);default:return n||r||o||a?a?0==e.indexOf("saml.")?new vo(e,a):new mo(e,{pendingToken:a,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new To(e).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(t){return null}}function Ko(t){if(!t.isOAuthProvider)throw new k("invalid-oauth-provider")}function Wo(t,e,n,r,i,o,a){if(this.c=t,this.b=e||null,this.g=n||null,this.f=r||null,this.i=o||null,this.h=a||null,this.a=i||null,!this.g&&!this.a)throw new k("invalid-auth-event");if(this.g&&this.a)throw new k("invalid-auth-event");if(this.g&&!this.f)throw new k("invalid-auth-event")}function Ho(t){return(t=t||{}).type?new Wo(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&A(t.error),t.postBody,t.tenantId):null}function Go(){this.b=null,this.a=[]}co.prototype.Ha=function(){return this.a?Pe(this.a):Pe(this.b)},co.prototype.w=function(){return this.type==lo?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},fo.prototype.ka=function(){},fo.prototype.b=function(){},fo.prototype.c=function(){},fo.prototype.w=function(){},vo.prototype.ka=function(t){return Es(t,go(this))},vo.prototype.b=function(t,e){var n=go(this);return n.idToken=e,Ss(t,n)},vo.prototype.c=function(t,e){return po(Cs(t,go(this)),e)},vo.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},mo.prototype.ka=function(t){return Es(t,_o(this))},mo.prototype.b=function(t,e){var n=_o(this);return n.idToken=e,Ss(t,n)},mo.prototype.c=function(t,e){return po(Cs(t,_o(this)),e)},mo.prototype.w=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},wo.prototype.Ka=function(t){return this.Jb=gt(t),this},S(Io,wo),S(To,wo),To.prototype.Ca=function(t){return Y(this.a,t)||this.a.push(t),this},To.prototype.Rb=function(){return Z(this.a)},To.prototype.credential=function(t,e){var n;if(!(n=g(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new k("argument-error","credential failed: must provide the ID token and/or the access token.");return new mo(this.providerId,n,this.providerId)},S(Eo,To),Zr(Eo,"PROVIDER_ID","facebook.com"),Zr(Eo,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),S(Co,To),Zr(Co,"PROVIDER_ID","github.com"),Zr(Co,"GITHUB_SIGN_IN_METHOD","github.com"),S(Ao,To),Zr(Ao,"PROVIDER_ID","google.com"),Zr(Ao,"GOOGLE_SIGN_IN_METHOD","google.com"),S(Po,wo),Zr(Po,"PROVIDER_ID","twitter.com"),Zr(Po,"TWITTER_SIGN_IN_METHOD","twitter.com"),Ro.prototype.ka=function(t){return this.signInMethod==Oo.EMAIL_LINK_SIGN_IN_METHOD?su(t,Os,{email:this.a,oobCode:this.f}):su(t,nu,{email:this.a,password:this.f})},Ro.prototype.b=function(t,e){return this.signInMethod==Oo.EMAIL_LINK_SIGN_IN_METHOD?su(t,Ls,{idToken:e,email:this.a,oobCode:this.f}):su(t,Qs,{idToken:e,email:this.a,password:this.f})},Ro.prototype.c=function(t,e){return po(this.ka(t),e)},Ro.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},ti(Oo,{PROVIDER_ID:"password"}),ti(Oo,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),ti(Oo,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),Fo.prototype.ka=function(t){return t.gb(jo(this))},Fo.prototype.b=function(t,e){var n=jo(this);return n.idToken=e,su(t,iu,n)},Fo.prototype.c=function(t,e){var n=jo(this);return n.operation="REAUTH",po(t=su(t,ou,n),e)},Fo.prototype.w=function(){var t={providerId:"phone"};return this.a.fb&&(t.verificationId=this.a.fb),this.a.eb&&(t.verificationCode=this.a.eb),this.a.La&&(t.temporaryProof=this.a.La),this.a.ea&&(t.phoneNumber=this.a.ea),t},qo.prototype.gb=function(t,e){var n=this.a.a;return Pe(e.verify()).then((function(r){if("string"!=typeof r)throw new k("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":var i=g(t)?t.session:null,o=g(t)?t.phoneNumber:t;return(i&&i.type==lo?i.Ha().then((function(t){return function(t,e){return su(t,Xs,e).then((function(t){return t.phoneSessionInfo.sessionInfo}))}(n,{idToken:t,phoneEnrollmentInfo:{phoneNumber:o,recaptchaToken:r}})})):i&&i.type==ho?i.Ha().then((function(e){return function(t,e){return su(t,$s,e).then((function(t){return t.phoneResponseInfo.sessionInfo}))}(n,{mfaPendingCredential:e,mfaEnrollmentId:t.multiFactorHint&&t.multiFactorHint.uid||t.multiFactorUid,phoneSignInInfo:{recaptchaToken:r}})})):function(t,e){return su(t,Gs,e)}(n,{phoneNumber:o,recaptchaToken:r})).then((function(t){return"function"==typeof e.reset&&e.reset(),t}),(function(t){throw"function"==typeof e.reset&&e.reset(),t}));default:throw new k("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}}))},ti(qo,{PROVIDER_ID:"phone"}),ti(qo,{PHONE_SIGN_IN_METHOD:"phone"}),Wo.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.h&&t.push(this.h),t.join("-")},Wo.prototype.T=function(){return this.h},Wo.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.w()}};var zo,Qo=null;function Yo(t){var e="unauthorized-domain",n=void 0,r=Bn(t);t=r.a,"chrome-extension"==(r=r.c)?n=Wt("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=Wt("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",k.call(this,e,n)}function Xo(t,e,n){k.call(this,t,n),(t=e||{}).Kb&&Zr(this,"email",t.Kb),t.ea&&Zr(this,"phoneNumber",t.ea),t.credential&&Zr(this,"credential",t.credential),t.$b&&Zr(this,"tenantId",t.$b)}function $o(t){if(t.code){var e=t.code||"";0==e.indexOf(P)&&(e=e.substring(P.length));var n={credential:Bo(t),$b:t.tenantId};if(t.email)n.Kb=t.email;else if(t.phoneNumber)n.ea=t.phoneNumber;else if(!n.credential)return new k(e,t.message||void 0);return new Xo(e,n,t.message)}return null}function Jo(){}function Zo(t){return t.c||(t.c=t.b())}function ta(){}function ea(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function na(){}function ra(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=I(this.qc,this),this.a.onerror=I(this.Tb,this),this.a.onprogress=I(this.rc,this),this.a.ontimeout=I(this.vc,this)}function ia(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function oa(t,e,n){this.reset(t,e,n,void 0,void 0)}S(Yo,k),S(Xo,k),Xo.prototype.w=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber),this.tenantId&&(t.tenantId=this.tenantId);var e=this.credential&&this.credential.w();return e&&mt(t,e),t},Xo.prototype.toJSON=function(){return this.w()},Jo.prototype.c=null,S(ta,Jo),ta.prototype.a=function(){var t=ea(this);return t?new ActiveXObject(t):new XMLHttpRequest},ta.prototype.b=function(){var t={};return ea(this)&&(t[0]=!0,t[1]=!0),t},zo=new ta,S(na,Jo),na.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new ra;throw Error("Unsupported browser")},na.prototype.b=function(){return{}},(t=ra.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},t.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},t.abort=function(){this.a.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},t.qc=function(){this.status=200,this.response=this.responseText=this.a.responseText,ia(this,4)},t.Tb=function(){this.status=500,this.response=this.responseText="",ia(this,4)},t.vc=function(){this.Tb()},t.rc=function(){this.status=200,ia(this,1)},t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},oa.prototype.a=null;function aa(t){this.f=t,this.b=this.c=this.a=null}function sa(t,e){this.name=t,this.value=e}oa.prototype.reset=function(t,e,n,r,i){"number"==typeof i||0,r||E(),delete this.a},sa.prototype.toString=function(){return this.name};var ua=new sa("SEVERE",1e3),ca=new sa("WARNING",900),la=new sa("CONFIG",700),ha=new sa("FINE",500);function fa(t){return t.c?t.c:t.a?fa(t.a):(F("Root logger has no level set."),null)}aa.prototype.log=function(t,e,n){if(t.value>=fa(this).value)for(v(e)&&(e=e()),t=new oa(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var da={},pa=null;function va(t){var e;if(pa||(pa=new aa(""),da[""]=pa,pa.c=la),!(e=da[t])){e=new aa(t);var n=t.lastIndexOf("."),r=t.substr(n+1);(n=va(t.substr(0,n))).b||(n.b={}),n.b[r]=e,e.a=n,da[t]=e}return e}function ga(t,e){t&&t.log(ha,e,void 0)}function ya(t){this.f=t}function ma(t){En.call(this),this.u=t,this.h=void 0,this.readyState=_a,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.f="",this.a=!1,this.i=va("goog.net.FetchXmlHttp"),this.m=this.c=this.g=null}S(ya,Jo),ya.prototype.a=function(){return new ma(this.f)},ya.prototype.b=function(t){return function(){return t}}({}),S(ma,En);var _a=0;function ba(t){t.c.read().then(t.pc.bind(t)).catch(t.Va.bind(t))}function wa(t){t.readyState=4,t.g=null,t.c=null,t.m=null,Ia(t)}function Ia(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function Ta(t){En.call(this),this.headers=new Rn,this.D=t||null,this.c=!1,this.C=this.a=null,this.h=this.P=this.l="",this.f=this.N=this.i=this.J=!1,this.g=0,this.s=null,this.m=Ea,this.u=this.S=!1}(t=ma.prototype).open=function(t,e){if(this.readyState!=_a)throw this.abort(),Error("Error reopening a connection");this.s=t,this.f=e,this.readyState=1,Ia(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.l,method:this.s,credentials:this.h,cache:void 0};t&&(e.body=t),this.u.fetch(new Request(this.f,e)).then(this.uc.bind(this),this.Va.bind(this))},t.abort=function(){this.response=this.responseText="",this.l=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,wa(this)),this.readyState=_a},t.uc=function(t){this.a&&(this.g=t,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=t.headers,this.readyState=2,Ia(this)),this.a&&(this.readyState=3,Ia(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.sc.bind(this),this.Va.bind(this)):void 0!==s.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.m=new TextDecoder,ba(this)):t.text().then(this.tc.bind(this),this.Va.bind(this)))))},t.pc=function(t){if(this.a){var e=this.m.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?wa(this):Ia(this),3==this.readyState&&ba(this)}},t.tc=function(t){this.a&&(this.response=this.responseText=t,wa(this))},t.sc=function(t){this.a&&(this.response=t,wa(this))},t.Va=function(t){var e=this.i;e&&e.log(ca,"Failed to fetch url "+this.f,t instanceof Error?t:Error(t)),this.a&&wa(this)},t.setRequestHeader=function(t,e){this.l.append(t,e)},t.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.i)&&t.log(ca,"Attempting to get response header but no headers have been received for url: "+this.f,void 0),"")},t.getAllResponseHeaders=function(){if(!this.b){var t=this.i;return t&&t.log(ca,"Attempting to get all response headers but no headers have been received for url: "+this.f,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(ma.prototype,"withCredentials",{get:function(){return"include"===this.h},set:function(t){this.h=t?"include":"same-origin"}}),S(Ta,En);var Ea="";Ta.prototype.b=va("goog.net.XhrIo");var Sa=/^https?$/i,Ca=["POST","PUT"];function ka(t,e,n,r,i){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.P=n,t.J=!1,t.c=!0,t.a=t.D?t.D.a():zo.a(),t.C=t.D?Zo(t.D):Zo(zo),t.a.onreadystatechange=I(t.Wb,t);try{ga(t.b,Ma(t,"Opening Xhr")),t.N=!0,t.a.open(n,String(e),!0),t.N=!1}catch(e){return ga(t.b,Ma(t,"Error opening Xhr: "+e.message)),void Na(t,e)}e=r||"";var o=new Rn(t.headers);i&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(p(t)||"string"==typeof t)H(t,e,void 0);else for(var n=xn(t),r=Pn(t),i=r.length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}(i,(function(t,e){o.set(e,t)})),i=function(t){t:{for(var e=Aa,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(o.Y()),r=s.FormData&&e instanceof s.FormData,!Y(Ca,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach((function(t,e){this.a.setRequestHeader(e,t)}),t),t.m&&(t.a.responseType=t.m),"withCredentials"in t.a&&t.a.withCredentials!==t.S&&(t.a.withCredentials=t.S);try{Da(t),0<t.g&&(t.u=function(t){return Xt&&se(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(t.a),ga(t.b,Ma(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.u)),t.u?(t.a.timeout=t.g,t.a.ontimeout=I(t.Ma,t)):t.s=An(t.Ma,t.g,t)),ga(t.b,Ma(t,"Sending request")),t.i=!0,t.a.send(e),t.i=!1}catch(e){ga(t.b,Ma(t,"Send error: "+e.message)),Na(t,e)}}function Aa(t){return"content-type"==t.toLowerCase()}function Na(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,Pa(t),Ra(t)}function Pa(t){t.J||(t.J=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function xa(t){if(t.c&&void 0!==a)if(t.C[1]&&4==Oa(t)&&2==La(t))ga(t.b,Ma(t,"Local request error detected and ignored"));else if(t.i&&4==Oa(t))An(t.Wb,0,t);else if(t.dispatchEvent("readystatechange"),4==Oa(t)){ga(t.b,Ma(t,"Request complete")),t.c=!1;try{var e,n=La(t);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.l).match(Ln)[1]||null;if(!o&&s.self&&s.self.location){var u=s.self.location.protocol;o=u.substr(0,u.length-1)}i=!Sa.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var c=2<Oa(t)?t.a.statusText:""}catch(e){ga(t.b,"Can not get status: "+e.message),c=""}t.h=c+" ["+La(t)+"]",Pa(t)}}finally{Ra(t)}}}function Ra(t,e){if(t.a){Da(t);var n=t.a,r=t.C[0]?f:null;t.a=null,t.C=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(e){(t=t.b)&&t.log(ua,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function Da(t){t.a&&t.u&&(t.a.ontimeout=null),t.s&&(s.clearTimeout(t.s),t.s=null)}function Oa(t){return t.a?t.a.readyState:0}function La(t){try{return 2<Oa(t)?t.a.status:-1}catch(t){return-1}}function Ma(t,e){return e+" ["+t.P+" "+t.l+" "+La(t)+"]"}function Fa(t){var e=Qa;this.g=[],this.u=e,this.s=t||null,this.f=this.a=!1,this.c=void 0,this.v=this.C=this.i=!1,this.h=0,this.b=null,this.l=0}function Ua(t,e,n){t.a=!0,t.c=n,t.f=!e,Ba(t)}function ja(t){if(t.a){if(!t.v)throw new Ka(t);t.v=!1}}function qa(t,e,n,r){t.g.push([e,n,r]),t.a&&Ba(t)}function Va(t){return Q(t.g,(function(t){return v(t[1])}))}function Ba(t){if(t.h&&t.a&&Va(t)){var e=t.h,n=Ga[e];n&&(s.clearTimeout(n.a),delete Ga[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.i;){var i=t.g.shift(),o=i[0],a=i[1];if(i=i[2],o=t.f?a:o)try{var u=o.call(i||t.s,e);void 0!==u&&(t.f=t.f&&(u==e||u instanceof Error),t.c=e=u),(O(e)||"function"==typeof s.Promise&&e instanceof s.Promise)&&(r=!0,t.i=!0)}catch(r){e=r,t.f=!0,Va(t)||(n=!0)}}t.c=e,r&&(u=I(t.m,t,!0),r=I(t.m,t,!1),e instanceof Fa?(qa(e,u,r),e.C=!0):e.then(u,r)),n&&(e=new Ha(e),Ga[e.a]=e,t.h=e.a)}function Ka(){L.call(this)}function Wa(){L.call(this)}function Ha(t){this.a=s.setTimeout(I(this.c,this),0),this.b=t}(t=Ta.prototype).Ma=function(){void 0!==a&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",ga(this.b,Ma(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},t.abort=function(){this.a&&this.c&&(ga(this.b,Ma(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Ra(this))},t.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),Ra(this,!0)),Ta.bb.Da.call(this)},t.Wb=function(){this.ya||(this.N||this.i||this.f?xa(this):this.Jc())},t.Jc=function(){xa(this)},t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case Ea:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(ua,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(t){return ga(this.b,"Can not get response: "+t.message),null}},Fa.prototype.cancel=function(t){if(this.a)this.c instanceof Fa&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,0>=e.l&&e.cancel())}this.u?this.u.call(this.s,this):this.v=!0,this.a||(t=new Wa(this),ja(this),Ua(this,!1,t))}},Fa.prototype.m=function(t,e){this.i=!1,Ua(this,t,e)},Fa.prototype.then=function(t,e,n){var r,i,o=new Te((function(t,e){r=t,i=e}));return qa(this,r,(function(t){t instanceof Wa?o.cancel():i(t)})),o.then(t,e,n)},Fa.prototype.$goog_Thenable=!0,S(Ka,L),Ka.prototype.message="Deferred has already fired",Ka.prototype.name="AlreadyCalledError",S(Wa,L),Wa.prototype.message="Deferred was canceled",Wa.prototype.name="CanceledError",Ha.prototype.c=function(){throw delete Ga[this.a],this.b};var Ga={};function za(t){var e={},n=e.document||document,r=kt(t).toString(),i=ye(document,"SCRIPT"),o={Xb:i,Ma:void 0},a=new Fa(o),u=null,c=null!=e.timeout?e.timeout:5e3;return 0<c&&(u=window.setTimeout((function(){Ya(i,!0);var t=new Ja($a,"Timeout reached for loading script "+r);ja(a),Ua(a,!1,t)}),c),o.Ma=u),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(Ya(i,e.xd||!1,u),ja(a),Ua(a,!0,null))},i.onerror=function(){Ya(i,!0,u);var t=new Ja(Xa,"Error while loading script "+r);ja(a),Ua(a,!1,t)},mt(o=e.attributes||{},{type:"text/javascript",charset:"UTF-8"}),fe(i,o),function(t,e){_t(t,"HTMLScriptElement"),t.src=kt(e),(e=t.ownerDocument&&t.ownerDocument.defaultView)&&e!=s?e=h(e.document):(null===l&&(l=h(s.document)),e=l),e&&t.setAttribute("nonce",e)}(i,t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(i),a}function Qa(){if(this&&this.Xb){var t=this.Xb;t&&"SCRIPT"==t.tagName&&Ya(t,!0,this.Ma)}}function Ya(t,e,n){null!=n&&s.clearTimeout(n),t.onload=f,t.onerror=f,t.onreadystatechange=f,e&&window.setTimeout((function(){t&&t.parentNode&&t.parentNode.removeChild(t)}),0)}var Xa=0,$a=1;function Ja(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),L.call(this,n),this.code=t}function Za(t){this.f=t}function ts(t,e,n){if(this.c=t,t=e||{},this.l=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=t.secureTokenTimeout||rs,this.g=gt(t.secureTokenHeaders||is),this.h=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=t.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.v=t.firebaseTimeout||os,this.a=gt(t.firebaseHeaders||as),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==Sr(),!(n=s.XMLHttpRequest||n&&u.default.INTERNAL.node&&u.default.INTERNAL.node.XMLHttpRequest)&&!Er())throw new k("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,Er()?this.f=new ya(self):Cr()?this.f=new Za(n):this.f=new na,this.b=null}S(Ja,L),S(Za,Jo),Za.prototype.a=function(){return new this.f},Za.prototype.b=function(){return{}};var es,ns="idToken",rs=new Hr(3e4,6e4),is={"Content-Type":"application/x-www-form-urlencoded"},os=new Hr(3e4,6e4),as={"Content-Type":"application/json"};function ss(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function us(t,e){e&&(t.l=cs("https://securetoken.googleapis.com/v1/token",e),t.h=cs("https://www.googleapis.com/identitytoolkit/v3/relyingparty/",e),t.i=cs("https://identitytoolkit.googleapis.com/v2/",e))}function cs(t,e){return t=Bn(t),e=Bn(e.url),t.f=t.a+t.f,Fn(t,e.c),t.a=e.a,Un(t,e.g),t.toString()}function ls(t,e){e?(t.a["X-Client-Version"]=e,t.g["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.g["X-Client-Version"])}function hs(t,e,n,r,i,o,a){(function(){var t=Rr();return!((t=Nr(t)!=Ar?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t||Xt&&ce&&!(9<ce))})()||Er()?t=I(t.u,t):(es||(es=new Te((function(t,e){!function(t,e){if(((window.gapi||{}).client||{}).request)t();else{s[ds]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))},function(t,e){qa(t,null,e,void 0)}(za(At(fs,{onload:ds})),(function(){e(Error("CORS_UNSUPPORTED"))}))}}(t,e)}))),t=I(t.s,t)),t(e,n,r,i,o,a)}ts.prototype.T=function(){return this.b},ts.prototype.u=function(t,e,n,r,i,o){if(Er()&&(void 0===s.fetch||void 0===s.Headers||void 0===s.Request))throw new k("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var a=new Ta(this.f);if(o){a.g=Math.max(0,o);var u=setTimeout((function(){a.dispatchEvent("timeout")}),o)}Sn(a,"complete",(function(){u&&clearTimeout(u);var t=null;try{t=JSON.parse(function(t){try{return t.a?t.a.responseText:""}catch(e){return ga(t.b,"Can not get responseText: "+e.message),""}}(this))||null}catch(e){t=null}e&&e(t)})),Cn(a,"ready",(function(){u&&clearTimeout(u),Qe(this)})),Cn(a,"timeout",(function(){u&&clearTimeout(u),Qe(this),e&&e(null)})),ka(a,t,n,r,i)};var fs=new bt(Et,"https://apis.google.com/js/client.js?onload=%{onload}"),ds="__fcb"+Math.floor(1e6*Math.random()).toString();function ps(t,e,n,r,i,o,a){var s=Bn(e+n);qn(s,"key",t.c),a&&qn(s,"cb",Date.now().toString());var u="GET"==r;if(u)for(var c in i)i.hasOwnProperty(c)&&qn(s,c,i[c]);return new Te((function(e,n){hs(t,s.toString(),(function(t){t?t.error?n(cu(t,o||{})):e(t):n(new k("network-request-failed"))}),r,u?void 0:ar(qr(i)),t.a,t.v.get())}))}function vs(t){if("string"!=typeof(t=t.email)||!br.test(t))throw new k("invalid-email")}function gs(t){"email"in t&&vs(t)}function ys(t){if(!t[ns]){if(t.mfaPendingCredential)throw new k("multi-factor-auth-required",null,gt(t));throw new k("internal-error")}}function ms(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new k("internal-error")}else{if(!t.sessionInfo)throw new k("missing-verification-id");if(!t.code)throw new k("missing-verification-code")}}ts.prototype.s=function(t,e,n,r,i){var o=this;es.then((function(){window.gapi.client.setApiKey(o.c);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})})).o((function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})}))},ts.prototype.Ab=function(){return su(this,Ys,{})},ts.prototype.Cb=function(t,e){return su(this,zs,{idToken:t,email:e})},ts.prototype.Db=function(t,e){return su(this,Qs,{idToken:t,password:e})};var _s={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function bs(t){if(!t.phoneVerificationInfo)throw new k("internal-error");if(!t.phoneVerificationInfo.sessionInfo)throw new k("missing-verification-id");if(!t.phoneVerificationInfo.code)throw new k("missing-verification-code")}function ws(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new k("internal-error")}function Is(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&(nr(t=new Jn(t.postBody),"nonce")&&(e.nonce=t.get("nonce")))),e}function Ts(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=$o(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=$o(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=$o(t)):t.errorMessage&&(e=uu(t.errorMessage)),e)throw e;ys(t)}function Es(t,e){return e.returnIdpCredential=!0,su(t,Js,e)}function Ss(t,e){return e.returnIdpCredential=!0,su(t,tu,e)}function Cs(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,su(t,Zs,e)}function ks(t){if(!t.oobCode)throw new k("invalid-action-code")}(t=ts.prototype).Eb=function(t,e){var n={idToken:t},r=[];return pt(_s,(function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)})),r.length&&(n.deleteAttribute=r),su(this,zs,n)},t.wb=function(t,e){return mt(t={requestType:"PASSWORD_RESET",email:t},e),su(this,Bs,t)},t.xb=function(t,e){return mt(t={requestType:"EMAIL_SIGNIN",email:t},e),su(this,js,t)},t.vb=function(t,e){return mt(t={requestType:"VERIFY_EMAIL",idToken:t},e),su(this,qs,t)},t.Fb=function(t,e,n){return mt(t={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:t,newEmail:e},n),su(this,Vs,t)},t.gb=function(t){return su(this,ru,t)},t.ob=function(t,e){return su(this,Hs,{oobCode:t,newPassword:e})},t.Sa=function(t){return su(this,Ns,{oobCode:t})},t.kb=function(t){return su(this,As,{oobCode:t})};var As={endpoint:"setAccountInfo",A:ks,Z:"email",B:!0},Ns={endpoint:"resetPassword",A:ks,G:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e&&"VERIFY_AND_CHANGE_EMAIL"!=e)throw new k("internal-error")},B:!0},Ps={endpoint:"signupNewUser",A:function(t){if(vs(t),!t.password)throw new k("weak-password")},G:ys,V:!0,B:!0},xs={endpoint:"createAuthUri",B:!0},Rs={endpoint:"deleteAccount",O:["idToken"]},Ds={endpoint:"setAccountInfo",O:["idToken","deleteProvider"],A:function(t){if(!Array.isArray(t.deleteProvider))throw new k("internal-error")}},Os={endpoint:"emailLinkSignin",O:["email","oobCode"],A:vs,G:ys,V:!0,B:!0},Ls={endpoint:"emailLinkSignin",O:["idToken","email","oobCode"],A:vs,G:ys,V:!0},Ms={endpoint:"accounts/mfaEnrollment:finalize",O:["idToken","phoneVerificationInfo"],A:bs,G:ys,B:!0,Na:!0},Fs={endpoint:"accounts/mfaSignIn:finalize",O:["mfaPendingCredential","phoneVerificationInfo"],A:bs,G:ys,B:!0,Na:!0},Us={endpoint:"getAccountInfo"},js={endpoint:"getOobConfirmationCode",O:["requestType"],A:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new k("internal-error");vs(t)},Z:"email",B:!0},qs={endpoint:"getOobConfirmationCode",O:["idToken","requestType"],A:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new k("internal-error")},Z:"email",B:!0},Vs={endpoint:"getOobConfirmationCode",O:["idToken","newEmail","requestType"],A:function(t){if("VERIFY_AND_CHANGE_EMAIL"!=t.requestType)throw new k("internal-error")},Z:"email",B:!0},Bs={endpoint:"getOobConfirmationCode",O:["requestType"],A:function(t){if("PASSWORD_RESET"!=t.requestType)throw new k("internal-error");vs(t)},Z:"email",B:!0},Ks={mb:!0,endpoint:"getProjectConfig",Vb:"GET"},Ws={mb:!0,endpoint:"getRecaptchaParam",Vb:"GET",G:function(t){if(!t.recaptchaSiteKey)throw new k("internal-error")}},Hs={endpoint:"resetPassword",A:ks,Z:"email",B:!0},Gs={endpoint:"sendVerificationCode",O:["phoneNumber","recaptchaToken"],Z:"sessionInfo",B:!0},zs={endpoint:"setAccountInfo",O:["idToken"],A:gs,V:!0},Qs={endpoint:"setAccountInfo",O:["idToken"],A:function(t){if(gs(t),!t.password)throw new k("weak-password")},G:ys,V:!0},Ys={endpoint:"signupNewUser",G:ys,V:!0,B:!0},Xs={endpoint:"accounts/mfaEnrollment:start",O:["idToken","phoneEnrollmentInfo"],A:function(t){if(!t.phoneEnrollmentInfo)throw new k("internal-error");if(!t.phoneEnrollmentInfo.phoneNumber)throw new k("missing-phone-number");if(!t.phoneEnrollmentInfo.recaptchaToken)throw new k("missing-app-credential")},G:function(t){if(!t.phoneSessionInfo||!t.phoneSessionInfo.sessionInfo)throw new k("internal-error")},B:!0,Na:!0},$s={endpoint:"accounts/mfaSignIn:start",O:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],A:function(t){if(!t.phoneSignInInfo||!t.phoneSignInInfo.recaptchaToken)throw new k("missing-app-credential")},G:function(t){if(!t.phoneResponseInfo||!t.phoneResponseInfo.sessionInfo)throw new k("internal-error")},B:!0,Na:!0},Js={endpoint:"verifyAssertion",A:ws,Za:Is,G:Ts,V:!0,B:!0},Zs={endpoint:"verifyAssertion",A:ws,Za:Is,G:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new k("user-not-found");if(t.errorMessage)throw uu(t.errorMessage);ys(t)},V:!0,B:!0},tu={endpoint:"verifyAssertion",A:function(t){if(ws(t),!t.idToken)throw new k("internal-error")},Za:Is,G:Ts,V:!0},eu={endpoint:"verifyCustomToken",A:function(t){if(!t.token)throw new k("invalid-custom-token")},G:ys,V:!0,B:!0},nu={endpoint:"verifyPassword",A:function(t){if(vs(t),!t.password)throw new k("wrong-password")},G:ys,V:!0,B:!0},ru={endpoint:"verifyPhoneNumber",A:ms,G:ys,B:!0},iu={endpoint:"verifyPhoneNumber",A:function(t){if(!t.idToken)throw new k("internal-error");ms(t)},G:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",$o(t);ys(t)}},ou={Ib:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",A:ms,G:ys,B:!0},au={endpoint:"accounts/mfaEnrollment:withdraw",O:["idToken","mfaEnrollmentId"],G:function(t){if(!!t[ns]^!!t.refreshToken)throw new k("internal-error")},B:!0,Na:!0};function su(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(null==r||""===r)return!1}return!0}(n,e.O))return xe(new k("internal-error"));var r,i=!!e.Na,o=e.Vb||"POST";return Pe(n).then(e.A).then((function(){return e.V&&(n.returnSecureToken=!0),e.B&&t.b&&void 0===n.tenantId&&(n.tenantId=t.b),ps(t,i?t.i:t.h,e.endpoint,o,n,e.Ib,e.mb||!1)})).then((function(t){return r=t,e.Za?e.Za(n,r):r})).then(e.G).then((function(){if(!e.Z)return r;if(!(e.Z in r))throw new k("internal-error");return r[e.Z]}))}function uu(t){return cu({error:{errors:[{message:t}],code:400,message:t}})}function cu(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new k(r[n]):null)return n;for(var i in n=t.error&&t.error.message||"",mt(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new k(r[i],e);return!e&&t&&(e=jr(t)),new k("internal-error",e)}function lu(t){this.b=t,this.a=null,this.sb=function(t){return(pu||(pu=new Te((function(t,e){function n(){Wr(),Dr("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){Wr(),e(Error("Network Error"))},timeout:fu.get()})}if(Dr("gapi.iframes.Iframe"))t();else if(Dr("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();s[r]=function(){Dr("gapi.load")?n():e(Error("Network Error"))},Pe(za(r=At(hu,{onload:r}))).o((function(){e(Error("Network Error"))}))}})).o((function(t){throw pu=null,t})))).then((function(){return new Te((function(e,n){Dr("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:Dr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},(function(r){function i(){clearTimeout(o),e()}t.a=r,t.a.restyle({setHideOnLeave:!1});var o=setTimeout((function(){n(Error("Network Error"))}),du.get());r.ping(i).then(i,(function(){n(Error("Network Error"))}))}))}))}))}(this)}var hu=new bt(Et,"https://apis.google.com/js/api.js?onload=%{onload}"),fu=new Hr(3e4,6e4),du=new Hr(5e3,15e3),pu=null;function vu(t,e,n,r){this.l=t,this.h=e,this.i=n,this.g=r,this.f=null,this.g?t=Kn((t=Bn(this.g.url)).c,t.a,t.g,"/emulator/auth/iframe"):t=Kn("https",this.l,null,"/__/auth/iframe"),this.a=t,qn(this.a,"apiKey",this.h),qn(this.a,"appName",this.i),this.b=null,this.c=[]}function gu(t,e,n,r,i,o){this.u=t,this.s=e,this.c=n,this.m=r,this.v=o,this.i=this.g=this.l=null,this.a=i,this.h=this.f=null}function yu(t){try{return u.default.app(t).auth().Ga()}catch(t){return[]}}function mu(t,e,n,r,i,o){this.s=t,this.g=e,this.b=n,this.f=o,this.c=r||null,this.i=i||null,this.l=this.u=this.C=null,this.h=[],this.m=this.a=null}function _u(t){var e=dr();return function(t){return su(t,Ks,{}).then((function(t){return t.authorizedDomains||[]}))}(t).then((function(t){t:{var n=Bn(e),r=n.c;n=n.a;for(var i=0;i<t.length;i++){var o=t[i],a=n,s=r;if(0==o.indexOf("chrome-extension://")?a=Bn(o).a==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:_r.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new Yo(dr())}))}function bu(t){return t.m||(t.m=wr().then((function(){if(!t.u){var e=t.c,n=t.i,r=yu(t.b),i=new vu(t.s,t.g,t.b,t.f);i.f=e,i.b=n,i.c=Z(r||[]),t.u=i.toString()}t.v=new lu(t.u),function(t){if(!t.v)throw Error("IfcHandler must be initialized!");!function(t,e){t.sb.then((function(){t.a.register("authEvent",e,Dr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}(t.v,(function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=Ho(e.authEvent),n=0;n<t.h.length;n++)r=t.h[n](e)||r;return(n={}).status=r?"ACK":"ERROR",Pe(n)}return n.status="ERROR",Pe(n)}))}(t)}))),t.m}function wu(t){return t.l||(t.C=t.c?xr(t.c,yu(t.b)):null,t.l=new ts(t.g,D(t.i),t.C),t.f&&us(t.l,t.f)),t.l}function Iu(t,e,n,r,i,o,a,s,u,c,l,h){return(t=new gu(t,e,n,r,i,h)).l=o,t.g=a,t.i=s,t.b=gt(u||null),t.f=c,t.zb(l).toString()}function Tu(t){if(this.a=t||u.default.INTERNAL.reactNative&&u.default.INTERNAL.reactNative.AsyncStorage,!this.a)throw new k("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function Eu(t){this.b=t,this.a={},this.f=I(this.c,this)}vu.prototype.toString=function(){return this.f?qn(this.a,"v",this.f):er(this.a.b,"v"),this.b?qn(this.a,"eid",this.b):er(this.a.b,"eid"),this.c.length?qn(this.a,"fw",this.c.join(",")):er(this.a.b,"fw"),this.a.toString()},gu.prototype.zb=function(t){return this.h=t,this},gu.prototype.toString=function(){if(this.v){var t=Bn(this.v.url);t=Kn(t.c,t.a,t.g,"/emulator/auth/handler")}else t=Kn("https",this.u,null,"/__/auth/handler");if(qn(t,"apiKey",this.s),qn(t,"appName",this.c),qn(t,"authType",this.m),this.a.isOAuthProvider){var e=this.a;try{var n=u.default.app(this.c).auth().la()}catch(t){n=null}for(var r in e.pb=n,qn(t,"providerId",this.a.providerId),e=qr((n=this.a).Jb))e[r]=e[r].toString();r=n.Qc,e=gt(e);for(var i=0;i<r.length;i++){var o=r[i];o in e&&delete e[o]}n.qb&&n.pb&&!e[n.qb]&&(e[n.qb]=n.pb),vt(e)||qn(t,"customParameters",jr(e))}if("function"==typeof this.a.Rb&&((n=this.a.Rb()).length&&qn(t,"scopes",n.join(","))),this.l?qn(t,"redirectUrl",this.l):er(t.b,"redirectUrl"),this.g?qn(t,"eventId",this.g):er(t.b,"eventId"),this.i?qn(t,"v",this.i):er(t.b,"v"),this.b)for(var a in this.b)this.b.hasOwnProperty(a)&&!Vn(t,a)&&qn(t,a,this.b[a]);return this.h?qn(t,"tid",this.h):er(t.b,"tid"),this.f?qn(t,"eid",this.f):er(t.b,"eid"),(a=yu(this.c)).length&&qn(t,"fw",a.join(",")),t.toString()},(t=mu.prototype).Pb=function(t,e,n){var r=new k("popup-closed-by-user"),i=new k("web-storage-unsupported"),o=this,a=!1;return this.ma().then((function(){(function(t){var e={type:"webStorageSupport"};return bu(t).then((function(){return function(t,e){return t.sb.then((function(){return new Te((function(n){t.a.send(e.type,e,n,Dr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}))}(t.v,e)})).then((function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()}))})(o).then((function(n){n||(t&&yr(t),e(i),a=!0)}))})).o((function(){})).then((function(){if(!a)return function(t){return new Te((function(e){return function n(){Nn(2e3).then((function(){if(t&&!t.closed)return n();e()}))}()}))}(t)})).then((function(){if(!a)return Nn(n).then((function(){e(r)}))}))},t.Yb=function(){var t=Rr();return!Ur(t)&&!Kr(t)},t.Ub=function(){return!1},t.Nb=function(t,e,n,r,i,o,a,s){if(!t)return xe(new k("popup-blocked"));if(a&&!Ur())return this.ma().o((function(e){yr(t),i(e)})),r(),Pe();this.a||(this.a=_u(wu(this)));var u=this;return this.a.then((function(){var e=u.ma().o((function(e){throw yr(t),i(e),e}));return r(),e})).then((function(){(Ko(n),a)||pr(Iu(u.s,u.g,u.b,e,n,null,o,u.c,void 0,u.i,s,u.f),t)})).o((function(t){throw"auth/network-request-failed"==t.code&&(u.a=null),t}))},t.Ob=function(t,e,n,r){this.a||(this.a=_u(wu(this)));var i=this;return this.a.then((function(){Ko(e),pr(Iu(i.s,i.g,i.b,t,e,dr(),n,i.c,void 0,i.i,r,i.f))})).o((function(t){throw"auth/network-request-failed"==t.code&&(i.a=null),t}))},t.ma=function(){var t=this;return bu(this).then((function(){return t.v.sb})).o((function(){throw t.a=null,new k("network-request-failed")}))},t.ac=function(){return!0},t.Ea=function(t){this.h.push(t)},t.Ta=function(t){$(this.h,(function(e){return e==t}))},(t=Tu.prototype).get=function(t){return Pe(this.a.getItem(t)).then((function(t){return t&&Vr(t)}))},t.set=function(t,e){return Pe(this.a.setItem(t,jr(e)))},t.U=function(t){return Pe(this.a.removeItem(t))},t.ca=function(){},t.ia=function(){};var Su,Cu=[];function ku(t,e,n){vt(t.a)&&t.b.addEventListener("message",t.f),void 0===t.a[e]&&(t.a[e]=[]),t.a[e].push(n)}function Au(t){this.a=t}function Nu(t){this.c=t,this.b=!1,this.a=[]}function Pu(t,e,n,r){var i,o,a,s,u=n||{},c=null;if(t.b)return xe(Error("connection_unavailable"));var l=r?800:50,h="undefined"!=typeof MessageChannel?new MessageChannel:null;return new Te((function(n,r){h?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),h.port1.start(),a=setTimeout((function(){r(Error("unsupported_event"))}),l),c={messageChannel:h,onMessage:o=function(t){t.data.eventId===i&&("ack"===t.data.status?(clearTimeout(a),s=setTimeout((function(){r(Error("timeout"))}),3e3)):"done"===t.data.status?(clearTimeout(s),void 0!==t.data.response?n(t.data.response):r(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),r(Error("invalid_response"))))}},t.a.push(c),h.port1.addEventListener("message",o),t.c.postMessage({eventType:e,eventId:i,data:u},[h.port2])):r(Error("connection_unavailable"))})).then((function(e){return xu(t,c),e})).o((function(e){throw xu(t,c),e}))}function xu(t,e){if(e){var n=e.messageChannel,r=e.onMessage;n&&(n.port1.removeEventListener("message",r),n.port1.close()),$(t.a,(function(t){return t==e}))}}function Ru(){if(!Mu())throw new k("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=s.indexedDB,this.type="indexedDB",this.g=this.v=this.f=this.l=null,this.s=!1,this.h=null;var t=this;Er()&&self?(this.v=function(){var t=Er()?self:null;if(H(Cu,(function(n){n.b==t&&(e=n)})),!e){var e=new Eu(t);Cu.push(e)}return e}(),ku(this.v,"keyChanged",(function(e,n){return Vu(t).then((function(e){return 0<e.length&&H(t.a,(function(t){t(e)})),{keyProcessed:Y(e,n.key)}}))})),ku(this.v,"ping",(function(){return Pe(["keyChanged"])}))):function(){var t=s.navigator;return t&&t.serviceWorker?Pe().then((function(){return t.serviceWorker.ready})).then((function(t){return t.active||null})).o((function(){return null})):Pe(null)}().then((function(e){(t.h=e)&&(t.g=new Nu(new Au(e)),Pu(t.g,"ping",null,!0).then((function(e){e[0].fulfilled&&Y(e[0].value,"keyChanged")&&(t.s=!0)})).o((function(){})))}))}function Du(t){return new Te((function(e,n){var r=t.m.open("firebaseLocalStorageDb",1);r.onerror=function(t){try{t.preventDefault()}catch(t){}n(Error(t.target.error))},r.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(t){n(t)}},r.onsuccess=function(r){(r=r.target.result).objectStoreNames.contains("firebaseLocalStorage")?e(r):function(t){return new Te((function(e,n){var r=t.m.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){e()},r.onerror=function(t){n(Error(t.target.error))}}))}(t).then((function(){return Du(t)})).then((function(t){e(t)})).o((function(t){n(t)}))}}))}function Ou(t){return t.i||(t.i=Du(t)),t.i}function Lu(t,e){var n=0;return new Te((function r(i,o){Ou(t).then(e).then(i).o((function(e){if(!(3<++n))return Ou(t).then((function(e){return e.close(),t.i=void 0,r(i,o)})).o((function(t){o(t)}));o(e)}))}))}function Mu(){try{return!!s.indexedDB}catch(t){return!1}}function Fu(t){return t.objectStore("firebaseLocalStorage")}function Uu(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function ju(t){return new Te((function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}}))}function qu(t,e){return t.g&&t.h&&function(){var t=s.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.h?Pu(t.g,"keyChanged",{key:e},t.s).then((function(){})).o((function(){})):Pe()}function Vu(t){return Ou(t).then((function(t){var e=Fu(Uu(t,!1));return e.getAll?ju(e.getAll()):new Te((function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},i.onerror=function(t){n(t.target.error)}}))})).then((function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=vr(t.c,n),t.c=n}return r}))}function Bu(t){t.l&&t.l.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function Ku(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=Pe().then((function(){if(Mu()){var t=Br(),r="__sak"+t;return Su||(Su=new Ru),(n=Su).set(r,t).then((function(){return n.get(r)})).then((function(e){if(e!==t)throw Error("indexedDB not supported!");return n.U(r)})).then((function(){return n})).o((function(){return e.c}))}return e.c})).then((function(t){return e.type=t.type,t.ca((function(t){H(e.a,(function(e){e(t)}))})),t}))}function Wu(){this.a={},this.type="inMemory"}function Hu(){if(!function(){var t="Node"==Sr();if(!(t=Gu()||t&&u.default.INTERNAL.node&&u.default.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==Sr())throw new k("internal-error","The LocalStorage compatibility library was not found.");throw new k("web-storage-unsupported")}this.a=Gu()||u.default.INTERNAL.node.localStorage,this.type="localStorage"}function Gu(){try{var t=s.localStorage,e=Br();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function zu(){this.type="nullStorage"}function Qu(){if(!function(){var t="Node"==Sr();if(!(t=Yu()||t&&u.default.INTERNAL.node&&u.default.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==Sr())throw new k("internal-error","The SessionStorage compatibility library was not found.");throw new k("web-storage-unsupported")}this.a=Yu()||u.default.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Yu(){try{var t=s.sessionStorage,e=Br();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function Xu(){var t={};t.Browser=Zu,t.Node=tc,t.ReactNative=ec,t.Worker=nc,this.a=t[Sr()]}Eu.prototype.c=function(t){var e=t.data.eventType,n=t.data.eventId,r=this.a[e];if(r&&0<r.length){t.ports[0].postMessage({status:"ack",eventId:n,eventType:e,response:null});var i=[];H(r,(function(e){i.push(Pe().then((function(){return e(t.origin,t.data.data)})))})),De(i).then((function(r){var i=[];H(r,(function(t){i.push({fulfilled:t.Qb,value:t.value,reason:t.reason?t.reason.message:void 0})})),H(i,(function(t){for(var e in t)void 0===t[e]&&delete t[e]})),t.ports[0].postMessage({status:"done",eventId:n,eventType:e,response:i})}))}},Au.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},Nu.prototype.close=function(){for(;0<this.a.length;)xu(this,this.a[0]);this.b=!0},(t=Ru.prototype).set=function(t,e){var n=this,r=!1;return Lu(this,(function(e){return ju((e=Fu(Uu(e,!0))).get(t))})).then((function(i){return Lu(n,(function(o){if(o=Fu(Uu(o,!0)),i)return i.value=e,ju(o.put(i));n.b++,r=!0;var a={};return a.fbase_key=t,a.value=e,ju(o.add(a))}))})).then((function(){return n.c[t]=e,qu(n,t)})).oa((function(){r&&n.b--}))},t.get=function(t){return Lu(this,(function(e){return ju(Fu(Uu(e,!1)).get(t))})).then((function(t){return t&&t.value}))},t.U=function(t){var e=this,n=!1;return Lu(this,(function(r){return n=!0,e.b++,ju(Fu(Uu(r,!0)).delete(t))})).then((function(){return delete e.c[t],qu(e,t)})).oa((function(){n&&e.b--}))},t.ca=function(t){0==this.a.length&&function(t){function e(){t.f=setTimeout((function(){t.l=Vu(t).then((function(e){0<e.length&&H(t.a,(function(t){t(e)}))})).then((function(){e()})).o((function(t){"STOP_EVENT"!=t.message&&e()}))}),800)}Bu(t),e()}(this),this.a.push(t)},t.ia=function(t){$(this.a,(function(e){return e==t})),0==this.a.length&&Bu(this)},(t=Ku.prototype).get=function(t){return this.b.then((function(e){return e.get(t)}))},t.set=function(t,e){return this.b.then((function(n){return n.set(t,e)}))},t.U=function(t){return this.b.then((function(e){return e.U(t)}))},t.ca=function(t){this.a.push(t)},t.ia=function(t){$(this.a,(function(e){return e==t}))},(t=Wu.prototype).get=function(t){return Pe(this.a[t])},t.set=function(t,e){return this.a[t]=e,Pe()},t.U=function(t){return delete this.a[t],Pe()},t.ca=function(){},t.ia=function(){},(t=Hu.prototype).get=function(t){var e=this;return Pe().then((function(){return Vr(e.a.getItem(t))}))},t.set=function(t,e){var n=this;return Pe().then((function(){var r=jr(e);null===r?n.U(t):n.a.setItem(t,r)}))},t.U=function(t){var e=this;return Pe().then((function(){e.a.removeItem(t)}))},t.ca=function(t){s.window&&fn(s.window,"storage",t)},t.ia=function(t){s.window&&vn(s.window,"storage",t)},(t=zu.prototype).get=function(){return Pe(null)},t.set=function(){return Pe()},t.U=function(){return Pe()},t.ca=function(){},t.ia=function(){},(t=Qu.prototype).get=function(t){var e=this;return Pe().then((function(){return Vr(e.a.getItem(t))}))},t.set=function(t,e){var n=this;return Pe().then((function(){var r=jr(e);null===r?n.U(t):n.a.setItem(t,r)}))},t.U=function(t){var e=this;return Pe().then((function(){e.a.removeItem(t)}))},t.ca=function(){},t.ia=function(){};var $u,Ju,Zu={F:Hu,cb:Qu},tc={F:Hu,cb:Qu},ec={F:Tu,cb:zu},nc={F:Hu,cb:zu},rc={rd:"local",NONE:"none",td:"session"};function ic(){var t=!(Kr(Rr())||!Tr()),e=Ur(),n=Or();this.m=t,this.h=e,this.l=n,this.a={},$u||($u=new Xu),t=$u;try{this.g=!fr()&&Qr()||!s.indexedDB?new t.a.F:new Ku(Er()?new Wu:new t.a.F)}catch(t){this.g=new Wu,this.h=!0}try{this.i=new t.a.cb}catch(t){this.i=new Wu}this.v=new Wu,this.f=I(this.Zb,this),this.b={}}function oc(){return Ju||(Ju=new ic),Ju}function ac(t,e){switch(e){case"session":return t.i;case"none":return t.v;default:return t.g}}function sc(t,e){return"firebase:"+t.name+(e?":"+e:"")}function uc(t,e,n){return n=sc(e,n),"local"==e.F&&(t.b[n]=null),ac(t,e.F).U(n)}function cc(t){t.c&&(clearInterval(t.c),t.c=null)}function lc(t){this.a=t,this.b=oc()}(t=ic.prototype).get=function(t,e){return ac(this,t.F).get(sc(t,e))},t.set=function(t,e,n){var r=sc(t,n),i=this,o=ac(this,t.F);return o.set(r,e).then((function(){return o.get(r)})).then((function(e){"local"==t.F&&(i.b[r]=e)}))},t.addListener=function(t,e,n){t=sc(t,e),this.l&&(this.b[t]=s.localStorage.getItem(t)),vt(this.a)&&(ac(this,"local").ca(this.f),this.h||(fr()||!Qr())&&s.indexedDB||!this.l||function(t){cc(t),t.c=setInterval((function(){for(var e in t.a){var n=s.localStorage.getItem(e),r=t.b[e];n!=r&&(t.b[e]=n,n=new tn({type:"storage",key:e,target:window,oldValue:r,newValue:n,a:!0}),t.Zb(n))}}),1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},t.removeListener=function(t,e,n){t=sc(t,e),this.a[t]&&($(this.a[t],(function(t){return t==n})),0==this.a[t].length&&delete this.a[t]),vt(this.a)&&(ac(this,"local").ia(this.f),cc(this))},t.Zb=function(t){if(t&&t.g){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=s.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.nb(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?ac(this,"local").ia(this.f):cc(this),this.m)if(n=s.localStorage.getItem(e),(r=t.a.newValue)!==n)null!==r?s.localStorage.setItem(e,r):s.localStorage.removeItem(e);else if(this.b[e]===r&&void 0===t.a.a)return;var o=this;n=function(){void 0===t.a.a&&o.b[e]===s.localStorage.getItem(e)||(o.b[e]=s.localStorage.getItem(e),o.nb(e))},Xt&&ce&&10==ce&&s.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else H(t,I(this.nb,this))},t.nb=function(t){this.a[t]&&H(this.a[t],(function(t){t()}))};var hc,fc={name:"authEvent",F:"local"};function dc(){this.a=oc()}function pc(t,e){this.b=vc,this.f=s.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=s.Int32Array?new Int32Array(64):Array(64),void 0===hc&&(hc=s.Int32Array?new Int32Array(Ic):Ic),this.reset()}S(pc,(function(){this.b=-1}));for(var vc=64,gc=vc-1,yc=[],mc=0;mc<gc;mc++)yc[mc]=0;var _c=J(128,yc);function bc(t){for(var e=t.f,n=t.l,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;64>e;e++){i=0|n[e-15],r=0|n[e-2];var o=(0|n[e-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[e-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+a|0}r=0|t.a[0],i=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],l=0|t.a[5],h=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((a=(a=c&l^~c&h)+(0|hc[e])|0)+(0|n[e])|0)|0,o=h,h=l,l=c,c=u+a|0,u=s,s=i,i=r,r=a+f|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+l|0,t.a[6]=t.a[6]+h|0,t.a[7]=t.a[7]+o|0}function wc(t,e,n){void 0===n&&(n=e.length);var r=0,i=t.c;if("string"==typeof e)for(;r<n;)t.f[i++]=e.charCodeAt(r++),i==t.b&&(bc(t),i=0);else{if(!p(e))throw Error("message must be string or array");for(;r<n;){var o=e[r++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");t.f[i++]=o,i==t.b&&(bc(t),i=0)}}t.c=i,t.g+=n}pc.prototype.reset=function(){this.g=this.c=0,this.a=s.Int32Array?new Int32Array(this.h):Z(this.h)};var Ic=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Tc(){pc.call(this,8,Ec)}S(Tc,pc);var Ec=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function Sc(t,e,n,r,i,o){this.v=t,this.i=e,this.l=n,this.m=r||null,this.u=i||null,this.s=o,this.h=e+":"+n,this.C=new dc,this.g=new lc(this.h),this.f=null,this.b=[],this.a=this.c=null}function Cc(t){return new k("invalid-cordova-configuration",t)}function kc(t){var e=new Tc;wc(e,t),t=[];var n=8*e.g;56>e.c?wc(e,_c,56-e.c):wc(e,_c,e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(bc(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return function(t){return z(t,(function(t){return 1<(t=t.toString(16)).length?t:"0"+t})).join("")}(t)}function Ac(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(t){}}function Nc(t){return t.f||(t.f=t.ma().then((function(){return new Te((function(e){t.Ea((function n(r){return e(r),t.Ta(n),!1})),function(t){function e(e){r=!0,i&&i.cancel(),Pc(t).then((function(r){var i=n;if(r&&e&&e.url){var o=null;-1!=(i=uo(e.url)).indexOf("/__/auth/callback")&&(o=(o="object"==typeof(o=Vr(Vn(o=Bn(i),"firebaseError")||null))?A(o):null)?new Wo(r.c,r.b,null,null,o,null,r.T()):new Wo(r.c,r.b,i,r.f,null,null,r.T())),i=o||n}Ac(t,i)}))}var n=new Wo("unknown",null,null,null,new k("no-auth-event")),r=!1,i=Nn(500).then((function(){return Pc(t).then((function(){r||Ac(t,n)}))})),o=s.handleOpenURL;s.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(Dr("BuildInfo.packageName",s).toLowerCase()+"://")&&e({url:t}),"function"==typeof o)try{o(t)}catch(t){console.error(t)}},Qo||(Qo=new Go),function(t){var e=Qo;e.a.push(t),e.b||(e.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"==typeof(t=Dr("universalLinks.subscribe",s))&&t(null,e.b))}(e)}(t)}))}))),t.f}function Pc(t){var e=null;return function(t){return t.b.get(fc,t.a).then((function(t){return Ho(t)}))}(t.g).then((function(n){return e=n,uc((n=t.g).b,fc,n.a)})).then((function(){return e}))}function xc(t){this.a=t,this.b=oc()}(t=Sc.prototype).ma=function(){return this.Ia?this.Ia:this.Ia=(Ir(void 0)?wr().then((function(){return new Te((function(t,e){var n=s.document,r=setTimeout((function(){e(Error("Cordova framework is not ready."))}),1e3);n.addEventListener("deviceready",(function(){clearTimeout(r),t()}),!1)}))})):xe(Error("Cordova must run in an Android or iOS file scheme."))).then((function(){if("function"!=typeof Dr("universalLinks.subscribe",s))throw Cc("cordova-universal-links-plugin-fix is not installed");if(void 0===Dr("BuildInfo.packageName",s))throw Cc("cordova-plugin-buildinfo is not installed");if("function"!=typeof Dr("cordova.plugins.browsertab.openUrl",s))throw Cc("cordova-plugin-browsertab is not installed");if("function"!=typeof Dr("cordova.InAppBrowser.open",s))throw Cc("cordova-plugin-inappbrowser is not installed")}),(function(){throw new k("cordova-not-ready")}))},t.Pb=function(t,e){return e(new k("operation-not-supported-in-this-environment")),Pe()},t.Nb=function(){return xe(new k("operation-not-supported-in-this-environment"))},t.ac=function(){return!1},t.Yb=function(){return!0},t.Ub=function(){return!0},t.Ob=function(t,e,n,r){if(this.c)return xe(new k("redirect-operation-pending"));var i=this,o=s.document,a=null,u=null,c=null,l=null;return this.c=Pe().then((function(){return Ko(e),Nc(i)})).then((function(){return function(t,e,n,r,i){var o=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),a=new Wo(e,r,null,o,new k("no-auth-event"),null,i),u=Dr("BuildInfo.packageName",s);if("string"!=typeof u)throw new k("invalid-cordova-configuration");var c=Dr("BuildInfo.displayName",s),l={};if(Rr().toLowerCase().match(/iphone|ipad|ipod/))l.ibi=u;else{if(!Rr().toLowerCase().match(/android/))return xe(new k("operation-not-supported-in-this-environment"));l.apn=u}c&&(l.appDisplayName=c),o=kc(o),l.sessionId=o;var h=Iu(t.v,t.i,t.l,e,n,null,r,t.m,l,t.u,i,t.s);return t.ma().then((function(){var e=t.h;return t.C.a.set(fc,a.w(),e)})).then((function(){var e=Dr("cordova.plugins.browsertab.isAvailable",s);if("function"!=typeof e)throw new k("invalid-cordova-configuration");var n=null;e((function(e){if(e){if("function"!=typeof(n=Dr("cordova.plugins.browsertab.openUrl",s)))throw new k("invalid-cordova-configuration");n(h)}else{if("function"!=typeof(n=Dr("cordova.InAppBrowser.open",s)))throw new k("invalid-cordova-configuration");e=Rr(),t.a=n(h,e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}}))}))}(i,t,e,n,r)})).then((function(){return new Te((function(t,e){u=function(){var e=Dr("cordova.plugins.browsertab.close",s);return t(),"function"==typeof e&&e(),i.a&&"function"==typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Ea(u),c=function(){a||(a=Nn(2e3).then((function(){e(new k("redirect-cancelled-by-user"))})))},l=function(){Gr()&&c()},o.addEventListener("resume",c,!1),Rr().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",l,!1)})).o((function(t){return Pc(i).then((function(){throw t}))}))})).oa((function(){c&&o.removeEventListener("resume",c,!1),l&&o.removeEventListener("visibilitychange",l,!1),a&&a.cancel(),u&&i.Ta(u),i.c=null}))},t.Ea=function(t){this.b.push(t),Nc(this).o((function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Wo("unknown",null,null,null,new k("no-auth-event")),t(e))}))},t.Ta=function(t){$(this.b,(function(e){return e==t}))};var Rc={name:"pendingRedirect",F:"session"};function Dc(t){return uc(t.b,Rc,t.a)}function Oc(t,e,n,r){this.i={},this.u=0,this.D=t,this.v=e,this.m=n,this.J=r,this.h=[],this.f=!1,this.l=I(this.s,this),this.b=new Yc,this.C=new tl,this.g=new xc(zc(this.v,this.m)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.C,this.c.linkViaPopup=this.C,this.c.reauthViaPopup=this.C,this.a=Lc(this.D,this.v,this.m,N,this.J)}function Lc(t,e,n,r,i){var o=u.default.SDK_VERSION||null;return Ir()?new Sc(t,e,n,o,r,i):new mu(t,e,n,o,r,i)}function Mc(t){t.f||(t.f=!0,t.a.Ea(t.l));var e=t.a;return t.a.ma().o((function(n){throw t.a==e&&t.reset(),n}))}function Fc(t){t.a.Yb()&&Mc(t).o((function(e){var n=new Wo("unknown",null,null,null,new k("operation-not-supported-in-this-environment"));Kc(e)&&t.s(n)})),t.a.Ub()||Xc(t.b)}function Uc(t,e){Y(t.h,e)||t.h.push(e),t.f||function(t){return t.b.get(Rc,t.a).then((function(t){return"pending"==t}))}(t.g).then((function(e){e?Dc(t.g).then((function(){Mc(t).o((function(e){var n=new Wo("unknown",null,null,null,new k("operation-not-supported-in-this-environment"));Kc(e)&&t.s(n)}))})):Fc(t)})).o((function(){Fc(t)}))}function jc(t,e){$(t.h,(function(t){return t==e}))}Oc.prototype.reset=function(){this.f=!1,this.a.Ta(this.l),this.a=Lc(this.D,this.v,this.m,null,this.J),this.i={}},Oc.prototype.s=function(t){if(!t)throw new k("invalid-auth-event");if(6e5<=Date.now()-this.u&&(this.i={},this.u=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.Gb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,r),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.u=Date.now())),e=!0;break}}return Xc(this.b),e};var qc=new Hr(2e3,1e4),Vc=new Hr(3e4,6e4);function Bc(t,e,n,r,i,o,a){return t.a.Nb(e,n,r,(function(){t.f||(t.f=!0,t.a.Ea(t.l))}),(function(){t.reset()}),i,o,a)}function Kc(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function Wc(t,e,n,r,i){var o;return function(t){return t.b.set(Rc,"pending",t.a)}(t.g).then((function(){return t.a.Ob(e,n,r,i).o((function(e){if(Kc(e))throw new k("operation-not-supported-in-this-environment");return o=e,Dc(t.g).then((function(){throw o}))})).then((function(){return t.a.ac()?new Te((function(){})):Dc(t.g).then((function(){return t.ra()})).then((function(){})).o((function(){}))}))}))}function Hc(t,e,n,r,i){return t.a.Pb(r,(function(t){e.na(n,null,t,i)}),qc.get())}Oc.prototype.ra=function(){return this.b.ra()};var Gc={};function zc(t,e,n){return t=t+":"+e,n&&(t=t+":"+n.url),t}function Qc(t,e,n,r){var i=zc(e,n,r);return Gc[i]||(Gc[i]=new Oc(t,e,n,r)),Gc[i]}function Yc(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function Xc(t){t.g||(t.g=!0,Zc(t,!1,null,null))}function $c(t){t.g&&!t.i&&Zc(t,!1,null,null)}function Jc(t,e){if(t.b=function(){return Pe(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function Zc(t,e,n,r){e?r?function(t,e){if(t.b=function(){return xe(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,r):Jc(t,n):Jc(t,{user:null}),t.f=[],t.c=[]}function tl(){}function el(){this.jb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.jb},set:function(t){this.jb=t},enumerable:!1})}function nl(t,e){this.a=e,Zr(this,"verificationId",t)}function rl(t,e,n,r){return new qo(t).gb(e,n).then((function(t){return new nl(t,r)}))}function il(t){var e=Qi(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new k("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");ti(this,{token:t,expirationTime:zr(1e3*e.exp),authTime:zr(1e3*e.auth_time),issuedAtTime:zr(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,signInSecondFactor:e.firebase&&e.firebase.sign_in_second_factor?e.firebase.sign_in_second_factor:null,claims:e})}function ol(t,e,n){var r=e&&e[sl];if(!r)throw new k("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=t,this.f=gt(e),this.g=n,this.c=new co(null,r),this.b=[];var i=this;H(e[al]||[],(function(t){(t=ii(t))&&i.b.push(t)})),Zr(this,"auth",this.a),Zr(this,"session",this.c),Zr(this,"hints",this.b)}Yc.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Yc.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,r=t.b,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?t.a?(Zc(this,!0,null,t.a),Pe()):e.Fa(n,r)?function(t,e,n){n=n.Fa(e.c,e.b);var r=e.g,i=e.f,o=e.i,a=e.T(),s=!!e.c.match(/Redirect$/);n(r,i,a,o).then((function(e){Zc(t,s,e,null)})).o((function(e){Zc(t,s,null,e)}))}(this,t,e):xe(new k("invalid-auth-event")):(Zc(this,!1,null,null),Pe())}else xe(new k("invalid-auth-event"))},Yc.prototype.ra=function(){var t=this;return new Te((function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),function(t){var e=new k("timeout");t.a&&t.a.cancel(),t.a=Nn(Vc.get()).then((function(){t.b||(t.g=!0,Zc(t,!0,null,e))}))}(t))}))},tl.prototype.h=function(t,e){if(t){var n=t.c,r=t.b;t.a?(e.na(t.c,null,t.a,t.b),Pe()):e.Fa(n,r)?function(t,e){var n=t.b,r=t.c;e.Fa(r,n)(t.g,t.f,t.T(),t.i).then((function(t){e.na(r,t,null,n)})).o((function(t){e.na(r,null,t,n)}))}(t,e):xe(new k("invalid-auth-event"))}else xe(new k("invalid-auth-event"))},nl.prototype.confirm=function(t){return t=Vo(this.verificationId,t),this.a(t)};var al="mfaInfo",sl="mfaPendingCredential";function ul(t,e,n,r){k.call(this,"multi-factor-auth-required",r,e),this.b=new ol(t,e,n),Zr(this,"resolver",this.b)}function cl(t,e,n){if(t&&g(t.serverResponse)&&"auth/multi-factor-auth-required"===t.code)try{return new ul(e,t.serverResponse,n,t.message)}catch(t){}return null}function ll(){}function hl(t){Zr(this,"factorId",t.fa),this.a=t}function fl(t){if(hl.call(this,t),this.a.fa!=qo.PROVIDER_ID)throw new k("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function dl(t,e){for(var n in Ze.call(this,t),e)this[n]=e[n]}function pl(t,e){this.a=t,this.b=[],this.c=I(this.yc,this),fn(this.a,"userReloaded",this.c);var n=[];e&&e.multiFactor&&e.multiFactor.enrolledFactors&&H(e.multiFactor.enrolledFactors,(function(t){var e=null,r={};if(t){t.uid&&(r[si]=t.uid),t.displayName&&(r[oi]=t.displayName),t.enrollmentTime&&(r[ai]=new Date(t.enrollmentTime).toISOString()),t.phoneNumber&&(r[ui]=t.phoneNumber);try{e=new ci(r)}catch(t){}t=e}else t=null;t&&n.push(t)})),vl(this,n)}function vl(t,e){t.b=e,Zr(t,"enrolledFactors",e)}function gl(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function yl(t,e){t.stop(),t.b=Nn(function(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}(t,e)).then((function(){return function(){var t=s.document,e=null;return Gr()||!t?Pe():new Te((function(n){e=function(){Gr()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)})).o((function(n){throw t.removeEventListener("visibilitychange",e,!1),n}))}()})).then((function(){return t.h()})).then((function(){yl(t,!0)})).o((function(e){t.i(e)&&yl(t,!1)}))}function ml(t){this.f=t,this.b=this.a=null,this.c=Date.now()}function _l(t,e){void 0===e&&(t.b?e=(e=t.b).a-e.g:e=0),t.c=Date.now()+1e3*e}function bl(t,e){t.b=zi(e[ns]||""),t.a=e.refreshToken,_l(t,void 0!==(e=e.expiresIn)?Number(e):void 0)}function wl(t,e){return function(t,e){return new Te((function(n,r){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?hs(t,t.l+"?key="+encodeURIComponent(t.c),(function(t){t?t.error?r(cu(t)):t.access_token&&t.refresh_token?n(t):r(new k("internal-error")):r(new k("network-request-failed"))}),"POST",tr(e).toString(),t.g,t.m.get()):r(new k("internal-error"))}))}(t.f,e).then((function(e){return t.b=zi(e.access_token),t.a=e.refresh_token,_l(t,e.expires_in),{accessToken:t.b.toString(),refreshToken:t.a}})).o((function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e}))}function Il(t,e){this.a=t||null,this.b=e||null,ti(this,{lastSignInTime:zr(e||null),creationTime:zr(t||null)})}function Tl(t,e,n,r,i,o){ti(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function El(t,e,n){this.N=[],this.l=t.apiKey,this.m=t.appName,this.s=t.authDomain||null;var r=u.default.SDK_VERSION?xr(u.default.SDK_VERSION):null;this.a=new ts(this.l,D(N),r),(this.u=t.emulatorConfig||null)&&us(this.a,this.u),this.h=new ml(this.a),Dl(this,e[ns]),bl(this.h,e),Zr(this,"refreshToken",this.h.a),Ml(this,n||{}),En.call(this),this.P=!1,this.s&&Lr()&&(this.b=Qc(this.s,this.l,this.m,this.u)),this.W=[],this.i=null,this.D=function(t){return new gl((function(){return t.I(!0)}),(function(t){return!(!t||"auth/network-request-failed"!=t.code)}),(function(){var e=t.h.c-Date.now()-3e5;return 0<e?e:0}))}(this),this.ba=I(this.ib,this);var i=this;this.za=null,this.Pa=function(t){i.xa(t.h)},this.qa=null,this.Ba=function(t){Sl(i,t.c)},this.$=null,this.aa=[],this.Oa=function(t){Al(i,t.f)},this.ja=null,this.S=new pl(this,n),Zr(this,"multiFactor",this.S)}function Sl(t,e){t.u=e,us(t.a,e),t.b&&(e=t.b,t.b=Qc(t.s,t.l,t.m,t.u),t.P&&(jc(e,t),Uc(t.b,t)))}function Cl(t,e){t.qa&&vn(t.qa,"languageCodeChanged",t.Pa),(t.qa=e)&&fn(e,"languageCodeChanged",t.Pa)}function kl(t,e){t.$&&vn(t.$,"emulatorConfigChanged",t.Ba),(t.$=e)&&fn(e,"emulatorConfigChanged",t.Ba)}function Al(t,e){t.aa=e,ls(t.a,u.default.SDK_VERSION?xr(u.default.SDK_VERSION,t.aa):null)}function Nl(t,e){t.ja&&vn(t.ja,"frameworkChanged",t.Oa),(t.ja=e)&&fn(e,"frameworkChanged",t.Oa)}function Pl(t){try{return u.default.app(t.m).auth()}catch(e){throw new k("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.m+"'!")}}function xl(t){t.J||t.D.b||(t.D.start(),vn(t,"tokenChanged",t.ba),fn(t,"tokenChanged",t.ba))}function Rl(t){vn(t,"tokenChanged",t.ba),t.D.stop()}function Dl(t,e){t.Aa=e,Zr(t,"_lat",e)}function Ol(t){for(var e=[],n=0;n<t.W.length;n++)e.push(t.W[n](t));return De(e).then((function(){return t}))}function Ll(t){t.b&&!t.P&&(t.P=!0,Uc(t.b,t))}function Ml(t,e){ti(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,tenantId:e.tenantId||null,metadata:new Il(e.createdAt,e.lastLoginAt),providerData:[]}),t.a.b=t.tenantId}function Fl(){}function Ul(t){return Pe().then((function(){if(t.J)throw new k("app-deleted")}))}function jl(t){return z(t.providerData,(function(t){return t.providerId}))}function ql(t,e){e&&(Vl(t,e.providerId),t.providerData.push(e))}function Vl(t,e){$(t.providerData,(function(t){return t.providerId==e}))}function Bl(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&Zr(t,e,n)}function Kl(t,e){t!=e&&(ti(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,tenantId:e.tenantId,providerData:[]}),e.metadata?Zr(t,"metadata",function(t){return new Il(t.a,t.b)}(e.metadata)):Zr(t,"metadata",new Il),H(e.providerData,(function(e){ql(t,e)})),function(t,e){t.b=e.b,t.a=e.a,t.c=e.c}(t.h,e.h),Zr(t,"refreshToken",t.h.a),vl(t.S,e.S.b))}function Wl(t){return t.I().then((function(e){var n=t.isAnonymous;return function(t,e){return su(t.a,Us,{idToken:e}).then(I(t.Kc,t))}(t,e).then((function(){return n||Bl(t,"isAnonymous",!1),e}))}))}function Hl(t,e){e[ns]&&t.Aa!=e[ns]&&(bl(t.h,e),t.dispatchEvent(new dl("tokenChanged")),Dl(t,e[ns]),Bl(t,"refreshToken",t.h.a))}function Gl(t,e){return Wl(t).then((function(){if(Y(jl(t),e))return Ol(t).then((function(){throw new k("provider-already-linked")}))}))}function zl(t,e,n){return ei({user:t,credential:Bo(e),additionalUserInfo:e=Zi(e),operationType:n})}function Ql(t,e){return Hl(t,e),t.reload().then((function(){return t}))}function Yl(t,e,n,r,i){if(!Lr())return xe(new k("operation-not-supported-in-this-environment"));if(t.i&&!i)return xe(t.i);var o=Ji(n.providerId),a=Br(t.uid+":::"),s=null;(!Ur()||Tr())&&t.s&&n.isOAuthProvider&&(s=Iu(t.s,t.l,t.m,e,n,null,a,u.default.SDK_VERSION||null,null,null,t.tenantId,t.u));var c=mr(s,o&&o.va,o&&o.ua);return r=r().then((function(){if($l(t),!i)return t.I().then((function(){}))})).then((function(){return Bc(t.b,c,e,n,a,!!s,t.tenantId)})).then((function(){return new Te((function(n,r){t.na(e,null,new k("cancelled-popup-request"),t.g||null),t.f=n,t.C=r,t.g=a,t.c=Hc(t.b,t,e,c,a)}))})).then((function(t){return c&&yr(c),t?ei(t):null})).o((function(t){throw c&&yr(c),t})),Jl(t,r,i)}function Xl(t,e,n,r,i){if(!Lr())return xe(new k("operation-not-supported-in-this-environment"));if(t.i&&!i)return xe(t.i);var o=null,a=Br(t.uid+":::");return r=r().then((function(){if($l(t),!i)return t.I().then((function(){}))})).then((function(){return t.ga=a,Ol(t)})).then((function(e){return t.ha&&(e=(e=t.ha).b.set(eh,t.w(),e.a)),e})).then((function(){return Wc(t.b,e,n,a,t.tenantId)})).o((function(e){if(o=e,t.ha)return nh(t.ha);throw o})).then((function(){if(o)throw o})),Jl(t,r,i)}function $l(t){if(!t.b||!t.P){if(t.b&&!t.P)throw new k("internal-error");throw new k("auth-domain-config-required")}}function Jl(t,e,n){var r=function(t,e,n){return t.i&&!n?(e.cancel(),xe(t.i)):e.o((function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.i||t.dispatchEvent(new dl("userInvalidated")),t.i=e),e}))}(t,e,n);return t.N.push(r),r.oa((function(){X(t.N,r)})),r.o((function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=cl(e.w(),Pl(t),I(t.jc,t))),n||e}))}function Zl(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName,emulatorConfig:t.emulatorConfig},n={};if(!t.stsTokenManager||!t.stsTokenManager.accessToken)return null;n[ns]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null;var r=t.stsTokenManager.expirationTime;r&&(n.expiresIn=(r-Date.now())/1e3);var i=new El(e,n,t);return t.providerData&&H(t.providerData,(function(t){t&&ql(i,ei(t))})),t.redirectEventId&&(i.ga=t.redirectEventId),i}function th(t){this.a=t,this.b=oc()}ol.prototype.Rc=function(t){var e=this;return t.tb(this.a.a,this.c).then((function(t){var n=gt(e.f);return delete n[al],delete n[sl],mt(n,t),e.g(n)}))},S(ul,k),ll.prototype.tb=function(t,e,n){return e.type==lo?function(t,e,n,r){return n.Ha().then((function(n){return n={idToken:n},void 0!==r&&(n.displayName=r),mt(n,{phoneVerificationInfo:jo(t.a)}),su(e,Ms,n)}))}(this,t,e,n):function(t,e,n){return n.Ha().then((function(n){return mt(n={mfaPendingCredential:n},{phoneVerificationInfo:jo(t.a)}),su(e,Fs,n)}))}(this,t,e)},S(hl,ll),S(fl,hl),S(dl,Ze),(t=pl.prototype).yc=function(t){vl(this,function(t){var e=[];return H(t.mfaInfo||[],(function(t){(t=ii(t))&&e.push(t)})),e}(t.hd))},t.Sb=function(){return this.a.I().then((function(t){return new co(t,null)}))},t.fc=function(t,e){var n=this,r=this.a.a;return this.Sb().then((function(n){return t.tb(r,n,e)})).then((function(t){return Hl(n.a,t),n.a.reload()}))},t.bd=function(t){var e=this,n="string"==typeof t?t:t.uid,r=this.a.a;return this.a.I().then((function(t){return su(r,au,{idToken:t,mfaEnrollmentId:n})})).then((function(t){var r=G(e.b,(function(t){return t.uid!=n}));return vl(e,r),Hl(e.a,t),e.a.reload().o((function(t){if("auth/user-token-expired"!=t.code)throw t}))}))},t.w=function(){return{multiFactor:{enrolledFactors:z(this.b,(function(t){return t.w()}))}}},gl.prototype.start=function(){this.a=this.c,yl(this,!0)},gl.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},ml.prototype.w=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:this.c}},ml.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?xe(new k("user-token-expired")):t||!this.b||Date.now()>this.c-3e4?this.a?wl(this,{grant_type:"refresh_token",refresh_token:this.a}):Pe(null):Pe({accessToken:this.b.toString(),refreshToken:this.a})},Il.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},S(El,En),El.prototype.xa=function(t){this.za=t,ss(this.a,t)},El.prototype.la=function(){return this.za},El.prototype.Ga=function(){return Z(this.aa)},El.prototype.ib=function(){this.D.b&&(this.D.stop(),this.D.start())},Zr(El.prototype,"providerId","firebase"),(t=El.prototype).reload=function(){var t=this;return Jl(this,Ul(this).then((function(){return Wl(t).then((function(){return Ol(t)})).then(Fl)})))},t.oc=function(t){return this.I(t).then((function(t){return new il(t)}))},t.I=function(t){var e=this;return Jl(this,Ul(this).then((function(){return e.h.getToken(t)})).then((function(t){if(!t)throw new k("internal-error");return t.accessToken!=e.Aa&&(Dl(e,t.accessToken),e.dispatchEvent(new dl("tokenChanged"))),Bl(e,"refreshToken",t.refreshToken),t.accessToken})))},t.Kc=function(t){if(!(t=t.users)||!t.length)throw new k("internal-error");Ml(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt,tenantId:t.tenantId});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?z(t,(function(t){return new Tl(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)})):[]}(t),n=0;n<e.length;n++)ql(this,e[n]);Bl(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length)),this.dispatchEvent(new dl("userReloaded",{hd:t}))},t.Lc=function(t){return $r("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.ub(t)},t.ub=function(t){var e=this,n=null;return Jl(this,t.c(this.a,this.uid).then((function(t){return Hl(e,t),n=zl(e,t,"reauthenticate"),e.i=null,e.reload()})).then((function(){return n})),!0)},t.Cc=function(t){return $r("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.rb(t)},t.rb=function(t){var e=this,n=null;return Jl(this,Gl(this,t.providerId).then((function(){return e.I()})).then((function(n){return t.b(e.a,n)})).then((function(t){return n=zl(e,t,"link"),Ql(e,t)})).then((function(){return n})))},t.Dc=function(t,e){var n=this;return Jl(this,Gl(this,"phone").then((function(){return rl(Pl(n),t,e,I(n.rb,n))})))},t.Mc=function(t,e){var n=this;return Jl(this,Pe().then((function(){return rl(Pl(n),t,e,I(n.ub,n))})),!0)},t.Cb=function(t){var e=this;return Jl(this,this.I().then((function(n){return e.a.Cb(n,t)})).then((function(t){return Hl(e,t),e.reload()})))},t.ed=function(t){var e=this;return Jl(this,this.I().then((function(n){return t.b(e.a,n)})).then((function(t){return Hl(e,t),e.reload()})))},t.Db=function(t){var e=this;return Jl(this,this.I().then((function(n){return e.a.Db(n,t)})).then((function(t){return Hl(e,t),e.reload()})))},t.Eb=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return Ul(this);var e=this;return Jl(this,this.I().then((function(n){return e.a.Eb(n,{displayName:t.displayName,photoUrl:t.photoURL})})).then((function(t){return Hl(e,t),Bl(e,"displayName",t.displayName||null),Bl(e,"photoURL",t.photoUrl||null),H(e.providerData,(function(t){"password"===t.providerId&&(Zr(t,"displayName",e.displayName),Zr(t,"photoURL",e.photoURL))})),Ol(e)})).then(Fl))},t.cd=function(t){var e=this;return Jl(this,Wl(this).then((function(n){return Y(jl(e),t)?function(t,e,n){return su(t,Ds,{idToken:e,deleteProvider:n})}(e.a,n,[t]).then((function(t){var n={};return H(t.providerUserInfo||[],(function(t){n[t.providerId]=!0})),H(jl(e),(function(t){n[t]||Vl(e,t)})),n[qo.PROVIDER_ID]||Zr(e,"phoneNumber",null),Ol(e)})):Ol(e).then((function(){throw new k("no-such-provider")}))})))},t.delete=function(){var t=this;return Jl(this,this.I().then((function(e){return su(t.a,Rs,{idToken:e})})).then((function(){t.dispatchEvent(new dl("userDeleted"))}))).then((function(){for(var e=0;e<t.N.length;e++)t.N[e].cancel("app-deleted");Cl(t,null),kl(t,null),Nl(t,null),t.N=[],t.J=!0,Rl(t),Zr(t,"refreshToken",null),t.b&&jc(t.b,t)}))},t.Gb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.ga||null)==e||"reauthViaRedirect"==t&&(this.ga||null)==e)},t.na=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.g||null)||(n&&this.C?this.C(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},t.Fa=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?I(this.Lb,this):"reauthViaPopup"==t&&e==(this.g||null)?I(this.Mb,this):"linkViaRedirect"==t&&(this.ga||null)==e?I(this.Lb,this):"reauthViaRedirect"==t&&(this.ga||null)==e?I(this.Mb,this):null},t.Ec=function(t){var e=this;return Yl(this,"linkViaPopup",t,(function(){return Gl(e,t.providerId).then((function(){return Ol(e)}))}),!1)},t.Nc=function(t){return Yl(this,"reauthViaPopup",t,(function(){return Pe()}),!0)},t.Fc=function(t){var e=this;return Xl(this,"linkViaRedirect",t,(function(){return Gl(e,t.providerId)}),!1)},t.Oc=function(t){return Xl(this,"reauthViaRedirect",t,(function(){return Pe()}),!0)},t.Lb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Jl(this,this.I().then((function(n){return Ss(i.a,{requestUri:t,postBody:r,sessionId:e,idToken:n})})).then((function(t){return o=zl(i,t,"link"),Ql(i,t)})).then((function(){return o})))},t.Mb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Jl(this,Pe().then((function(){return po(Cs(i.a,{requestUri:t,sessionId:e,postBody:r,tenantId:n}),i.uid)})).then((function(t){return o=zl(i,t,"reauthenticate"),Hl(i,t),i.i=null,i.reload()})).then((function(){return o})),!0)},t.vb=function(t){var e=this,n=null;return Jl(this,this.I().then((function(e){return n=e,void 0===t||vt(t)?{}:Ki(new Di(t))})).then((function(t){return e.a.vb(n,t)})).then((function(t){if(e.email!=t)return e.reload()})).then((function(){})))},t.Fb=function(t,e){var n=this,r=null;return Jl(this,this.I().then((function(t){return r=t,void 0===e||vt(e)?{}:Ki(new Di(e))})).then((function(e){return n.a.Fb(r,t,e)})).then((function(t){if(n.email!=t)return n.reload()})).then((function(){})))},t.jc=function(t){var e=null,n=this;return Jl(this,t=po(Pe(t),n.uid).then((function(t){return e=zl(n,t,"reauthenticate"),Hl(n,t),n.i=null,n.reload()})).then((function(){return e})),!0)},t.toJSON=function(){return this.w()},t.w=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.s,stsTokenManager:this.h.w(),redirectEventId:this.ga||null};return this.metadata&&mt(t,this.metadata.w()),H(this.providerData,(function(e){t.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(e))})),mt(t,this.S.w()),t};var eh={name:"redirectUser",F:"session"};function nh(t){return uc(t.b,eh,t.a)}function rh(t){this.a=t,this.b=oc(),this.c=null,this.f=function(t){var e=ah("local"),n=ah("session"),r=ah("none");return function(t,e,n){var r=sc(e,n),i=ac(t,e.F);return t.get(e,n).then((function(o){var a=null;try{a=Vr(s.localStorage.getItem(r))}catch(t){}if(a&&!o)return s.localStorage.removeItem(r),t.set(e,a,n);a&&o&&"localStorage"!=i.type&&s.localStorage.removeItem(r)}))}(t.b,e,t.a).then((function(){return t.b.get(n,t.a)})).then((function(i){return i?n:t.b.get(r,t.a).then((function(n){return n?r:t.b.get(e,t.a).then((function(n){return n?e:t.b.get(oh,t.a).then((function(t){return t?ah(t):e}))}))}))})).then((function(e){return t.c=e,ih(t,e.F)})).o((function(){t.c||(t.c=e)}))}(this),this.b.addListener(ah("local"),this.a,I(this.g,this))}function ih(t,e){var n,r=[];for(n in rc)rc[n]!==e&&r.push(uc(t.b,ah(rc[n]),t.a));return r.push(uc(t.b,oh,t.a)),function(t){return new Te((function(e,n){var r=t.length,i=[];if(r)for(var o=function(t,n){r--,i[t]=n,0==r&&e(i)},a=function(t){n(t)},s=0;s<t.length;s++)Re(t[s],T(o,s),a);else e(i)}))}(r)}rh.prototype.g=function(){var t=this,e=ah("local");lh(this,(function(){return Pe().then((function(){return t.c&&"local"!=t.c.F?t.b.get(e,t.a):null})).then((function(n){if(n)return ih(t,"local").then((function(){t.c=e}))}))}))};var oh={name:"persistence",F:"session"};function ah(t){return{name:"authUser",F:t}}function sh(t,e){return lh(t,(function(){return t.b.set(t.c,e.w(),t.a)}))}function uh(t){return lh(t,(function(){return uc(t.b,t.c,t.a)}))}function ch(t,e,n){return lh(t,(function(){return t.b.get(t.c,t.a).then((function(t){return t&&e&&(t.authDomain=e),t&&n&&(t.emulatorConfig=n),Zl(t||{})}))}))}function lh(t,e){return t.f=t.f.then(e,e),t.f}function hh(t){if(this.l=!1,Zr(this,"settings",new el),Zr(this,"app",t),!bh(this).options||!bh(this).options.apiKey)throw new k("invalid-api-key");t=u.default.SDK_VERSION?xr(u.default.SDK_VERSION):null,this.a=new ts(bh(this).options&&bh(this).options.apiKey,D(N),t),this.P=[],this.s=[],this.N=[],this.Pa=u.default.INTERNAL.createSubscribe(I(this.zc,this)),this.W=void 0,this.ib=u.default.INTERNAL.createSubscribe(I(this.Ac,this)),mh(this,null),this.i=new rh(bh(this).options.apiKey+":"+bh(this).name),this.D=new th(bh(this).options.apiKey+":"+bh(this).name),this.$=Eh(this,function(t){var e=bh(t).options.authDomain,n=function(t){var e=function(t,e){return t.b.get(eh,t.a).then((function(t){return t&&e&&(t.authDomain=e),Zl(t||{})}))}(t.D,bh(t).options.authDomain).then((function(e){return(t.m=e)&&(e.ha=t.D),nh(t.D)}));return Eh(t,e)}(t).then((function(){return ch(t.i,e,t.R)})).then((function(e){return e?(e.ha=t.D,t.m&&(t.m.ga||null)==(e.ga||null)?e:e.reload().then((function(){return sh(t.i,e).then((function(){return e}))})).o((function(n){return"auth/network-request-failed"==n.code?e:uh(t.i)}))):null})).then((function(e){mh(t,e||null)}));return Eh(t,n)}(this)),this.h=Eh(this,function(t){return t.$.then((function(){return gh(t)})).o((function(){})).then((function(){if(!t.l)return t.ja()})).o((function(){})).then((function(){if(!t.l){t.ba=!0;var e=t.i;e.b.addListener(ah("local"),e.a,t.ja)}}))}(this)),this.ba=!1,this.ja=I(this.Zc,this),this.Ba=I(this.da,this),this.qa=I(this.mc,this),this.za=I(this.wc,this),this.Aa=I(this.xc,this),this.b=null,function(t){var e=bh(t).options.authDomain,n=bh(t).options.apiKey;e&&Lr()&&(t.Oa=t.$.then((function(){if(!t.l){if(t.b=Qc(e,n,bh(t).name,t.R),Uc(t.b,t),wh(t)&&Ll(wh(t)),t.m){Ll(t.m);var r=t.m;r.xa(t.la()),Cl(r,t),Al(r=t.m,t.J),Nl(r,t),Sl(r=t.m,t.R),kl(r,t),t.m=null}return t.b}})))}(this),this.INTERNAL={},this.INTERNAL.delete=I(this.delete,this),this.INTERNAL.logFramework=I(this.Gc,this),this.u=0,En.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.la()},set:function(t){this.xa(t)},enumerable:!1}),t.aa=null,Object.defineProperty(t,"ti",{get:function(){return this.T()},set:function(t){this.zb(t)},enumerable:!1}),t.S=null,Object.defineProperty(t,"emulatorConfig",{get:function(){if(this.R){var t=Bn(this.R.url);t=ei({protocol:t.c,host:t.a,port:t.g,options:ei({disableWarnings:this.R.ec})})}else t=null;return t},enumerable:!1})}(this),this.J=[],this.R=null}function fh(t){Ze.call(this,"languageCodeChanged"),this.h=t}function dh(t){Ze.call(this,"emulatorConfigChanged"),this.c=t}function ph(t){Ze.call(this,"frameworkChanged"),this.f=t}function vh(t){return t.Oa||xe(new k("auth-domain-config-required"))}function gh(t){if(!Lr())return xe(new k("operation-not-supported-in-this-environment"));var e=vh(t).then((function(){return t.b.ra()})).then((function(t){return t?ei(t):null}));return Eh(t,e)}function yh(t,e){var n={};return n.apiKey=bh(t).options.apiKey,n.authDomain=bh(t).options.authDomain,n.appName=bh(t).name,t.R&&(n.emulatorConfig=t.R),t.$.then((function(){return function(t,e,n,r){var i=new El(t,e);return n&&(i.ha=n),r&&Al(i,r),i.reload().then((function(){return i}))}(n,e,t.D,t.Ga())})).then((function(e){return wh(t)&&e.uid==wh(t).uid?(Kl(wh(t),e),t.da(e)):(mh(t,e),Ll(e),t.da(e))})).then((function(){Th(t)}))}function mh(t,e){wh(t)&&(function(t,e){$(t.W,(function(t){return t==e}))}(wh(t),t.Ba),vn(wh(t),"tokenChanged",t.qa),vn(wh(t),"userDeleted",t.za),vn(wh(t),"userInvalidated",t.Aa),Rl(wh(t))),e&&(e.W.push(t.Ba),fn(e,"tokenChanged",t.qa),fn(e,"userDeleted",t.za),fn(e,"userInvalidated",t.Aa),0<t.u&&xl(e)),Zr(t,"currentUser",e),e&&(e.xa(t.la()),Cl(e,t),Al(e,t.J),Nl(e,t),Sl(e,t.R),kl(e,t))}function _h(t,e){var n=null,r=null;return Eh(t,e.then((function(e){return n=Bo(e),r=Zi(e),yh(t,e)}),(function(e){var n=null;throw e&&"auth/multi-factor-auth-required"===e.code&&(n=cl(e.w(),t,I(t.kc,t))),n||e})).then((function(){return ei({user:wh(t),credential:n,additionalUserInfo:r,operationType:"signIn"})})))}function bh(t){return t.app}function wh(t){return t.currentUser}function Ih(t){return wh(t)&&wh(t)._lat||null}function Th(t){if(t.ba){for(var e=0;e<t.s.length;e++)t.s[e]&&t.s[e](Ih(t));if(t.W!==t.getUid()&&t.N.length)for(t.W=t.getUid(),e=0;e<t.N.length;e++)t.N[e]&&t.N[e](Ih(t))}}function Eh(t,e){return t.P.push(e),e.oa((function(){X(t.P,e)})),e}function Sh(){}function Ch(){this.a={},this.b=1e12}rh.prototype.yb=function(t){var e=null,n=this;return function(t){var e=new k("invalid-persistence-type"),n=new k("unsupported-persistence-type");t:{for(r in rc)if(rc[r]==t){var r=!0;break t}r=!1}if(!r||"string"!=typeof t)throw e;switch(Sr()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;case"Worker":if("session"===t||!Mu()&&"none"!==t)throw n;break;default:if(!Or()&&"none"!==t)throw n}}(t),lh(this,(function(){return t!=n.c.F?n.b.get(n.c,n.a).then((function(r){return e=r,ih(n,t)})).then((function(){if(n.c=ah(t),e)return n.b.set(n.c,e,n.a)})):Pe()}))},S(hh,En),S(fh,Ze),S(dh,Ze),S(ph,Ze),(t=hh.prototype).yb=function(t){return Eh(this,t=this.i.yb(t))},t.xa=function(t){this.aa===t||this.l||(this.aa=t,ss(this.a,this.aa),this.dispatchEvent(new fh(this.la())))},t.la=function(){return this.aa},t.fd=function(){var t=s.navigator;this.xa(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},t.gd=function(t,e){if(!this.R){if(!/^https?:\/\//.test(t))throw new k("argument-error","Emulator URL must start with a valid scheme (http:// or https://).");(function(t){"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),s.document&&!t&&wr().then((function(){var t=s.document.createElement("div");t.innerText="Running in emulator mode. Do not use with production credentials.",t.style.position="fixed",t.style.width="100%",t.style.backgroundColor="#ffffff",t.style.border=".1em solid #000000",t.style.color="#b50000",t.style.bottom="0px",t.style.left="0px",t.style.margin="0px",t.style.zIndex=1e4,t.style.textAlign="center",t.classList.add("firebase-emulator-warning"),s.document.body.appendChild(t)}))})(e=!!e&&!!e.disableWarnings),this.R={url:t,ec:e},this.settings.jb=!0,us(this.a,this.R),this.dispatchEvent(new dh(this.R))}},t.Gc=function(t){this.J.push(t),ls(this.a,u.default.SDK_VERSION?xr(u.default.SDK_VERSION,this.J):null),this.dispatchEvent(new ph(this.J))},t.Ga=function(){return Z(this.J)},t.zb=function(t){this.S===t||this.l||(this.S=t,this.a.b=this.S)},t.T=function(){return this.S},t.toJSON=function(){return{apiKey:bh(this).options.apiKey,authDomain:bh(this).options.authDomain,appName:bh(this).name,currentUser:wh(this)&&wh(this).w()}},t.Gb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},t.na=function(t,e,n,r){"signInViaPopup"==t&&this.g==r&&(n&&this.C?this.C(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},t.Fa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?I(this.ic,this):null},t.ic=function(t,e,n,r){var i=this,o={requestUri:t,postBody:r,sessionId:e,tenantId:n};return this.c&&(this.c.cancel(),this.c=null),i.$.then((function(){return _h(i,Es(i.a,o))}))},t.Xc=function(t){if(!Lr())return xe(new k("operation-not-supported-in-this-environment"));var e=this,n=Ji(t.providerId),r=Br(),i=null;(!Ur()||Tr())&&bh(this).options.authDomain&&t.isOAuthProvider&&(i=Iu(bh(this).options.authDomain,bh(this).options.apiKey,bh(this).name,"signInViaPopup",t,null,r,u.default.SDK_VERSION||null,null,null,this.T(),this.R));var o=mr(i,n&&n.va,n&&n.ua);return Eh(this,n=vh(this).then((function(n){return Bc(n,o,"signInViaPopup",t,r,!!i,e.T())})).then((function(){return new Te((function(t,n){e.na("signInViaPopup",null,new k("cancelled-popup-request"),e.g),e.f=t,e.C=n,e.g=r,e.c=Hc(e.b,e,"signInViaPopup",o,r)}))})).then((function(t){return o&&yr(o),t?ei(t):null})).o((function(t){throw o&&yr(o),t})))},t.Yc=function(t){if(!Lr())return xe(new k("operation-not-supported-in-this-environment"));var e=this;return Eh(this,vh(this).then((function(){return function(t){return lh(t,(function(){return t.b.set(oh,t.c.F,t.a)}))}(e.i)})).then((function(){return Wc(e.b,"signInViaRedirect",t,void 0,e.T())})))},t.ra=function(){var t=this;return gh(this).then((function(e){return t.b&&$c(t.b.b),e})).o((function(e){throw t.b&&$c(t.b.b),e}))},t.dd=function(t){if(!t)return xe(new k("null-user"));if(this.S!=t.tenantId)return xe(new k("tenant-id-mismatch"));var e=this,n={};n.apiKey=bh(this).options.apiKey,n.authDomain=bh(this).options.authDomain,n.appName=bh(this).name;var r=function(t,e,n,r){var i=t.h,o={};return o[ns]=i.b&&i.b.toString(),o.refreshToken=i.a,e=new El(e||{apiKey:t.l,authDomain:t.s,appName:t.m},o),n&&(e.ha=n),r&&Al(e,r),Kl(e,t),e}(t,n,e.D,e.Ga());return Eh(this,this.h.then((function(){if(bh(e).options.apiKey!=t.l)return r.reload()})).then((function(){return wh(e)&&t.uid==wh(e).uid?(Kl(wh(e),t),e.da(t)):(mh(e,r),Ll(r),e.da(r))})).then((function(){Th(e)})))},t.Bb=function(){var t=this;return Eh(this,this.h.then((function(){return t.b&&$c(t.b.b),wh(t)?(mh(t,null),uh(t.i).then((function(){Th(t)}))):Pe()})))},t.Zc=function(){var t=this;return ch(this.i,bh(this).options.authDomain).then((function(e){if(!t.l){var n;if(n=wh(t)&&e){n=wh(t).uid;var r=e.uid;n=null!=n&&""!==n&&null!=r&&""!==r&&n==r}if(n)return Kl(wh(t),e),wh(t).I();(wh(t)||e)&&(mh(t,e),e&&(Ll(e),e.ha=t.D),t.b&&Uc(t.b,t),Th(t))}}))},t.da=function(t){return sh(this.i,t)},t.mc=function(){Th(this),this.da(wh(this))},t.wc=function(){this.Bb()},t.xc=function(){this.Bb()},t.kc=function(t){var e=this;return this.h.then((function(){return _h(e,Pe(t))}))},t.zc=function(t){var e=this;this.addAuthTokenListener((function(){t.next(wh(e))}))},t.Ac=function(t){var e=this;!function(t,e){t.N.push(e),Eh(t,t.h.then((function(){!t.l&&Y(t.N,e)&&t.W!==t.getUid()&&(t.W=t.getUid(),e(Ih(t)))})))}(this,(function(){t.next(wh(e))}))},t.Ic=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){"function"==typeof t?t(wh(r)):"function"==typeof t.next&&t.next(wh(r))})),this.Pa(t,e,n)},t.Hc=function(t,e,n){var r=this;return this.ba&&Promise.resolve().then((function(){r.W=r.getUid(),"function"==typeof t?t(wh(r)):"function"==typeof t.next&&t.next(wh(r))})),this.ib(t,e,n)},t.nc=function(t){var e=this;return Eh(this,this.h.then((function(){return wh(e)?wh(e).I(t).then((function(t){return{accessToken:t}})):null})))},t.Tc=function(t){var e=this;return this.h.then((function(){return _h(e,su(e.a,eu,{token:t}))})).then((function(t){var n=t.user;return Bl(n,"isAnonymous",!1),e.da(n),t}))},t.Uc=function(t,e){var n=this;return this.h.then((function(){return _h(n,su(n.a,nu,{email:t,password:e}))}))},t.dc=function(t,e){var n=this;return this.h.then((function(){return _h(n,su(n.a,Ps,{email:t,password:e}))}))},t.ab=function(t){var e=this;return this.h.then((function(){return _h(e,t.ka(e.a))}))},t.Sc=function(t){return $r("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.ab(t)},t.Ab=function(){var t=this;return this.h.then((function(){var e=wh(t);if(e&&e.isAnonymous){var n=ei({providerId:null,isNewUser:!1});return ei({user:e,credential:null,additionalUserInfo:n,operationType:"signIn"})}return _h(t,t.a.Ab()).then((function(e){var n=e.user;return Bl(n,"isAnonymous",!0),t.da(n),e}))}))},t.getUid=function(){return wh(this)&&wh(this).uid||null},t.cc=function(t){this.addAuthTokenListener(t),this.u++,0<this.u&&wh(this)&&xl(wh(this))},t.Pc=function(t){var e=this;H(this.s,(function(n){n==t&&e.u--})),0>this.u&&(this.u=0),0==this.u&&wh(this)&&Rl(wh(this)),this.removeAuthTokenListener(t)},t.addAuthTokenListener=function(t){var e=this;this.s.push(t),Eh(this,this.h.then((function(){e.l||Y(e.s,t)&&t(Ih(e))})))},t.removeAuthTokenListener=function(t){$(this.s,(function(e){return e==t}))},t.delete=function(){this.l=!0;for(var t=0;t<this.P.length;t++)this.P[t].cancel("app-deleted");return this.P=[],this.i&&(t=this.i).b.removeListener(ah("local"),t.a,this.ja),this.b&&(jc(this.b,this),$c(this.b.b)),Promise.resolve()},t.hc=function(t){return Eh(this,function(t,e){return su(t,xs,{identifier:e,continueUri:Mr()?dr():"http://localhost"}).then((function(t){return t.signinMethods||[]}))}(this.a,t))},t.Bc=function(t){return!!Mo(t)},t.xb=function(t,e){var n=this;return Eh(this,Pe().then((function(){var t=new Di(e);if(!t.c)throw new k("argument-error",Mi+" must be true when sending sign in link to email");return Ki(t)})).then((function(e){return n.a.xb(t,e)})).then((function(){})))},t.jd=function(t){return this.Sa(t).then((function(t){return t.data.email}))},t.ob=function(t,e){return Eh(this,this.a.ob(t,e).then((function(){})))},t.Sa=function(t){return Eh(this,this.a.Sa(t).then((function(t){return new li(t)})))},t.kb=function(t){return Eh(this,this.a.kb(t).then((function(){})))},t.wb=function(t,e){var n=this;return Eh(this,Pe().then((function(){return void 0===e||vt(e)?{}:Ki(new Di(e))})).then((function(e){return n.a.wb(t,e)})).then((function(){})))},t.Wc=function(t,e){return Eh(this,rl(this,t,e,I(this.ab,this)))},t.Vc=function(t,e){var n=this;return Eh(this,Pe().then((function(){var r=e||dr(),i=Lo(t,r);if(!(r=Mo(r)))throw new k("argument-error","Invalid email link!");if(r.tenantId!==n.T())throw new k("tenant-id-mismatch");return n.ab(i)})))},Sh.prototype.render=function(){},Sh.prototype.reset=function(){},Sh.prototype.getResponse=function(){},Sh.prototype.execute=function(){};var kh=null;function Ah(t,e){return(e=Nh(e))&&t.a[e]||null}function Nh(t){return(t=void 0===t?1e12:t)?t.toString():null}function Ph(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=he(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():fn(this.f,"click",this.i)}function xh(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function Rh(){}function Dh(){}Ch.prototype.render=function(t,e){return this.a[this.b.toString()]=new Ph(t,e),this.b++},Ch.prototype.reset=function(t){var e=Ah(this,t);t=Nh(t),e&&t&&(e.delete(),delete this.a[t])},Ch.prototype.getResponse=function(t){return(t=Ah(this,t))?t.getResponse():null},Ch.prototype.execute=function(t){(t=Ah(this,t))&&t.execute()},Ph.prototype.getResponse=function(){return xh(this),this.b},Ph.prototype.execute=function(){xh(this);var t=this;this.a||(this.a=setTimeout((function(){t.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var e=t.c.callback,n=t.c["expired-callback"];if(e)try{e(t.b)}catch(t){}t.a=setTimeout((function(){if(t.a=null,t.b=null,n)try{n()}catch(t){}t.h&&t.execute()}),6e4)}),500))},Ph.prototype.delete=function(){xh(this),this.g=!0,clearTimeout(this.a),this.a=null,vn(this.f,"click",this.i)},Zr(Rh,"FACTOR_ID","phone"),Dh.prototype.g=function(){return kh||(kh=new Ch),Pe(kh)},Dh.prototype.c=function(){};var Oh=null;function Lh(){this.b=s.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var Mh=new bt(Et,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),Fh=new Hr(3e4,6e4);Lh.prototype.g=function(t){var e=this;return new Te((function(n,r){var i=setTimeout((function(){r(new k("network-request-failed"))}),Fh.get());!s.grecaptcha||t!==e.f&&!e.b?(s[e.a]=function(){if(s.grecaptcha){e.f=t;var o=s.grecaptcha.render;s.grecaptcha.render=function(t,n){return t=o(t,n),e.b++,t},clearTimeout(i),n(s.grecaptcha)}else clearTimeout(i),r(new k("internal-error"));delete s[e.a]},Pe(za(At(Mh,{onload:e.a,hl:t||""}))).o((function(){clearTimeout(i),r(new k("internal-error","Unable to load external reCAPTCHA dependencies!"))}))):(clearTimeout(i),n(s.grecaptcha))}))},Lh.prototype.c=function(){this.b--};var Uh=null;function jh(t,e,n,r,i,o,a){if(Zr(this,"type","recaptcha"),this.c=this.f=null,this.J=!1,this.v=e,this.g=null,a?(Oh||(Oh=new Dh),a=Oh):(Uh||(Uh=new Lh),a=Uh),this.m=a,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[Bh])throw new k("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Kh],!s.document)throw new k("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!he(e)||!this.i&&he(e).hasChildNodes())throw new k("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.s=new ts(t,o||null,i||null),this.u=r||function(){return null};var u=this;this.l=[];var c=this.a[qh];this.a[qh]=function(t){if(Wh(u,t),"function"==typeof c)c(t);else if("string"==typeof c){var e=Dr(c,s);"function"==typeof e&&e(t)}};var l=this.a[Vh];this.a[Vh]=function(){if(Wh(u,null),"function"==typeof l)l();else if("string"==typeof l){var t=Dr(l,s);"function"==typeof t&&t()}}}var qh="callback",Vh="expired-callback",Bh="sitekey",Kh="size";function Wh(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(t){}}function Hh(t,e){return t.h.push(e),e.oa((function(){X(t.h,e)})),e}function Gh(t){if(t.J)throw new k("internal-error","RecaptchaVerifier instance has been destroyed.")}function zh(t,e,n){var r=!1;try{this.b=n||u.default.app()}catch(t){throw new k("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new k("invalid-api-key");n=this.b.options.apiKey;var i=this,o=null;try{o=this.b.auth().Ga()}catch(t){}try{r=this.b.auth().settings.appVerificationDisabledForTesting}catch(t){}o=u.default.SDK_VERSION?xr(u.default.SDK_VERSION,o):null,jh.call(this,n,t,e,(function(){try{var t=i.b.auth().la()}catch(e){t=null}return t}),o,D(N),r)}function Qh(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new k("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].M(n[i])&&!o){if(e=e[i],0>i||i>=Yh.length)throw new k("internal-error","Argument validator received an unsupported number of arguments.");n=Yh[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.K+".";break t}r=null}}if(r)throw new k("argument-error",t+" failed: "+r)}(t=jh.prototype).Ia=function(){var t=this;return this.f?this.f:this.f=Hh(this,Pe().then((function(){if(Mr()&&!Er())return wr();throw new k("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")})).then((function(){return t.m.g(t.u())})).then((function(e){return t.g=e,su(t.s,Ws,{})})).then((function(e){t.a[Bh]=e.recaptchaSiteKey})).o((function(e){throw t.f=null,e})))},t.render=function(){Gh(this);var t=this;return Hh(this,this.Ia().then((function(){if(null===t.c){var e=t.v;if(!t.i){var n=he(e);e=function(t,e,n){var r=arguments,i=document,o=String(r[0]),a=r[1];if(!le&&a&&(a.name||a.type)){if(o=["<",o],a.name&&o.push(' name="',Ht(a.name),'"'),a.type){o.push(' type="',Ht(a.type),'"');var s={};mt(s,a),delete s.type,a=s}o.push(">"),o=o.join("")}return o=ye(i,o),a&&("string"==typeof a?o.className=a:Array.isArray(a)?o.className=a.join(" "):fe(o,a)),2<r.length&&ge(i,o,r),o}("DIV"),n.appendChild(e)}t.c=t.g.render(e,t.a)}return t.c})))},t.verify=function(){Gh(this);var t=this;return Hh(this,this.render().then((function(e){return new Te((function(n){var r=t.g.getResponse(e);if(r)n(r);else{var i=function(e){e&&(function(t,e){$(t.l,(function(t){return t==e}))}(t,i),n(e))};t.l.push(i),t.i&&t.g.execute(t.c)}}))})))},t.reset=function(){Gh(this),null!==this.c&&this.g.reset(this.c)},t.clear=function(){Gh(this),this.J=!0,this.m.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=he(this.v);for(var e;e=t.firstChild;)t.removeChild(e)}},S(zh,jh);var Yh="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Xh(t,e){return{name:t||"",K:"a valid string",optional:!!e,M:function(t){return"string"==typeof t}}}function $h(t,e){return{name:t||"",K:"a boolean",optional:!!e,M:function(t){return"boolean"==typeof t}}}function Jh(t,e){return{name:t||"",K:"a valid object",optional:!!e,M:g}}function Zh(t,e){return{name:t||"",K:"a function",optional:!!e,M:function(t){return"function"==typeof t}}}function tf(t,e){return{name:t||"",K:"null",optional:!!e,M:function(t){return null===t}}}function ef(t){return{name:t?t+"Credential":"credential",K:t?"a valid "+t+" credential":"a valid credential",optional:!1,M:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.ka||!n)}}}function nf(t,e){return g(t)&&"string"==typeof t.type&&t.type===e&&"function"==typeof t.Ha}function rf(t){return g(t)&&"string"==typeof t.uid}function of(t,e,n,r){return{name:n||"",K:t.K+" or "+e.K,optional:!!r,M:function(n){return t.M(n)||e.M(n)}}}function af(t,e){for(var n in e){var r=e[n].name;t[r]=cf(r,t[n],e[n].j)}}function sf(t,e){for(var n in e){var r=e[n].name;r!==n&&Object.defineProperty(t,r,{get:T((function(t){return this[t]}),n),set:T((function(t,e,n,r){Qh(t,[n],[r],!0),this[e]=r}),r,n,e[n].lb),enumerable:!0})}}function uf(t,e,n,r){t[e]=cf(e,n,r)}function cf(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return Qh(o,n,t),e.apply(this,t)}if(!n)return e;var i,o=function(t){return(t=t.split("."))[t.length-1]}(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}af(hh.prototype,{kb:{name:"applyActionCode",j:[Xh("code")]},Sa:{name:"checkActionCode",j:[Xh("code")]},ob:{name:"confirmPasswordReset",j:[Xh("code"),Xh("newPassword")]},dc:{name:"createUserWithEmailAndPassword",j:[Xh("email"),Xh("password")]},hc:{name:"fetchSignInMethodsForEmail",j:[Xh("email")]},ra:{name:"getRedirectResult",j:[]},Bc:{name:"isSignInWithEmailLink",j:[Xh("emailLink")]},Hc:{name:"onAuthStateChanged",j:[of(Jh(),Zh(),"nextOrObserver"),Zh("opt_error",!0),Zh("opt_completed",!0)]},Ic:{name:"onIdTokenChanged",j:[of(Jh(),Zh(),"nextOrObserver"),Zh("opt_error",!0),Zh("opt_completed",!0)]},wb:{name:"sendPasswordResetEmail",j:[Xh("email"),of(Jh("opt_actionCodeSettings",!0),tf(null,!0),"opt_actionCodeSettings",!0)]},xb:{name:"sendSignInLinkToEmail",j:[Xh("email"),Jh("actionCodeSettings")]},yb:{name:"setPersistence",j:[Xh("persistence")]},Sc:{name:"signInAndRetrieveDataWithCredential",j:[ef()]},Ab:{name:"signInAnonymously",j:[]},ab:{name:"signInWithCredential",j:[ef()]},Tc:{name:"signInWithCustomToken",j:[Xh("token")]},Uc:{name:"signInWithEmailAndPassword",j:[Xh("email"),Xh("password")]},Vc:{name:"signInWithEmailLink",j:[Xh("email"),Xh("emailLink",!0)]},Wc:{name:"signInWithPhoneNumber",j:[Xh("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Xc:{name:"signInWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Yc:{name:"signInWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},dd:{name:"updateCurrentUser",j:[of({name:"user",K:"an instance of Firebase User",optional:!1,M:function(t){return!!(t&&t instanceof El)}},tf(),"user")]},Bb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Xh(null,!0)]},fd:{name:"useDeviceLanguage",j:[]},gd:{name:"useEmulator",j:[Xh("url"),Jh("options",!0)]},jd:{name:"verifyPasswordResetCode",j:[Xh("code")]}}),sf(hh.prototype,{lc:{name:"languageCode",lb:of(Xh(),tf(),"languageCode")},ti:{name:"tenantId",lb:of(Xh(),tf(),"tenantId")}}),hh.Persistence=rc,hh.Persistence.LOCAL="local",hh.Persistence.SESSION="session",hh.Persistence.NONE="none",af(El.prototype,{delete:{name:"delete",j:[]},oc:{name:"getIdTokenResult",j:[$h("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[$h("opt_forceRefresh",!0)]},Cc:{name:"linkAndRetrieveDataWithCredential",j:[ef()]},rb:{name:"linkWithCredential",j:[ef()]},Dc:{name:"linkWithPhoneNumber",j:[Xh("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Ec:{name:"linkWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Fc:{name:"linkWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Lc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[ef()]},ub:{name:"reauthenticateWithCredential",j:[ef()]},Mc:{name:"reauthenticateWithPhoneNumber",j:[Xh("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]},Nc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Oc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},vb:{name:"sendEmailVerification",j:[of(Jh("opt_actionCodeSettings",!0),tf(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Xh(null,!0)]},cd:{name:"unlink",j:[Xh("provider")]},Cb:{name:"updateEmail",j:[Xh("email")]},Db:{name:"updatePassword",j:[Xh("password")]},ed:{name:"updatePhoneNumber",j:[ef("phone")]},Eb:{name:"updateProfile",j:[Jh("profile")]},Fb:{name:"verifyBeforeUpdateEmail",j:[Xh("email"),of(Jh("opt_actionCodeSettings",!0),tf(null,!0),"opt_actionCodeSettings",!0)]}}),af(Ch.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),af(Sh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),af(Te.prototype,{oa:{name:"finally"},o:{name:"catch"},then:{name:"then"}}),sf(el.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",lb:$h("appVerificationDisabledForTesting")}}),af(nl.prototype,{confirm:{name:"confirm",j:[Xh("verificationCode")]}}),uf(fo,"fromJSON",(function(t){t="string"==typeof t?JSON.parse(t):t;for(var e,n=[bo,Do,Uo,yo],r=0;r<n.length;r++)if(e=n[r](t))return e;return null}),[of(Xh(),Jh(),"json")]),uf(Oo,"credential",(function(t,e){return new Ro(t,e)}),[Xh("email"),Xh("password")]),af(Ro.prototype,{w:{name:"toJSON",j:[Xh(null,!0)]}}),af(Eo.prototype,{Ca:{name:"addScope",j:[Xh("scope")]},Ka:{name:"setCustomParameters",j:[Jh("customOAuthParameters")]}}),uf(Eo,"credential",So,[of(Xh(),Jh(),"token")]),uf(Oo,"credentialWithLink",Lo,[Xh("email"),Xh("emailLink")]),af(Co.prototype,{Ca:{name:"addScope",j:[Xh("scope")]},Ka:{name:"setCustomParameters",j:[Jh("customOAuthParameters")]}}),uf(Co,"credential",ko,[of(Xh(),Jh(),"token")]),af(Ao.prototype,{Ca:{name:"addScope",j:[Xh("scope")]},Ka:{name:"setCustomParameters",j:[Jh("customOAuthParameters")]}}),uf(Ao,"credential",No,[of(Xh(),of(Jh(),tf()),"idToken"),of(Xh(),tf(),"accessToken",!0)]),af(Po.prototype,{Ka:{name:"setCustomParameters",j:[Jh("customOAuthParameters")]}}),uf(Po,"credential",xo,[of(Xh(),Jh(),"token"),Xh("secret",!0)]),af(To.prototype,{Ca:{name:"addScope",j:[Xh("scope")]},credential:{name:"credential",j:[of(Xh(),of(Jh(),tf()),"optionsOrIdToken"),of(Xh(),tf(),"accessToken",!0)]},Ka:{name:"setCustomParameters",j:[Jh("customOAuthParameters")]}}),af(mo.prototype,{w:{name:"toJSON",j:[Xh(null,!0)]}}),af(vo.prototype,{w:{name:"toJSON",j:[Xh(null,!0)]}}),uf(qo,"credential",Vo,[Xh("verificationId"),Xh("verificationCode")]),af(qo.prototype,{gb:{name:"verifyPhoneNumber",j:[of(Xh(),{name:"phoneInfoOptions",K:"valid phone info options",optional:!1,M:function(t){return!!t&&(t.session&&t.phoneNumber?nf(t.session,lo)&&"string"==typeof t.phoneNumber:t.session&&t.multiFactorHint?nf(t.session,ho)&&rf(t.multiFactorHint):t.session&&t.multiFactorUid?nf(t.session,ho)&&"string"==typeof t.multiFactorUid:!!t.phoneNumber&&"string"==typeof t.phoneNumber)}},"phoneInfoOptions"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(t){return!(!t||"string"!=typeof t.type||"function"!=typeof t.verify)}}]}}),af(Fo.prototype,{w:{name:"toJSON",j:[Xh(null,!0)]}}),af(k.prototype,{toJSON:{name:"toJSON",j:[Xh(null,!0)]}}),af(Xo.prototype,{toJSON:{name:"toJSON",j:[Xh(null,!0)]}}),af(Yo.prototype,{toJSON:{name:"toJSON",j:[Xh(null,!0)]}}),af(ul.prototype,{toJSON:{name:"toJSON",j:[Xh(null,!0)]}}),af(ol.prototype,{Rc:{name:"resolveSignIn",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(t){return!!t&&!!t.tb}}]}}),af(pl.prototype,{Sb:{name:"getSession",j:[]},fc:{name:"enroll",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(t){return!!t&&!!t.tb}},Xh("displayName",!0)]},bd:{name:"unenroll",j:[of({name:"multiFactorInfo",K:"a valid multiFactorInfo",optional:!1,M:rf},Xh(),"multiFactorInfoIdentifier")]}}),af(zh.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),uf(Ei,"parseLink",Ri,[Xh("link")]),uf(Rh,"assertion",(function(t){return new fl(t)}),[ef("phone")]),function(){if(void 0===u.default||!u.default.INTERNAL||!u.default.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:fi,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:hi,VERIFY_AND_CHANGE_EMAIL:di,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:hh,AuthCredential:fo,Error:k};uf(t,"EmailAuthProvider",Oo,[]),uf(t,"FacebookAuthProvider",Eo,[]),uf(t,"GithubAuthProvider",Co,[]),uf(t,"GoogleAuthProvider",Ao,[]),uf(t,"TwitterAuthProvider",Po,[]),uf(t,"OAuthProvider",To,[Xh("providerId")]),uf(t,"SAMLAuthProvider",Io,[Xh("providerId")]),uf(t,"PhoneAuthProvider",qo,[{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(t){return!!(t&&t instanceof hh)}}]),uf(t,"RecaptchaVerifier",zh,[of(Xh(),{name:"",K:"an HTML element",optional:!1,M:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),Jh("recaptchaParameters",!0),{name:"app",K:"an instance of Firebase App",optional:!0,M:function(t){return!!(t&&t instanceof u.default.app.App)}}]),uf(t,"ActionCodeURL",Ei,[]),uf(t,"PhoneMultiFactorGenerator",Rh,[]),u.default.INTERNAL.registerComponent({name:"auth",instanceFactory:function(t){return new hh(t=t.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:t,instantiationMode:"LAZY",type:"PUBLIC",onInstanceCreated:function(t){t.getProvider("auth-internal").initialize()}}),u.default.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(t){return{getUid:I((t=t.getProvider("auth").getImmediate()).getUid,t),getToken:I(t.nc,t),addAuthTokenListener:I(t.cc,t),removeAuthTokenListener:I(t.Pc,t)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),u.default.registerVersion("@firebase/auth","0.16.8"),u.default.INTERNAL.extendNamespace({User:El})}()}).apply(void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});n(446);var c=n(655),l=n(589),h=n(594),f=function(t,e){return(f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function d(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var p,v="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},g=g||{},y=v||self;function m(){}function _(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function b(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var w="closure_uid_"+(1e9*Math.random()>>>0),I=0;function T(t,e,n){return t.call.apply(t.bind,arguments)}function E(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function S(t,e,n){return(S=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?T:E).apply(null,arguments)}function C(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function k(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function A(){this.s=this.s,this.o=this.o}var N={};A.prototype.s=!1,A.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var t=function(t){return Object.prototype.hasOwnProperty.call(t,w)&&t[w]||(t[w]=++I)}(this);delete N[t]}},A.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var P=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},x=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function R(t){return Array.prototype.concat.apply([],arguments)}function D(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function O(t){return/^[\s\xa0]*$/.test(t)}var L,M=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function F(t,e){return-1!=t.indexOf(e)}function U(t,e){return t<e?-1:t>e?1:0}t:{var j=y.navigator;if(j){var q=j.userAgent;if(q){L=q;break t}}L=""}function V(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function B(t){var e={};for(var n in t)e[n]=t[n];return e}var K="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function W(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<K.length;o++)n=K[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function H(t){return H[" "](t),t}H[" "]=m;var G,z,Q=F(L,"Opera"),Y=F(L,"Trident")||F(L,"MSIE"),X=F(L,"Edge"),$=X||Y,J=F(L,"Gecko")&&!(F(L.toLowerCase(),"webkit")&&!F(L,"Edge"))&&!(F(L,"Trident")||F(L,"MSIE"))&&!F(L,"Edge"),Z=F(L.toLowerCase(),"webkit")&&!F(L,"Edge");function tt(){var t=y.document;return t?t.documentMode:void 0}t:{var et="",nt=(z=L,J?/rv:([^\);]+)(\)|;)/.exec(z):X?/Edge\/([\d\.]+)/.exec(z):Y?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(z):Z?/WebKit\/(\S+)/.exec(z):Q?/(?:Version)[ \/]?(\S+)/.exec(z):void 0);if(nt&&(et=nt?nt[1]:""),Y){var rt=tt();if(null!=rt&&rt>parseFloat(et)){G=String(rt);break t}}G=et}var it,ot={};function at(){return function(t){var e=ot;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}((function(){for(var t=0,e=M(String(G)).split("."),n=M("9").split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",a=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==o[0].length&&0==a[0].length)break;t=U(0==o[1].length?0:parseInt(o[1],10),0==a[1].length?0:parseInt(a[1],10))||U(0==o[2].length,0==a[2].length)||U(o[2],a[2]),o=o[3],a=a[3]}while(0==t)}return 0<=t}))}if(y.document&&Y){var st=tt();it=st||(parseInt(G,10)||void 0)}else it=void 0;var ut=it,ct=function(){if(!y.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{y.addEventListener("test",m,e),y.removeEventListener("test",m,e)}catch(t){}return t}();function lt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}function ht(t,e){if(lt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(J){t:{try{H(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:ft[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&ht.Z.h.call(this)}}lt.prototype.h=function(){this.defaultPrevented=!0},k(ht,lt);var ft={2:"touch",3:"pen",4:"mouse"};ht.prototype.h=function(){ht.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var dt="closure_listenable_"+(1e6*Math.random()|0),pt=0;function vt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=i,this.key=++pt,this.ca=this.fa=!1}function gt(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function yt(t){this.src=t,this.g={},this.h=0}function mt(t,e){var n=e.type;if(n in t.g){var r,i=t.g[n],o=P(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(gt(e),0==t.g[n].length&&(delete t.g[n],t.h--))}}function _t(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ca&&o.listener==e&&o.capture==!!n&&o.ia==r)return i}return-1}yt.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.g[o])||(t=this.g[o]=[],this.h++);var a=_t(t,e,r,i);return-1<a?(e=t[a],n||(e.fa=!1)):((e=new vt(e,this.src,o,!!r,i)).fa=n,t.push(e)),e};var bt="closure_lm_"+(1e6*Math.random()|0),wt={};function It(t,e,n,r,i){if(r&&r.once)return Et(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)It(t,e[o],n,r,i);return null}return n=xt(n),t&&t[dt]?t.N(e,n,b(r)?!!r.capture:!!r,i):Tt(t,e,n,!1,r,i)}function Tt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=b(i)?!!i.capture:!!i,s=Nt(t);if(s||(t[bt]=s=new yt(t)),(n=s.add(e,n,r,a,o)).proxy)return n;if(r=function(){function t(n){return e.call(t.src,t.listener,n)}var e=At;return t}(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)ct||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(kt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Et(t,e,n,r,i){if(Array.isArray(e)){for(var o=0;o<e.length;o++)Et(t,e[o],n,r,i);return null}return n=xt(n),t&&t[dt]?t.O(e,n,b(r)?!!r.capture:!!r,i):Tt(t,e,n,!0,r,i)}function St(t,e,n,r,i){if(Array.isArray(e))for(var o=0;o<e.length;o++)St(t,e[o],n,r,i);else r=b(r)?!!r.capture:!!r,n=xt(n),t&&t[dt]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(n=_t(o=t.g[e],n,r,i))&&(gt(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.g[e],t.h--)))):t&&(t=Nt(t))&&(e=t.g[e.toString()],t=-1,e&&(t=_t(e,n,r,i)),(n=-1<t?e[t]:null)&&Ct(n))}function Ct(t){if("number"!=typeof t&&t&&!t.ca){var e=t.src;if(e&&e[dt])mt(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(kt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Nt(e))?(mt(n,t),0==n.h&&(n.src=null,e[bt]=null)):gt(t)}}}function kt(t){return t in wt?wt[t]:wt[t]="on"+t}function At(t,e){if(t.ca)t=!0;else{e=new ht(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&Ct(t),t=n.call(r,e)}return t}function Nt(t){return(t=t[bt])instanceof yt?t:null}var Pt="__closure_events_fn_"+(1e9*Math.random()>>>0);function xt(t){return"function"==typeof t?t:(t[Pt]||(t[Pt]=function(e){return t.handleEvent(e)}),t[Pt])}function Rt(){A.call(this),this.i=new yt(this),this.P=this,this.I=null}function Dt(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,"string"==typeof e)e=new lt(e,t);else if(e instanceof lt)e.target=e.target||t;else{var i=e;W(e=new lt(r,t),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var a=e.g=n[o];i=Ot(a,r,!0,e)&&i}if(i=Ot(a=e.g=t,r,!0,e)&&i,i=Ot(a,r,!1,e)&&i,n)for(o=0;o<n.length;o++)i=Ot(a=e.g=n[o],r,!1,e)&&i}function Ot(t,e,n,r){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.ca&&a.capture==n){var s=a.listener,u=a.ia||a.src;a.fa&&mt(t.i,a),i=!1!==s.call(u,r)&&i}}return i&&!r.defaultPrevented}k(Rt,A),Rt.prototype[dt]=!0,Rt.prototype.removeEventListener=function(t,e,n,r){St(this,t,e,n,r)},Rt.prototype.M=function(){if(Rt.Z.M.call(this),this.i){var t,e=this.i;for(t in e.g){for(var n=e.g[t],r=0;r<n.length;r++)gt(n[r]);delete e.g[t],e.h--}}this.I=null},Rt.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)},Rt.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};var Lt=y.JSON.stringify;function Mt(){var t=Wt,e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var Ft,Ut=function(){function t(){this.h=this.g=null}return t.prototype.add=function(t,e){var n=jt.get();n.set(t,e),this.h?this.h.next=n:this.g=n,this.h=n},t}(),jt=new(function(){function t(t,e){this.i=t,this.j=e,this.h=0,this.g=null}return t.prototype.get=function(){var t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t},t}())((function(){return new qt}),(function(t){return t.reset()})),qt=function(){function t(){this.next=this.g=this.h=null}return t.prototype.set=function(t,e){this.h=t,this.g=e,this.next=null},t.prototype.reset=function(){this.next=this.g=this.h=null},t}();function Vt(t){y.setTimeout((function(){throw t}),0)}function Bt(t,e){Ft||function(){var t=y.Promise.resolve(void 0);Ft=function(){t.then(Ht)}}(),Kt||(Ft(),Kt=!0),Wt.add(t,e)}var Kt=!1,Wt=new Ut;function Ht(){for(var t;t=Mt();){try{t.h.call(t.g)}catch(t){Vt(t)}var e=jt;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Kt=!1}function Gt(t,e){Rt.call(this),this.h=t||1,this.g=e||y,this.j=S(this.kb,this),this.l=Date.now()}function zt(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}function Qt(t,e,n){if("function"==typeof t)n&&(t=S(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=S(t.handleEvent,t)}return 2147483647<Number(e)?-1:y.setTimeout(t,e||0)}function Yt(t){t.g=Qt((function(){t.g=null,t.i&&(t.i=!1,Yt(t))}),t.j);var e=t.h;t.h=null,t.m.apply(null,e)}k(Gt,Rt),(p=Gt.prototype).da=!1,p.S=null,p.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Dt(this,"tick"),this.da&&(zt(this),this.start()))}},p.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},p.M=function(){Gt.Z.M.call(this),zt(this),delete this.g};var Xt=function(t){function e(e,n){var r=t.call(this)||this;return r.m=e,r.j=n,r.h=null,r.i=!1,r.g=null,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}f(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.l=function(t){this.h=arguments,this.g?this.i=!0:Yt(this)},e.prototype.M=function(){t.prototype.M.call(this),this.g&&(y.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},e}(A);function $t(t){A.call(this),this.h=t,this.g={}}k($t,A);var Jt=[];function Zt(t,e,n,r){Array.isArray(n)||(n&&(Jt[0]=n.toString()),n=Jt);for(var i=0;i<n.length;i++){var o=It(e,n[i],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}}function te(t){V(t.g,(function(t,e){this.g.hasOwnProperty(e)&&Ct(t)}),t),t.g={}}function ee(){this.g=!0}function ne(t,e,n,r){t.info((function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var a=1;a<i.length;a++)i[a]=""}}}return Lt(n)}catch(t){return e}}(t,n)+(r?" "+r:"")}))}$t.prototype.M=function(){$t.Z.M.call(this),te(this)},$t.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ee.prototype.Aa=function(){this.g=!1},ee.prototype.info=function(){};var re={},ie=null;function oe(){return ie=ie||new Rt}function ae(t){lt.call(this,re.Ma,t)}function se(t){var e=oe();Dt(e,new ae(e,t))}function ue(t,e){lt.call(this,re.STAT_EVENT,t),this.stat=e}function ce(t){var e=oe();Dt(e,new ue(e,t))}function le(t,e){lt.call(this,re.Na,t),this.size=e}function he(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return y.setTimeout((function(){t()}),e)}re.Ma="serverreachability",k(ae,lt),re.STAT_EVENT="statevent",k(ue,lt),re.Na="timingevent",k(le,lt);var fe={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},de={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function pe(){}function ve(t){return t.h||(t.h=t.i())}function ge(){}pe.prototype.h=null;var ye,me={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function _e(){lt.call(this,"d")}function be(){lt.call(this,"c")}function we(){}function Ie(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new $t(this),this.P=Ee,t=$?125:void 0,this.W=new Gt(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new Te}function Te(){this.i=null,this.g="",this.h=!1}k(_e,lt),k(be,lt),k(we,pe),we.prototype.g=function(){return new XMLHttpRequest},we.prototype.i=function(){return{}},ye=new we;var Ee=45e3,Se={},Ce={};function ke(t,e,n){t.K=1,t.v=Xe(We(e)),t.s=n,t.U=!0,Ae(t,null)}function Ae(t,e){t.F=Date.now(),Re(t),t.A=We(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),ln(n.h,"t",r),t.C=0,n=t.l.H,t.h=new Te,t.g=hr(t.l,n?e:null,!t.s),0<t.O&&(t.L=new Xt(S(t.Ia,t,t.g),t.O)),Zt(t.V,t.g,"readystatechange",t.gb),e=t.H?B(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),se(1),function(t,e,n,r,i,o){t.info((function(){if(t.g)if(o)for(var a="",s=o.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");a=2<=h.length&&"type"==h[1]?a+(l+"=")+c+"&":a+(l+"=redacted&")}}else a=null;else a=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+a}))}(t.j,t.u,t.A,t.m,t.X,t.s)}function Ne(t){return!!t.g&&("GET"==t.u&&2!=t.K&&t.l.Ba)}function Pe(t,e,n){for(var r,i=!0;!t.I&&t.C<n.length;){if((r=xe(t,n))==Ce){4==e&&(t.o=4,ce(14),i=!1),ne(t.j,t.m,null,"[Incomplete Response]");break}if(r==Se){t.o=4,ce(15),ne(t.j,t.m,n,"[Invalid Chunk]"),i=!1;break}ne(t.j,t.m,r,null),Fe(t,r)}Ne(t)&&r!=Ce&&r!=Se&&(t.h.g="",t.C=0),4!=e||0!=n.length||t.h.h||(t.o=1,ce(16),i=!1),t.i=t.i&&i,i?0<n.length&&!t.aa&&(t.aa=!0,(e=t.l).g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),rr(e),e.L=!0,ce(11))):(ne(t.j,t.m,n,"[Invalid Chunked Response]"),Me(t),Le(t))}function xe(t,e){var n=t.C,r=e.indexOf("\n",n);return-1==r?Ce:(n=Number(e.substring(n,r)),isNaN(n)?Se:(r+=1)+n>e.length?Ce:(e=e.substr(r,n),t.C=r+n,e))}function Re(t){t.Y=Date.now()+t.P,De(t,t.P)}function De(t,e){if(null!=t.B)throw Error("WatchDog timer not null");t.B=he(S(t.eb,t),e)}function Oe(t){t.B&&(y.clearTimeout(t.B),t.B=null)}function Le(t){0==t.l.G||t.I||ar(t.l,t)}function Me(t){Oe(t);var e=t.L;e&&"function"==typeof e.na&&e.na(),t.L=null,zt(t.W),te(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function Fe(t,e){try{var n=t.l;if(0!=n.G&&(n.g==t||yn(n.i,t)))if(n.I=t.N,!t.J&&yn(n.i,t)&&3==n.G){try{var r=n.Ca.g.parse(e)}catch(o){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){t:if(!n.u){if(n.g){if(!(n.g.F+3e3<t.F))break t;or(n),Qn(n)}nr(n),ce(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=he(S(n.ab,n),6e3));if(1>=gn(n.i)&&n.ka){try{n.ka()}catch(o){}n.ka=void 0}}else ur(n,11)}else if((t.J||n.g==t)&&or(n),!O(e))for(i=n.Ca.g.parse(e),e=0;e<i.length;e++){var o=i[e];if(n.U=o[0],o=o[1],2==n.G)if("c"==o[0]){n.J=o[1],n.la=o[2];var a=o[3];null!=a&&(n.ma=a,n.h.info("VER="+n.ma));var s=o[4];null!=s&&(n.za=s,n.h.info("SVER="+n.za));var u=o[5];null!=u&&"number"==typeof u&&0<u&&(r=1.5*u,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=t.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var h=r.i;!h.g&&(F(l,"spdy")||F(l,"quic")||F(l,"h2"))&&(h.j=h.l,h.g=new Set,h.h&&(mn(h,h.h),h.h=null))}if(r.D){var f=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;f&&(r.sa=f,Ye(r.F,r.D,f))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms"));var d=t;if((r=n).oa=lr(r,r.H?r.la:null,r.W),d.J){_n(r.i,d);var p=d,v=r.K;v&&p.setTimeout(v),p.B&&(Oe(p),Re(p)),r.g=d}else er(r);0<n.l.length&&$n(n)}else"stop"!=o[0]&&"close"!=o[0]||ur(n,7);else 3==n.G&&("stop"==o[0]||"close"==o[0]?"stop"==o[0]?ur(n,7):zn(n):"noop"!=o[0]&&n.j&&n.j.wa(o),n.A=0)}se(4)}catch(o){}}function Ue(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(_(t)||"string"==typeof t)x(t,e,void 0);else{if(t.T&&"function"==typeof t.T)var n=t.T();else if(t.R&&"function"==typeof t.R)n=void 0;else if(_(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.R&&"function"==typeof t.R)return t.R();if("string"==typeof t)return t.split("");if(_(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function je(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof je)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function qe(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];Ve(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var i={};for(n=e=0;e<t.g.length;)Ve(i,r=t.g[e])||(t.g[n++]=r,i[r]=1),e++;t.g.length=n}}function Ve(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(p=Ie.prototype).setTimeout=function(t){this.P=t},p.gb=function(t){t=t.target;var e=this.L;e&&3==Bn(t)?e.l():this.Ia(t)},p.Ia=function(t){try{if(t==this.g)t:{var e=Bn(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>e)&&(3!=e||$||this.g&&(this.h.h||this.g.ga()||Kn(this.g)))){this.I||4!=e||7==n||se(8==n||0>=r?3:2),Oe(this);var i=this.g.ba();this.N=i;e:if(Ne(this)){var o=Kn(this.g);t="";var a=o.length,s=4==Bn(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Me(this),Le(this);var u="";break e}this.h.i=new y.TextDecoder}for(n=0;n<a;n++)this.h.h=!0,t+=this.h.i.decode(o[n],{stream:s&&n==a-1});o.splice(0,a),this.h.g+=t,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==i,function(t,e,n,r,i,o,a){t.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+a}))}(this.j,this.u,this.A,this.m,this.X,e,i),this.i){if(this.$&&!this.J){e:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(c)){var h=c;break e}}h=null}if(!(i=h)){this.i=!1,this.o=3,ce(12),Me(this),Le(this);break t}ne(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Fe(this,i)}this.U?(Pe(this,e,u),$&&this.i&&3==e&&(Zt(this.V,this.W,"tick",this.fb),this.W.start())):(ne(this.j,this.m,u,null),Fe(this,u)),4==e&&Me(this),this.i&&!this.I&&(4==e?ar(this.l,this):(this.i=!1,Re(this)))}else 400==i&&0<u.indexOf("Unknown SID")?(this.o=3,ce(12)):(this.o=0,ce(13)),Me(this),Le(this)}}}catch(e){}},p.fb=function(){if(this.g){var t=Bn(this.g),e=this.g.ga();this.C<e.length&&(Oe(this),Pe(this,t,e),this.i&&4!=t&&Re(this))}},p.cancel=function(){this.I=!0,Me(this)},p.eb=function(){this.B=null;var t=Date.now();0<=t-this.Y?(function(t,e){t.info((function(){return"TIMEOUT: "+e}))}(this.j,this.A),2!=this.K&&(se(3),ce(17)),Me(this),this.o=2,Le(this)):De(this,this.Y-t)},(p=je.prototype).R=function(){qe(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t},p.T=function(){return qe(this),this.g.concat()},p.get=function(t,e){return Ve(this.h,t)?this.h[t]:e},p.set=function(t,e){Ve(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e},p.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Be=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ke(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof Ke){this.g=void 0!==e?e:t.g,He(this,t.j),this.s=t.s,Ge(this,t.i),ze(this,t.m),this.l=t.l,e=t.h;var n=new an;n.i=e.i,e.g&&(n.g=new je(e.g),n.h=e.h),Qe(this,n),this.o=t.o}else t&&(n=String(t).match(Be))?(this.g=!!e,He(this,n[1]||"",!0),this.s=$e(n[2]||""),Ge(this,n[3]||"",!0),ze(this,n[4]),this.l=$e(n[5]||"",!0),Qe(this,n[6]||"",!0),this.o=$e(n[7]||"")):(this.g=!!e,this.h=new an(null,this.g))}function We(t){return new Ke(t)}function He(t,e,n){t.j=n?$e(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Ge(t,e,n){t.i=n?$e(e,!0):e}function ze(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Qe(t,e,n){e instanceof an?(t.h=e,function(t,e){e&&!t.j&&(sn(t),t.i=null,t.g.forEach((function(t,e){var n=e.toLowerCase();e!=n&&(un(this,e),ln(this,n,t))}),t)),t.j=e}(t.h,t.g)):(n||(e=Je(e,rn)),t.h=new an(e,t.g))}function Ye(t,e,n){t.h.set(e,n)}function Xe(t){return Ye(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function $e(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Je(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,Ze),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Ze(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ke.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Je(e,tn,!0),":");var n=this.i;return(n||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(Je(e,tn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&t.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&t.push("/"),t.push(Je(n,"/"==n.charAt(0)?nn:en,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Je(n,on)),t.join("")};var tn=/[#\/\?@]/g,en=/[#\?:]/g,nn=/[#\?]/g,rn=/[#\?@]/g,on=/#/g;function an(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function sn(t){t.g||(t.g=new je,t.h=0,t.i&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(t.i,(function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)})))}function un(t,e){sn(t),e=hn(t,e),Ve(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,Ve((t=t.g).h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&qe(t)))}function cn(t,e){return sn(t),e=hn(t,e),Ve(t.g.h,e)}function ln(t,e,n){un(t,e),0<n.length&&(t.i=null,t.g.set(hn(t,e),D(n)),t.h+=n.length)}function hn(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}(p=an.prototype).add=function(t,e){sn(this),this.i=null,t=hn(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this},p.forEach=function(t,e){sn(this),this.g.forEach((function(n,r){x(n,(function(n){t.call(e,n,r,this)}),this)}),this)},p.T=function(){sn(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},p.R=function(t){sn(this);var e=[];if("string"==typeof t)cn(this,t)&&(e=R(e,this.g.get(hn(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=R(e,t[n])}return e},p.set=function(t,e){return sn(this),this.i=null,cn(this,t=hn(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},p.get=function(t,e){return t&&0<(t=this.R(t)).length?String(t[0]):e},p.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.R(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.i=t.join("&")};var fn=function(t,e){this.h=t,this.g=e};function dn(t){this.l=t||pn,y.PerformanceNavigationTiming?t=0<(t=y.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(y.g&&y.g.Ea&&y.g.Ea()&&y.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var pn=10;function vn(t){return!!t.h||!!t.g&&t.g.size>=t.j}function gn(t){return t.h?1:t.g?t.g.size:0}function yn(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function mn(t,e){t.g?t.g.add(e):t.h=e}function _n(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function bn(t){var e,n;if(null!=t.h)return t.i.concat(t.h.D);if(null!=t.g&&0!==t.g.size){var r=t.i;try{for(var i=d(t.g.values()),o=i.next();!o.done;o=i.next()){var a=o.value;r=r.concat(a.D)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}return D(t.i)}function wn(){}function In(){this.g=new wn}function Tn(t,e,n){var r=n||"";try{Ue(t,(function(t,n){var i=t;b(t)&&(i=Lt(t)),e.push(r+n+"="+encodeURIComponent(i))}))}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function En(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}function Sn(t){this.l=t.$b||null,this.j=t.ib||!1}function Cn(t,e){Rt.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=kn,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}dn.prototype.cancel=function(){var t,e;if(this.i=bn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var n=d(this.g.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.g.clear()}},wn.prototype.stringify=function(t){return y.JSON.stringify(t,void 0)},wn.prototype.parse=function(t){return y.JSON.parse(t,void 0)},k(Sn,pe),Sn.prototype.g=function(){return new Cn(this.l,this.j)},Sn.prototype.i=function(t){return function(){return t}}({}),k(Cn,Rt);var kn=0;function An(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}function Nn(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Pn(t)}function Pn(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(p=Cn.prototype).open=function(t,e){if(this.readyState!=kn)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Pn(this)},p.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||y).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},p.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Nn(this)),this.readyState=kn},p.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Pn(this)),this.g&&(this.readyState=3,Pn(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==y.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;An(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))},p.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Nn(this):Pn(this),3==this.readyState&&An(this)}},p.Ua=function(t){this.g&&(this.response=this.responseText=t,Nn(this))},p.Ta=function(t){this.g&&(this.response=t,Nn(this))},p.ha=function(){this.g&&Nn(this)},p.setRequestHeader=function(t,e){this.v.append(t,e)},p.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},p.getAllResponseHeaders=function(){if(!this.h)return"";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},Object.defineProperty(Cn.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var xn=y.JSON.parse;function Rn(t){Rt.call(this),this.headers=new je,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Dn,this.K=this.L=!1}k(Rn,Rt);var Dn="",On=/^https?$/i,Ln=["POST","PUT"];function Mn(t){return"content-type"==t.toLowerCase()}function Fn(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Un(t),qn(t)}function Un(t){t.D||(t.D=!0,Dt(t,"complete"),Dt(t,"error"))}function jn(t){if(t.h&&void 0!==g&&(!t.C[1]||4!=Bn(t)||2!=t.ba()))if(t.v&&4==Bn(t))Qt(t.Fa,0,t);else if(Dt(t,"readystatechange"),4==Bn(t)){t.h=!1;try{var e,n=t.ba();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.H).match(Be)[1]||null;if(!o&&y.self&&y.self.location){var a=y.self.location.protocol;o=a.substr(0,a.length-1)}i=!On.test(o?o.toLowerCase():"")}e=i}if(e)Dt(t,"complete"),Dt(t,"success");else{t.m=6;try{var s=2<Bn(t)?t.g.statusText:""}catch(t){s=""}t.j=s+" ["+t.ba()+"]",Un(t)}}finally{qn(t)}}}function qn(t,e){if(t.g){Vn(t);var n=t.g,r=t.C[0]?m:null;t.g=null,t.C=null,e||Dt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Vn(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(y.clearTimeout(t.A),t.A=null)}function Bn(t){return t.g?t.g.readyState:0}function Kn(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case Dn:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Wn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}r||(n=function(t){var e="";return V(t,(function(t,n){e+=n,e+=":",e+=t,e+="\r\n"})),e}(n),"string"==typeof t?null!=n&&encodeURIComponent(String(n)):Ye(t,e,n))}function Hn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Gn(t){this.za=0,this.l=[],this.h=new ee,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Hn("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Hn("baseRetryDelayMs",5e3,t),this.$a=Hn("retryDelaySeedMs",1e4,t),this.Ya=Hn("forwardChannelMaxRetries",2,t),this.ra=Hn("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new dn(t&&t.concurrentRequestLimit),this.Ca=new In,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||!1!==t.Xb}function zn(t){if(Yn(t),3==t.G){var e=t.V++,n=We(t.F);Ye(n,"SID",t.J),Ye(n,"RID",e),Ye(n,"TYPE","terminate"),Zn(t,n),(e=new Ie(t,t.h,e,void 0)).K=2,e.v=Xe(We(n)),n=!1,y.navigator&&y.navigator.sendBeacon&&(n=y.navigator.sendBeacon(e.v.toString(),"")),!n&&y.Image&&((new Image).src=e.v,n=!0),n||(e.g=hr(e.l,null),e.g.ea(e.v)),e.F=Date.now(),Re(e)}cr(t)}function Qn(t){t.g&&(rr(t),t.g.cancel(),t.g=null)}function Yn(t){Qn(t),t.u&&(y.clearTimeout(t.u),t.u=null),or(t),t.i.cancel(),t.m&&("number"==typeof t.m&&y.clearTimeout(t.m),t.m=null)}function Xn(t,e){t.l.push(new fn(t.Za++,e)),3==t.G&&$n(t)}function $n(t){vn(t.i)||t.m||(t.m=!0,Bt(t.Ha,t),t.C=0)}function Jn(t,e){var n;n=e?e.m:t.V++;var r=We(t.F);Ye(r,"SID",t.J),Ye(r,"RID",n),Ye(r,"AID",t.U),Zn(t,r),t.o&&t.s&&Wn(r,t.o,t.s),n=new Ie(t,t.h,n,t.C+1),null===t.o&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=tr(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),mn(t.i,n),ke(n,r,e)}function Zn(t,e){t.j&&Ue({},(function(t,n){Ye(e,n,t)}))}function tr(t,e,n){n=Math.min(t.l.length,n);var r=t.j?S(t.j.Oa,t.j,t):null;t:for(var i=t.l,o=-1;;){var a=["count="+n];-1==o?0<n?(o=i[0].h,a.push("ofs="+o)):o=0:a.push("ofs="+o);for(var s=!0,u=0;u<n;u++){var c=i[u].h,l=i[u].g;if(0>(c-=o))o=Math.max(0,i[u].h-100),s=!1;else try{Tn(l,a,"req"+c+"_")}catch(t){r&&r(l)}}if(s){r=a.join("&");break t}}return t=t.l.splice(0,n),e.D=t,r}function er(t){t.g||t.u||(t.Y=1,Bt(t.Ga,t),t.A=0)}function nr(t){return!(t.g||t.u||3<=t.A)&&(t.Y++,t.u=he(S(t.Ga,t),sr(t,t.A)),t.A++,!0)}function rr(t){null!=t.B&&(y.clearTimeout(t.B),t.B=null)}function ir(t){t.g=new Ie(t,t.h,"rpc",t.Y),null===t.o&&(t.g.H=t.s),t.g.O=0;var e=We(t.oa);Ye(e,"RID","rpc"),Ye(e,"SID",t.J),Ye(e,"CI",t.N?"0":"1"),Ye(e,"AID",t.U),Zn(t,e),Ye(e,"TYPE","xmlhttp"),t.o&&t.s&&Wn(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=Xe(We(e)),n.s=null,n.U=!0,Ae(n,t)}function or(t){null!=t.v&&(y.clearTimeout(t.v),t.v=null)}function ar(t,e){var n=null;if(t.g==e){or(t),rr(t),t.g=null;var r=2}else{if(!yn(t.i,e))return;n=e.D,_n(t.i,e),r=1}if(t.I=e.N,0!=t.G)if(e.i)if(1==r){n=e.s?e.s.length:0,e=Date.now()-e.F;var i=t.C;Dt(r=oe(),new le(r,n,e,i)),$n(t)}else er(t);else if(3==(i=e.o)||0==i&&0<t.I||!(1==r&&function(t,e){return!(gn(t.i)>=t.i.j-(t.m?1:0)||(t.m?(t.l=e.D.concat(t.l),0):1==t.G||2==t.G||t.C>=(t.Xa?0:t.Ya)||(t.m=he(S(t.Ha,t,e),sr(t,t.C)),t.C++,0)))}(t,e)||2==r&&nr(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:ur(t,5);break;case 4:ur(t,10);break;case 3:ur(t,6);break;default:ur(t,2)}}function sr(t,e){var n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function ur(t,e){if(t.h.info("Error code "+e),2==e){var n=null;t.j&&(n=null);var r=S(t.jb,t);n||(n=new Ke("//www.google.com/images/cleardot.gif"),y.location&&"http"==y.location.protocol||He(n,"https"),Xe(n)),function(t,e){var n=new ee;if(y.Image){var r=new Image;r.onload=C(En,n,r,"TestLoadImage: loaded",!0,e),r.onerror=C(En,n,r,"TestLoadImage: error",!1,e),r.onabort=C(En,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=C(En,n,r,"TestLoadImage: timeout",!1,e),y.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=t}else e(!1)}(n.toString(),r)}else ce(2);t.G=0,t.j&&t.j.va(e),cr(t),Yn(t)}function cr(t){t.G=0,t.I=-1,t.j&&(0==bn(t.i).length&&0==t.l.length||(t.i.i.length=0,D(t.l),t.l.length=0),t.j.ua())}function lr(t,e,n){var r=function(t){return t instanceof Ke?We(t):new Ke(t,void 0)}(n);if(""!=r.i)e&&Ge(r,e+"."+r.i),ze(r,r.m);else{var i=y.location;r=function(t,e,n,r){var i=new Ke(null,void 0);return t&&He(i,t),e&&Ge(i,e),n&&ze(i,n),r&&(i.l=r),i}(i.protocol,e?e+"."+i.hostname:i.hostname,+i.port,n)}return t.aa&&V(t.aa,(function(t,e){Ye(r,e,t)})),e=t.D,n=t.sa,e&&n&&Ye(r,e,n),Ye(r,"VER",t.ma),Zn(t,r),r}function hr(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=n&&t.Ba&&!t.qa?new Rn(new Sn({ib:!0})):new Rn(t.qa)).L=t.H,e}function fr(){}function dr(){if(Y&&!(10<=Number(ut)))throw Error("Environmental error: no available transport.")}function pr(t,e){Rt.call(this),this.g=new Gn(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!O(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!O(e)&&(this.g.D=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new yr(this)}function vr(t){_e.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function gr(){be.call(this),this.status=1}function yr(t){this.g=t}(p=Rn.prototype).ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():ye.g(),this.C=this.u?ve(this.u):ve(ye),this.g.onreadystatechange=S(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(t){return void Fn(this,t)}t=n||"";var i=new je(this.headers);r&&Ue(r,(function(t,e){i.set(e,t)})),r=function(t){t:{for(var e=Mn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:"string"==typeof t?t.charAt(e):t[e]}(i.T()),n=y.FormData&&t instanceof y.FormData,!(0<=P(Ln,e))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(t,e){this.g.setRequestHeader(e,t)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Vn(this),0<this.B&&((this.K=function(t){return Y&&at()&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=S(this.pa,this)):this.A=Qt(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(t){Fn(this,t)}},p.pa=function(){void 0!==g&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Dt(this,"timeout"),this.abort(8))},p.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,Dt(this,"complete"),Dt(this,"abort"),qn(this))},p.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),qn(this,!0)),Rn.Z.M.call(this)},p.Fa=function(){this.s||(this.F||this.v||this.l?jn(this):this.cb())},p.cb=function(){jn(this)},p.ba=function(){try{return 2<Bn(this)?this.g.status:-1}catch(t){return-1}},p.ga=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},p.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),xn(e)}},p.Da=function(){return this.m},p.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(p=Gn.prototype).ma=8,p.G=1,p.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch(t){}},p.Ha=function(t){if(this.m)if(this.m=null,1==this.G){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;var e=new Ie(this,this.h,t,void 0),n=this.s;if(this.P&&(n?W(n=B(n),this.P):n=this.P),null===this.o&&(e.H=n),this.ja)t:{for(var r=0,i=0;i<this.l.length;i++){var o=this.l[i];if(void 0===(o="__data__"in o.g&&"string"==typeof(o=o.g.__data__)?o.length:void 0))break;if(4096<(r+=o)){r=i;break t}if(4096===r||i===this.l.length-1){r=i+1;break t}}r=1e3}else r=1e3;r=tr(this,e,r),Ye(i=We(this.F),"RID",t),Ye(i,"CVER",22),this.D&&Ye(i,"X-HTTP-Session-Id",this.D),Zn(this,i),this.o&&n&&Wn(i,this.o,n),mn(this.i,e),this.Ra&&Ye(i,"TYPE","init"),this.ja?(Ye(i,"$req",r),Ye(i,"SID","null"),e.$=!0,ke(e,i,null)):ke(e,i,r),this.G=2}}else 3==this.G&&(t?Jn(this,t):0==this.l.length||vn(this.i)||Jn(this))},p.Ga=function(){if(this.u=null,ir(this),this.$&&!(this.L||null==this.g||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=he(S(this.bb,this),t)}},p.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,ce(10),Qn(this),ir(this))},p.ab=function(){null!=this.v&&(this.v=null,Qn(this),nr(this),ce(19))},p.jb=function(t){t?(this.h.info("Successfully pinged google.com"),ce(2)):(this.h.info("Failed to ping google.com"),ce(1))},(p=fr.prototype).xa=function(){},p.wa=function(){},p.va=function(){},p.ua=function(){},p.Oa=function(){},dr.prototype.g=function(t,e){return new pr(t,e)},k(pr,Rt),pr.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),Bt(S(t.hb,t,e))),ce(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=lr(t,null,t.W),$n(t)},pr.prototype.close=function(){zn(this.g)},pr.prototype.u=function(t){if("string"==typeof t){var e={};e.__data__=t,Xn(this.g,e)}else this.v?((e={}).__data__=Lt(t),Xn(this.g,e)):Xn(this.g,t)},pr.prototype.M=function(){this.g.j=null,delete this.j,zn(this.g),delete this.g,pr.Z.M.call(this)},k(vr,_e),k(gr,be),k(yr,fr),yr.prototype.xa=function(){Dt(this.g,"a")},yr.prototype.wa=function(t){Dt(this.g,new vr(t))},yr.prototype.va=function(t){Dt(this.g,new gr(t))},yr.prototype.ua=function(){Dt(this.g,"b")},dr.prototype.createWebChannel=dr.prototype.g,pr.prototype.send=pr.prototype.u,pr.prototype.open=pr.prototype.m,pr.prototype.close=pr.prototype.close,fe.NO_ERROR=0,fe.TIMEOUT=8,fe.HTTP_ERROR=6,de.COMPLETE="complete",ge.EventType=me,me.OPEN="a",me.CLOSE="b",me.ERROR="c",me.MESSAGE="d",Rt.prototype.listen=Rt.prototype.N,Rn.prototype.listenOnce=Rn.prototype.O,Rn.prototype.getLastError=Rn.prototype.La,Rn.prototype.getLastErrorCode=Rn.prototype.Da,Rn.prototype.getStatus=Rn.prototype.ba,Rn.prototype.getResponseJson=Rn.prototype.Qa,Rn.prototype.getResponseText=Rn.prototype.ga,Rn.prototype.send=Rn.prototype.ea;var mr=function(){return new dr},_r=function(){return oe()},br=fe,wr=de,Ir=re,Tr={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},Er=Sn,Sr=ge,Cr=Rn,kr=function(){function t(t,e){var n=this;this.previousValue=t,e&&(e.sequenceNumberHandler=function(t){return n.t(t)},this.i=function(t){return e.writeSequenceNumber(t)})}return t.prototype.t=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},t.prototype.next=function(){var t=++this.previousValue;return this.i&&this.i(t),t},t}();kr.o=-1;var Ar={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Nr=function(t){function e(e,n){var r=this;return(r=t.call(this,n)||this).code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return(0,c.__extends)(e,t),e}(Error),Pr=new h.Logger("@firebase/firestore");function xr(){return Pr.logLevel}function Rr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Pr.logLevel<=h.LogLevel.DEBUG){var r=e.map(Lr);Pr.debug.apply(Pr,(0,c.__spreadArray)(["Firestore (8.10.1): "+t],r))}}function Dr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Pr.logLevel<=h.LogLevel.ERROR){var r=e.map(Lr);Pr.error.apply(Pr,(0,c.__spreadArray)(["Firestore (8.10.1): "+t],r))}}function Or(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Pr.logLevel<=h.LogLevel.WARN){var r=e.map(Lr);Pr.warn.apply(Pr,(0,c.__spreadArray)(["Firestore (8.10.1): "+t],r))}}function Lr(t){if("string"==typeof t)return t;try{return e=t,JSON.stringify(e)}catch(e){return t}var e}function Mr(t){void 0===t&&(t="Unexpected state");var e="FIRESTORE (8.10.1) INTERNAL ASSERTION FAILED: "+t;throw Dr(e),new Error(e)}function Fr(t,e){t||Mr()}function Ur(t,e){return t}function jr(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var qr=function(){function t(){}return t.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=jr(40),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},t}();function Vr(t,e){return t<e?-1:t>e?1:0}function Br(t,e,n){return t.length===e.length&&t.every((function(t,r){return n(t,e[r])}))}function Kr(t){return t+"\0"}var Wr=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new Nr(Ar.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new Nr(Ar.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Nr(Ar.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Nr(Ar.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?Vr(this.nanoseconds,t.nanoseconds):Vr(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),Hr=function(){function t(t){this.timestamp=t}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new Wr(0,0))},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();function Gr(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function zr(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Qr(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Yr=function(){function t(t,e,n){void 0===e?e=0:e>t.length&&Mr(),void 0===n?n=t.length-e:n>t.length-e&&Mr(),this.segments=t,this.offset=e,this.len=n}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach((function(t){n.push(t)})):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(t){return this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.isImmediateParentOf=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),Xr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,c.__extends)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],i=0,o=t;i<o.length;i++){var a=o[i];if(a.indexOf("//")>=0)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid segment ("+a+"). Paths must not contain // in them.");r.push.apply(r,a.split("/").filter((function(t){return t.length>0})))}return new e(r)},e.emptyPath=function(){return new e([])},e}(Yr),$r=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Jr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,c.__extends)(e,t),e.prototype.construct=function(t,n,r){return new e(t,n,r)},e.isValidIdentifier=function(t){return $r.test(t)},e.prototype.canonicalString=function(){return this.toArray().map((function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t})).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new Nr(Ar.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Nr(Ar.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===s?(a=!a,i++):"."!==s||a?(r+=s,i++):(o(),i++)}if(o(),a)throw new Nr(Ar.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.emptyPath=function(){return new e([])},e}(Yr),Zr=function(){function t(t){this.fields=t,t.sort(Jr.comparator)}return t.prototype.covers=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].isPrefixOf(t))return!0;return!1},t.prototype.isEqual=function(t){return Br(this.fields,t.fields,(function(t,e){return t.isEqual(e)}))},t}(),ti=function(){function t(t){this.binaryString=t}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e))},t.prototype.toBase64=function(){return t=this.binaryString,btoa(t);var t},t.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(t){return Vr(this.binaryString,t.binaryString)},t.prototype.isEqual=function(t){return this.binaryString===t.binaryString},t}();ti.EMPTY_BYTE_STRING=new ti("");var ei=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ni(t){if(Fr(!!t),"string"==typeof t){var e=0,n=ei.exec(t);if(Fr(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:ri(t.seconds),nanos:ri(t.nanos)}}function ri(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function ii(t){return"string"==typeof t?ti.fromBase64String(t):ti.fromUint8Array(t)}function oi(t){var e,n;return"server_timestamp"===(null===(n=((null===(e=null==t?void 0:t.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ai(t){var e=t.mapValue.fields.__previous_value__;return oi(e)?ai(e):e}function si(t){var e=ni(t.mapValue.fields.__local_write_time__.timestampValue);return new Wr(e.seconds,e.nanos)}function ui(t){return null==t}function ci(t){return 0===t&&1/t==-1/0}function li(t){return"number"==typeof t&&Number.isInteger(t)&&!ci(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var hi=function(){function t(t){this.path=t}return t.fromPath=function(e){return new t(Xr.fromString(e))},t.fromName=function(e){return new t(Xr.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t},t.prototype.isEqual=function(t){return null!==t&&0===Xr.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return Xr.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2==0},t.fromSegments=function(e){return new t(new Xr(e.slice()))},t}();function fi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?oi(t)?4:10:Mr()}function di(t,e){var n=fi(t);if(n!==fi(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return si(t).isEqual(si(e));case 3:return function(t,e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=ni(t.timestampValue),r=ni(e.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(t,e){return ii(t.bytesValue).isEqual(ii(e.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(t,e){return ri(t.geoPointValue.latitude)===ri(e.geoPointValue.latitude)&&ri(t.geoPointValue.longitude)===ri(e.geoPointValue.longitude)}(t,e);case 2:return function(t,e){if("integerValue"in t&&"integerValue"in e)return ri(t.integerValue)===ri(e.integerValue);if("doubleValue"in t&&"doubleValue"in e){var n=ri(t.doubleValue),r=ri(e.doubleValue);return n===r?ci(n)===ci(r):isNaN(n)&&isNaN(r)}return!1}(t,e);case 9:return Br(t.arrayValue.values||[],e.arrayValue.values||[],di);case 10:return function(t,e){var n=t.mapValue.fields||{},r=e.mapValue.fields||{};if(Gr(n)!==Gr(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!di(n[i],r[i])))return!1;return!0}(t,e);default:return Mr()}}function pi(t,e){return void 0!==(t.values||[]).find((function(t){return di(t,e)}))}function vi(t,e){var n=fi(t),r=fi(e);if(n!==r)return Vr(n,r);switch(n){case 0:return 0;case 1:return Vr(t.booleanValue,e.booleanValue);case 2:return function(t,e){var n=ri(t.integerValue||t.doubleValue),r=ri(e.integerValue||e.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(t,e);case 3:return gi(t.timestampValue,e.timestampValue);case 4:return gi(si(t),si(e));case 5:return Vr(t.stringValue,e.stringValue);case 6:return function(t,e){var n=ii(t),r=ii(e);return n.compareTo(r)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Vr(n[i],r[i]);if(0!==o)return o}return Vr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return function(t,e){var n=Vr(ri(t.latitude),ri(e.latitude));return 0!==n?n:Vr(ri(t.longitude),ri(e.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=vi(n[i],r[i]);if(o)return o}return Vr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var a=0;a<r.length&&a<o.length;++a){var s=Vr(r[a],o[a]);if(0!==s)return s;var u=vi(n[r[a]],i[o[a]]);if(0!==u)return u}return Vr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Mr()}}function gi(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Vr(t,e);var n=ni(t),r=ni(e),i=Vr(n.seconds,r.seconds);return 0!==i?i:Vr(n.nanos,r.nanos)}function yi(t){return mi(t)}function mi(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(t){var e=ni(t);return"time("+e.seconds+","+e.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?ii(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,hi.fromName(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(t){for(var e="[",n=!0,r=0,i=t.values||[];r<i.length;r++)n?n=!1:e+=",",e+=mi(i[r]);return e+"]"}(t.arrayValue):"mapValue"in t?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+mi(t.fields[o])}return e+"}"}(t.mapValue):Mr();var e,n}function _i(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function bi(t){return!!t&&"integerValue"in t}function wi(t){return!!t&&"arrayValue"in t}function Ii(t){return!!t&&"nullValue"in t}function Ti(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ei(t){return!!t&&"mapValue"in t}function Si(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&"object"==typeof t.timestampValue)return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){var e={mapValue:{fields:{}}};return zr(t.mapValue.fields,(function(t,n){return e.mapValue.fields[t]=Si(n)})),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=Si(t.arrayValue.values[r]);return n}return Object.assign({},t)}var Ci=function(){function t(t){this.value=t}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(t){if(t.isEmpty())return this.value;for(var e=this.value,n=0;n<t.length-1;++n)if(!Ei(e=(e.mapValue.fields||{})[t.get(n)]))return null;return(e=(e.mapValue.fields||{})[t.lastSegment()])||null},t.prototype.set=function(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=Si(e)},t.prototype.setAll=function(t){var e=this,n=Jr.emptyPath(),r={},i=[];t.forEach((function(t,o){if(!n.isImmediateParentOf(o)){var a=e.getFieldsMap(n);e.applyChanges(a,r,i),r={},i=[],n=o.popLast()}t?r[o.lastSegment()]=Si(t):i.push(o.lastSegment())}));var o=this.getFieldsMap(n);this.applyChanges(o,r,i)},t.prototype.delete=function(t){var e=this.field(t.popLast());Ei(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]},t.prototype.isEqual=function(t){return di(this.value,t.value)},t.prototype.getFieldsMap=function(t){var e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(var n=0;n<t.length;++n){var r=e.mapValue.fields[t.get(n)];Ei(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(n)]=r),e=r}return e.mapValue.fields},t.prototype.applyChanges=function(t,e,n){zr(e,(function(e,n){return t[e]=n}));for(var r=0,i=n;r<i.length;r++){var o=i[r];delete t[o]}},t.prototype.clone=function(){return new t(Si(this.value))},t}();function ki(t){var e=[];return zr(t.fields,(function(t,n){var r=new Jr([t]);if(Ei(n)){var i=ki(n.mapValue).fields;if(0===i.length)e.push(r);else for(var o=0,a=i;o<a.length;o++){var s=a[o];e.push(r.child(s))}}else e.push(r)})),new Zr(e)}var Ai=function(){function t(t,e,n,r,i){this.key=t,this.documentType=e,this.version=n,this.data=r,this.documentState=i}return t.newInvalidDocument=function(e){return new t(e,0,Hr.min(),Ci.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,Ci.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,Ci.empty(),2)},t.prototype.convertToFoundDocument=function(t,e){return this.version=t,this.documentType=1,this.data=e,this.documentState=0,this},t.prototype.convertToNoDocument=function(t){return this.version=t,this.documentType=2,this.data=Ci.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(t){return this.version=t,this.documentType=3,this.data=Ci.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return 0!==this.documentType},t.prototype.isFoundDocument=function(){return 1===this.documentType},t.prototype.isNoDocument=function(){return 2===this.documentType},t.prototype.isUnknownDocument=function(){return 3===this.documentType},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),Ni=function(t,e,n,r,i,o,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.h=null};function Pi(t,e,n,r,i,o,a){return void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),new Ni(t,e,n,r,i,o,a)}function xi(t){var e=Ur(t);if(null===e.h){var n=e.path.canonicalString();null!==e.collectionGroup&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((function(t){return function(t){return t.field.canonicalString()+t.op.toString()+yi(t.value)}(t)})).join(","),n+="|ob:",n+=e.orderBy.map((function(t){return function(t){return t.field.canonicalString()+t.dir}(t)})).join(","),ui(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=Wi(e.startAt)),e.endAt&&(n+="|ub:",n+=Wi(e.endAt)),e.h=n}return e.h}function Ri(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!Gi(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(i=t.filters[r],o=e.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!di(i.value,o.value))return!1;var i,o;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Qi(t.startAt,e.startAt)&&Qi(t.endAt,e.endAt)}function Di(t){return hi.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}var Oi=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).field=e,i.op=n,i.value=r,i}return(0,c.__extends)(e,t),e.create=function(t,n,r){return t.isKeyField()?"in"===n||"not-in"===n?this.l(t,n,r):new Li(t,n,r):"array-contains"===n?new ji(t,r):"in"===n?new qi(t,r):"not-in"===n?new Vi(t,r):"array-contains-any"===n?new Bi(t,r):new e(t,n,r)},e.l=function(t,e,n){return"in"===e?new Mi(t,n):new Fi(t,n)},e.prototype.matches=function(t){var e=t.data.field(this.field);return"!="===this.op?null!==e&&this.m(vi(e,this.value)):null!==e&&fi(this.value)===fi(e)&&this.m(vi(e,this.value))},e.prototype.m=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return t>0;case">=":return t>=0;default:return Mr()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}((function(){})),Li=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,r)||this).key=hi.fromName(r.referenceValue),i}return(0,c.__extends)(e,t),e.prototype.matches=function(t){var e=hi.comparator(t.key,this.key);return this.m(e)},e}(Oi),Mi=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"in",n)||this).keys=Ui("in",n),r}return(0,c.__extends)(e,t),e.prototype.matches=function(t){return this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Oi),Fi=function(t){function e(e,n){var r=this;return(r=t.call(this,e,"not-in",n)||this).keys=Ui("not-in",n),r}return(0,c.__extends)(e,t),e.prototype.matches=function(t){return!this.keys.some((function(e){return e.isEqual(t.key)}))},e}(Oi);function Ui(t,e){var n;return((null===(n=e.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(t){return hi.fromName(t.referenceValue)}))}var ji=function(t){function e(e,n){return t.call(this,e,"array-contains",n)||this}return(0,c.__extends)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return wi(e)&&pi(e.arrayValue,this.value)},e}(Oi),qi=function(t){function e(e,n){return t.call(this,e,"in",n)||this}return(0,c.__extends)(e,t),e.prototype.matches=function(t){var e=t.data.field(this.field);return null!==e&&pi(this.value.arrayValue,e)},e}(Oi),Vi=function(t){function e(e,n){return t.call(this,e,"not-in",n)||this}return(0,c.__extends)(e,t),e.prototype.matches=function(t){if(pi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var e=t.data.field(this.field);return null!==e&&!pi(this.value.arrayValue,e)},e}(Oi),Bi=function(t){function e(e,n){return t.call(this,e,"array-contains-any",n)||this}return(0,c.__extends)(e,t),e.prototype.matches=function(t){var e=this,n=t.data.field(this.field);return!(!wi(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(t){return pi(e.value.arrayValue,t)}))},e}(Oi),Ki=function(t,e){this.position=t,this.before=e};function Wi(t){return(t.before?"b":"a")+":"+t.position.map((function(t){return yi(t)})).join(",")}var Hi=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Gi(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function zi(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],a=t.position[i];if(r=o.field.isKeyField()?hi.comparator(hi.fromName(a.referenceValue),n.key):vi(a,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Qi(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!di(t.position[n],e.position[n]))return!1;return!0}var Yi=function(t,e,n,r,i,o,a,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===a&&(a=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=s,this.p=null,this.T=null,this.startAt,this.endAt};function Xi(t,e,n,r,i,o,a,s){return new Yi(t,e,n,r,i,o,a,s)}function $i(t){return new Yi(t)}function Ji(t){return!ui(t.limit)&&"F"===t.limitType}function Zi(t){return!ui(t.limit)&&"L"===t.limitType}function to(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function eo(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function no(t){return null!==t.collectionGroup}function ro(t){var e=Ur(t);if(null===e.p){e.p=[];var n=eo(e),r=to(e);if(null!==n&&null===r)n.isKeyField()||e.p.push(new Hi(n)),e.p.push(new Hi(Jr.keyField(),"asc"));else{for(var i=!1,o=0,a=e.explicitOrderBy;o<a.length;o++){var s=a[o];e.p.push(s),s.field.isKeyField()&&(i=!0)}if(!i){var u=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new Hi(Jr.keyField(),u))}}}return e.p}function io(t){var e=Ur(t);if(!e.T)if("F"===e.limitType)e.T=Pi(e.path,e.collectionGroup,ro(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=ro(e);r<i.length;r++){var o=i[r],a="desc"===o.dir?"asc":"desc";n.push(new Hi(o.field,a))}var s=e.endAt?new Ki(e.endAt.position,!e.endAt.before):null,u=e.startAt?new Ki(e.startAt.position,!e.startAt.before):null;e.T=Pi(e.path,e.collectionGroup,n,e.filters,e.limit,s,u)}return e.T}function oo(t,e,n){return new Yi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ao(t,e){return Ri(io(t),io(e))&&t.limitType===e.limitType}function so(t){return xi(io(t))+"|lt:"+t.limitType}function uo(t){return"Query(target="+function(t){var e=t.path.canonicalString();return null!==t.collectionGroup&&(e+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(e+=", filters: ["+t.filters.map((function(t){return(e=t).field.canonicalString()+" "+e.op+" "+yi(e.value);var e})).join(", ")+"]"),ui(t.limit)||(e+=", limit: "+t.limit),t.orderBy.length>0&&(e+=", orderBy: ["+t.orderBy.map((function(t){return function(t){return t.field.canonicalString()+" ("+t.dir+")"}(t)})).join(", ")+"]"),t.startAt&&(e+=", startAt: "+Wi(t.startAt)),t.endAt&&(e+=", endAt: "+Wi(t.endAt)),"Target("+e+")"}(io(t))+"; limitType="+t.limitType+")"}function co(t,e){return e.isFoundDocument()&&function(t,e){var n=e.key.path;return null!==t.collectionGroup?e.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(n):hi.isDocumentKey(t.path)?t.path.isEqual(n):t.path.isImmediateParentOf(n)}(t,e)&&function(t,e){for(var n=0,r=t.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===e.data.field(i.field))return!1}return!0}(t,e)&&function(t,e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return!1;return!0}(t,e)&&function(t,e){return!(t.startAt&&!zi(t.startAt,ro(t),e)||t.endAt&&zi(t.endAt,ro(t),e))}(t,e)}function lo(t){return function(e,n){for(var r=!1,i=0,o=ro(t);i<o.length;i++){var a=o[i],s=ho(a,e,n);if(0!==s)return s;r=r||a.field.isKeyField()}return 0}}function ho(t,e,n){var r=t.field.isKeyField()?hi.comparator(e.key,n.key):function(t,e,n){var r=e.data.field(t),i=n.data.field(t);return null!==r&&null!==i?vi(r,i):Mr()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Mr()}}function fo(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ci(e)?"-0":e}}function po(t){return{integerValue:""+t}}function vo(t,e){return li(e)?po(e):fo(t,e)}var go=function(){this._=void 0};function yo(t,e,n){return t instanceof bo?function(t,e){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:t.seconds,nanos:t.nanoseconds}}}};return e&&(n.fields.__previous_value__=e),{mapValue:n}}(n,e):t instanceof wo?Io(t,e):t instanceof To?Eo(t,e):function(t,e){var n=_o(t,e),r=Co(n)+Co(t.A);return bi(n)&&bi(t.A)?po(r):fo(t.R,r)}(t,e)}function mo(t,e,n){return t instanceof wo?Io(t,e):t instanceof To?Eo(t,e):n}function _o(t,e){return t instanceof So?bi(n=e)||function(t){return!!t&&"doubleValue"in t}(n)?e:{integerValue:0}:null;var n}var bo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,c.__extends)(e,t),e}(go),wo=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return(0,c.__extends)(e,t),e}(go);function Io(t,e){for(var n=ko(e),r=function(t){n.some((function(e){return di(e,t)}))||n.push(t)},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var To=function(t){function e(e){var n=this;return(n=t.call(this)||this).elements=e,n}return(0,c.__extends)(e,t),e}(go);function Eo(t,e){for(var n=ko(e),r=function(t){n=n.filter((function(e){return!di(e,t)}))},i=0,o=t.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var So=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).R=e,r.A=n,r}return(0,c.__extends)(e,t),e}(go);function Co(t){return ri(t.integerValue||t.doubleValue)}function ko(t){return wi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Ao=function(t,e){this.field=t,this.transform=e},No=function(t,e){this.version=t,this.transformResults=e},Po=function(){function t(t,e){this.updateTime=t,this.exists=e}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},t}();function xo(t,e){return void 0!==t.updateTime?e.isFoundDocument()&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e.isFoundDocument()}var Ro=function(){};function Do(t,e,n){t instanceof Uo?function(t,e,n){var r=t.value.clone(),i=Vo(t.fieldTransforms,e,n.transformResults);r.setAll(i),e.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(t,e,n):t instanceof jo?function(t,e,n){if(xo(t.precondition,e)){var r=Vo(t.fieldTransforms,e,n.transformResults),i=e.data;i.setAll(qo(t)),i.setAll(r),e.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else e.convertToUnknownDocument(n.version)}(t,e,n):function(t,e,n){e.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,n)}function Oo(t,e,n){t instanceof Uo?function(t,e,n){if(xo(t.precondition,e)){var r=t.value.clone(),i=Bo(t.fieldTransforms,n,e);r.setAll(i),e.convertToFoundDocument(Fo(e),r).setHasLocalMutations()}}(t,e,n):t instanceof jo?function(t,e,n){if(xo(t.precondition,e)){var r=Bo(t.fieldTransforms,n,e),i=e.data;i.setAll(qo(t)),i.setAll(r),e.convertToFoundDocument(Fo(e),i).setHasLocalMutations()}}(t,e,n):function(t,e){xo(t.precondition,e)&&e.convertToNoDocument(Hr.min())}(t,e)}function Lo(t,e){for(var n=null,r=0,i=t.fieldTransforms;r<i.length;r++){var o=i[r],a=e.data.field(o.field),s=_o(o.transform,a||null);null!=s&&(null==n&&(n=Ci.empty()),n.set(o.field,s))}return n||null}function Mo(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(t,e){return void 0===t&&void 0===e||!(!t||!e)&&Br(t,e,(function(t,e){return function(t,e){return t.field.isEqual(e.field)&&function(t,e){return t instanceof wo&&e instanceof wo||t instanceof To&&e instanceof To?Br(t.elements,e.elements,di):t instanceof So&&e instanceof So?di(t.A,e.A):t instanceof bo&&e instanceof bo}(t.transform,e.transform)}(t,e)}))}(t.fieldTransforms,e.fieldTransforms)&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function Fo(t){return t.isFoundDocument()?t.version:Hr.min()}var Uo=function(t){function e(e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=t.call(this)||this).key=e,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return(0,c.__extends)(e,t),e}(Ro),jo=function(t){function e(e,n,r,i,o){void 0===o&&(o=[]);var a=this;return(a=t.call(this)||this).key=e,a.data=n,a.fieldMask=r,a.precondition=i,a.fieldTransforms=o,a.type=1,a}return(0,c.__extends)(e,t),e}(Ro);function qo(t){var e=new Map;return t.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}})),e}function Vo(t,e,n){var r=new Map;Fr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],a=o.transform,s=e.data.field(o.field);r.set(o.field,mo(a,s,n[i]))}return r}function Bo(t,e,n){for(var r=new Map,i=0,o=t;i<o.length;i++){var a=o[i],s=a.transform,u=n.data.field(a.field);r.set(a.field,yo(s,u,e))}return r}var Ko,Wo,Ho=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return(0,c.__extends)(e,t),e}(Ro),Go=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).key=e,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return(0,c.__extends)(e,t),e}(Ro),zo=function(t){this.count=t};function Qo(t){switch(t){case Ar.OK:return Mr();case Ar.CANCELLED:case Ar.UNKNOWN:case Ar.DEADLINE_EXCEEDED:case Ar.RESOURCE_EXHAUSTED:case Ar.INTERNAL:case Ar.UNAVAILABLE:case Ar.UNAUTHENTICATED:return!1;case Ar.INVALID_ARGUMENT:case Ar.NOT_FOUND:case Ar.ALREADY_EXISTS:case Ar.PERMISSION_DENIED:case Ar.FAILED_PRECONDITION:case Ar.ABORTED:case Ar.OUT_OF_RANGE:case Ar.UNIMPLEMENTED:case Ar.DATA_LOSS:return!0;default:return Mr()}}function Yo(t){if(void 0===t)return Dr("GRPC error has no .code"),Ar.UNKNOWN;switch(t){case Ko.OK:return Ar.OK;case Ko.CANCELLED:return Ar.CANCELLED;case Ko.UNKNOWN:return Ar.UNKNOWN;case Ko.DEADLINE_EXCEEDED:return Ar.DEADLINE_EXCEEDED;case Ko.RESOURCE_EXHAUSTED:return Ar.RESOURCE_EXHAUSTED;case Ko.INTERNAL:return Ar.INTERNAL;case Ko.UNAVAILABLE:return Ar.UNAVAILABLE;case Ko.UNAUTHENTICATED:return Ar.UNAUTHENTICATED;case Ko.INVALID_ARGUMENT:return Ar.INVALID_ARGUMENT;case Ko.NOT_FOUND:return Ar.NOT_FOUND;case Ko.ALREADY_EXISTS:return Ar.ALREADY_EXISTS;case Ko.PERMISSION_DENIED:return Ar.PERMISSION_DENIED;case Ko.FAILED_PRECONDITION:return Ar.FAILED_PRECONDITION;case Ko.ABORTED:return Ar.ABORTED;case Ko.OUT_OF_RANGE:return Ar.OUT_OF_RANGE;case Ko.UNIMPLEMENTED:return Ar.UNIMPLEMENTED;case Ko.DATA_LOSS:return Ar.DATA_LOSS;default:return Mr()}}(Wo=Ko||(Ko={}))[Wo.OK=0]="OK",Wo[Wo.CANCELLED=1]="CANCELLED",Wo[Wo.UNKNOWN=2]="UNKNOWN",Wo[Wo.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Wo[Wo.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Wo[Wo.NOT_FOUND=5]="NOT_FOUND",Wo[Wo.ALREADY_EXISTS=6]="ALREADY_EXISTS",Wo[Wo.PERMISSION_DENIED=7]="PERMISSION_DENIED",Wo[Wo.UNAUTHENTICATED=16]="UNAUTHENTICATED",Wo[Wo.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Wo[Wo.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Wo[Wo.ABORTED=10]="ABORTED",Wo[Wo.OUT_OF_RANGE=11]="OUT_OF_RANGE",Wo[Wo.UNIMPLEMENTED=12]="UNIMPLEMENTED",Wo[Wo.INTERNAL=13]="INTERNAL",Wo[Wo.UNAVAILABLE=14]="UNAVAILABLE",Wo[Wo.DATA_LOSS=15]="DATA_LOSS";var Xo=function(){function t(t,e){this.comparator=t,this.root=e||Jo.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Jo.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Jo.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal((function(e,n){return t(e,n),!1}))},t.prototype.toString=function(){var t=[];return this.inorderTraversal((function(e,n){return t.push(e+":"+n),!1})),"{"+t.join(", ")+"}"},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new $o(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new $o(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new $o(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new $o(this.root,t,this.comparator,!0)},t}(),$o=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),Jo=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight())).rotateLeft()).colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=(t=t.rotateRight()).colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw Mr();if(this.right.isRed())throw Mr();var t=this.left.check();if(t!==this.right.check())throw Mr();return t+(this.isRed()?0:1)},t}();Jo.EMPTY=null,Jo.RED=!0,Jo.BLACK=!1,Jo.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw Mr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw Mr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw Mr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw Mr()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw Mr()},enumerable:!1,configurable:!0}),t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new Jo(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());var Zo=function(){function t(t){this.comparator=t,this.data=new Xo(this.comparator)}return t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();)if(!t(n.getNext().key))return},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.getIterator=function(){return new ta(this.data.getIterator())},t.prototype.getIteratorFrom=function(t){return new ta(this.data.getIteratorFrom(t))},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach((function(t){e=e.add(t)})),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toArray=function(){var t=[];return this.forEach((function(e){t.push(e)})),t},t.prototype.toString=function(){var t=[];return this.forEach((function(e){return t.push(e)})),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),ta=function(){function t(t){this.iter=t}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),ea=new Xo(hi.comparator);function na(){return ea}var ra=new Xo(hi.comparator);function ia(){return ra}var oa=new Xo(hi.comparator);function aa(){return oa}var sa=new Zo(hi.comparator);function ua(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=sa,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var ca=new Zo(Vr);function la(){return ca}var ha=function(){function t(t,e,n,r,i){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,fa.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(Hr.min(),r,la(),na(),ua())},t}(),fa=function(){function t(t,e,n,r,i){this.resumeToken=t,this.current=e,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(ti.EMPTY_BYTE_STRING,n,ua(),ua(),ua())},t}(),da=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},pa=function(t,e){this.targetId=t,this.V=e},va=function(t,e,n,r){void 0===n&&(n=ti.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},ga=function(){function t(){this.S=0,this.D=_a(),this.C=ti.EMPTY_BYTE_STRING,this.N=!1,this.k=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"F",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.k},enumerable:!1,configurable:!0}),t.prototype.O=function(t){t.approximateByteSize()>0&&(this.k=!0,this.C=t)},t.prototype.M=function(){var t=ua(),e=ua(),n=ua();return this.D.forEach((function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Mr()}})),new fa(this.C,this.N,t,e,n)},t.prototype.L=function(){this.k=!1,this.D=_a()},t.prototype.B=function(t,e){this.k=!0,this.D=this.D.insert(t,e)},t.prototype.q=function(t){this.k=!0,this.D=this.D.remove(t)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.k=!0,this.N=!0},t}(),ya=function(){function t(t){this.W=t,this.G=new Map,this.H=na(),this.J=ma(),this.Y=new Zo(Vr)}return t.prototype.X=function(t){for(var e=0,n=t.v;e<n.length;e++){var r=n[e];t.P&&t.P.isFoundDocument()?this.Z(r,t.P):this.tt(r,t.key,t.P)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.tt(r,t.key,t.P)},t.prototype.et=function(t){var e=this;this.forEachTarget(t,(function(n){var r=e.nt(n);switch(t.state){case 0:e.st(n)&&r.O(t.resumeToken);break;case 1:r.K(),r.F||r.L(),r.O(t.resumeToken);break;case 2:r.K(),r.F||e.removeTarget(n);break;case 3:e.st(n)&&(r.j(),r.O(t.resumeToken));break;case 4:e.st(n)&&(e.it(n),r.O(t.resumeToken));break;default:Mr()}}))},t.prototype.forEachTarget=function(t,e){var n=this;t.targetIds.length>0?t.targetIds.forEach(e):this.G.forEach((function(t,r){n.st(r)&&e(r)}))},t.prototype.rt=function(t){var e=t.targetId,n=t.V.count,r=this.ot(e);if(r){var i=r.target;if(Di(i))if(0===n){var o=new hi(i.path);this.tt(e,o,Ai.newNoDocument(o,Hr.min()))}else Fr(1===n);else this.ct(e)!==n&&(this.it(e),this.Y=this.Y.add(e))}},t.prototype.ut=function(t){var e=this,n=new Map;this.G.forEach((function(r,i){var o=e.ot(i);if(o){if(r.current&&Di(o.target)){var a=new hi(o.target.path);null!==e.H.get(a)||e.at(i,a)||e.tt(i,a,Ai.newNoDocument(a,t))}r.$&&(n.set(i,r.M()),r.L())}}));var r=ua();this.J.forEach((function(t,n){var i=!0;n.forEachWhile((function(t){var n=e.ot(t);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(t))}));var i=new ha(t,n,this.Y,this.H,r);return this.H=na(),this.J=ma(),this.Y=new Zo(Vr),i},t.prototype.Z=function(t,e){if(this.st(t)){var n=this.at(t,e.key)?2:0;this.nt(t).B(e.key,n),this.H=this.H.insert(e.key,e),this.J=this.J.insert(e.key,this.ht(e.key).add(t))}},t.prototype.tt=function(t,e,n){if(this.st(t)){var r=this.nt(t);this.at(t,e)?r.B(e,1):r.q(e),this.J=this.J.insert(e,this.ht(e).delete(t)),n&&(this.H=this.H.insert(e,n))}},t.prototype.removeTarget=function(t){this.G.delete(t)},t.prototype.ct=function(t){var e=this.nt(t).M();return this.W.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size},t.prototype.U=function(t){this.nt(t).U()},t.prototype.nt=function(t){var e=this.G.get(t);return e||(e=new ga,this.G.set(t,e)),e},t.prototype.ht=function(t){var e=this.J.get(t);return e||(e=new Zo(Vr),this.J=this.J.insert(t,e)),e},t.prototype.st=function(t){var e=null!==this.ot(t);return e||Rr("WatchChangeAggregator","Detected inactive target",t),e},t.prototype.ot=function(t){var e=this.G.get(t);return e&&e.F?null:this.W.lt(t)},t.prototype.it=function(t){var e=this;this.G.set(t,new ga),this.W.getRemoteKeysForTarget(t).forEach((function(n){e.tt(t,n,null)}))},t.prototype.at=function(t,e){return this.W.getRemoteKeysForTarget(t).has(e)},t}();function ma(){return new Xo(hi.comparator)}function _a(){return new Xo(hi.comparator)}var ba={asc:"ASCENDING",desc:"DESCENDING"},wa={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Ia=function(t,e){this.databaseId=t,this.I=e};function Ta(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Ea(t,e){return t.I?e.toBase64():e.toUint8Array()}function Sa(t,e){return Ta(t,e.toTimestamp())}function Ca(t){return Fr(!!t),Hr.fromTimestamp(function(t){var e=ni(t);return new Wr(e.seconds,e.nanos)}(t))}function ka(t,e){return function(t){return new Xr(["projects",t.projectId,"databases",t.database])}(t).child("documents").child(e).canonicalString()}function Aa(t){var e=Xr.fromString(t);return Fr(Ja(e)),e}function Na(t,e){return ka(t.databaseId,e.path)}function Pa(t,e){var n=Aa(e);if(n.get(1)!==t.databaseId.projectId)throw new Nr(Ar.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Nr(Ar.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new hi(Oa(n))}function xa(t,e){return ka(t.databaseId,e)}function Ra(t){var e=Aa(t);return 4===e.length?Xr.emptyPath():Oa(e)}function Da(t){return new Xr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Oa(t){return Fr(t.length>4&&"documents"===t.get(4)),t.popFirst(5)}function La(t,e,n){return{name:Na(t,e),fields:n.value.mapValue.fields}}function Ma(t,e,n){var r=Pa(t,e.name),i=Ca(e.updateTime),o=new Ci({mapValue:{fields:e.fields}}),a=Ai.newFoundDocument(r,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function Fa(t,e){var n;if(e instanceof Uo)n={update:La(t,e.key,e.value)};else if(e instanceof Ho)n={delete:Na(t,e.key)};else if(e instanceof jo)n={update:La(t,e.key,e.data),updateMask:$a(e.fieldMask)};else{if(!(e instanceof Go))return Mr();n={verify:Na(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((function(t){return function(t,e){var n=e.transform;if(n instanceof bo)return{fieldPath:e.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof wo)return{fieldPath:e.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof To)return{fieldPath:e.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof So)return{fieldPath:e.field.canonicalString(),increment:n.A};throw Mr()}(0,t)}))),e.precondition.isNone||(n.currentDocument=function(t,e){return void 0!==e.updateTime?{updateTime:Sa(t,e.updateTime)}:void 0!==e.exists?{exists:e.exists}:Mr()}(t,e.precondition)),n}function Ua(t,e){var n=e.currentDocument?function(t){return void 0!==t.updateTime?Po.updateTime(Ca(t.updateTime)):void 0!==t.exists?Po.exists(t.exists):Po.none()}(e.currentDocument):Po.none(),r=e.updateTransforms?e.updateTransforms.map((function(e){return function(t,e){var n=null;if("setToServerValue"in e)Fr("REQUEST_TIME"===e.setToServerValue),n=new bo;else if("appendMissingElements"in e){var r=e.appendMissingElements.values||[];n=new wo(r)}else if("removeAllFromArray"in e){var i=e.removeAllFromArray.values||[];n=new To(i)}else"increment"in e?n=new So(t,e.increment):Mr();var o=Jr.fromServerFormat(e.fieldPath);return new Ao(o,n)}(t,e)})):[];if(e.update){e.update.name;var i=Pa(t,e.update.name),o=new Ci({mapValue:{fields:e.update.fields}});if(e.updateMask){var a=function(t){var e=t.fieldPaths||[];return new Zr(e.map((function(t){return Jr.fromServerFormat(t)})))}(e.updateMask);return new jo(i,o,a,n,r)}return new Uo(i,o,n,r)}if(e.delete){var s=Pa(t,e.delete);return new Ho(s,n)}if(e.verify){var u=Pa(t,e.verify);return new Go(u,n)}return Mr()}function ja(t,e){return{documents:[xa(t,e.path)]}}function qa(t,e){var n={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(n.parent=xa(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=xa(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(t){if(0!==t.length){var e=t.map((function(t){return function(t){if("=="===t.op){if(Ti(t.value))return{unaryFilter:{field:za(t.field),op:"IS_NAN"}};if(Ii(t.value))return{unaryFilter:{field:za(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ti(t.value))return{unaryFilter:{field:za(t.field),op:"IS_NOT_NAN"}};if(Ii(t.value))return{unaryFilter:{field:za(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:za(t.field),op:Ga(t.op),value:t.value}}}(t)}));return 1===e.length?e[0]:{compositeFilter:{op:"AND",filters:e}}}}(e.filters);i&&(n.structuredQuery.where=i);var o=function(t){if(0!==t.length)return t.map((function(t){return function(t){return{field:za(t.field),direction:Ha(t.dir)}}(t)}))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);var a=function(t,e){return t.I||ui(e)?e:{value:e}}(t,e.limit);return null!==a&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=Ka(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Ka(e.endAt)),n}function Va(t){var e=Ra(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){Fr(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var a=[];n.where&&(a=Ba(n.where));var s=[];n.orderBy&&(s=n.orderBy.map((function(t){return function(t){return new Hi(Qa(t.field),function(t){switch(t){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction))}(t)})));var u=null;n.limit&&(u=function(t){var e;return ui(e="object"==typeof t?t.value:t)?null:e}(n.limit));var c=null;n.startAt&&(c=Wa(n.startAt));var l=null;return n.endAt&&(l=Wa(n.endAt)),Xi(e,i,s,a,u,"F",c,l)}function Ba(t){return t?void 0!==t.unaryFilter?[Xa(t)]:void 0!==t.fieldFilter?[Ya(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map((function(t){return Ba(t)})).reduce((function(t,e){return t.concat(e)})):Mr():[]}function Ka(t){return{before:t.before,values:t.position}}function Wa(t){var e=!!t.before,n=t.values||[];return new Ki(n,e)}function Ha(t){return ba[t]}function Ga(t){return wa[t]}function za(t){return{fieldPath:t.canonicalString()}}function Qa(t){return Jr.fromServerFormat(t.fieldPath)}function Ya(t){return Oi.create(Qa(t.fieldFilter.field),function(t){switch(t){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Mr()}}(t.fieldFilter.op),t.fieldFilter.value)}function Xa(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Qa(t.unaryFilter.field);return Oi.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Qa(t.unaryFilter.field);return Oi.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Qa(t.unaryFilter.field);return Oi.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=Qa(t.unaryFilter.field);return Oi.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Mr()}}function $a(t){var e=[];return t.fields.forEach((function(t){return e.push(t.canonicalString())})),{fieldPaths:e}}function Ja(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)}function Za(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=es(e)),e=ts(t.get(n),e);return es(e)}function ts(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}function es(t){return t+""}function ns(t){var e=t.length;if(Fr(e>=2),2===e)return Fr(""===t.charAt(0)&&""===t.charAt(1)),Xr.emptyPath();for(var n=e-2,r=[],i="",o=0;o<e;){var a=t.indexOf("",o);switch((a<0||a>n)&&Mr(),t.charAt(a+1)){case"":var s=t.substring(o,a),u=void 0;0===i.length?u=s:(u=i+=s,i=""),r.push(u);break;case"":i+=t.substring(o,a),i+="\0";break;case"":i+=t.substring(o,a+1);break;default:Mr()}o=a+2}return new Xr(r)}var rs=function(t,e){this.seconds=t,this.nanoseconds=e},is=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};is.store="owner",is.key="owner";var os=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};os.store="mutationQueues",os.keyPath="userId";var as=function(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};as.store="mutations",as.keyPath="batchId",as.userMutationsIndex="userMutationsIndex",as.userMutationsKeyPath=["userId","batchId"];var ss=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,Za(e)]},t.key=function(t,e,n){return[t,Za(e),n]},t}();ss.store="documentMutations",ss.PLACEHOLDER=new ss;var us=function(t,e){this.path=t,this.readTime=e},cs=function(t,e){this.path=t,this.version=e},ls=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};ls.store="remoteDocuments",ls.readTimeIndex="readTimeIndex",ls.readTimeIndexPath="readTime",ls.collectionReadTimeIndex="collectionReadTimeIndex",ls.collectionReadTimeIndexPath=["parentPath","readTime"];var hs=function(t){this.byteSize=t};hs.store="remoteDocumentGlobal",hs.key="remoteDocumentGlobalKey";var fs=function(t,e,n,r,i,o,a){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=a};fs.store="targets",fs.keyPath="targetId",fs.queryTargetsIndexName="queryTargetsIndex",fs.queryTargetsKeyPath=["canonicalId","targetId"];var ds=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};ds.store="targetDocuments",ds.keyPath=["targetId","path"],ds.documentTargetsIndex="documentTargetsIndex",ds.documentTargetsKeyPath=["path","targetId"];var ps=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};ps.key="targetGlobalKey",ps.store="targetGlobal";var vs=function(t,e){this.collectionId=t,this.parent=e};vs.store="collectionParents",vs.keyPath=["collectionId","parent"];var gs=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};gs.store="clientMetadata",gs.keyPath="clientId";var ys=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};ys.store="bundles",ys.keyPath="bundleId";var ms=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};ms.store="namedQueries",ms.keyPath="name";var _s=(0,c.__spreadArray)((0,c.__spreadArray)([],(0,c.__spreadArray)((0,c.__spreadArray)([],(0,c.__spreadArray)((0,c.__spreadArray)([],(0,c.__spreadArray)((0,c.__spreadArray)([],[os.store,as.store,ss.store,ls.store,fs.store,is.store,ps.store,ds.store]),[gs.store])),[hs.store])),[vs.store])),[ys.store,ms.store]),bs="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ws=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(t){this.onCommittedListeners.push(t)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(t){return t()}))},t}(),Is=function(){var t=this;this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))},Ts=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)}),(function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)}))}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&Mr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}}))},t.prototype.toPromise=function(){var t=this;return new Promise((function(e,n){t.next(e,n)}))},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction((function(){return e(n)})):t.reject(n)},t.resolve=function(e){return new t((function(t,n){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.waitFor=function(e){return new t((function(t,n){var r=0,i=0,o=!1;e.forEach((function(e){++r,e.next((function(){++i,o&&i===r&&t()}),(function(t){return n(t)}))})),o=!0,i===r&&t()}))},t.or=function(e){for(var n=t.resolve(!1),r=function(e){n=n.next((function(n){return n?t.resolve(n):e()}))},i=0,o=e;i<o.length;i++)r(o[i]);return n},t.forEach=function(t,e){var n=this,r=[];return t.forEach((function(t,i){r.push(e.call(n,t,i))})),this.waitFor(r)},t}(),Es=function(){function t(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.ft=new Is,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){e.error?n.ft.reject(new ks(t,e.error)):n.ft.resolve()},this.transaction.onerror=function(e){var r=Rs(e.target.error);n.ft.reject(new ks(t,r))}}return t.open=function(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(e){throw new ks(n,e)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(t){t&&this.ft.reject(t),this.aborted||(Rr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return new Ns(e)},t}(),Ss=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,12.2===t._t((0,l.getUA)())&&Dr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(t){return Rr("SimpleDb","Removing database:",t),Ps(window.indexedDB.deleteDatabase(t)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=(0,l.getUA)(),n=t._t(e),r=0<n&&n<10,i=t.Et(e),o=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||o)},t.gt=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Tt)},t.It=function(t,e){return t.store(e)},t._t=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e,n=this;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(Rr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise((function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){var n=t.target.result;e(n)},i.onblocked=function(){r(new ks(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){var n=e.target.error;"VersionError"===n.name?r(new Nr(Ar.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new ks(t,n))},i.onupgradeneeded=function(t){Rr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.wt.Rt(e,i.transaction,t.oldVersion,n.version).next((function(){Rr("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(t){return n.bt(t)}),this.db)]}}))}))},t.prototype.vt=function(t){this.bt=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},t.prototype.runTransaction=function(t,e,n,r){return(0,c.__awaiter)(this,void 0,void 0,(function(){var i,o,a,s,u;return(0,c.__generator)(this,(function(l){switch(l.label){case 0:i="readonly"===e,o=0,a=function(){var e,a,u,l,h;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:++o,c.label=1;case 1:return c.trys.push([1,4,,5]),[4,s.At(t)];case 2:return s.db=c.sent(),e=Es.open(s.db,t,i?"readonly":"readwrite",n),a=r(e).catch((function(t){return e.abort(t),Ts.reject(t)})).toPromise(),u={},a.catch((function(){})),[4,e.dt];case 3:return[2,(u.value=(c.sent(),a),u)];case 4:return l=c.sent(),h="FirebaseError"!==l.name&&o<3,Rr("SimpleDb","Transaction failed with error:",l.message,"Retrying:",h),s.close(),h?[3,5]:[2,{value:Promise.reject(l)}];case 5:return[2]}}))},s=this,l.label=1;case 1:return[5,a()];case 2:if("object"==typeof(u=l.sent()))return[2,u.value];l.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),Cs=function(){function t(t){this.Pt=t,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.Pt=t},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(t){this.St=t},t.prototype.delete=function(){return Ps(this.Pt.delete())},t}(),ks=function(t){function e(e,n){var r=this;return(r=t.call(this,Ar.UNAVAILABLE,"IndexedDB transaction '"+e+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return(0,c.__extends)(e,t),e}(Nr);function As(t){return"IndexedDbTransactionError"===t.name}var Ns=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(Rr("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(Rr("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),Ps(n)},t.prototype.add=function(t){return Rr("SimpleDb","ADD",this.store.name,t,t),Ps(this.store.add(t))},t.prototype.get=function(t){var e=this;return Ps(this.store.get(t)).next((function(n){return void 0===n&&(n=null),Rr("SimpleDb","GET",e.store.name,t,n),n}))},t.prototype.delete=function(t){return Rr("SimpleDb","DELETE",this.store.name,t),Ps(this.store.delete(t))},t.prototype.count=function(){return Rr("SimpleDb","COUNT",this.store.name),Ps(this.store.count())},t.prototype.Nt=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.xt(n,(function(t,e){r.push(e)})).next((function(){return r}))},t.prototype.kt=function(t,e){Rr("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.Ft=!1;var r=this.cursor(n);return this.xt(r,(function(t,e,n){return n.delete()}))},t.prototype.$t=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.xt(r,e)},t.prototype.Ot=function(t){var e=this.cursor({});return new Ts((function(n,r){e.onerror=function(t){var e=Rs(t.target.error);r(e)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next((function(t){t?r.continue():n()})):n()}}))},t.prototype.xt=function(t,e){var n=[];return new Ts((function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(i){var o=new Cs(i),a=e(i.primaryKey,i.value,o);if(a instanceof Ts){var s=a.catch((function(t){return o.done(),Ts.reject(t)}));n.push(s)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}})).next((function(){return Ts.waitFor(n)}))},t.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.Ft?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}();function Ps(t){return new Ts((function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){var e=Rs(t.target.error);n(e)}}))}var xs=!1;function Rs(t){var e=Ss._t((0,l.getUA)());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new Nr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return xs||(xs=!0,setTimeout((function(){throw r}),0)),r}}return t}var Ds=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Mt=e,r.currentSequenceNumber=n,r}return(0,c.__extends)(e,t),e}(ws);function Os(t,e){var n=Ur(t);return Ss.It(n.Mt,e)}var Ls=function(){function t(t,e,n,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=n,this.mutations=r}return t.prototype.applyToRemoteDocument=function(t,e){for(var n=e.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t.key)&&Do(i,t,n[r])}},t.prototype.applyToLocalView=function(t){for(var e=0,n=this.baseMutations;e<n.length;e++)(o=n[e]).key.isEqual(t.key)&&Oo(o,t,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(t.key)&&Oo(o,t,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(t){var e=this;this.mutations.forEach((function(n){var r=t.get(n.key),i=r;e.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(Hr.min())}))},t.prototype.keys=function(){return this.mutations.reduce((function(t,e){return t.add(e.key)}),ua())},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&Br(this.mutations,t.mutations,(function(t,e){return Mo(t,e)}))&&Br(this.baseMutations,t.baseMutations,(function(t,e){return Mo(t,e)}))},t}(),Ms=function(){function t(t,e,n,r){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.docVersions=r}return t.from=function(e,n,r){Fr(e.mutations.length===r.length);for(var i=aa(),o=e.mutations,a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new t(e,n,r,i)},t}(),Fs=function(){function t(t,e,n,r,i,o,a){void 0===i&&(i=Hr.min()),void 0===o&&(o=Hr.min()),void 0===a&&(a=ti.EMPTY_BYTE_STRING),this.target=t,this.targetId=e,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),Us=function(t){this.Lt=t};function js(t,e){if(e.document)return Ma(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=hi.fromSegments(e.noDocument.path),r=Ws(e.noDocument.readTime),i=Ai.newNoDocument(n,r);return e.hasCommittedMutations?i.setHasCommittedMutations():i}if(e.unknownDocument){var o=hi.fromSegments(e.unknownDocument.path);return r=Ws(e.unknownDocument.version),Ai.newUnknownDocument(o,r)}return Mr()}function qs(t,e,n){var r=Vs(n),i=e.key.path.popLast().toArray();if(e.isFoundDocument()){var o=function(t,e){return{name:Na(t,e.key),fields:e.data.value.mapValue.fields,updateTime:Ta(t,e.version.toTimestamp())}}(t.Lt,e),a=e.hasCommittedMutations;return new ls(null,null,o,a,r,i)}if(e.isNoDocument()){var s=e.key.path.toArray(),u=Ks(e.version);return a=e.hasCommittedMutations,new ls(null,new us(s,u),null,a,r,i)}if(e.isUnknownDocument()){var c=e.key.path.toArray(),l=Ks(e.version);return new ls(new cs(c,l),null,null,!0,r,i)}return Mr()}function Vs(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Bs(t){var e=new Wr(t[0],t[1]);return Hr.fromTimestamp(e)}function Ks(t){var e=t.toTimestamp();return new rs(e.seconds,e.nanoseconds)}function Ws(t){var e=new Wr(t.seconds,t.nanoseconds);return Hr.fromTimestamp(e)}function Hs(t,e){for(var n=(e.baseMutations||[]).map((function(e){return Ua(t.Lt,e)})),r=0;r<e.mutations.length-1;++r){var i=e.mutations[r];if(r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform){var o=e.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var a=e.mutations.map((function(e){return Ua(t.Lt,e)})),s=Wr.fromMillis(e.localWriteTimeMs);return new Ls(e.batchId,s,n,a)}function Gs(t){var e,n,r=Ws(t.readTime),i=void 0!==t.lastLimboFreeSnapshotVersion?Ws(t.lastLimboFreeSnapshotVersion):Hr.min();return void 0!==t.query.documents?(Fr(1===(n=t.query).documents.length),e=io($i(Ra(n.documents[0])))):e=function(t){return io(Va(t))}(t.query),new Fs(e,t.targetId,0,t.lastListenSequenceNumber,r,i,ti.fromBase64String(t.resumeToken))}function zs(t,e){var n,r=Ks(e.snapshotVersion),i=Ks(e.lastLimboFreeSnapshotVersion);n=Di(e.target)?ja(t.Lt,e.target):qa(t.Lt,e.target);var o=e.resumeToken.toBase64();return new fs(e.targetId,xi(e.target),r,o,e.sequenceNumber,i,n)}function Qs(t){var e=Va({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?oo(e,e.limit,"L"):e}var Ys=function(){function t(){}return t.prototype.getBundleMetadata=function(t,e){return Xs(t).get(e).next((function(t){if(t)return{id:(e=t).bundleId,createTime:Ws(e.createTime),version:e.version};var e}))},t.prototype.saveBundleMetadata=function(t,e){return Xs(t).put({bundleId:(n=e).id,createTime:Ks(Ca(n.createTime)),version:n.version});var n},t.prototype.getNamedQuery=function(t,e){return $s(t).get(e).next((function(t){if(t)return{name:(e=t).name,query:Qs(e.bundledQuery),readTime:Ws(e.readTime)};var e}))},t.prototype.saveNamedQuery=function(t,e){return $s(t).put(function(t){return{name:t.name,readTime:Ks(Ca(t.readTime)),bundledQuery:t.bundledQuery}}(e))},t}();function Xs(t){return Os(t,ys.store)}function $s(t){return Os(t,ms.store)}var Js=function(){function t(){this.Bt=new Zs}return t.prototype.addToCollectionParentIndex=function(t,e){return this.Bt.add(e),Ts.resolve()},t.prototype.getCollectionParents=function(t,e){return Ts.resolve(this.Bt.getEntries(e))},t}(),Zs=function(){function t(){this.index={}}return t.prototype.add=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e]||new Zo(Xr.comparator),i=!r.has(n);return this.index[e]=r.add(n),i},t.prototype.has=function(t){var e=t.lastSegment(),n=t.popLast(),r=this.index[e];return r&&r.has(n)},t.prototype.getEntries=function(t){return(this.index[t]||new Zo(Xr.comparator)).toArray()},t}(),tu=function(){function t(){this.qt=new Zs}return t.prototype.addToCollectionParentIndex=function(t,e){var n=this;if(!this.qt.has(e)){var r=e.lastSegment(),i=e.popLast();t.addOnCommittedListener((function(){n.qt.add(e)}));var o={collectionId:r,parent:Za(i)};return eu(t).put(o)}return Ts.resolve()},t.prototype.getCollectionParents=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Kr(e),""],!1,!0);return eu(t).Nt(r).next((function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(ns(o.parent))}return n}))},t}();function eu(t){return Os(t,vs.store)}var nu={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},ru=function(){function t(t,e,n){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=n}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();function iu(t,e,n){var r=t.store(as.store),i=t.store(ss.store),o=[],a=IDBKeyRange.only(n.batchId),s=0,u=r.$t({range:a},(function(t,e,n){return s++,n.delete()}));o.push(u.next((function(){Fr(1===s)})));for(var c=[],l=0,h=n.mutations;l<h.length;l++){var f=h[l],d=ss.key(e,f.key.path,n.batchId);o.push(i.delete(d)),c.push(f.key)}return Ts.waitFor(o).next((function(){return c}))}function ou(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Mr();e=t.noDocument}return JSON.stringify(e).length}ru.DEFAULT_COLLECTION_PERCENTILE=10,ru.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ru.DEFAULT=new ru(41943040,ru.DEFAULT_COLLECTION_PERCENTILE,ru.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ru.DISABLED=new ru(-1,0,0);var au=function(){function t(t,e,n,r){this.userId=t,this.R=e,this.Ut=n,this.referenceDelegate=r,this.Kt={}}return t.Qt=function(e,n,r,i){return Fr(""!==e.uid),new t(e.isAuthenticated()?e.uid:"",n,r,i)},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return uu(t).$t({index:as.userMutationsIndex,range:n},(function(t,n,r){e=!1,r.done()})).next((function(){return e}))},t.prototype.addMutationBatch=function(t,e,n,r){var i=this,o=cu(t),a=uu(t);return a.add({}).next((function(s){Fr("number"==typeof s);for(var u=new Ls(s,e,n,r),c=function(t,e,n){var r=n.baseMutations.map((function(e){return Fa(t.Lt,e)})),i=n.mutations.map((function(e){return Fa(t.Lt,e)}));return new as(e,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,u),l=[],h=new Zo((function(t,e){return Vr(t.canonicalString(),e.canonicalString())})),f=0,d=r;f<d.length;f++){var p=d[f],v=ss.key(i.userId,p.key.path,s);h=h.add(p.key.path.popLast()),l.push(a.put(c)),l.push(o.put(v,ss.PLACEHOLDER))}return h.forEach((function(e){l.push(i.Ut.addToCollectionParentIndex(t,e))})),t.addOnCommittedListener((function(){i.Kt[s]=u.keys()})),Ts.waitFor(l).next((function(){return u}))}))},t.prototype.lookupMutationBatch=function(t,e){var n=this;return uu(t).get(e).next((function(t){return t?(Fr(t.userId===n.userId),Hs(n.R,t)):null}))},t.prototype.jt=function(t,e){var n=this;return this.Kt[e]?Ts.resolve(this.Kt[e]):this.lookupMutationBatch(t,e).next((function(t){if(t){var r=t.keys();return n.Kt[e]=r,r}return null}))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=e+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return uu(t).$t({index:as.userMutationsIndex,range:i},(function(t,e,i){e.userId===n.userId&&(Fr(e.batchId>=r),o=Hs(n.R,e)),i.done()})).next((function(){return o}))},t.prototype.getHighestUnacknowledgedBatchId=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return uu(t).$t({index:as.userMutationsIndex,range:e,reverse:!0},(function(t,e,r){n=e.batchId,r.done()})).next((function(){return n}))},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return uu(t).Nt(as.userMutationsIndex,n).next((function(t){return t.map((function(t){return Hs(e.R,t)}))}))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=ss.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return cu(t).$t({range:i},(function(r,i,a){var s=r[0],u=r[1],c=r[2],l=ns(u);if(s===n.userId&&e.path.isEqual(l))return uu(t).get(c).next((function(t){if(!t)throw Mr();Fr(t.userId===n.userId),o.push(Hs(n.R,t))}));a.done()})).next((function(){return o}))},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Zo(Vr),i=[];return e.forEach((function(e){var o=ss.prefixForPath(n.userId,e.path),a=IDBKeyRange.lowerBound(o),s=cu(t).$t({range:a},(function(t,i,o){var a=t[0],s=t[1],u=t[2],c=ns(s);a===n.userId&&e.path.isEqual(c)?r=r.add(u):o.done()}));i.push(s)})),Ts.waitFor(i).next((function(){return n.Wt(t,r)}))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=ss.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new Zo(Vr);return cu(t).$t({range:a},(function(t,e,o){var a=t[0],u=t[1],c=t[2],l=ns(u);a===n.userId&&r.isPrefixOf(l)?l.length===i&&(s=s.add(c)):o.done()})).next((function(){return n.Wt(t,s)}))},t.prototype.Wt=function(t,e){var n=this,r=[],i=[];return e.forEach((function(e){i.push(uu(t).get(e).next((function(t){if(null===t)throw Mr();Fr(t.userId===n.userId),r.push(Hs(n.R,t))})))})),Ts.waitFor(i).next((function(){return r}))},t.prototype.removeMutationBatch=function(t,e){var n=this;return iu(t.Mt,this.userId,e).next((function(r){return t.addOnCommittedListener((function(){n.Gt(e.batchId)})),Ts.forEach(r,(function(e){return n.referenceDelegate.markPotentiallyOrphaned(t,e)}))}))},t.prototype.Gt=function(t){delete this.Kt[t]},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next((function(n){if(!n)return Ts.resolve();var r=IDBKeyRange.lowerBound(ss.prefixForUser(e.userId)),i=[];return cu(t).$t({range:r},(function(t,n,r){if(t[0]===e.userId){var o=ns(t[1]);i.push(o)}else r.done()})).next((function(){Fr(0===i.length)}))}))},t.prototype.containsKey=function(t,e){return su(t,this.userId,e)},t.prototype.zt=function(t){var e=this;return lu(t).get(this.userId).next((function(t){return t||new os(e.userId,-1,"")}))},t}();function su(t,e,n){var r=ss.prefixForPath(e,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return cu(t).$t({range:o,Ft:!0},(function(t,n,r){var o=t[0],s=t[1];t[2],o===e&&s===i&&(a=!0),r.done()})).next((function(){return a}))}function uu(t){return Os(t,as.store)}function cu(t){return Os(t,ss.store)}function lu(t){return Os(t,os.store)}var hu=function(){function t(t){this.Ht=t}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),fu=function(){function t(t,e){this.referenceDelegate=t,this.R=e}return t.prototype.allocateTargetId=function(t){var e=this;return this.Xt(t).next((function(n){var r=new hu(n.highestTargetId);return n.highestTargetId=r.next(),e.Zt(t,n).next((function(){return n.highestTargetId}))}))},t.prototype.getLastRemoteSnapshotVersion=function(t){return this.Xt(t).next((function(t){return Hr.fromTimestamp(new Wr(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))}))},t.prototype.getHighestSequenceNumber=function(t){return this.Xt(t).next((function(t){return t.highestListenSequenceNumber}))},t.prototype.setTargetsMetadata=function(t,e,n){var r=this;return this.Xt(t).next((function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Zt(t,i)}))},t.prototype.addTargetData=function(t,e){var n=this;return this.te(t,e).next((function(){return n.Xt(t).next((function(r){return r.targetCount+=1,n.ee(e,r),n.Zt(t,r)}))}))},t.prototype.updateTargetData=function(t,e){return this.te(t,e)},t.prototype.removeTargetData=function(t,e){var n=this;return this.removeMatchingKeysForTargetId(t,e.targetId).next((function(){return du(t).delete(e.targetId)})).next((function(){return n.Xt(t)})).next((function(e){return Fr(e.targetCount>0),e.targetCount-=1,n.Zt(t,e)}))},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return du(t).$t((function(a,s){var u=Gs(s);u.sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.removeTargetData(t,u)))})).next((function(){return Ts.waitFor(o)})).next((function(){return i}))},t.prototype.forEachTarget=function(t,e){return du(t).$t((function(t,n){var r=Gs(n);e(r)}))},t.prototype.Xt=function(t){return pu(t).get(ps.key).next((function(t){return Fr(null!==t),t}))},t.prototype.Zt=function(t,e){return pu(t).put(ps.key,e)},t.prototype.te=function(t,e){return du(t).put(zs(this.R,e))},t.prototype.ee=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},t.prototype.getTargetCount=function(t){return this.Xt(t).next((function(t){return t.targetCount}))},t.prototype.getTargetData=function(t,e){var n=xi(e),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return du(t).$t({range:r,index:fs.queryTargetsIndexName},(function(t,n,r){var o=Gs(n);Ri(e,o.target)&&(i=o,r.done())})).next((function(){return i}))},t.prototype.addMatchingKeys=function(t,e,n){var r=this,i=[],o=vu(t);return e.forEach((function(e){var a=Za(e.path);i.push(o.put(new ds(n,a))),i.push(r.referenceDelegate.addReference(t,n,e))})),Ts.waitFor(i)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=vu(t);return Ts.forEach(e,(function(e){var o=Za(e.path);return Ts.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(t,n,e)])}))},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=vu(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=vu(t),i=ua();return r.$t({range:n,Ft:!0},(function(t,e,n){var r=ns(t[1]),o=new hi(r);i=i.add(o)})).next((function(){return i}))},t.prototype.containsKey=function(t,e){var n=Za(e.path),r=IDBKeyRange.bound([n],[Kr(n)],!1,!0),i=0;return vu(t).$t({index:ds.documentTargetsIndex,Ft:!0,range:r},(function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},t.prototype.lt=function(t,e){return du(t).get(e).next((function(t){return t?Gs(t):null}))},t}();function du(t){return Os(t,fs.store)}function pu(t){return Os(t,ps.store)}function vu(t){return Os(t,ds.store)}function gu(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){return(0,c.__generator)(this,(function(e){if(t.code!==Ar.FAILED_PRECONDITION||t.message!==bs)throw t;return Rr("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}function yu(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],a=Vr(n,i);return 0===a?Vr(r,o):a}var mu=function(){function t(t){this.ne=t,this.buffer=new Zo(yu),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(t){var e=[t,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();yu(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),_u=function(){function t(t,e){this.garbageCollector=t,this.asyncQueue=e,this.oe=!1,this.ce=null}return t.prototype.start=function(t){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(t)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),t.prototype.ue=function(t){var e=this,n=this.oe?3e5:6e4;Rr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,(function(){return(0,c.__awaiter)(e,void 0,void 0,(function(){var e;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return As(e=n.sent())?(Rr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,gu(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(t)];case 8:return n.sent(),[2]}}))}))}))},t}(),bu=function(){function t(t,e){this.ae=t,this.params=e}return t.prototype.calculateTargetCount=function(t,e){return this.ae.he(t).next((function(t){return Math.floor(e/100*t)}))},t.prototype.nthSequenceNumber=function(t,e){var n=this;if(0===e)return Ts.resolve(kr.o);var r=new mu(e);return this.ae.forEachTarget(t,(function(t){return r.re(t.sequenceNumber)})).next((function(){return n.ae.le(t,(function(t){return r.re(t)}))})).next((function(){return r.maxValue}))},t.prototype.removeTargets=function(t,e,n){return this.ae.removeTargets(t,e,n)},t.prototype.removeOrphanedDocuments=function(t,e){return this.ae.removeOrphanedDocuments(t,e)},t.prototype.collect=function(t,e){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(Rr("LruGarbageCollector","Garbage collection skipped; disabled"),Ts.resolve(nu)):this.getCacheSize(t).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(Rr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),nu):n.fe(t,e)}))},t.prototype.getCacheSize=function(t){return this.ae.getCacheSize(t)},t.prototype.fe=function(t,e){var n,r,i,o,a,s,u,c=this,l=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((function(e){return e>c.params.maximumSequenceNumbersToCollect?(Rr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+c.params.maximumSequenceNumbersToCollect+" from "+e),r=c.params.maximumSequenceNumbersToCollect):r=e,o=Date.now(),c.nthSequenceNumber(t,r)})).next((function(r){return n=r,a=Date.now(),c.removeTargets(t,n,e)})).next((function(e){return i=e,s=Date.now(),c.removeOrphanedDocuments(t,n)})).next((function(t){return u=Date.now(),xr()<=h.LogLevel.DEBUG&&Rr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(o-l)+"ms\n\tDetermined least recently used "+r+" in "+(a-o)+"ms\n\tRemoved "+i+" targets in "+(s-a)+"ms\n\tRemoved "+t+" documents in "+(u-s)+"ms\nTotal Duration: "+(u-l)+"ms"),Ts.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:t})}))},t}(),wu=function(){function t(t,e){this.db=t,this.garbageCollector=function(t,e){return new bu(t,e)}(this,e)}return t.prototype.he=function(t){var e=this.de(t);return this.db.getTargetCache().getTargetCount(t).next((function(t){return e.next((function(e){return t+e}))}))},t.prototype.de=function(t){var e=0;return this.le(t,(function(t){e++})).next((function(){return e}))},t.prototype.forEachTarget=function(t,e){return this.db.getTargetCache().forEachTarget(t,e)},t.prototype.le=function(t,e){return this.we(t,(function(t,n){return e(n)}))},t.prototype.addReference=function(t,e,n){return Iu(t,n)},t.prototype.removeReference=function(t,e,n){return Iu(t,n)},t.prototype.removeTargets=function(t,e,n){return this.db.getTargetCache().removeTargets(t,e,n)},t.prototype.markPotentiallyOrphaned=function(t,e){return Iu(t,e)},t.prototype._e=function(t,e){return function(t,e){var n=!1;return lu(t).Ot((function(r){return su(t,r,e).next((function(t){return t&&(n=!0),Ts.resolve(!t)}))})).next((function(){return n}))}(t,e)},t.prototype.removeOrphanedDocuments=function(t,e){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(t,(function(a,s){if(s<=e){var u=n._e(t,a).next((function(e){if(!e)return o++,r.getEntry(t,a).next((function(){return r.removeEntry(a),vu(t).delete([0,Za(a.path)])}))}));i.push(u)}})).next((function(){return Ts.waitFor(i)})).next((function(){return r.apply(t)})).next((function(){return o}))},t.prototype.removeTarget=function(t,e){var n=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,n)},t.prototype.updateLimboDocument=function(t,e){return Iu(t,e)},t.prototype.we=function(t,e){var n,r=vu(t),i=kr.o;return r.$t({index:ds.documentTargetsIndex},(function(t,r){var o=t[0];t[1];var a=r.path,s=r.sequenceNumber;0===o?(i!==kr.o&&e(new hi(ns(n)),i),i=s,n=a):i=kr.o})).next((function(){i!==kr.o&&e(new hi(ns(n)),i)}))},t.prototype.getCacheSize=function(t){return this.db.getRemoteDocumentCache().getSize(t)},t}();function Iu(t,e){return vu(t).put(function(t,e){return new ds(0,Za(t.path),e)}(e,t.currentSequenceNumber))}var Tu=function(){function t(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];if(this.equalsFn(a,t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.inner[n]=[[t,e]]},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){zr(this.inner,(function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];t(a,s)}}))},t.prototype.isEmpty=function(){return Qr(this.inner)},t}(),Eu=function(){function t(){this.changes=new Tu((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),this.changesApplied=!1}return t.prototype.getReadTime=function(t){var e=this.changes.get(t);return e?e.readTime:Hr.min()},t.prototype.addEntry=function(t,e){this.assertNotApplied(),this.changes.set(t.key,{document:t,readTime:e})},t.prototype.removeEntry=function(t,e){void 0===e&&(e=null),this.assertNotApplied(),this.changes.set(t,{document:Ai.newInvalidDocument(t),readTime:e})},t.prototype.getEntry=function(t,e){this.assertNotApplied();var n=this.changes.get(e);return void 0!==n?Ts.resolve(n.document):this.getFromCache(t,e)},t.prototype.getEntries=function(t,e){return this.getAllFromCache(t,e)},t.prototype.apply=function(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)},t.prototype.assertNotApplied=function(){},t}(),Su=function(){function t(t,e){this.R=t,this.Ut=e}return t.prototype.addEntry=function(t,e,n){return Au(t).put(Nu(e),n)},t.prototype.removeEntry=function(t,e){var n=Au(t),r=Nu(e);return n.delete(r)},t.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next((function(r){return r.byteSize+=e,n.me(t,r)}))},t.prototype.getEntry=function(t,e){var n=this;return Au(t).get(Nu(e)).next((function(t){return n.ye(e,t)}))},t.prototype.ge=function(t,e){var n=this;return Au(t).get(Nu(e)).next((function(t){return{document:n.ye(e,t),size:ou(t)}}))},t.prototype.getEntries=function(t,e){var n=this,r=na();return this.pe(t,e,(function(t,e){var i=n.ye(t,e);r=r.insert(t,i)})).next((function(){return r}))},t.prototype.Ee=function(t,e){var n=this,r=na(),i=new Xo(hi.comparator);return this.pe(t,e,(function(t,e){var o=n.ye(t,e);r=r.insert(t,o),i=i.insert(t,ou(e))})).next((function(){return{documents:r,Te:i}}))},t.prototype.pe=function(t,e,n){if(e.isEmpty())return Ts.resolve();var r=IDBKeyRange.bound(e.first().path.toArray(),e.last().path.toArray()),i=e.getIterator(),o=i.getNext();return Au(t).$t({range:r},(function(t,e,r){for(var a=hi.fromSegments(t);o&&hi.comparator(o,a)<0;)n(o,null),o=i.getNext();o&&o.isEqual(a)&&(n(o,e),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){var r=this,i=na(),o=e.path.length+1,a={};if(n.isEqual(Hr.min())){var s=e.path.toArray();a.range=IDBKeyRange.lowerBound(s)}else{var u=e.path.toArray(),c=Vs(n);a.range=IDBKeyRange.lowerBound([u,c],!0),a.index=ls.collectionReadTimeIndex}return Au(t).$t(a,(function(t,n,a){if(t.length===o){var s=js(r.R,n);e.path.isPrefixOf(s.key.path)?co(e,s)&&(i=i.insert(s.key,s)):a.done()}})).next((function(){return i}))},t.prototype.newChangeBuffer=function(t){return new Cu(this,!!t&&t.trackRemovals)},t.prototype.getSize=function(t){return this.getMetadata(t).next((function(t){return t.byteSize}))},t.prototype.getMetadata=function(t){return ku(t).get(hs.key).next((function(t){return Fr(!!t),t}))},t.prototype.me=function(t,e){return ku(t).put(hs.key,e)},t.prototype.ye=function(t,e){if(e){var n=js(this.R,e);if(!n.isNoDocument()||!n.version.isEqual(Hr.min()))return n}return Ai.newInvalidDocument(t)},t}(),Cu=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).Ie=e,r.trackRemovals=n,r.Ae=new Tu((function(t){return t.toString()}),(function(t,e){return t.isEqual(e)})),r}return(0,c.__extends)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[],r=0,i=new Zo((function(t,e){return Vr(t.canonicalString(),e.canonicalString())}));return this.changes.forEach((function(o,a){var s=e.Ae.get(o);if(a.document.isValidDocument()){var u=qs(e.Ie.R,a.document,e.getReadTime(o));i=i.add(o.path.popLast());var c=ou(u);r+=c-s,n.push(e.Ie.addEntry(t,o,u))}else if(r-=s,e.trackRemovals){var l=qs(e.Ie.R,Ai.newNoDocument(o,Hr.min()),e.getReadTime(o));n.push(e.Ie.addEntry(t,o,l))}else n.push(e.Ie.removeEntry(t,o))})),i.forEach((function(r){n.push(e.Ie.Ut.addToCollectionParentIndex(t,r))})),n.push(this.Ie.updateMetadata(t,r)),Ts.waitFor(n)},e.prototype.getFromCache=function(t,e){var n=this;return this.Ie.ge(t,e).next((function(t){return n.Ae.set(e,t.size),t.document}))},e.prototype.getAllFromCache=function(t,e){var n=this;return this.Ie.Ee(t,e).next((function(t){var e=t.documents;return t.Te.forEach((function(t,e){n.Ae.set(t,e)})),e}))},e}(Eu);function ku(t){return Os(t,hs.store)}function Au(t){return Os(t,ls.store)}function Nu(t){return t.path.toArray()}var Pu=function(){function t(t){this.R=t}return t.prototype.Rt=function(t,e,n,r){var i=this;Fr(n<r&&n>=0&&r<=11);var o=new Es("createOrUpgrade",e);n<1&&r>=1&&(function(t){t.createObjectStore(is.store)}(t),function(t){t.createObjectStore(os.store,{keyPath:os.keyPath}),t.createObjectStore(as.store,{keyPath:as.keyPath,autoIncrement:!0}).createIndex(as.userMutationsIndex,as.userMutationsKeyPath,{unique:!0}),t.createObjectStore(ss.store)}(t),xu(t),function(t){t.createObjectStore(ls.store)}(t));var a=Ts.resolve();return n<3&&r>=3&&(0!==n&&(function(t){t.deleteObjectStore(ds.store),t.deleteObjectStore(fs.store),t.deleteObjectStore(ps.store)}(t),xu(t)),a=a.next((function(){return function(t){var e=t.store(ps.store),n=new ps(0,0,Hr.min().toTimestamp(),0);return e.put(ps.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(a=a.next((function(){return function(t,e){return e.store(as.store).Nt().next((function(n){t.deleteObjectStore(as.store),t.createObjectStore(as.store,{keyPath:as.keyPath,autoIncrement:!0}).createIndex(as.userMutationsIndex,as.userMutationsKeyPath,{unique:!0});var r=e.store(as.store),i=n.map((function(t){return r.put(t)}));return Ts.waitFor(i)}))}(t,o)}))),a=a.next((function(){!function(t){t.createObjectStore(gs.store,{keyPath:gs.keyPath})}(t)}))),n<5&&r>=5&&(a=a.next((function(){return i.Re(o)}))),n<6&&r>=6&&(a=a.next((function(){return function(t){t.createObjectStore(hs.store)}(t),i.be(o)}))),n<7&&r>=7&&(a=a.next((function(){return i.ve(o)}))),n<8&&r>=8&&(a=a.next((function(){return i.Pe(t,o)}))),n<9&&r>=9&&(a=a.next((function(){!function(t){t.objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges")}(t),function(t){var e=t.objectStore(ls.store);e.createIndex(ls.readTimeIndex,ls.readTimeIndexPath,{unique:!1}),e.createIndex(ls.collectionReadTimeIndex,ls.collectionReadTimeIndexPath,{unique:!1})}(e)}))),n<10&&r>=10&&(a=a.next((function(){return i.Ve(o)}))),n<11&&r>=11&&(a=a.next((function(){!function(t){t.createObjectStore(ys.store,{keyPath:ys.keyPath})}(t),function(t){t.createObjectStore(ms.store,{keyPath:ms.keyPath})}(t)}))),a},t.prototype.be=function(t){var e=0;return t.store(ls.store).$t((function(t,n){e+=ou(n)})).next((function(){var n=new hs(e);return t.store(hs.store).put(hs.key,n)}))},t.prototype.Re=function(t){var e=this,n=t.store(os.store),r=t.store(as.store);return n.Nt().next((function(n){return Ts.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(as.userMutationsIndex,i).next((function(r){return Ts.forEach(r,(function(r){Fr(r.userId===n.userId);var i=Hs(e.R,r);return iu(t,n.userId,i).next((function(){}))}))}))}))}))},t.prototype.ve=function(t){var e=t.store(ds.store),n=t.store(ls.store);return t.store(ps.store).get(ps.key).next((function(t){var r=[];return n.$t((function(n,i){var o=new Xr(n),a=function(t){return[0,Za(t)]}(o);r.push(e.get(a).next((function(n){return n?Ts.resolve():function(n){return e.put(new ds(0,Za(n),t.highestListenSequenceNumber))}(o)})))})).next((function(){return Ts.waitFor(r)}))}))},t.prototype.Pe=function(t,e){t.createObjectStore(vs.store,{keyPath:vs.keyPath});var n=e.store(vs.store),r=new Zs,i=function(t){if(r.add(t)){var e=t.lastSegment(),i=t.popLast();return n.put({collectionId:e,parent:Za(i)})}};return e.store(ls.store).$t({Ft:!0},(function(t,e){var n=new Xr(t);return i(n.popLast())})).next((function(){return e.store(ss.store).$t({Ft:!0},(function(t,e){t[0];var n=t[1];t[2];var r=ns(n);return i(r.popLast())}))}))},t.prototype.Ve=function(t){var e=this,n=t.store(fs.store);return n.$t((function(t,r){var i=Gs(r),o=zs(e.R,i);return n.put(o)}))},t}();function xu(t){t.createObjectStore(ds.store,{keyPath:ds.keyPath}).createIndex(ds.documentTargetsIndex,ds.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(fs.store,{keyPath:fs.keyPath}).createIndex(fs.queryTargetsIndexName,fs.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(ps.store)}var Ru="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Du=function(){function t(e,n,r,i,o,a,s,u,c,l){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=a,this.document=s,this.De=c,this.Ce=l,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ke=null,this.inForeground=!1,this.Fe=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(t){return Promise.resolve()},!t.yt())throw new Nr(Ar.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new wu(this,i),this.Le=n+"main",this.R=new Us(u),this.Be=new Ss(this.Le,11,new Pu(this.R)),this.qe=new fu(this.referenceDelegate,this.R),this.Ut=new tu,this.Ue=function(t,e){return new Su(t,e)}(this.R,this.Ut),this.Ke=new Ys,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,!1===l&&Dr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var t=this;return this.je().then((function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Nr(Ar.FAILED_PRECONDITION,Ru);return t.We(),t.Ge(),t.ze(),t.runTransaction("getHighestListenSequenceNumber","readonly",(function(e){return t.qe.getHighestSequenceNumber(e)}))})).then((function(e){t.Ne=new kr(e,t.De)})).then((function(){t.xe=!0})).catch((function(e){return t.Be&&t.Be.close(),Promise.reject(e)}))},t.prototype.He=function(t){var e=this;return this.Me=function(n){return(0,c.__awaiter)(e,void 0,void 0,(function(){return(0,c.__generator)(this,(function(e){return this.started?[2,t(n)]:[2]}))}))},t(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(t){var e=this;this.Be.vt((function(n){return(0,c.__awaiter)(e,void 0,void 0,(function(){return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))},t.prototype.setNetworkEnabled=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Se.enqueueAndForget((function(){return(0,c.__awaiter)(e,void 0,void 0,(function(){return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))})))},t.prototype.je=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(e){return Lu(e).put(new gs(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next((function(){if(t.isPrimary)return t.Je(e).next((function(e){e||(t.isPrimary=!1,t.Se.enqueueRetryable((function(){return t.Me(!1)})))}))})).next((function(){return t.Ye(e)})).next((function(n){return t.isPrimary&&!n?t.Xe(e).next((function(){return!1})):!!n&&t.Ze(e).next((function(){return!0}))}))})).catch((function(e){if(As(e))return Rr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Rr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((function(e){t.isPrimary!==e&&t.Se.enqueueRetryable((function(){return t.Me(e)})),t.isPrimary=e}))},t.prototype.Je=function(t){var e=this;return Ou(t).get(is.key).next((function(t){return Ts.resolve(e.tn(t))}))},t.prototype.en=function(t){return Lu(t).delete(this.clientId)},t.prototype.nn=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r,i=this;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(t){var e=Os(t,gs.store);return e.Nt().next((function(t){var n=i.rn(t,18e5),r=t.filter((function(t){return-1===n.indexOf(t)}));return Ts.forEach(r,(function(t){return e.delete(t.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(t=o.sent(),this.Qe)for(e=0,n=t;e<n.length;e++)r=n[e],this.Qe.removeItem(this.on(r.clientId));o.label=2;case 2:return[2]}}))}))},t.prototype.ze=function(){var t=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return t.je().then((function(){return t.nn()})).then((function(){return t.ze()}))}))},t.prototype.tn=function(t){return!!t&&t.ownerId===this.clientId},t.prototype.Ye=function(t){var e=this;return this.Ce?Ts.resolve(!0):Ou(t).get(is.key).next((function(n){if(null!==n&&e.sn(n.leaseTimestampMs,5e3)&&!e.cn(n.ownerId)){if(e.tn(n)&&e.networkEnabled)return!0;if(!e.tn(n)){if(!n.allowTabSynchronization)throw new Nr(Ar.FAILED_PRECONDITION,Ru);return!1}}return!(!e.networkEnabled||!e.inForeground)||Lu(t).Nt().next((function(t){return void 0===e.rn(t,5e3).find((function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground,i=e.networkEnabled===t.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(t){return e.isPrimary!==t&&Rr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t}))},t.prototype.shutdown=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){var t=this;return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[is.store,gs.store],(function(e){var n=new Ds(e,kr.o);return t.Xe(n).next((function(){return t.en(n)}))}))];case 1:return e.sent(),this.Be.close(),this.ln(),[2]}}))}))},t.prototype.rn=function(t,e){var n=this;return t.filter((function(t){return n.sn(t.updateTimeMs,e)&&!n.cn(t.clientId)}))},t.prototype.fn=function(){var t=this;return this.runTransaction("getActiveClients","readonly",(function(e){return Lu(e).Nt().next((function(e){return t.rn(e,18e5).map((function(t){return t.clientId}))}))}))},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(t){return au.Qt(t,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;Rr("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.Be.runTransaction(t,o,_s,(function(o){return i=new Ds(o,r.Ne?r.Ne.next():kr.o),"readwrite-primary"===e?r.Je(i).next((function(t){return!!t||r.Ye(i)})).next((function(e){if(!e)throw Dr("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Se.enqueueRetryable((function(){return r.Me(!1)})),new Nr(Ar.FAILED_PRECONDITION,bs);return n(i)})).next((function(t){return r.Ze(i).next((function(){return t}))})):r.dn(i).next((function(){return n(i)}))})).then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.dn=function(t){var e=this;return Ou(t).get(is.key).next((function(t){if(null!==t&&e.sn(t.leaseTimestampMs,5e3)&&!e.cn(t.ownerId)&&!e.tn(t)&&!(e.Ce||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Nr(Ar.FAILED_PRECONDITION,Ru)}))},t.prototype.Ze=function(t){var e=new is(this.clientId,this.allowTabSynchronization,Date.now());return Ou(t).put(is.key,e)},t.yt=function(){return Ss.yt()},t.prototype.Xe=function(t){var e=this,n=Ou(t);return n.get(is.key).next((function(t){return e.tn(t)?(Rr("IndexedDbPersistence","Releasing primary lease."),n.delete(is.key)):Ts.resolve()}))},t.prototype.sn=function(t,e){var n=Date.now();return!(t<n-e||t>n&&(Dr("Detected an update time that is in the future: "+t+" > "+n),1))},t.prototype.We=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Fe=function(){t.Se.enqueueAndForget((function(){return t.inForeground="visible"===t.document.visibilityState,t.je()}))},this.document.addEventListener("visibilitychange",this.Fe),this.inForeground="visible"===this.document.visibilityState)},t.prototype.an=function(){this.Fe&&(this.document.removeEventListener("visibilitychange",this.Fe),this.Fe=null)},t.prototype.Ge=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.ke=function(){e.un(),(0,l.isSafari)()&&navigator.appVersion.match("Version/14")&&e.Se.enterRestrictedMode(!0),e.Se.enqueueAndForget((function(){return e.shutdown()}))},this.window.addEventListener("pagehide",this.ke))},t.prototype.hn=function(){this.ke&&(this.window.removeEventListener("pagehide",this.ke),this.ke=null)},t.prototype.cn=function(t){var e;try{var n=null!==(null===(e=this.Qe)||void 0===e?void 0:e.getItem(this.on(t)));return Rr("IndexedDbPersistence","Client '"+t+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(t){return Dr("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},t.prototype.un=function(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),String(Date.now()))}catch(t){Dr("Failed to set zombie client id.",t)}},t.prototype.ln=function(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch(t){}},t.prototype.on=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},t}();function Ou(t){return Os(t,is.store)}function Lu(t){return Os(t,gs.store)}function Mu(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var Fu=function(t,e){this.progress=t,this.wn=e},Uu=function(){function t(t,e,n){this.Ue=t,this._n=e,this.Ut=n}return t.prototype.mn=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(t,e).next((function(r){return n.yn(t,e,r)}))},t.prototype.yn=function(t,e,n){return this.Ue.getEntry(t,e).next((function(t){for(var e=0,r=n;e<r.length;e++)r[e].applyToLocalView(t);return t}))},t.prototype.gn=function(t,e){t.forEach((function(t,n){for(var r=0,i=e;r<i.length;r++)i[r].applyToLocalView(n)}))},t.prototype.pn=function(t,e){var n=this;return this.Ue.getEntries(t,e).next((function(e){return n.En(t,e).next((function(){return e}))}))},t.prototype.En=function(t,e){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(t,e).next((function(t){return n.gn(e,t)}))},t.prototype.getDocumentsMatchingQuery=function(t,e,n){return function(t){return hi.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length}(e)?this.Tn(t,e.path):no(e)?this.In(t,e,n):this.An(t,e,n)},t.prototype.Tn=function(t,e){return this.mn(t,new hi(e)).next((function(t){var e=ia();return t.isFoundDocument()&&(e=e.insert(t.key,t)),e}))},t.prototype.In=function(t,e,n){var r=this,i=e.collectionGroup,o=ia();return this.Ut.getCollectionParents(t,i).next((function(a){return Ts.forEach(a,(function(a){var s=function(t,e){return new Yi(e,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(e,a.child(i));return r.An(t,s,n).next((function(t){t.forEach((function(t,e){o=o.insert(t,e)}))}))})).next((function(){return o}))}))},t.prototype.An=function(t,e,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(t,e,n).next((function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(t,e)})).next((function(e){return i=e,o.Rn(t,i,r).next((function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],a=0,s=o.mutations;a<s.length;a++){var u=s[a],c=u.key,l=r.get(c);null==l&&(l=Ai.newInvalidDocument(c),r=r.insert(c,l)),Oo(u,l,o.localWriteTime),l.isFoundDocument()||(r=r.remove(c))}}))})).next((function(){return r.forEach((function(t,n){co(e,n)||(r=r.remove(t))})),r}))},t.prototype.Rn=function(t,e,n){for(var r=ua(),i=0,o=e;i<o.length;i++)for(var a=0,s=o[i].mutations;a<s.length;a++){var u=s[a];u instanceof jo&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Ue.getEntries(t,r).next((function(t){return t.forEach((function(t,e){e.isFoundDocument()&&(c=c.insert(t,e))})),c}))},t}(),ju=function(){function t(t,e,n,r){this.targetId=t,this.fromCache=e,this.bn=n,this.vn=r}return t.Pn=function(e,n){for(var r=ua(),i=ua(),o=0,a=n.docChanges;o<a.length;o++){var s=a[o];switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new t(e,n.fromCache,r,i)},t}(),qu=function(){function t(){}return t.prototype.Vn=function(t){this.Sn=t},t.prototype.getDocumentsMatchingQuery=function(t,e,n,r){var i=this;return function(t){return 0===t.filters.length&&null===t.limit&&null==t.startAt&&null==t.endAt&&(0===t.explicitOrderBy.length||1===t.explicitOrderBy.length&&t.explicitOrderBy[0].field.isKeyField())}(e)||n.isEqual(Hr.min())?this.Dn(t,e):this.Sn.pn(t,r).next((function(o){var a=i.Cn(e,o);return(Ji(e)||Zi(e))&&i.Nn(e.limitType,a,r,n)?i.Dn(t,e):(xr()<=h.LogLevel.DEBUG&&Rr("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),uo(e)),i.Sn.getDocumentsMatchingQuery(t,e,n).next((function(t){return a.forEach((function(e){t=t.insert(e.key,e)})),t})))}))},t.prototype.Cn=function(t,e){var n=new Zo(lo(t));return e.forEach((function(e,r){co(t,r)&&(n=n.add(r))})),n},t.prototype.Nn=function(t,e,n,r){if(n.size!==e.size)return!0;var i="F"===t?e.last():e.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},t.prototype.Dn=function(t,e){return xr()<=h.LogLevel.DEBUG&&Rr("QueryEngine","Using full collection scan to execute query:",uo(e)),this.Sn.getDocumentsMatchingQuery(t,e,Hr.min())},t}(),Vu=function(){function t(t,e,n,r){this.persistence=t,this.xn=e,this.R=r,this.kn=new Xo(Vr),this.Fn=new Tu((function(t){return xi(t)}),Ri),this.$n=Hr.min(),this._n=t.getMutationQueue(n),this.On=t.getRemoteDocumentCache(),this.qe=t.getTargetCache(),this.Mn=new Uu(this.On,this._n,this.persistence.getIndexManager()),this.Ke=t.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return t.collect(n,e.kn)}))},t}();function Bu(t,e,n,r){return new Vu(t,e,n,r)}function Ku(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o;return(0,c.__generator)(this,(function(a){switch(a.label){case 0:return n=Ur(t),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",(function(t){var o;return n._n.getAllMutationBatches(t).next((function(a){return o=a,r=n.persistence.getMutationQueue(e),i=new Uu(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(t)})).next((function(e){for(var n=[],r=[],a=ua(),s=0,u=o;s<u.length;s++){var c=u[s];n.push(c.batchId);for(var l=0,h=c.mutations;l<h.length;l++){var f=h[l];a=a.add(f.key)}}for(var d=0,p=e;d<p.length;d++){var v=p[d];r.push(v.batchId);for(var g=0,y=v.mutations;g<y.length;g++){var m=y[g];a=a.add(m.key)}}return i.pn(t,a).next((function(t){return{Ln:t,removedBatchIds:n,addedBatchIds:r}}))}))}))];case 1:return o=a.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}}))}))}function Wu(t,e){var n=Ur(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(t){var r=e.batch.keys(),i=n.On.newChangeBuffer({trackRemovals:!0});return function(t,e,n,r){var i=n.batch,o=i.keys(),a=Ts.resolve();return o.forEach((function(t){a=a.next((function(){return r.getEntry(e,t)})).next((function(e){var o=n.docVersions.get(t);Fr(null!==o),e.version.compareTo(o)<0&&(i.applyToRemoteDocument(e,n),e.isValidDocument()&&r.addEntry(e,n.commitVersion))}))})),a.next((function(){return t._n.removeMutationBatch(e,i)}))}(n,t,e,i).next((function(){return i.apply(t)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}function Hu(t){var e=Ur(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(function(t){return e.qe.getLastRemoteSnapshotVersion(t)}))}function Gu(t,e){var n=Ur(t),r=e.snapshotVersion,i=n.kn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(t){var o=n.On.newChangeBuffer({trackRemovals:!0});i=n.kn;var a=[];e.targetChanges.forEach((function(e,o){var s=i.get(o);if(s){a.push(n.qe.removeMatchingKeys(t,e.removedDocuments,o).next((function(){return n.qe.addMatchingKeys(t,e.addedDocuments,o)})));var u=e.resumeToken;if(u.approximateByteSize()>0){var c=s.withResumeToken(u,r).withSequenceNumber(t.currentSequenceNumber);i=i.insert(o,c),function(t,e,n){return Fr(e.resumeToken.approximateByteSize()>0),0===t.resumeToken.approximateByteSize()||e.snapshotVersion.toMicroseconds()-t.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(s,c,e)&&a.push(n.qe.updateTargetData(t,c))}}}));var s=na();if(e.documentUpdates.forEach((function(r,i){e.resolvedLimboDocuments.has(r)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(t,r))})),a.push(zu(t,o,e.documentUpdates,r,void 0).next((function(t){s=t}))),!r.isEqual(Hr.min())){var u=n.qe.getLastRemoteSnapshotVersion(t).next((function(e){return n.qe.setTargetsMetadata(t,t.currentSequenceNumber,r)}));a.push(u)}return Ts.waitFor(a).next((function(){return o.apply(t)})).next((function(){return n.Mn.En(t,s)})).next((function(){return s}))})).then((function(t){return n.kn=i,t}))}function zu(t,e,n,r,i){var o=ua();return n.forEach((function(t){return o=o.add(t)})),e.getEntries(t,o).next((function(t){var o=na();return n.forEach((function(n,a){var s=t.get(n),u=(null==i?void 0:i.get(n))||r;a.isNoDocument()&&a.version.isEqual(Hr.min())?(e.removeEntry(n,u),o=o.insert(n,a)):!s.isValidDocument()||a.version.compareTo(s.version)>0||0===a.version.compareTo(s.version)&&s.hasPendingWrites?(e.addEntry(a,u),o=o.insert(n,a)):Rr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",a.version)})),o}))}function Qu(t,e){var n=Ur(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(t){return void 0===e&&(e=-1),n._n.getNextMutationBatchAfterBatchId(t,e)}))}function Yu(t,e){var n=Ur(t);return n.persistence.runTransaction("Allocate target","readwrite",(function(t){var r;return n.qe.getTargetData(t,e).next((function(i){return i?(r=i,Ts.resolve(r)):n.qe.allocateTargetId(t).next((function(i){return r=new Fs(e,i,0,t.currentSequenceNumber),n.qe.addTargetData(t,r).next((function(){return r}))}))}))})).then((function(t){var r=n.kn.get(t.targetId);return(null===r||t.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.kn=n.kn.insert(t.targetId,t),n.Fn.set(e,t.targetId)),t}))}function Xu(t,e,n){return(0,c.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a;return(0,c.__generator)(this,(function(s){switch(s.label){case 0:r=Ur(t),i=r.kn.get(e),o=n?"readwrite":"readwrite-primary",s.label=1;case 1:return s.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(t){return r.persistence.referenceDelegate.removeTarget(t,i)}))];case 2:s.sent(),s.label=3;case 3:return[3,5];case 4:if(!As(a=s.sent()))throw a;return Rr("LocalStore","Failed to update sequence numbers for target "+e+": "+a),[3,5];case 5:return r.kn=r.kn.remove(e),r.Fn.delete(i.target),[2]}}))}))}function $u(t,e,n){var r=Ur(t),i=Hr.min(),o=ua();return r.persistence.runTransaction("Execute query","readonly",(function(t){return function(t,e,n){var r=Ur(t),i=r.Fn.get(n);return void 0!==i?Ts.resolve(r.kn.get(i)):r.qe.getTargetData(e,n)}(r,t,io(e)).next((function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(t,e.targetId).next((function(t){o=t}))})).next((function(){return r.xn.getDocumentsMatchingQuery(t,e,n?i:Hr.min(),n?o:ua())})).next((function(t){return{documents:t,Bn:o}}))}))}function Ju(t,e){var n=Ur(t),r=Ur(n.qe),i=n.kn.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(t){return r.lt(t,e).next((function(t){return t?t.target:null}))}))}function Zu(t){var e=Ur(t);return e.persistence.runTransaction("Get new document changes","readonly",(function(t){return function(t,e,n){var r=Ur(t),i=na(),o=Vs(n),a=Au(e),s=IDBKeyRange.lowerBound(o,!0);return a.$t({index:ls.readTimeIndex,range:s},(function(t,e){var n=js(r.R,e);i=i.insert(n.key,n),o=e.readTime})).next((function(){return{wn:i,readTime:Bs(o)}}))}(e.On,t,e.$n)})).then((function(t){var n=t.wn,r=t.readTime;return e.$n=r,n}))}function tc(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e;return(0,c.__generator)(this,(function(n){return[2,(e=Ur(t)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(t){return function(t){var e=Au(t),n=Hr.min();return e.$t({index:ls.readTimeIndex,reverse:!0},(function(t,e,r){e.readTime&&(n=Bs(e.readTime)),r.done()})).next((function(){return n}))}(t)})).then((function(t){e.$n=t}))]}))}))}function ec(t,e,n,r){return(0,c.__awaiter)(this,void 0,void 0,(function(){var i,o,a,s,u,l,h,f,d,p;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:for(i=Ur(t),o=ua(),a=na(),s=aa(),u=0,l=n;u<l.length;u++)h=l[u],f=e.qn(h.metadata.name),h.document&&(o=o.add(f)),a=a.insert(f,e.Un(h)),s=s.insert(f,e.Kn(h.metadata.readTime));return d=i.On.newChangeBuffer({trackRemovals:!0}),[4,Yu(i,function(t){return io($i(Xr.fromString("__bundle__/docs/"+t)))}(r))];case 1:return p=c.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",(function(t){return zu(t,d,a,Hr.min(),s).next((function(e){return d.apply(t),e})).next((function(e){return i.qe.removeMatchingKeysForTargetId(t,p.targetId).next((function(){return i.qe.addMatchingKeys(t,o,p.targetId)})).next((function(){return i.Mn.En(t,e)})).next((function(){return e}))}))}))]}}))}))}function nc(t,e,n){return void 0===n&&(n=ua()),(0,c.__awaiter)(this,void 0,void 0,(function(){var r,i;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return[4,Yu(t,io(Qs(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=Ur(t)).persistence.runTransaction("Save named query","readwrite",(function(t){var o=Ca(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Ke.saveNamedQuery(t,e);var a=r.withResumeToken(ti.EMPTY_BYTE_STRING,o);return i.kn=i.kn.insert(a.targetId,a),i.qe.updateTargetData(t,a).next((function(){return i.qe.removeMatchingKeysForTargetId(t,r.targetId)})).next((function(){return i.qe.addMatchingKeys(t,n,r.targetId)})).next((function(){return i.Ke.saveNamedQuery(t,e)}))}))]}}))}))}var rc=function(){function t(t){this.R=t,this.Qn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(t,e){return Ts.resolve(this.Qn.get(e))},t.prototype.saveBundleMetadata=function(t,e){var n;return this.Qn.set(e.id,{id:(n=e).id,version:n.version,createTime:Ca(n.createTime)}),Ts.resolve()},t.prototype.getNamedQuery=function(t,e){return Ts.resolve(this.jn.get(e))},t.prototype.saveNamedQuery=function(t,e){return this.jn.set(e.name,function(t){return{name:t.name,query:Qs(t.bundledQuery),readTime:Ca(t.readTime)}}(e)),Ts.resolve()},t}(),ic=function(){function t(){this.Wn=new Zo(oc.Gn),this.zn=new Zo(oc.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(t,e){var n=new oc(t,e);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},t.prototype.Jn=function(t,e){var n=this;t.forEach((function(t){return n.addReference(t,e)}))},t.prototype.removeReference=function(t,e){this.Yn(new oc(t,e))},t.prototype.Xn=function(t,e){var n=this;t.forEach((function(t){return n.removeReference(t,e)}))},t.prototype.Zn=function(t){var e=this,n=new hi(new Xr([])),r=new oc(n,t),i=new oc(n,t+1),o=[];return this.zn.forEachInRange([r,i],(function(t){e.Yn(t),o.push(t.key)})),o},t.prototype.ts=function(){var t=this;this.Wn.forEach((function(e){return t.Yn(e)}))},t.prototype.Yn=function(t){this.Wn=this.Wn.delete(t),this.zn=this.zn.delete(t)},t.prototype.es=function(t){var e=new hi(new Xr([])),n=new oc(e,t),r=new oc(e,t+1),i=ua();return this.zn.forEachInRange([n,r],(function(t){i=i.add(t.key)})),i},t.prototype.containsKey=function(t){var e=new oc(t,0),n=this.Wn.firstAfterOrEqual(e);return null!==n&&t.isEqual(n.key)},t}(),oc=function(){function t(t,e){this.key=t,this.ns=e}return t.Gn=function(t,e){return hi.comparator(t.key,e.key)||Vr(t.ns,e.ns)},t.Hn=function(t,e){return Vr(t.ns,e.ns)||hi.comparator(t.key,e.key)},t}(),ac=function(){function t(t,e){this.Ut=t,this.referenceDelegate=e,this._n=[],this.ss=1,this.rs=new Zo(oc.Gn)}return t.prototype.checkEmpty=function(t){return Ts.resolve(0===this._n.length)},t.prototype.addMutationBatch=function(t,e,n,r){var i=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];var o=new Ls(i,e,n,r);this._n.push(o);for(var a=0,s=r;a<s.length;a++){var u=s[a];this.rs=this.rs.add(new oc(u.key,i)),this.Ut.addToCollectionParentIndex(t,u.key.path.popLast())}return Ts.resolve(o)},t.prototype.lookupMutationBatch=function(t,e){return Ts.resolve(this.os(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=e+1,r=this.cs(n),i=r<0?0:r;return Ts.resolve(this._n.length>i?this._n[i]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return Ts.resolve(0===this._n.length?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(t){return Ts.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new oc(e,0),i=new oc(e,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],(function(t){var e=n.os(t.ns);o.push(e)})),Ts.resolve(o)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(t,e){var n=this,r=new Zo(Vr);return e.forEach((function(t){var e=new oc(t,0),i=new oc(t,Number.POSITIVE_INFINITY);n.rs.forEachInRange([e,i],(function(t){r=r.add(t.ns)}))})),Ts.resolve(this.us(r))},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=e.path,r=n.length+1,i=n;hi.isDocumentKey(i)||(i=i.child(""));var o=new oc(new hi(i),0),a=new Zo(Vr);return this.rs.forEachWhile((function(t){var e=t.key.path;return!!n.isPrefixOf(e)&&(e.length===r&&(a=a.add(t.ns)),!0)}),o),Ts.resolve(this.us(a))},t.prototype.us=function(t){var e=this,n=[];return t.forEach((function(t){var r=e.os(t);null!==r&&n.push(r)})),n},t.prototype.removeMutationBatch=function(t,e){var n=this;Fr(0===this.hs(e.batchId,"removed")),this._n.shift();var r=this.rs;return Ts.forEach(e.mutations,(function(i){var o=new oc(i.key,e.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(t,i.key)})).next((function(){n.rs=r}))},t.prototype.Gt=function(t){},t.prototype.containsKey=function(t,e){var n=new oc(e,0),r=this.rs.firstAfterOrEqual(n);return Ts.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return this._n.length,Ts.resolve()},t.prototype.hs=function(t,e){return this.cs(t)},t.prototype.cs=function(t){return 0===this._n.length?0:t-this._n[0].batchId},t.prototype.os=function(t){var e=this.cs(t);return e<0||e>=this._n.length?null:this._n[e]},t}(),sc=function(){function t(t,e){this.Ut=t,this.ls=e,this.docs=new Xo(hi.comparator),this.size=0}return t.prototype.addEntry=function(t,e,n){var r=e.key,i=this.docs.get(r),o=i?i.size:0,a=this.ls(e);return this.docs=this.docs.insert(r,{document:e.clone(),size:a,readTime:n}),this.size+=a-o,this.Ut.addToCollectionParentIndex(t,r.path.popLast())},t.prototype.removeEntry=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},t.prototype.getEntry=function(t,e){var n=this.docs.get(e);return Ts.resolve(n?n.document.clone():Ai.newInvalidDocument(e))},t.prototype.getEntries=function(t,e){var n=this,r=na();return e.forEach((function(t){var e=n.docs.get(t);r=r.insert(t,e?e.document.clone():Ai.newInvalidDocument(t))})),Ts.resolve(r)},t.prototype.getDocumentsMatchingQuery=function(t,e,n){for(var r=na(),i=new hi(e.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var a=o.getNext(),s=a.key,u=a.value,c=u.document,l=u.readTime;if(!e.path.isPrefixOf(s.path))break;l.compareTo(n)<=0||co(e,c)&&(r=r.insert(c.key,c.clone()))}return Ts.resolve(r)},t.prototype.fs=function(t,e){return Ts.forEach(this.docs,(function(t){return e(t)}))},t.prototype.newChangeBuffer=function(t){return new uc(this)},t.prototype.getSize=function(t){return Ts.resolve(this.size)},t}(),uc=function(t){function e(e){var n=this;return(n=t.call(this)||this).Ie=e,n}return(0,c.__extends)(e,t),e.prototype.applyChanges=function(t){var e=this,n=[];return this.changes.forEach((function(r,i){i.document.isValidDocument()?n.push(e.Ie.addEntry(t,i.document,e.getReadTime(r))):e.Ie.removeEntry(r)})),Ts.waitFor(n)},e.prototype.getFromCache=function(t,e){return this.Ie.getEntry(t,e)},e.prototype.getAllFromCache=function(t,e){return this.Ie.getEntries(t,e)},e}(Eu),cc=function(){function t(t){this.persistence=t,this.ds=new Tu((function(t){return xi(t)}),Ri),this.lastRemoteSnapshotVersion=Hr.min(),this.highestTargetId=0,this.ws=0,this._s=new ic,this.targetCount=0,this.ys=hu.Jt()}return t.prototype.forEachTarget=function(t,e){return this.ds.forEach((function(t,n){return e(n)})),Ts.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(t){return Ts.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(t){return Ts.resolve(this.ws)},t.prototype.allocateTargetId=function(t){return this.highestTargetId=this.ys.next(),Ts.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.ws&&(this.ws=e),Ts.resolve()},t.prototype.te=function(t){this.ds.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.ys=new hu(e),this.highestTargetId=e),t.sequenceNumber>this.ws&&(this.ws=t.sequenceNumber)},t.prototype.addTargetData=function(t,e){return this.te(e),this.targetCount+=1,Ts.resolve()},t.prototype.updateTargetData=function(t,e){return this.te(e),Ts.resolve()},t.prototype.removeTargetData=function(t,e){return this.ds.delete(e.target),this._s.Zn(e.targetId),this.targetCount-=1,Ts.resolve()},t.prototype.removeTargets=function(t,e,n){var r=this,i=0,o=[];return this.ds.forEach((function(a,s){s.sequenceNumber<=e&&null===n.get(s.targetId)&&(r.ds.delete(a),o.push(r.removeMatchingKeysForTargetId(t,s.targetId)),i++)})),Ts.waitFor(o).next((function(){return i}))},t.prototype.getTargetCount=function(t){return Ts.resolve(this.targetCount)},t.prototype.getTargetData=function(t,e){var n=this.ds.get(e)||null;return Ts.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this._s.Jn(e,n),Ts.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){this._s.Xn(e,n);var r=this.persistence.referenceDelegate,i=[];return r&&e.forEach((function(e){i.push(r.markPotentiallyOrphaned(t,e))})),Ts.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this._s.Zn(e),Ts.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this._s.es(e);return Ts.resolve(n)},t.prototype.containsKey=function(t,e){return Ts.resolve(this._s.containsKey(e))},t}(),lc=function(){function t(t,e){var n=this;this.gs={},this.Ne=new kr(0),this.xe=!1,this.xe=!0,this.referenceDelegate=t(this),this.qe=new cc(this),this.Ut=new Js,this.Ue=function(t,e){return new sc(t,(function(t){return n.referenceDelegate.ps(t)}))}(this.Ut),this.R=new Us(e),this.Ke=new rc(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(t){var e=this.gs[t.toKey()];return e||(e=new ac(this.Ut,this.referenceDelegate),this.gs[t.toKey()]=e),e},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(t,e,n){var r=this;Rr("MemoryPersistence","Starting transaction:",t);var i=new hc(this.Ne.next());return this.referenceDelegate.Es(),n(i).next((function(t){return r.referenceDelegate.Ts(i).next((function(){return t}))})).toPromise().then((function(t){return i.raiseOnCommittedEvent(),t}))},t.prototype.Is=function(t,e){return Ts.or(Object.values(this.gs).map((function(n){return function(){return n.containsKey(t,e)}})))},t}(),hc=function(t){function e(e){var n=this;return(n=t.call(this)||this).currentSequenceNumber=e,n}return(0,c.__extends)(e,t),e}(ws),fc=function(){function t(t){this.persistence=t,this.As=new ic,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw Mr()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(t,e,n){return this.As.addReference(n,e),this.vs.delete(n.toString()),Ts.resolve()},t.prototype.removeReference=function(t,e,n){return this.As.removeReference(n,e),this.vs.add(n.toString()),Ts.resolve()},t.prototype.markPotentiallyOrphaned=function(t,e){return this.vs.add(e.toString()),Ts.resolve()},t.prototype.removeTarget=function(t,e){var n=this;this.As.Zn(e.targetId).forEach((function(t){return n.vs.add(t.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(t,e.targetId).next((function(t){t.forEach((function(t){return n.vs.add(t.toString())}))})).next((function(){return r.removeTargetData(t,e)}))},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(t){var e=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ts.forEach(this.vs,(function(r){var i=hi.fromPath(r);return e.Ps(t,i).next((function(t){t||n.removeEntry(i)}))})).next((function(){return e.Rs=null,n.apply(t)}))},t.prototype.updateLimboDocument=function(t,e){var n=this;return this.Ps(t,e).next((function(t){t?n.vs.delete(e.toString()):n.vs.add(e.toString())}))},t.prototype.ps=function(t){return 0},t.prototype.Ps=function(t,e){var n=this;return Ts.or([function(){return Ts.resolve(n.As.containsKey(e))},function(){return n.persistence.getTargetCache().containsKey(t,e)},function(){return n.persistence.Is(t,e)}])},t}(),dc=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t}();function pc(t,e){return"firestore_clients_"+t+"_"+e}function vc(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function gc(t,e){return"firestore_targets_"+t+"_"+e}dc.UNAUTHENTICATED=new dc(null),dc.GOOGLE_CREDENTIALS=new dc("google-credentials-uid"),dc.FIRST_PARTY=new dc("first-party-uid"),dc.MOCK_USER=new dc("mock-user");var yc=function(){function t(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}return t.Vs=function(e,n,r){var i,o=JSON.parse(r),a="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return a&&o.error&&(a="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new Nr(o.error.code,o.error.message)),a?new t(e,n,o.state,i):(Dr("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),mc=function(){function t(t,e,n){this.targetId=t,this.state=e,this.error=n}return t.Vs=function(e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new Nr(i.error.code,i.error.message)),o?new t(e,i.state,r):(Dr("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},t}(),_c=function(){function t(t,e){this.clientId=t,this.activeTargetIds=e}return t.Vs=function(e,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=la(),a=0;i&&a<r.activeTargetIds.length;++a)i=li(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new t(e,o):(Dr("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),bc=function(){function t(t,e){this.clientId=t,this.onlineState=e}return t.Vs=function(e){var n=JSON.parse(e);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new t(n.clientId,n.onlineState):(Dr("SharedClientState","Failed to parse online state: "+e),null)},t}(),wc=function(){function t(){this.activeTargetIds=la()}return t.prototype.Ds=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},t.prototype.Cs=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},t.prototype.Ss=function(){var t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)},t}(),Ic=function(){function t(t,e,n,r,i){this.window=t,this.Se=e,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.ks.bind(this),this.Fs=new Xo(Vr),this.started=!1,this.$s=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Os=pc(this.persistenceKey,this.Ns),this.Ms=function(t){return"firestore_sequence_number_"+t}(this.persistenceKey),this.Fs=this.Fs.insert(this.Ns,new wc),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(t){return"firestore_online_state_"+t}(this.persistenceKey),this.Ks=function(t){return"firestore_bundle_loaded_"+t}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(t){return!(!t||!t.localStorage)},t.prototype.start=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r,i,o,a,s,u,l,h,f=this;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:return[4,this.syncEngine.fn()];case 1:for(t=c.sent(),e=0,n=t;e<n.length;e++)(r=n[e])!==this.Ns&&(i=this.getItem(pc(this.persistenceKey,r)))&&(o=_c.Vs(r,i))&&(this.Fs=this.Fs.insert(o.clientId,o));for(this.Qs(),(a=this.storage.getItem(this.Us))&&(s=this.js(a))&&this.Ws(s),u=0,l=this.$s;u<l.length;u++)h=l[u],this.ks(h);return this.$s=[],this.window.addEventListener("pagehide",(function(){return f.shutdown()})),this.started=!0,[2]}}))}))},t.prototype.writeSequenceNumber=function(t){this.setItem(this.Ms,JSON.stringify(t))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.Fs)},t.prototype.isActiveQueryTarget=function(t){var e=!1;return this.Fs.forEach((function(n,r){r.activeTargetIds.has(t)&&(e=!0)})),e},t.prototype.addPendingMutation=function(t){this.zs(t,"pending")},t.prototype.updateMutationState=function(t,e,n){this.zs(t,e,n),this.Hs(t)},t.prototype.addLocalQueryTarget=function(t){var e="not-current";if(this.isActiveQueryTarget(t)){var n=this.storage.getItem(gc(this.persistenceKey,t));if(n){var r=mc.Vs(t,n);r&&(e=r.state)}}return this.Js.Ds(t),this.Qs(),e},t.prototype.removeLocalQueryTarget=function(t){this.Js.Cs(t),this.Qs()},t.prototype.isLocalQueryTarget=function(t){return this.Js.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){this.removeItem(gc(this.persistenceKey,t))},t.prototype.updateQueryState=function(t,e,n){this.Ys(t,e,n)},t.prototype.handleUserChange=function(t,e,n){var r=this;e.forEach((function(t){r.Hs(t)})),this.currentUser=t,n.forEach((function(t){r.addPendingMutation(t)}))},t.prototype.setOnlineState=function(t){this.Xs(t)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(t){var e=this.storage.getItem(t);return Rr("SharedClientState","READ",t,e),e},t.prototype.setItem=function(t,e){Rr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},t.prototype.removeItem=function(t){Rr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},t.prototype.ks=function(t){var e=this,n=t;if(n.storageArea===this.storage){if(Rr("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Os)return void Dr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable((function(){return(0,c.__awaiter)(e,void 0,void 0,(function(){var t,e,r,i,o,a;return(0,c.__generator)(this,(function(s){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return t=this.ti(n.key),[2,this.ei(t,null)];if(e=this.ni(n.key,n.newValue))return[2,this.ei(e.clientId,e)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(a=function(t){var e=kr.o;if(null!=t)try{var n=JSON.parse(t);Fr("number"==typeof n),e=n}catch(t){Dr("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==kr.o&&this.sequenceNumberHandler(a);else if(n.key===this.Ks)return[2,this.syncEngine.ci()]}else this.$s.push(n);return[2]}))}))}))}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.Fs.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Qs=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(t,e,n){var r=new yc(this.currentUser,t,e,n),i=vc(this.persistenceKey,this.currentUser,t);this.setItem(i,r.Ss())},t.prototype.Hs=function(t){var e=vc(this.persistenceKey,this.currentUser,t);this.removeItem(e)},t.prototype.Xs=function(t){var e={clientId:this.Ns,onlineState:t};this.storage.setItem(this.Us,JSON.stringify(e))},t.prototype.Ys=function(t,e,n){var r=gc(this.persistenceKey,t),i=new mc(t,e,n);this.setItem(r,i.Ss())},t.prototype.Zs=function(){this.setItem(this.Ks,"value-not-used")},t.prototype.ti=function(t){var e=this.Ls.exec(t);return e?e[1]:null},t.prototype.ni=function(t,e){var n=this.ti(t);return _c.Vs(n,e)},t.prototype.si=function(t,e){var n=this.Bs.exec(t),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return yc.Vs(new dc(i),r,e)},t.prototype.ri=function(t,e){var n=this.qs.exec(t),r=Number(n[1]);return mc.Vs(r,e)},t.prototype.js=function(t){return bc.Vs(t)},t.prototype.ii=function(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){return(0,c.__generator)(this,(function(e){return t.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(t.batchId,t.state,t.error)]:(Rr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])}))}))},t.prototype.oi=function(t){return this.syncEngine.ai(t.targetId,t.state,t.error)},t.prototype.ei=function(t,e){var n=this,r=e?this.Fs.insert(t,e):this.Fs.remove(t),i=this.Gs(this.Fs),o=this.Gs(r),a=[],s=[];return o.forEach((function(t){i.has(t)||a.push(t)})),i.forEach((function(t){o.has(t)||s.push(t)})),this.syncEngine.hi(a,s).then((function(){n.Fs=r}))},t.prototype.Ws=function(t){this.Fs.get(t.clientId)&&this.onlineStateHandler(t.onlineState)},t.prototype.Gs=function(t){var e=la();return t.forEach((function(t,n){e=e.unionWith(n.activeTargetIds)})),e},t}(),Tc=function(){function t(){this.li=new wc,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(t){},t.prototype.updateMutationState=function(t,e,n){},t.prototype.addLocalQueryTarget=function(t){return this.li.Ds(t),this.fi[t]||"not-current"},t.prototype.updateQueryState=function(t,e,n){this.fi[t]=e},t.prototype.removeLocalQueryTarget=function(t){this.li.Cs(t)},t.prototype.isLocalQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.clearQueryState=function(t){delete this.fi[t]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(t){return this.li.activeTargetIds.has(t)},t.prototype.start=function(){return this.li=new wc,Promise.resolve()},t.prototype.handleUserChange=function(t,e,n){},t.prototype.setOnlineState=function(t){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(t){},t.prototype.notifyBundleLoaded=function(){},t}(),Ec=function(){function t(){}return t.prototype.di=function(t){},t.prototype.shutdown=function(){},t}(),Sc=function(){function t(){var t=this;this.wi=function(){return t._i()},this.mi=function(){return t.yi()},this.gi=[],this.pi()}return t.prototype.di=function(t){this.gi.push(t)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){Rr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(0)},t.prototype.yi=function(){Rr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.gi;t<e.length;t++)(0,e[t])(1)},t.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},t}(),Cc={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},kc=function(){function t(t){this.Ei=t.Ei,this.Ti=t.Ti}return t.prototype.Ii=function(t){this.Ai=t},t.prototype.Ri=function(t){this.bi=t},t.prototype.onMessage=function(t){this.vi=t},t.prototype.close=function(){this.Ti()},t.prototype.send=function(t){this.Ei(t)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(t){this.bi(t)},t.prototype.Si=function(t){this.vi(t)},t}(),Ac=function(t){function e(e){var n=this;return(n=t.call(this,e)||this).forceLongPolling=e.forceLongPolling,n.autoDetectLongPolling=e.autoDetectLongPolling,n.useFetchStreams=e.useFetchStreams,n}return(0,c.__extends)(e,t),e.prototype.Fi=function(t,e,n,r){return new Promise((function(i,o){var a=new Cr;a.listenOnce(wr.COMPLETE,(function(){try{switch(a.getLastErrorCode()){case br.NO_ERROR:var e=a.getResponseJson();Rr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case br.TIMEOUT:Rr("Connection",'RPC "'+t+'" timed out'),o(new Nr(Ar.DEADLINE_EXCEEDED,"Request time out"));break;case br.HTTP_ERROR:var n=a.getStatus();if(Rr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",a.getResponseText()),n>0){var r=a.getResponseJson().error;if(r&&r.status&&r.message){var s=function(t){var e=t.toLowerCase().replace(/_/g,"-");return Object.values(Ar).indexOf(e)>=0?e:Ar.UNKNOWN}(r.status);o(new Nr(s,r.message))}else o(new Nr(Ar.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new Nr(Ar.UNAVAILABLE,"Connection failed."));break;default:Mr()}}finally{Rr("Connection",'RPC "'+t+'" completed.')}}));var s=JSON.stringify(r);a.send(e,"POST",s,n,15)}))},e.prototype.Oi=function(t,e){var n=[this.Di,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=mr(),i=_r(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new Er({})),this.ki(o.initMessageHeaders,e),(0,l.isMobileCordova)()||(0,l.isReactNative)()||(0,l.isElectron)()||(0,l.isIE)()||(0,l.isUWP)()||(0,l.isBrowserExtension)()||(o.httpHeadersOverwriteParam="$httpHeaders");var a=n.join("");Rr("Connection","Creating WebChannel: "+a,o);var s=r.createWebChannel(a,o),u=!1,c=!1,h=new kc({Ei:function(t){c?Rr("Connection","Not sending because WebChannel is closed:",t):(u||(Rr("Connection","Opening WebChannel transport."),s.open(),u=!0),Rr("Connection","WebChannel sending:",t),s.send(t))},Ti:function(){return s.close()}}),f=function(t,e,n){t.listen(e,(function(t){try{n(t)}catch(t){setTimeout((function(){throw t}),0)}}))};return f(s,Sr.EventType.OPEN,(function(){c||Rr("Connection","WebChannel transport opened.")})),f(s,Sr.EventType.CLOSE,(function(){c||(c=!0,Rr("Connection","WebChannel transport closed"),h.Vi())})),f(s,Sr.EventType.ERROR,(function(t){c||(c=!0,Or("Connection","WebChannel transport errored:",t),h.Vi(new Nr(Ar.UNAVAILABLE,"The operation could not be completed")))})),f(s,Sr.EventType.MESSAGE,(function(t){var e;if(!c){var n=t.data[0];Fr(!!n);var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){Rr("Connection","WebChannel received error:",i);var o=i.status,a=function(t){var e=Ko[t];if(void 0!==e)return Yo(e)}(o),u=i.message;void 0===a&&(a=Ar.INTERNAL,u="Unknown error status: "+o+" with message "+i.message),c=!0,h.Vi(new Nr(a,u)),s.close()}else Rr("Connection","WebChannel received:",n),h.Si(n)}})),f(i,Ir.STAT_EVENT,(function(t){t.stat===Tr.PROXY?Rr("Connection","Detected buffering proxy"):t.stat===Tr.NOPROXY&&Rr("Connection","Detected no buffering proxy")})),setTimeout((function(){h.Pi()}),0),h},e}(function(){function t(t){this.databaseInfo=t,this.databaseId=t.databaseId;var e=t.ssl?"https":"http";this.Di=e+"://"+t.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(t,e,n,r){var i=this.xi(t,e);Rr("RestConnection","Sending: ",i,n);var o={};return this.ki(o,r),this.Fi(t,i,o,n).then((function(t){return Rr("RestConnection","Received: ",t),t}),(function(e){throw Or("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e}))},t.prototype.$i=function(t,e,n,r){return this.Ni(t,e,n,r)},t.prototype.ki=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.10.1",t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n])},t.prototype.xi=function(t,e){var n=Cc[t];return this.Di+"/v1/"+e+":"+n},t}());function Nc(){return"undefined"!=typeof window?window:null}function Pc(){return"undefined"!=typeof document?document:null}function xc(t){return new Ia(t,!0)}var Rc=function(){function t(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=t,this.timerId=e,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Ki=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Qi=function(){this.qi=this.Bi},t.prototype.ji=function(t){var e=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Ki),i=Math.max(0,n-r);i>0&&Rr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,(function(){return e.Ki=Date.now(),t()})),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),Dc=function(){function t(t,e,n,r,i,o){this.Se=t,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new Rc(t,e)}return t.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},t.prototype.er=function(){return 2===this.state},t.prototype.start=function(){3!==this.state?this.auth():this.nr()},t.prototype.stop=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var t=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,(function(){return t.rr()})))},t.prototype.cr=function(t){this.ur(),this.stream.send(t)},t.prototype.rr=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){return(0,c.__generator)(this,(function(t){return this.er()?[2,this.close(0)]:[2]}))}))},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==t?this.Zi.reset():e&&e.code===Ar.RESOURCE_EXHAUSTED?(Dr(e.toString()),Dr("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Qi()):e&&e.code===Ar.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Ri(e)];case 1:return n.sent(),[2]}}))}))},t.prototype.ar=function(){},t.prototype.auth=function(){var t=this;this.state=1;var e=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then((function(e){t.Yi===n&&t.lr(e)}),(function(n){e((function(){var e=new Nr(Ar.UNKNOWN,"Fetching auth token failed: "+n.message);return t.dr(e)}))}))},t.prototype.lr=function(t){var e=this,n=this.hr(this.Yi);this.stream=this.wr(t),this.stream.Ii((function(){n((function(){return e.state=2,e.listener.Ii()}))})),this.stream.Ri((function(t){n((function(){return e.dr(t)}))})),this.stream.onMessage((function(t){n((function(){return e.onMessage(t)}))}))},t.prototype.nr=function(){var t=this;this.state=4,this.Zi.ji((function(){return(0,c.__awaiter)(t,void 0,void 0,(function(){return(0,c.__generator)(this,(function(t){return this.state=0,this.start(),[2]}))}))}))},t.prototype.dr=function(t){return Rr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},t.prototype.hr=function(t){var e=this;return function(n){e.Se.enqueueAndForget((function(){return e.Yi===t?n():(Rr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},t}(),Oc=function(t){function e(e,n,r,i,o){var a=this;return(a=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,a}return(0,c.__extends)(e,t),e.prototype.wr=function(t){return this.Hi.Oi("Listen",t)},e.prototype.onMessage=function(t){this.Zi.reset();var e=function(t,e){var n;if("targetChange"in e){e.targetChange;var r=function(t){return"NO_CHANGE"===t?0:"ADD"===t?1:"REMOVE"===t?2:"CURRENT"===t?3:"RESET"===t?4:Mr()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],o=function(t,e){return t.I?(Fr(void 0===e||"string"==typeof e),ti.fromBase64String(e||"")):(Fr(void 0===e||e instanceof Uint8Array),ti.fromUint8Array(e||new Uint8Array))}(t,e.targetChange.resumeToken),a=(s=e.targetChange.cause)&&function(t){var e=void 0===t.code?Ar.UNKNOWN:Yo(t.code);return new Nr(e,t.message||"")}(s);n=new va(r,i,o,a||null)}else if("documentChange"in e){e.documentChange,(r=e.documentChange).document,r.document.name,r.document.updateTime,i=Pa(t,r.document.name),o=Ca(r.document.updateTime);var s=new Ci({mapValue:{fields:r.document.fields}}),u=(a=Ai.newFoundDocument(i,o,s),r.targetIds||[]),c=r.removedTargetIds||[];n=new da(u,c,a.key,a)}else if("documentDelete"in e)e.documentDelete,(r=e.documentDelete).document,i=Pa(t,r.document),o=r.readTime?Ca(r.readTime):Hr.min(),s=Ai.newNoDocument(i,o),a=r.removedTargetIds||[],n=new da([],a,s.key,s);else if("documentRemove"in e)e.documentRemove,(r=e.documentRemove).document,i=Pa(t,r.document),o=r.removedTargetIds||[],n=new da([],o,i,null);else{if(!("filter"in e))return Mr();e.filter;var l=e.filter;l.targetId,r=l.count||0,i=new zo(r),o=l.targetId,n=new pa(o,i)}return n}(this.R,t),n=function(t){if(!("targetChange"in t))return Hr.min();var e=t.targetChange;return e.targetIds&&e.targetIds.length?Hr.min():e.readTime?Ca(e.readTime):Hr.min()}(t);return this.listener._r(e,n)},e.prototype.mr=function(t){var e={};e.database=Da(this.R),e.addTarget=function(t,e){var n,r=e.target;return(n=Di(r)?{documents:ja(t,r)}:{query:qa(t,r)}).targetId=e.targetId,e.resumeToken.approximateByteSize()>0?n.resumeToken=Ea(t,e.resumeToken):e.snapshotVersion.compareTo(Hr.min())>0&&(n.readTime=Ta(t,e.snapshotVersion.toTimestamp())),n}(this.R,t);var n=function(t,e){var n=function(t,e){switch(e){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Mr()}}(0,e.purpose);return null==n?null:{"goog-listen-tags":n}}(this.R,t);n&&(e.labels=n),this.cr(e)},e.prototype.yr=function(t){var e={};e.database=Da(this.R),e.removeTarget=t,this.cr(e)},e}(Dc),Lc=function(t){function e(e,n,r,i,o){var a=this;return(a=t.call(this,e,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,a.gr=!1,a}return(0,c.__extends)(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(t){return this.Hi.Oi("Write",t)},e.prototype.onMessage=function(t){if(Fr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.gr){this.Zi.reset();var e=function(t,e){return t&&t.length>0?(Fr(void 0!==e),t.map((function(t){return function(t,e){var n=t.updateTime?Ca(t.updateTime):Ca(e);return n.isEqual(Hr.min())&&(n=Ca(e)),new No(n,t.transformResults||[])}(t,e)}))):[]}(t.writeResults,t.commitTime),n=Ca(t.commitTime);return this.listener.Tr(n,e)}return Fr(!t.writeResults||0===t.writeResults.length),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var t={};t.database=Da(this.R),this.cr(t)},e.prototype.Er=function(t){var e=this,n={streamToken:this.lastStreamToken,writes:t.map((function(t){return Fa(e.R,t)}))};this.cr(n)},e}(Dc),Mc=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).credentials=e,i.Hi=n,i.R=r,i.Rr=!1,i}return(0,c.__extends)(e,t),e.prototype.br=function(){if(this.Rr)throw new Nr(Ar.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Ni(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===Ar.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Nr(Ar.UNKNOWN,t.toString())}))},e.prototype.$i=function(t,e,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.$i(t,e,n,i)})).catch((function(t){throw"FirebaseError"===t.name?(t.code===Ar.UNAUTHENTICATED&&r.credentials.invalidateToken(),t):new Nr(Ar.UNKNOWN,t.toString())}))},e.prototype.terminate=function(){this.Rr=!0},e}((function(){})),Fc=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var t=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return t.Pr=null,t.Cr("Backend didn't respond within 10 seconds."),t.Dr("Offline"),Promise.resolve()})))},t.prototype.Nr=function(t){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.kr(),this.Cr("Connection failed 1 times. Most recent error: "+t.toString()),this.Dr("Offline")))},t.prototype.set=function(t){this.kr(),this.vr=0,"Online"===t&&(this.Vr=!1),this.Dr(t)},t.prototype.Dr=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.Cr=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(Dr(e),this.Vr=!1):Rr("OnlineStateTracker",e)},t.prototype.kr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},t}(),Uc=function(t,e,n,r,i){var o=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Fr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=i,this.Lr.di((function(t){n.enqueueAndForget((function(){return(0,c.__awaiter)(o,void 0,void 0,(function(){return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return zc(this)?(Rr("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return(e=Ur(t)).Or.add(4),[4,qc(e)];case 1:return n.sent(),e.Br.set("Unknown"),e.Or.delete(4),[4,jc(e)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))})),this.Br=new Fc(n,r)};function jc(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:if(!zc(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function qc(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}}))}))}function Vc(t,e){var n=Ur(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),Gc(n)?Hc(n):ul(n).er()&&Kc(n,e))}function Bc(t,e){var n=Ur(t),r=ul(n);n.$r.delete(e),r.er()&&Wc(n,e),0===n.$r.size&&(r.er()?r.ir():zc(n)&&n.Br.set("Unknown"))}function Kc(t,e){t.qr.U(e.targetId),ul(t).mr(e)}function Wc(t,e){t.qr.U(e),ul(t).yr(e)}function Hc(t){t.qr=new ya({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),ul(t).start(),t.Br.Sr()}function Gc(t){return zc(t)&&!ul(t).tr()&&t.$r.size>0}function zc(t){return 0===Ur(t).Or.size}function Qc(t){t.qr=void 0}function Yc(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){return(0,c.__generator)(this,(function(e){return t.$r.forEach((function(e,n){Kc(t,e)})),[2]}))}))}function Xc(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){return(0,c.__generator)(this,(function(n){return Qc(t),Gc(t)?(t.Br.Nr(e),Hc(t)):t.Br.set("Unknown"),[2]}))}))}function $c(t,e,n){return(0,c.__awaiter)(this,void 0,void 0,(function(){var r,i,o;return(0,c.__generator)(this,(function(a){switch(a.label){case 0:if(t.Br.set("Online"),!(e instanceof va&&2===e.state&&e.cause))return[3,6];a.label=1;case 1:return a.trys.push([1,3,,5]),[4,function(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o;return(0,c.__generator)(this,(function(a){switch(a.label){case 0:n=e.cause,r=0,i=e.targetIds,a.label=1;case 1:return r<i.length?(o=i[r],t.$r.has(o)?[4,t.remoteSyncer.rejectListen(o,n)]:[3,3]):[3,5];case 2:a.sent(),t.$r.delete(o),t.qr.removeTarget(o),a.label=3;case 3:a.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(t,e)];case 2:return a.sent(),[3,5];case 3:return r=a.sent(),Rr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,Jc(t,r)];case 4:return a.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof da?t.qr.X(e):e instanceof pa?t.qr.rt(e):t.qr.et(e),n.isEqual(Hr.min()))return[3,13];a.label=7;case 7:return a.trys.push([7,11,,13]),[4,Hu(t.localStore)];case 8:return i=a.sent(),n.compareTo(i)>=0?[4,function(t,e){var n=t.qr.ut(e);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=t.$r.get(r);i&&t.$r.set(r,i.withResumeToken(n.resumeToken,e))}})),n.targetMismatches.forEach((function(e){var n=t.$r.get(e);if(n){t.$r.set(e,n.withResumeToken(ti.EMPTY_BYTE_STRING,n.snapshotVersion)),Wc(t,e);var r=new Fs(n.target,e,1,n.sequenceNumber);Kc(t,r)}})),t.remoteSyncer.applyRemoteEvent(n)}(t,n)]:[3,10];case 9:a.sent(),a.label=10;case 10:return[3,13];case 11:return Rr("RemoteStore","Failed to raise snapshot:",o=a.sent()),[4,Jc(t,o)];case 12:return a.sent(),[3,13];case 13:return[2]}}))}))}function Jc(t,e,n){return(0,c.__awaiter)(this,void 0,void 0,(function(){var r=this;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:if(!As(e))throw e;return t.Or.add(1),[4,qc(t)];case 1:return i.sent(),t.Br.set("Offline"),n||(n=function(){return Hu(t.localStore)}),t.asyncQueue.enqueueRetryable((function(){return(0,c.__awaiter)(r,void 0,void 0,(function(){return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return Rr("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Or.delete(1),[4,jc(t)];case 2:return e.sent(),[2]}}))}))})),[2]}}))}))}function Zc(t,e){return e().catch((function(n){return Jc(t,n,e)}))}function tl(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e,n,r,i,o;return(0,c.__generator)(this,(function(a){switch(a.label){case 0:e=Ur(t),n=cl(e),r=e.Fr.length>0?e.Fr[e.Fr.length-1].batchId:-1,a.label=1;case 1:if(!function(t){return zc(t)&&t.Fr.length<10}(e))return[3,7];a.label=2;case 2:return a.trys.push([2,4,,6]),[4,Qu(e.localStore,r)];case 3:return null===(i=a.sent())?(0===e.Fr.length&&n.ir(),[3,7]):(r=i.batchId,function(t,e){t.Fr.push(e);var n=cl(t);n.er()&&n.pr&&n.Er(e.mutations)}(e,i),[3,6]);case 4:return o=a.sent(),[4,Jc(e,o)];case 5:return a.sent(),[3,6];case 6:return[3,1];case 7:return el(e)&&nl(e),[2]}}))}))}function el(t){return zc(t)&&!cl(t).tr()&&t.Fr.length>0}function nl(t){cl(t).start()}function rl(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){return(0,c.__generator)(this,(function(e){return cl(t).Ar(),[2]}))}))}function il(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e,n,r,i;return(0,c.__generator)(this,(function(o){for(e=cl(t),n=0,r=t.Fr;n<r.length;n++)i=r[n],e.Er(i.mutations);return[2]}))}))}function ol(t,e,n){return(0,c.__awaiter)(this,void 0,void 0,(function(){var r,i;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return r=t.Fr.shift(),i=Ms.from(r,e,n),[4,Zc(t,(function(){return t.remoteSyncer.applySuccessfulWrite(i)}))];case 1:return o.sent(),[4,tl(t)];case 2:return o.sent(),[2]}}))}))}function al(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return e&&cl(t).pr?[4,function(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:return Qo(r=e.code)&&r!==Ar.ABORTED?(n=t.Fr.shift(),cl(t).sr(),[4,Zc(t,(function(){return t.remoteSyncer.rejectFailedWrite(n.batchId,e)}))]):[3,3];case 1:return i.sent(),[4,tl(t)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return el(t)&&nl(t),[2]}}))}))}function sl(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return n=Ur(t),e?(n.Or.delete(2),[4,jc(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,qc(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function ul(t){var e=this;return t.Ur||(t.Ur=function(t,e,n){var r=Ur(t);return r.br(),new Oc(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:Yc.bind(null,t),Ri:Xc.bind(null,t),_r:$c.bind(null,t)}),t.Mr.push((function(n){return(0,c.__awaiter)(e,void 0,void 0,(function(){return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return n?(t.Ur.sr(),Gc(t)?Hc(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:e.sent(),Qc(t),e.label=3;case 3:return[2]}}))}))}))),t.Ur}function cl(t){var e=this;return t.Kr||(t.Kr=function(t,e,n){var r=Ur(t);return r.br(),new Lc(e,r.Hi,r.credentials,r.R,n)}(t.datastore,t.asyncQueue,{Ii:rl.bind(null,t),Ri:al.bind(null,t),Ir:il.bind(null,t),Tr:ol.bind(null,t)}),t.Mr.push((function(n){return(0,c.__awaiter)(e,void 0,void 0,(function(){return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return n?(t.Kr.sr(),[4,tl(t)]):[3,2];case 1:return e.sent(),[3,4];case 2:return[4,t.Kr.stop()];case 3:e.sent(),t.Fr.length>0&&(Rr("RemoteStore","Stopping write stream with "+t.Fr.length+" pending writes"),t.Fr=[]),e.label=4;case 4:return[2]}}))}))}))),t.Kr}var ll=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Is,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(t){}))}return t.createAndSchedule=function(e,n,r,i,o){var a=new t(e,n,Date.now()+r,i,o);return a.start(r),a},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout((function(){return e.handleDelayElapsed()}),t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Nr(Ar.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueueAndForget((function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then((function(e){return t.deferred.resolve(e)}))):Promise.resolve()}))},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function hl(t,e){if(Dr("AsyncQueue",e+": "+t),As(t))return new Nr(Ar.UNAVAILABLE,e+": "+t);throw t}var fl=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||hi.comparator(e.key,n.key)}:function(t,e){return hi.comparator(t.key,e.key)},this.keyedMap=ia(),this.sortedSet=new Xo(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal((function(e,n){return t(e),!1}))},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach((function(e){t.push(e.toString())})),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),dl=function(){function t(){this.Qr=new Xo(hi.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.Qr.get(e);n?0!==t.type&&3===n.type?this.Qr=this.Qr.insert(e,t):3===t.type&&1!==n.type?this.Qr=this.Qr.insert(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.Qr=this.Qr.insert(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.Qr=this.Qr.remove(e):1===t.type&&2===n.type?this.Qr=this.Qr.insert(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.Qr=this.Qr.insert(e,{type:2,doc:t.doc}):Mr():this.Qr=this.Qr.insert(e,t)},t.prototype.jr=function(){var t=[];return this.Qr.inorderTraversal((function(e,n){t.push(n)})),t},t}(),pl=function(){function t(t,e,n,r,i,o,a,s){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}return t.fromInitialDocuments=function(e,n,r,i){var o=[];return n.forEach((function(t){o.push({type:0,doc:t})})),new t(e,n,fl.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&ao(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),vl=function(){this.Wr=void 0,this.listeners=[]},gl=function(){this.queries=new Tu((function(t){return so(t)}),ao),this.onlineState="Unknown",this.Gr=new Set};function yl(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:if(n=Ur(t),r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new vl),!i)return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),a=o,[4,n.onListen(r)];case 2:return a.Wr=c.sent(),[3,4];case 3:return s=c.sent(),u=hl(s,"Initialization of query '"+uo(e.query)+"' failed"),[2,void e.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.zr(n.onlineState),o.Wr&&e.Hr(o.Wr)&&wl(n),[2]}}))}))}function ml(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a;return(0,c.__generator)(this,(function(s){return n=Ur(t),r=e.query,i=!1,(o=n.queries.get(r))&&(a=o.listeners.indexOf(e))>=0&&(o.listeners.splice(a,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]}))}))}function _l(t,e){for(var n=Ur(t),r=!1,i=0,o=e;i<o.length;i++){var a=o[i],s=a.query,u=n.queries.get(s);if(u){for(var c=0,l=u.listeners;c<l.length;c++)l[c].Hr(a)&&(r=!0);u.Wr=a}}r&&wl(n)}function bl(t,e,n){var r=Ur(t),i=r.queries.get(e);if(i)for(var o=0,a=i.listeners;o<a.length;o++)a[o].onError(n);r.queries.delete(e)}function wl(t){t.Gr.forEach((function(t){t.next()}))}var Il=function(){function t(t,e,n){this.query=t,this.Jr=e,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return t.prototype.Hr=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new pl(t.query,t.docs,t.oldDocs,e,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(t)&&(this.Jr.next(t),o=!0):this.eo(t,this.onlineState)&&(this.no(t),o=!0),this.Xr=t,o},t.prototype.onError=function(t){this.Jr.error(t)},t.prototype.zr=function(t){this.onlineState=t;var e=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,t)&&(this.no(this.Xr),e=!0),e},t.prototype.eo=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.so&&n||t.docs.isEmpty()&&"Offline"!==e)},t.prototype.Zr=function(t){if(t.docChanges.length>0)return!0;var e=this.Xr&&this.Xr.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeMetadataChanges},t.prototype.no=function(t){t=pl.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache),this.Yr=!0,this.Jr.next(t)},t}(),Tl=function(){function t(t,e){this.payload=t,this.byteLength=e}return t.prototype.io=function(){return"metadata"in this.payload},t}(),El=function(){function t(t){this.R=t}return t.prototype.qn=function(t){return Pa(this.R,t)},t.prototype.Un=function(t){return t.metadata.exists?Ma(this.R,t.document,!1):Ai.newNoDocument(this.qn(t.metadata.name),this.Kn(t.metadata.readTime))},t.prototype.Kn=function(t){return Ca(t)},t}(),Sl=function(){function t(t,e,n){this.ro=t,this.localStore=e,this.R=n,this.queries=[],this.documents=[],this.progress=Cl(t)}return t.prototype.oo=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},t.prototype.co=function(t){for(var e=new Map,n=new El(this.R),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var a=n.qn(o.metadata.name),s=0,u=o.metadata.queries;s<u.length;s++){var c=u[s],l=(e.get(c)||ua()).add(a);e.set(c,l)}}return e},t.prototype.complete=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r,i;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return[4,ec(this.localStore,new El(this.R),this.documents,this.ro.id)];case 1:t=o.sent(),e=this.co(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?(i=r[n],[4,nc(this.localStore,i,e.get(i.name))]):[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new Fu(Object.assign({},this.progress),t))]}}))}))},t}();function Cl(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var kl=function(t){this.key=t},Al=function(t){this.key=t},Nl=function(){function t(t,e){this.query=t,this.uo=e,this.ao=null,this.current=!1,this.ho=ua(),this.mutatedKeys=ua(),this.lo=lo(t),this.fo=new fl(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(t,e){var n=this,r=e?e.mo:new dl,i=e?e.fo:this.fo,o=e?e.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=Ji(this.query)&&i.size===this.query.limit?i.last():null,c=Zi(this.query)&&i.size===this.query.limit?i.first():null;if(t.inorderTraversal((function(t,e){var l=i.get(t),h=co(n.query,e)?e:null,f=!!l&&n.mutatedKeys.has(l.key),d=!!h&&(h.hasLocalMutations||n.mutatedKeys.has(h.key)&&h.hasCommittedMutations),p=!1;l&&h?l.data.isEqual(h.data)?f!==d&&(r.track({type:3,doc:h}),p=!0):n.yo(l,h)||(r.track({type:2,doc:h}),p=!0,(u&&n.lo(h,u)>0||c&&n.lo(h,c)<0)&&(s=!0)):!l&&h?(r.track({type:0,doc:h}),p=!0):l&&!h&&(r.track({type:1,doc:l}),p=!0,(u||c)&&(s=!0)),p&&(h?(a=a.add(h),o=d?o.add(t):o.delete(t)):(a=a.delete(t),o=o.delete(t)))})),Ji(this.query)||Zi(this.query))for(;a.size>this.query.limit;){var l=Ji(this.query)?a.last():a.first();a=a.delete(l.key),o=o.delete(l.key),r.track({type:1,doc:l})}return{fo:a,mo:r,Nn:s,mutatedKeys:o}},t.prototype.yo=function(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations},t.prototype.applyChanges=function(t,e,n){var r=this,i=this.fo;this.fo=t.fo,this.mutatedKeys=t.mutatedKeys;var o=t.mo.jr();o.sort((function(t,e){return function(t,e){var n=function(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Mr()}};return n(t)-n(e)}(t.type,e.type)||r.lo(t.doc,e.doc)})),this.po(n);var a=e?this.Eo():[],s=0===this.ho.size&&this.current?1:0,u=s!==this.ao;return this.ao=s,0!==o.length||u?{snapshot:new pl(this.query,t.fo,i,o,t.mutatedKeys,0===s,u,!1),To:a}:{To:a}},t.prototype.zr=function(t){return this.current&&"Offline"===t?(this.current=!1,this.applyChanges({fo:this.fo,mo:new dl,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(t){return!this.uo.has(t)&&!!this.fo.has(t)&&!this.fo.get(t).hasLocalMutations},t.prototype.po=function(t){var e=this;t&&(t.addedDocuments.forEach((function(t){return e.uo=e.uo.add(t)})),t.modifiedDocuments.forEach((function(t){})),t.removedDocuments.forEach((function(t){return e.uo=e.uo.delete(t)})),this.current=t.current)},t.prototype.Eo=function(){var t=this;if(!this.current)return[];var e=this.ho;this.ho=ua(),this.fo.forEach((function(e){t.Io(e.key)&&(t.ho=t.ho.add(e.key))}));var n=[];return e.forEach((function(e){t.ho.has(e)||n.push(new Al(e))})),this.ho.forEach((function(t){e.has(t)||n.push(new kl(t))})),n},t.prototype.Ao=function(t){this.uo=t.Bn,this.ho=ua();var e=this._o(t.documents);return this.applyChanges(e,!0)},t.prototype.Ro=function(){return pl.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},t}(),Pl=function(t,e,n){this.query=t,this.targetId=e,this.view=n},xl=function(t){this.key=t,this.bo=!1},Rl=function(){function t(t,e,n,r,i,o){this.localStore=t,this.remoteStore=e,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new Tu((function(t){return so(t)}),ao),this.Vo=new Map,this.So=new Set,this.Do=new Xo(hi.comparator),this.Co=new Map,this.No=new ic,this.xo={},this.ko=new Map,this.Fo=hu.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return!0===this.$o},enumerable:!1,configurable:!0}),t}();function Dl(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s;return(0,c.__generator)(this,(function(u){switch(u.label){case 0:return n=uh(t),(o=n.Po.get(e))?(r=o.targetId,n.sharedClientState.addLocalQueryTarget(r),i=o.view.Ro(),[3,4]):[3,1];case 1:return[4,Yu(n.localStore,io(e))];case 2:return a=u.sent(),s=n.sharedClientState.addLocalQueryTarget(a.targetId),r=a.targetId,[4,Ol(n,e,r,"current"===s)];case 3:i=u.sent(),n.isPrimaryClient&&Vc(n.remoteStore,a),u.label=4;case 4:return[2,i]}}))}))}function Ol(t,e,n,r){return(0,c.__awaiter)(this,void 0,void 0,(function(){var i,o,a,s,u,l;return(0,c.__generator)(this,(function(h){switch(h.label){case 0:return t.Oo=function(e,n,r){return function(t,e,n,r){return(0,c.__awaiter)(this,void 0,void 0,(function(){var i,o,a;return(0,c.__generator)(this,(function(s){switch(s.label){case 0:return(i=e.view._o(n)).Nn?[4,$u(t.localStore,e.query,!1).then((function(t){var n=t.documents;return e.view._o(n,i)}))]:[3,2];case 1:i=s.sent(),s.label=2;case 2:return o=r&&r.targetChanges.get(e.targetId),a=e.view.applyChanges(i,t.isPrimaryClient,o),[2,(zl(t,e.targetId,a.To),a.snapshot)]}}))}))}(t,e,n,r)},[4,$u(t.localStore,e,!0)];case 1:return i=h.sent(),o=new Nl(e,i.Bn),a=o._o(i.documents),s=fa.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==t.onlineState),u=o.applyChanges(a,t.isPrimaryClient,s),zl(t,n,u.To),l=new Pl(e,n,o),[2,(t.Po.set(e,l),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),u.snapshot)]}}))}))}function Ll(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return n=Ur(t),r=n.Po.get(e),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter((function(t){return!ao(t,e)}))),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,Xu(n.localStore,r.targetId,!1).then((function(){n.sharedClientState.clearQueryState(r.targetId),Bc(n.remoteStore,r.targetId),Hl(n,r.targetId)})).catch(gu)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Hl(n,r.targetId),[4,Xu(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function Ml(t,e,n){return(0,c.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a;return(0,c.__generator)(this,(function(s){switch(s.label){case 0:r=ch(t),s.label=1;case 1:return s.trys.push([1,5,,6]),[4,function(t,e){var n,r=Ur(t),i=Wr.now(),o=e.reduce((function(t,e){return t.add(e.key)}),ua());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(t){return r.Mn.pn(t,o).next((function(o){n=o;for(var a=[],s=0,u=e;s<u.length;s++){var c=u[s],l=Lo(c,n.get(c.key));null!=l&&a.push(new jo(c.key,l,ki(l.value.mapValue),Po.exists(!0)))}return r._n.addMutationBatch(t,i,a,e)}))})).then((function(t){return t.applyToLocalDocumentSet(n),{batchId:t.batchId,changes:n}}))}(r.localStore,e)];case 2:return i=s.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(t,e,n){var r=t.xo[t.currentUser.toKey()];r||(r=new Xo(Vr)),r=r.insert(e,n),t.xo[t.currentUser.toKey()]=r}(r,i.batchId,n),[4,Xl(r,i.changes)];case 3:return s.sent(),[4,tl(r.remoteStore)];case 4:return s.sent(),[3,6];case 5:return o=s.sent(),a=hl(o,"Failed to persist write"),n.reject(a),[3,6];case 6:return[2]}}))}))}function Fl(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:n=Ur(t),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Gu(n.localStore,e)];case 2:return r=i.sent(),e.targetChanges.forEach((function(t,e){var r=n.Co.get(e);r&&(Fr(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1),t.addedDocuments.size>0?r.bo=!0:t.modifiedDocuments.size>0?Fr(r.bo):t.removedDocuments.size>0&&(Fr(r.bo),r.bo=!1))})),[4,Xl(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,gu(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function Ul(t,e,n){var r=Ur(t);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach((function(t,n){var r=n.view.zr(e);r.snapshot&&i.push(r.snapshot)})),function(t,e){var n=Ur(t);n.onlineState=e;var r=!1;n.queries.forEach((function(t,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(e)&&(r=!0)})),r&&wl(n)}(r.eventManager,e),i.length&&r.vo._r(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function jl(t,e,n){return(0,c.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,s,u;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:return(r=Ur(t)).sharedClientState.updateQueryState(e,"rejected",n),i=r.Co.get(e),(o=i&&i.key)?(a=(a=new Xo(hi.comparator)).insert(o,Ai.newNoDocument(o,Hr.min())),s=ua().add(o),u=new ha(Hr.min(),new Map,new Zo(Vr),a,s),[4,Fl(r,u)]):[3,2];case 1:return c.sent(),r.Do=r.Do.remove(o),r.Co.delete(e),Yl(r),[3,4];case 2:return[4,Xu(r.localStore,e,!1).then((function(){return Hl(r,e,n)})).catch(gu)];case 3:c.sent(),c.label=4;case 4:return[2]}}))}))}function ql(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:n=Ur(t),r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,Wu(n.localStore,e)];case 2:return i=o.sent(),Wl(n,r,null),Kl(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,Xl(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,gu(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Vl(t,e,n){return(0,c.__awaiter)(this,void 0,void 0,(function(){var r,i;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:r=Ur(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=Ur(t);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(t){var r;return n._n.lookupMutationBatch(t,e).next((function(e){return Fr(null!==e),r=e.keys(),n._n.removeMutationBatch(t,e)})).next((function(){return n._n.performConsistencyCheck(t)})).next((function(){return n.Mn.pn(t,r)}))}))}(r.localStore,e)];case 2:return i=o.sent(),Wl(r,e,n),Kl(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,Xl(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,gu(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Bl(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a;return(0,c.__generator)(this,(function(s){switch(s.label){case 0:zc((n=Ur(t)).remoteStore)||Rr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,function(t){var e=Ur(t);return e.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(t){return e._n.getHighestUnacknowledgedBatchId(t)}))}(n.localStore)];case 2:return-1===(r=s.sent())?[2,void e.resolve()]:((i=n.ko.get(r)||[]).push(e),n.ko.set(r,i),[3,4]);case 3:return o=s.sent(),a=hl(o,"Initialization of waitForPendingWrites() operation failed"),e.reject(a),[3,4];case 4:return[2]}}))}))}function Kl(t,e){(t.ko.get(e)||[]).forEach((function(t){t.resolve()})),t.ko.delete(e)}function Wl(t,e,n){var r=Ur(t),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(e);o&&(n?o.reject(n):o.resolve(),i=i.remove(e)),r.xo[r.currentUser.toKey()]=i}}function Hl(t,e,n){void 0===n&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,i=t.Vo.get(e);r<i.length;r++){var o=i[r];t.Po.delete(o),n&&t.vo.Mo(o,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach((function(e){t.No.containsKey(e)||Gl(t,e)}))}function Gl(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);null!==n&&(Bc(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),Yl(t))}function zl(t,e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof kl?(t.No.addReference(o.key,e),Ql(t,o)):o instanceof Al?(Rr("SyncEngine","Document no longer in limbo: "+o.key),t.No.removeReference(o.key,e),t.No.containsKey(o.key)||Gl(t,o.key)):Mr()}}function Ql(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(Rr("SyncEngine","New document in limbo: "+n),t.So.add(r),Yl(t))}function Yl(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new hi(Xr.fromString(e)),r=t.Fo.next();t.Co.set(r,new xl(n)),t.Do=t.Do.insert(n,r),Vc(t.remoteStore,new Fs(io($i(n.path)),r,2,kr.o))}}function Xl(t,e,n){return(0,c.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a;return(0,c.__generator)(this,(function(s){switch(s.label){case 0:return r=Ur(t),i=[],o=[],a=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach((function(t,s){a.push(r.Oo(s,e,n).then((function(t){if(t){r.isPrimaryClient&&r.sharedClientState.updateQueryState(s.targetId,t.fromCache?"not-current":"current"),i.push(t);var e=ju.Pn(s.targetId,t);o.push(e)}})))})),[4,Promise.all(a)]);case 1:return s.sent(),r.vo._r(i),[4,function(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,l,h;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:n=Ur(t),c.label=1;case 1:return c.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(t){return Ts.forEach(e,(function(e){return Ts.forEach(e.bn,(function(r){return n.persistence.referenceDelegate.addReference(t,e.targetId,r)})).next((function(){return Ts.forEach(e.vn,(function(r){return n.persistence.referenceDelegate.removeReference(t,e.targetId,r)}))}))}))}))];case 2:return c.sent(),[3,4];case 3:if(!As(r=c.sent()))throw r;return Rr("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)a=o[i],s=a.targetId,a.fromCache||(u=n.kn.get(s),l=u.snapshotVersion,h=u.withLastLimboFreeSnapshotVersion(l),n.kn=n.kn.insert(s,h));return[2]}}))}))}(r.localStore,o)];case 2:s.sent(),s.label=3;case 3:return[2]}}))}))}function $l(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:return(n=Ur(t)).currentUser.isEqual(e)?[3,3]:(Rr("SyncEngine","User change. New user:",e.toKey()),[4,Ku(n.localStore,e)]);case 1:return r=i.sent(),n.currentUser=e,function(t,e){t.ko.forEach((function(t){t.forEach((function(t){t.reject(new Nr(Ar.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),t.ko.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,Xl(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function Jl(t,e){var n=Ur(t),r=n.Co.get(e);if(r&&r.bo)return ua().add(r.key);var i=ua(),o=n.Vo.get(e);if(!o)return i;for(var a=0,s=o;a<s.length;a++){var u=s[a],c=n.Po.get(u);i=i.unionWith(c.view.wo)}return i}function Zl(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return[4,$u((n=Ur(t)).localStore,e.query,!0)];case 1:return r=o.sent(),i=e.view.Ao(r),[2,(n.isPrimaryClient&&zl(n,e.targetId,i.To),i)]}}))}))}function th(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e;return(0,c.__generator)(this,(function(n){return[2,Zu((e=Ur(t)).localStore).then((function(t){return Xl(e,t)}))]}))}))}function eh(t,e,n,r){return(0,c.__awaiter)(this,void 0,void 0,(function(){var i,o;return(0,c.__generator)(this,(function(a){switch(a.label){case 0:return[4,function(t,e){var n=Ur(t),r=Ur(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(t){return r.jt(t,e).next((function(e){return e?n.Mn.pn(t,e):Ts.resolve(null)}))}))}((i=Ur(t)).localStore,e)];case 1:return null===(o=a.sent())?[3,6]:"pending"!==n?[3,3]:[4,tl(i.remoteStore)];case 2:return a.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Wl(i,e,r||null),Kl(i,e),function(t,e){Ur(Ur(t)._n).Gt(e)}(i.localStore,e)):Mr(),a.label=4;case 4:return[4,Xl(i,o)];case 5:return a.sent(),[3,7];case 6:Rr("SyncEngine","Cannot apply mutation batch with id: "+e),a.label=7;case 7:return[2]}}))}))}function nh(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,l;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:return uh(n=Ur(t)),ch(n),!0!==e||!0===n.$o?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,rh(n,r.toArray())]);case 1:return i=c.sent(),n.$o=!0,[4,sl(n.remoteStore,!0)];case 2:for(c.sent(),o=0,a=i;o<a.length;o++)s=a[o],Vc(n.remoteStore,s);return[3,7];case 3:return!1!==e||!1===n.$o?[3,7]:(u=[],l=Promise.resolve(),n.Vo.forEach((function(t,e){n.sharedClientState.isLocalQueryTarget(e)?u.push(e):l=l.then((function(){return Hl(n,e),Xu(n.localStore,e,!0)})),Bc(n.remoteStore,e)})),[4,l]);case 4:return c.sent(),[4,rh(n,u)];case 5:return c.sent(),function(t){var e=Ur(t);e.Co.forEach((function(t,n){Bc(e.remoteStore,n)})),e.No.ts(),e.Co=new Map,e.Do=new Xo(hi.comparator)}(n),n.$o=!1,[4,sl(n.remoteStore,!1)];case 6:c.sent(),c.label=7;case 7:return[2]}}))}))}function rh(t,e,n){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,l,h,f,d,p,v,g;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:n=Ur(t),r=[],i=[],o=0,a=e,c.label=1;case 1:return o<a.length?(s=a[o],u=void 0,(l=n.Vo.get(s))&&0!==l.length?[4,Yu(n.localStore,io(l[0]))]:[3,7]):[3,13];case 2:u=c.sent(),h=0,f=l,c.label=3;case 3:return h<f.length?(d=f[h],p=n.Po.get(d),[4,Zl(n,p)]):[3,6];case 4:(v=c.sent()).snapshot&&i.push(v.snapshot),c.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,Ju(n.localStore,s)];case 8:return g=c.sent(),[4,Yu(n.localStore,g)];case 9:return u=c.sent(),[4,Ol(n,ih(g),s,!1)];case 10:c.sent(),c.label=11;case 11:r.push(u),c.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}}))}))}function ih(t){return Xi(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function oh(t){var e=Ur(t);return Ur(Ur(e.localStore).persistence).fn()}function ah(t,e,n,r){return(0,c.__awaiter)(this,void 0,void 0,(function(){var i,o,a;return(0,c.__generator)(this,(function(s){switch(s.label){case 0:return(i=Ur(t)).$o?(Rr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Zu(i.localStore)];case 3:return o=s.sent(),a=ha.createSynthesizedRemoteEventForCurrentChange(e,"current"===n),[4,Xl(i,o,a)];case 4:return s.sent(),[3,8];case 5:return[4,Xu(i.localStore,e,!0)];case 6:return s.sent(),Hl(i,e,r),[3,8];case 7:Mr(),s.label=8;case 8:return[2]}}))}))}function sh(t,e,n){return(0,c.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,s,u,l,h,f,d;return(0,c.__generator)(this,(function(p){switch(p.label){case 0:if(!(r=uh(t)).$o)return[3,10];i=0,o=e,p.label=1;case 1:return i<o.length?(a=o[i],r.Vo.has(a)?(Rr("SyncEngine","Adding an already active target "+a),[3,5]):[4,Ju(r.localStore,a)]):[3,6];case 2:return s=p.sent(),[4,Yu(r.localStore,s)];case 3:return u=p.sent(),[4,Ol(r,ih(s),u.targetId,!1)];case 4:p.sent(),Vc(r.remoteStore,u),p.label=5;case 5:return i++,[3,1];case 6:l=function(t){return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return r.Vo.has(t)?[4,Xu(r.localStore,t,!1).then((function(){Bc(r.remoteStore,t),Hl(r,t)})).catch(gu)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))},h=0,f=n,p.label=7;case 7:return h<f.length?(d=f[h],[5,l(d)]):[3,10];case 8:p.sent(),p.label=9;case 9:return h++,[3,7];case 10:return[2]}}))}))}function uh(t){var e=Ur(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Fl.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Jl.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=jl.bind(null,e),e.vo._r=_l.bind(null,e.eventManager),e.vo.Mo=bl.bind(null,e.eventManager),e}function ch(t){var e=Ur(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ql.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Vl.bind(null,e),e}function lh(t,e,n){var r=Ur(t);(function(t,e,n){return(0,c.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,s,u;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:return c.trys.push([0,14,,15]),[4,e.getMetadata()];case 1:return r=c.sent(),[4,function(t,e){var n=Ur(t),r=Ca(e.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(function(t){return n.Ke.getBundleMetadata(t,e.id)})).then((function(t){return!!t&&t.createTime.compareTo(r)>=0}))}(t.localStore,r)];case 2:return c.sent()?[4,e.close()]:[3,4];case 3:return[2,(c.sent(),void n._completeWith(function(t){return{taskState:"Success",documentsLoaded:t.totalDocuments,bytesLoaded:t.totalBytes,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}(r)))];case 4:return n._updateProgress(Cl(r)),i=new Sl(r,t.localStore,e.R),[4,e.Lo()];case 5:o=c.sent(),c.label=6;case 6:return o?[4,i.oo(o)]:[3,10];case 7:return(a=c.sent())&&n._updateProgress(a),[4,e.Lo()];case 8:o=c.sent(),c.label=9;case 9:return[3,6];case 10:return[4,i.complete()];case 11:return s=c.sent(),[4,Xl(t,s.wn,void 0)];case 12:return c.sent(),[4,function(t,e){var n=Ur(t);return n.persistence.runTransaction("Save bundle","readwrite",(function(t){return n.Ke.saveBundleMetadata(t,e)}))}(t.localStore,r)];case 13:return c.sent(),n._completeWith(s.progress),[3,15];case 14:return Or("SyncEngine","Loading bundle failed with "+(u=c.sent())),n._failWith(u),[3,15];case 15:return[2]}}))}))})(r,e,n).then((function(){r.sharedClientState.notifyBundleLoaded()}))}var hh=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return this.R=xc(t.databaseInfo.databaseId),this.sharedClientState=this.Bo(t),this.persistence=this.qo(t),[4,this.persistence.start()];case 1:return e.sent(),this.gcScheduler=this.Uo(t),this.localStore=this.Ko(t),[2]}}))}))},t.prototype.Uo=function(t){return null},t.prototype.Ko=function(t){return Bu(this.persistence,new qu,t.initialUser,this.R)},t.prototype.qo=function(t){return new lc(fc.bs,this.R)},t.prototype.Bo=function(t){return new Tc},t.prototype.terminate=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return t.sent(),[4,this.persistence.shutdown()];case 2:return t.sent(),[2]}}))}))},t}(),fh=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).Qo=e,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return(0,c.__extends)(e,t),e.prototype.initialize=function(e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n=this;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return r.sent(),[4,tc(this.localStore)];case 2:return r.sent(),[4,this.Qo.initialize(this,e)];case 3:return r.sent(),[4,ch(this.Qo.syncEngine)];case 4:return r.sent(),[4,tl(this.Qo.remoteStore)];case 5:return r.sent(),[4,this.persistence.He((function(){return n.gcScheduler&&!n.gcScheduler.started&&n.gcScheduler.start(n.localStore),Promise.resolve()}))];case 6:return r.sent(),[2]}}))}))},e.prototype.Ko=function(t){return Bu(this.persistence,new qu,t.initialUser,this.R)},e.prototype.Uo=function(t){var e=this.persistence.referenceDelegate.garbageCollector;return new _u(e,t.asyncQueue)},e.prototype.qo=function(t){var e=Mu(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?ru.withCacheSize(this.cacheSizeBytes):ru.DEFAULT;return new Du(this.synchronizeTabs,e,t.clientId,n,t.asyncQueue,Nc(),Pc(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(t){return new Tc},e}(hh),dh=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n,!1)||this).Qo=e,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return(0,c.__extends)(e,t),e.prototype.initialize=function(e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r=this;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:return[4,t.prototype.initialize.call(this,e)];case 1:return i.sent(),n=this.Qo.syncEngine,this.sharedClientState instanceof Ic?(this.sharedClientState.syncEngine={ui:eh.bind(null,n),ai:ah.bind(null,n),hi:sh.bind(null,n),fn:oh.bind(null,n),ci:th.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He((function(t){return(0,c.__awaiter)(r,void 0,void 0,(function(){return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return[4,nh(this.Qo.syncEngine,t)];case 1:return e.sent(),this.gcScheduler&&(t&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):t||this.gcScheduler.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},e.prototype.Bo=function(t){var e=Nc();if(!Ic.yt(e))throw new Nr(Ar.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=Mu(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new Ic(e,t.asyncQueue,n,t.clientId,t.initialUser)},e}(fh),ph=function(){function t(){}return t.prototype.initialize=function(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n=this;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(t){return Ul(n.syncEngine,t,1)},this.remoteStore.remoteSyncer.handleCredentialChange=$l.bind(null,this.syncEngine),[4,sl(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.createEventManager=function(t){return new gl},t.prototype.createDatastore=function(t){var e,n=xc(t.databaseInfo.databaseId),r=(e=t.databaseInfo,new Ac(e));return function(t,e,n){return new Mc(t,e,n)}(t.credentials,r,n)},t.prototype.createRemoteStore=function(t){var e,n,r,i,o,a=this;return e=this.localStore,n=this.datastore,r=t.asyncQueue,i=function(t){return Ul(a.syncEngine,t,0)},o=Sc.yt()?new Sc:new Ec,new Uc(e,n,r,i,o)},t.prototype.createSyncEngine=function(t,e){return function(t,e,n,r,i,o,a){var s=new Rl(t,e,n,r,i,o);return a&&(s.$o=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)},t.prototype.terminate=function(){return function(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return e=Ur(t),Rr("RemoteStore","RemoteStore shutting down."),e.Or.add(5),[4,qc(e)];case 1:return n.sent(),e.Lr.shutdown(),e.Br.set("Unknown"),[2]}}))}))}(this.remoteStore)},t}();function vh(t,e){void 0===e&&(e=10240);var n=0;return{read:function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){var r;return(0,c.__generator)(this,(function(i){return n<t.byteLength?(r={value:t.slice(n,n+e),done:!1},[2,(n+=e,r)]):[2,{done:!0}]}))}))},cancel:function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){return(0,c.__generator)(this,(function(t){return[2]}))}))},releaseLock:function(){},closed:Promise.reject("unimplemented")}}var gh=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.observer.next&&this.jo(this.observer.next,t)},t.prototype.error=function(t){this.observer.error?this.jo(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(t,e){var n=this;this.muted||setTimeout((function(){n.muted||t(e)}),0)},t}(),yh=function(){function t(t,e){var n=this;this.Go=t,this.R=e,this.metadata=new Is,this.buffer=new Uint8Array,this.zo=new TextDecoder("utf-8"),this.Ho().then((function(t){t&&t.io()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))}),(function(t){return n.metadata.reject(t)}))}return t.prototype.close=function(){return this.Go.cancel()},t.prototype.getMetadata=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){return(0,c.__generator)(this,(function(t){return[2,this.metadata.promise]}))}))},t.prototype.Lo=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.Ho())]}}))}))},t.prototype.Ho=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.Jo()];case 1:return null===(t=i.sent())?[2,null]:(e=this.zo.decode(t),n=Number(e),isNaN(n)&&this.Yo("length string ("+e+") is not valid number"),[4,this.Xo(n)]);case 2:return r=i.sent(),[2,new Tl(JSON.parse(r),t.length+n)]}}))}))},t.prototype.Zo=function(){return this.buffer.findIndex((function(t){return t==="{".charCodeAt(0)}))},t.prototype.Jo=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return this.Zo()<0?[4,this.tc()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.Zo())<0&&this.Yo("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}}))}))},t.prototype.Xo=function(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.tc()]:[3,3];case 1:n.sent()&&this.Yo("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.zo.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}}))}))},t.prototype.Yo=function(t){throw this.Go.cancel(),new Error("Invalid bundle format: "+t)},t.prototype.tc=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.Go.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}}))}))},t}(),mh=function(){function t(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e,n=this;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new Nr(Ar.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s;return(0,c.__generator)(this,(function(u){switch(u.label){case 0:return n=Ur(t),r=Da(n.R)+"/documents",i={documents:e.map((function(t){return Na(n.R,t)}))},[4,n.$i("BatchGetDocuments",r,i)];case 1:return o=u.sent(),a=new Map,o.forEach((function(t){var e=function(t,e){return"found"in e?function(t,e){Fr(!!e.found),e.found.name,e.found.updateTime;var n=Pa(t,e.found.name),r=Ca(e.found.updateTime),i=new Ci({mapValue:{fields:e.found.fields}});return Ai.newFoundDocument(n,r,i)}(t,e):"missing"in e?function(t,e){Fr(!!e.missing),Fr(!!e.readTime);var n=Pa(t,e.missing),r=Ca(e.readTime);return Ai.newNoDocument(n,r)}(t,e):Mr()}(n.R,t);a.set(e.key.toString(),e)})),s=[],[2,(e.forEach((function(t){var e=a.get(t.toString());Fr(!!e),s.push(e)})),s)]}}))}))}(this.datastore,t)];case 1:return[2,((e=r.sent()).forEach((function(t){return n.recordVersion(t)})),e)]}}))}))},t.prototype.set=function(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.update=function(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(t){this.lastWriteError=t}this.writtenDocs.add(t.toString())},t.prototype.delete=function(t){this.write(new Ho(t,this.precondition(t))),this.writtenDocs.add(t.toString())},t.prototype.commit=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){var t,e=this;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return t=this.readVersions,this.mutations.forEach((function(e){t.delete(e.key.toString())})),t.forEach((function(t,n){var r=hi.fromPath(n);e.mutations.push(new Go(r,e.precondition(r)))})),[4,function(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return n=Ur(t),r=Da(n.R)+"/documents",i={writes:e.map((function(t){return Fa(n.R,t)}))},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},t.prototype.recordVersion=function(t){var e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw Mr();e=Hr.min()}var n=this.readVersions.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Nr(Ar.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)},t.prototype.precondition=function(t){var e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?Po.updateTime(e):Po.none()},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(Hr.min()))throw new Nr(Ar.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Po.updateTime(e)}return Po.exists(!0)},t.prototype.write=function(t){this.ensureCommitNotCalled(),this.mutations.push(t)},t.prototype.ensureCommitNotCalled=function(){},t}(),_h=function(){function t(t,e,n,r){this.asyncQueue=t,this.datastore=e,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new Rc(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.ec-=1,this.nc()},t.prototype.nc=function(){var t=this;this.Zi.ji((function(){return(0,c.__awaiter)(t,void 0,void 0,(function(){var t,e,n=this;return(0,c.__generator)(this,(function(r){return t=new mh(this.datastore),(e=this.sc(t))&&e.then((function(e){n.asyncQueue.enqueueAndForget((function(){return t.commit().then((function(){n.deferred.resolve(e)})).catch((function(t){n.ic(t)}))}))})).catch((function(t){n.ic(t)})),[2]}))}))}))},t.prototype.sc=function(t){try{var e=this.updateFunction(t);return!ui(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}},t.prototype.ic=function(t){var e=this;this.ec>0&&this.rc(t)?(this.ec-=1,this.asyncQueue.enqueueAndForget((function(){return e.nc(),Promise.resolve()}))):this.deferred.reject(t)},t.prototype.rc=function(t){if("FirebaseError"===t.name){var e=t.code;return"aborted"===e||"failed-precondition"===e||!Qo(e)}return!1},t}(),bh=function(){function t(t,e,n){var r=this;this.credentials=t,this.asyncQueue=e,this.databaseInfo=n,this.user=dc.UNAUTHENTICATED,this.clientId=qr.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(e,(function(t){return(0,c.__awaiter)(r,void 0,void 0,(function(){return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return Rr("FirestoreClient","Received user=",t.uid),[4,this.credentialListener(t)];case 1:return e.sent(),this.user=t,[2]}}))}))}))}return t.prototype.getConfiguration=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){return(0,c.__generator)(this,(function(t){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]}))}))},t.prototype.setCredentialChangeListener=function(t){this.credentialListener=t},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new Nr(Ar.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var t=this;this.asyncQueue.enterRestrictedMode();var e=new Is;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((function(){return(0,c.__awaiter)(t,void 0,void 0,(function(){var t,n;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),e.resolve(),[3,6];case 5:return t=r.sent(),n=hl(t,"Failed to shutdown persistence"),e.reject(n),[3,6];case 6:return[2]}}))}))})),e.promise},t}();function wh(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r,i=this;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),Rr("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.initialUser,t.setCredentialChangeListener((function(t){return(0,c.__awaiter)(i,void 0,void 0,(function(){return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return r.isEqual(t)?[3,2]:[4,Ku(e.localStore,t)];case 1:n.sent(),r=t,n.label=2;case 2:return[2]}}))}))})),e.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=e,[2]}}))}))}function Ih(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,Th(t)];case 1:return n=i.sent(),Rr("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.setCredentialChangeListener((function(t){return function(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:return(n=Ur(t)).asyncQueue.verifyOperationInProgress(),Rr("RemoteStore","RemoteStore received new credentials"),r=zc(n),n.Or.add(3),[4,qc(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(e)];case 2:return i.sent(),n.Or.delete(3),[4,jc(n)];case 3:return i.sent(),[2]}}))}))}(e.remoteStore,t)})),t.onlineComponents=e,[2]}}))}))}function Th(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(Rr("FirestoreClient","Using default OfflineComponentProvider"),[4,wh(t,new hh)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}}))}))}function Eh(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(Rr("FirestoreClient","Using default OnlineComponentProvider"),[4,Ih(t,new ph)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}}))}))}function Sh(t){return Th(t).then((function(t){return t.persistence}))}function Ch(t){return Th(t).then((function(t){return t.localStore}))}function kh(t){return Eh(t).then((function(t){return t.remoteStore}))}function Ah(t){return Eh(t).then((function(t){return t.syncEngine}))}function Nh(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return[4,Eh(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=Dl.bind(null,e.syncEngine),n.onUnlisten=Ll.bind(null,e.syncEngine),n)]}}))}))}function Ph(t,e,n){var r=this;void 0===n&&(n={});var i=new Is;return t.asyncQueue.enqueueAndForget((function(){return(0,c.__awaiter)(r,void 0,void 0,(function(){var r;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new gh({next:function(o){e.enqueueAndForget((function(){return ml(t,a)}));var s=o.docs.has(n);!s&&o.fromCache?i.reject(new Nr(Ar.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&o.fromCache&&r&&"server"===r.source?i.reject(new Nr(Ar.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),a=new Il($i(n.path),o,{includeMetadataChanges:!0,so:!0});return yl(t,a)},[4,Nh(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}function xh(t,e,n){var r=this;void 0===n&&(n={});var i=new Is;return t.asyncQueue.enqueueAndForget((function(){return(0,c.__awaiter)(r,void 0,void 0,(function(){var r;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new gh({next:function(n){e.enqueueAndForget((function(){return ml(t,a)})),n.fromCache&&"server"===r.source?i.reject(new Nr(Ar.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),a=new Il(n,o,{includeMetadataChanges:!0,so:!0});return yl(t,a)},[4,Nh(t)];case 1:return[2,r.apply(void 0,[o.sent(),t.asyncQueue,e,n,i])]}}))}))})),i.promise}var Rh=function(t,e,n,r,i,o,a,s){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.useFetchStreams=s},Dh=function(){function t(t,e){this.projectId=t,this.database=e||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),Oh=new Map,Lh=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},Mh=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){this.changeListener=e,t.enqueueRetryable((function(){return e(dc.UNAUTHENTICATED)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Fh=function(){function t(t){this.token=t,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(t,e){var n=this;this.changeListener=e,t.enqueueRetryable((function(){return e(n.token.user)}))},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),Uh=function(){function t(t){var e=this;this.currentUser=dc.UNAUTHENTICATED,this.oc=new Is,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){e.cc++,e.currentUser=e.ac(),e.oc.resolve(),e.changeListener&&e.asyncQueue.enqueueRetryable((function(){return e.changeListener(e.currentUser)}))};var n=function(t){Rr("FirebaseCredentialsProvider","Auth detected"),e.auth=t,e.auth.addAuthTokenListener(e.uc)};t.onInit((function(t){return n(t)})),setTimeout((function(){if(!e.auth){var r=t.getImmediate({optional:!0});r?n(r):(Rr("FirebaseCredentialsProvider","Auth not yet detected"),e.oc.resolve())}}),0)}return t.prototype.getToken=function(){var t=this,e=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return t.cc!==e?(Rr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Fr("string"==typeof n.accessToken),new Lh(n.accessToken,t.currentUser)):null})):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(t,e){var n=this;this.asyncQueue=t,this.asyncQueue.enqueueRetryable((function(){return(0,c.__awaiter)(n,void 0,void 0,(function(){return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.oc.promise];case 1:return t.sent(),[4,e(this.currentUser)];case 2:return t.sent(),this.changeListener=e,[2]}}))}))}))},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.ac=function(){var t=this.auth&&this.auth.getUid();return Fr(null===t||"string"==typeof t),new dc(t)},t}(),jh=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n,this.type="FirstParty",this.user=dc.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var t={"X-Goog-AuthUser":this.lc},e=this.hc.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),this.fc&&(t["X-Goog-Iam-Authorization-Token"]=this.fc),t},enumerable:!1,configurable:!0}),t}(),qh=function(){function t(t,e,n){this.hc=t,this.lc=e,this.fc=n}return t.prototype.getToken=function(){return Promise.resolve(new jh(this.hc,this.lc,this.fc))},t.prototype.setChangeListener=function(t,e){t.enqueueRetryable((function(){return e(dc.FIRST_PARTY)}))},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();function Vh(t,e,n){if(!n)throw new Nr(Ar.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function Bh(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function Kh(t,e,n,r){if(!0===e&&!0===r)throw new Nr(Ar.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function Wh(t){if(!hi.isDocumentKey(t))throw new Nr(Ar.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function Hh(t){if(hi.isDocumentKey(t))throw new Nr(Ar.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Gh(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"==typeof t){if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&e.length>1)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return"function"==typeof t?"a function":Mr()}function zh(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Nr(Ar.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Gh(t);throw new Nr(Ar.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function Qh(t,e){if(e<=0)throw new Nr(Ar.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Yh=function(){function t(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Nr(Ar.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Nr(Ar.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,Kh("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams},t}(),Xh=function(){function t(t,e){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Yh({}),this._settingsFrozen=!1,t instanceof Dh?(this._databaseId=t,this._credentials=new Mh):(this._app=t,this._databaseId=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Nr(Ar.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Dh(t.options.projectId)}(t),this._credentials=new Uh(e))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new Nr(Ar.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(t){if(this._settingsFrozen)throw new Nr(Ar.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Yh(t),void 0!==t.credentials&&(this._credentials=function(t){if(!t)return new Mh;switch(t.type){case"gapi":var e=t.client;return Fr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new qh(e,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new Nr(Ar.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return this,(t=Oh.get(this))&&(Rr("ComponentProvider","Removing Datastore"),Oh.delete(this),t.terminate()),Promise.resolve();var t},t}(),$h=function(){function t(t,e,n){this.converter=e,this._key=n,this.type="document",this.firestore=t}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Zh(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),Jh=function(){function t(t,e,n){this.converter=e,this._query=n,this.type="query",this.firestore=t}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),Zh=function(t){function e(e,n,r){var i=this;return(i=t.call(this,e,n,$i(r))||this)._path=r,i.type="collection",i}return(0,c.__extends)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._path.popLast();return t.isEmpty()?null:new $h(this.firestore,null,new hi(t))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._path)},e}(Jh);function tf(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=(0,l.getModularInstance)(t),Vh("collection","path",e),t instanceof Xh)return Hh(n=Xr.fromString.apply(Xr,(0,c.__spreadArray)([e],r))),new Zh(t,null,n);if(!(t instanceof $h||t instanceof Zh))throw new Nr(Ar.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Hh(n=Xr.fromString.apply(Xr,(0,c.__spreadArray)([t.path],r)).child(Xr.fromString(e))),new Zh(t.firestore,null,n)}function ef(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t=(0,l.getModularInstance)(t),1===arguments.length&&(e=qr.u()),Vh("doc","path",e),t instanceof Xh)return Wh(n=Xr.fromString.apply(Xr,(0,c.__spreadArray)([e],r))),new $h(t,null,new hi(n));if(!(t instanceof $h||t instanceof Zh))throw new Nr(Ar.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Wh(n=t._path.child(Xr.fromString.apply(Xr,(0,c.__spreadArray)([e],r)))),new $h(t.firestore,t instanceof Zh?t.converter:null,new hi(n))}function nf(t,e){return t=(0,l.getModularInstance)(t),e=(0,l.getModularInstance)(e),(t instanceof $h||t instanceof Zh)&&(e instanceof $h||e instanceof Zh)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function rf(t,e){return t=(0,l.getModularInstance)(t),e=(0,l.getModularInstance)(e),t instanceof Jh&&e instanceof Jh&&t.firestore===e.firestore&&ao(t._query,e._query)&&t.converter===e.converter}var of=function(){function t(){var t=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=!1,this.Tc=[],this.Zi=new Rc(this,"async_queue_retry"),this.Ic=function(){var e=Pc();e&&Rr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Zi.Gi()};var e=Pc();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ic)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(t){this.enqueue(t)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(t){this.Ac(),this.Rc(t)},t.prototype.enterRestrictedMode=function(t){if(!this._c){this._c=!0,this.Ec=t||!1;var e=Pc();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Ic)}},t.prototype.enqueue=function(t){var e=this;if(this.Ac(),this._c)return new Promise((function(){}));var n=new Is;return this.Rc((function(){return e._c&&e.Ec?Promise.resolve():(t().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))},t.prototype.enqueueRetryable=function(t){var e=this;this.enqueueAndForget((function(){return e.wc.push(t),e.bc()}))},t.prototype.bc=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){var t,e=this;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:if(0===this.wc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return n.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!As(t=n.sent()))throw t;return Rr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:this.wc.length>0&&this.Zi.ji((function(){return e.bc()})),n.label=5;case 5:return[2]}}))}))},t.prototype.Rc=function(t){var e=this,n=this.dc.then((function(){return e.gc=!0,t().catch((function(t){throw e.yc=t,e.gc=!1,Dr("INTERNAL UNHANDLED ERROR: ",function(t){var e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+"\n"+t.stack),e}(t)),t})).then((function(t){return e.gc=!1,t}))}));return this.dc=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.Ac(),this.Tc.indexOf(t)>-1&&(e=0);var i=ll.createAndSchedule(this,t,e,n,(function(t){return r.vc(t)}));return this.mc.push(i),i},t.prototype.Ac=function(){this.yc&&Mr()},t.prototype.verifyOperationInProgress=function(){},t.prototype.Pc=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){var t;return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return[4,t=this.dc];case 1:e.sent(),e.label=2;case 2:if(t!==this.dc)return[3,0];e.label=3;case 3:return[2]}}))}))},t.prototype.Vc=function(t){for(var e=0,n=this.mc;e<n.length;e++)if(n[e].timerId===t)return!0;return!1},t.prototype.Sc=function(t){var e=this;return this.Pc().then((function(){e.mc.sort((function(t,e){return t.targetTimeMs-e.targetTimeMs}));for(var n=0,r=e.mc;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==t&&i.timerId===t)break}return e.Pc()}))},t.prototype.Dc=function(t){this.Tc.push(t)},t.prototype.vc=function(t){var e=this.mc.indexOf(t);this.mc.splice(e,1)},t}();function af(t){return function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=t,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(t)}var sf=function(){function t(){this._progressObserver={},this._taskCompletionResolver=new Is,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}return t.prototype.onProgress=function(t,e,n){this._progressObserver={next:t,error:e,complete:n}},t.prototype.catch=function(t){return this._taskCompletionResolver.promise.catch(t)},t.prototype.then=function(t,e){return this._taskCompletionResolver.promise.then(t,e)},t.prototype._completeWith=function(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)},t.prototype._failWith=function(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)},t.prototype._updateProgress=function(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)},t}(),uf=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).type="firestore",r._queue=new of,r._persistenceKey="name"in e?e.name:"[DEFAULT]",r}return(0,c.__extends)(e,t),e.prototype._terminate=function(){return this._firestoreClient||lf(this),this._firestoreClient.terminate()},e}(Xh);function cf(t){return t._firestoreClient||lf(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function lf(t){var e,n=t._freezeSettings(),r=function(t,e,n,r){return new Rh(t,e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(t._databaseId,(null===(e=t._app)||void 0===e?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new bh(t._credentials,t._queue,r)}function hf(t,e,n){var r=this,i=new Is;return t.asyncQueue.enqueue((function(){return(0,c.__awaiter)(r,void 0,void 0,(function(){var r;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,wh(t,n)];case 1:return o.sent(),[4,Ih(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(t){return"FirebaseError"===t.name?t.code===Ar.FAILED_PRECONDITION||t.code===Ar.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function ff(t){if(t._initialized||t._terminated)throw new Nr(Ar.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var df=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Jr(t)}return t.prototype.isEqual=function(t){return this._internalPath.isEqual(t._internalPath)},t}(),pf=function(){function t(t){this._byteString=t}return t.fromBase64String=function(e){try{return new t(ti.fromBase64String(e))}catch(e){throw new Nr(Ar.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}},t.fromUint8Array=function(e){return new t(ti.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._byteString.isEqual(t._byteString)},t}(),vf=function(t){this._methodName=t},gf=function(){function t(t,e){if(!isFinite(t)||t<-90||t>90)throw new Nr(Ar.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new Nr(Ar.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(t){return Vr(this._lat,t._lat)||Vr(this._long,t._long)},t}(),yf=/^__.*__$/,mf=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return null!==this.fieldMask?new jo(t,this.data,this.fieldMask,e,this.fieldTransforms):new Uo(t,this.data,e,this.fieldTransforms)},t}(),_f=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutation=function(t,e){return new jo(t,this.data,this.fieldMask,e,this.fieldTransforms)},t}();function bf(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Mr()}}var wf=function(){function t(t,e,n,r,i,o){this.settings=t,this.databaseId=e,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Cc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Nc",{get:function(){return this.settings.Nc},enumerable:!1,configurable:!0}),t.prototype.xc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.kc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.xc({path:n,Fc:!1});return r.$c(t),r},t.prototype.Oc=function(t){var e,n=null===(e=this.path)||void 0===e?void 0:e.child(t),r=this.xc({path:n,Fc:!1});return r.Cc(),r},t.prototype.Mc=function(t){return this.xc({path:void 0,Fc:!0})},t.prototype.Lc=function(t){return Vf(t,this.settings.methodName,this.settings.Bc||!1,this.path,this.settings.qc)},t.prototype.contains=function(t){return void 0!==this.fieldMask.find((function(e){return t.isPrefixOf(e)}))||void 0!==this.fieldTransforms.find((function(e){return t.isPrefixOf(e.field)}))},t.prototype.Cc=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.$c(this.path.get(t))},t.prototype.$c=function(t){if(0===t.length)throw this.Lc("Document fields must not be empty");if(bf(this.Nc)&&yf.test(t))throw this.Lc('Document fields cannot begin and end with "__"')},t}(),If=function(){function t(t,e,n){this.databaseId=t,this.ignoreUndefinedProperties=e,this.R=n||xc(t)}return t.prototype.Uc=function(t,e,n,r){return void 0===r&&(r=!1),new wf({Nc:t,methodName:e,qc:n,path:Jr.emptyPath(),Fc:!1,Bc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function Tf(t){var e=t._freezeSettings(),n=xc(t._databaseId);return new If(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Ef(t,e,n,r,i,o){void 0===o&&(o={});var a=t.Uc(o.merge||o.mergeFields?2:0,e,n,i);Ff("Data must be an object, but it was:",a,r);var s,u,c=Lf(r,a);if(o.merge)s=new Zr(a.fieldMask),u=a.fieldTransforms;else if(o.mergeFields){for(var l=[],h=0,f=o.mergeFields;h<f.length;h++){var d=Uf(e,f[h],n);if(!a.contains(d))throw new Nr(Ar.INVALID_ARGUMENT,"Field '"+d+"' is specified in your field mask but missing from your input data.");Bf(l,d)||l.push(d)}s=new Zr(l),u=a.fieldTransforms.filter((function(t){return s.covers(t.field)}))}else s=null,u=a.fieldTransforms;return new mf(new Ci(c),s,u)}var Sf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,c.__extends)(e,t),e.prototype._toFieldTransform=function(t){if(2!==t.Nc)throw 1===t.Nc?t.Lc(this._methodName+"() can only appear at the top level of your update data"):t.Lc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.fieldMask.push(t.path),null},e.prototype.isEqual=function(t){return t instanceof e},e}(vf);function Cf(t,e,n){return new wf({Nc:3,qc:e.settings.qc,methodName:t._methodName,Fc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var kf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,c.__extends)(e,t),e.prototype._toFieldTransform=function(t){return new Ao(t.path,new bo)},e.prototype.isEqual=function(t){return t instanceof e},e}(vf),Af=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return(0,c.__extends)(e,t),e.prototype._toFieldTransform=function(t){var e=Cf(this,t,!0),n=this.Kc.map((function(t){return Of(t,e)})),r=new wo(n);return new Ao(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(vf),Nf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Kc=n,r}return(0,c.__extends)(e,t),e.prototype._toFieldTransform=function(t){var e=Cf(this,t,!0),n=this.Kc.map((function(t){return Of(t,e)})),r=new To(n);return new Ao(t.path,r)},e.prototype.isEqual=function(t){return this===t},e}(vf),Pf=function(t){function e(e,n){var r=this;return(r=t.call(this,e)||this).Qc=n,r}return(0,c.__extends)(e,t),e.prototype._toFieldTransform=function(t){var e=new So(t.R,vo(t.R,this.Qc));return new Ao(t.path,e)},e.prototype.isEqual=function(t){return this===t},e}(vf);function xf(t,e,n,r){var i=t.Uc(1,e,n);Ff("Data must be an object, but it was:",i,r);var o=[],a=Ci.empty();zr(r,(function(t,r){var s=qf(e,t,n);r=(0,l.getModularInstance)(r);var u=i.Oc(s);if(r instanceof Sf)o.push(s);else{var c=Of(r,u);null!=c&&(o.push(s),a.set(s,c))}}));var s=new Zr(o);return new _f(a,s,i.fieldTransforms)}function Rf(t,e,n,r,i,o){var a=t.Uc(1,e,n),s=[Uf(e,r,n)],u=[i];if(o.length%2!=0)throw new Nr(Ar.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)s.push(Uf(e,o[c])),u.push(o[c+1]);for(var h=[],f=Ci.empty(),d=s.length-1;d>=0;--d)if(!Bf(h,s[d])){var p=s[d],v=u[d];v=(0,l.getModularInstance)(v);var g=a.Oc(p);if(v instanceof Sf)h.push(p);else{var y=Of(v,g);null!=y&&(h.push(p),f.set(p,y))}}var m=new Zr(h);return new _f(f,m,a.fieldTransforms)}function Df(t,e,n,r){return void 0===r&&(r=!1),Of(n,t.Uc(r?4:3,e))}function Of(t,e){if(Mf(t=(0,l.getModularInstance)(t)))return Ff("Unsupported field value:",e,t),Lf(t,e);if(t instanceof vf)return function(t,e){if(!bf(e.Nc))throw e.Lc(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.Lc(t._methodName+"() is not currently supported inside arrays");var n=t._toFieldTransform(e);n&&e.fieldTransforms.push(n)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Fc&&4!==e.Nc)throw e.Lc("Nested arrays are not supported");return function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var a=Of(o[i],e.Mc(r));null==a&&(a={nullValue:"NULL_VALUE"}),n.push(a),r++}return{arrayValue:{values:n}}}(t,e)}return function(t,e){if(null===(t=(0,l.getModularInstance)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return vo(e.R,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=Wr.fromDate(t);return{timestampValue:Ta(e.R,n)}}if(t instanceof Wr)return n=new Wr(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Ta(e.R,n)};if(t instanceof gf)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof pf)return{bytesValue:Ea(e.R,t._byteString)};if(t instanceof $h){n=e.databaseId;var r=t.firestore._databaseId;if(!r.isEqual(n))throw e.Lc("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:ka(t.firestore._databaseId||e.databaseId,t._key.path)}}throw e.Lc("Unsupported field value: "+Gh(t))}(t,e)}function Lf(t,e){var n={};return Qr(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):zr(t,(function(t,r){var i=Of(r,e.kc(t));null!=i&&(n[t]=i)})),{mapValue:{fields:n}}}function Mf(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof Wr||t instanceof gf||t instanceof pf||t instanceof $h||t instanceof vf)}function Ff(t,e,n){if(!Mf(n)||!function(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}(n)){var r=Gh(n);throw"an object"===r?e.Lc(t+" a custom object"):e.Lc(t+" "+r)}}function Uf(t,e,n){if((e=(0,l.getModularInstance)(e))instanceof df)return e._internalPath;if("string"==typeof e)return qf(t,e);throw Vf("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var jf=new RegExp("[~\\*/\\[\\]]");function qf(t,e,n){if(e.search(jf)>=0)throw Vf("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(df.bind.apply(df,(0,c.__spreadArray)([void 0],e.split(".")))))._internalPath}catch(r){throw Vf("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Vf(t,e,n,r,i){var o=r&&!r.isEmpty(),a=void 0!==i,s="Function "+e+"() called with invalid data";n&&(s+=" (via `toFirestore()`)");var u="";return(o||a)&&(u+=" (found",o&&(u+=" in field "+r),a&&(u+=" in document "+i),u+=")"),new Nr(Ar.INVALID_ARGUMENT,(s+=". ")+t+u)}function Bf(t,e){return t.some((function(t){return t.isEqual(e)}))}var Kf=function(){function t(t,e,n,r,i){this._firestore=t,this._userDataWriter=e,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new $h(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return null!==this._document},t.prototype.data=function(){if(this._document){if(this._converter){var t=new Wf(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(t){if(this._document){var e=this._document.data.field(Hf("DocumentSnapshot.get",t));if(null!==e)return this._userDataWriter.convertValue(e)}},t}(),Wf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,c.__extends)(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Kf);function Hf(t,e){return"string"==typeof e?qf(t,e):e instanceof df?e._internalPath:e._delegate._internalPath}var Gf=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),zf=function(t){function e(e,n,r,i,o,a){var s=this;return(s=t.call(this,e,n,r,i,a)||this)._firestore=e,s._firestoreImpl=e,s.metadata=o,s}return(0,c.__extends)(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(t){if(void 0===t&&(t={}),this._document){if(this._converter){var e=new Qf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}},e.prototype.get=function(t,e){if(void 0===e&&(e={}),this._document){var n=this._document.data.field(Hf("DocumentSnapshot.get",t));if(null!==n)return this._userDataWriter.convertValue(n,e.serverTimestamps)}},e}(Kf),Qf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,c.__extends)(e,t),e.prototype.data=function(e){return void 0===e&&(e={}),t.prototype.data.call(this,e)},e}(zf),Yf=function(){function t(t,e,n,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new Gf(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach((function(e){return t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;this._snapshot.docs.forEach((function(r){t.call(e,new Qf(n._firestore,n._userDataWriter,r.key,r,new Gf(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))},t.prototype.docChanges=function(t){void 0===t&&(t={});var e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new Nr(Ar.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(t,e){if(t._snapshot.oldDocs.isEmpty()){var n=0;return t._snapshot.docChanges.map((function(e){return{type:"added",doc:new Qf(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Gf(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),oldIndex:-1,newIndex:n++}}))}var r=t._snapshot.oldDocs;return t._snapshot.docChanges.filter((function(t){return e||3!==t.type})).map((function(e){var n=new Qf(t._firestore,t._userDataWriter,e.doc.key,e.doc,new Gf(t._snapshot.mutatedKeys.has(e.doc.key),t._snapshot.fromCache),t.query.converter),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:Xf(e.type),doc:n,oldIndex:i,newIndex:o}}))}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges},t}();function Xf(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Mr()}}function $f(t,e){return t instanceof zf&&e instanceof zf?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(null===t._document?null===e._document:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Yf&&e instanceof Yf&&t._firestore===e._firestore&&rf(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function Jf(t){if(Zi(t)&&0===t.explicitOrderBy.length)throw new Nr(Ar.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Zf=function(){};function td(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++){var o=i[r];t=o._apply(t)}return t}var ed=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).jc=e,i.Wc=n,i.Gc=r,i.type="where",i}return(0,c.__extends)(e,t),e.prototype._apply=function(t){var e=Tf(t.firestore),n=function(t,e,n,r,i,o,a){var s;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){ud(a,o);for(var u=[],c=0,l=a;c<l.length;c++){var h=l[c];u.push(sd(r,t,h))}s={arrayValue:{values:u}}}else s=sd(r,t,a)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||ud(a,o),s=Df(n,"where",a,"in"===o||"not-in"===o);var f=Oi.create(i,o,s);return function(t,e){if(e.g()){var n=eo(t);if(null!==n&&!n.isEqual(e.field))throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");var r=to(t);null!==r&&cd(t,e.field,r)}var i=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(e.indexOf(i.op)>=0)return i.op}return null}(t,function(t){switch(t){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==i)throw i===e.op?new Nr(Ar.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Nr(Ar.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+i.toString()+"' filters.")}(t,f),f}(t._query,0,e,t.firestore._databaseId,this.jc,this.Wc,this.Gc);return new Jh(t.firestore,t.converter,function(t,e){var n=t.filters.concat([e]);return new Yi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}(t._query,n))},e}(Zf),nd=function(t){function e(e,n){var r=this;return(r=t.call(this)||this).jc=e,r.zc=n,r.type="orderBy",r}return(0,c.__extends)(e,t),e.prototype._apply=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Hi(e,n);return function(t,e){if(null===to(t)){var n=eo(t);null!==n&&cd(t,n,e.field)}}(t,r),r}(t._query,this.jc,this.zc);return new Jh(t.firestore,t.converter,function(t,e){var n=t.explicitOrderBy.concat([e]);return new Yi(t.path,t.collectionGroup,n,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)}(t._query,e))},e}(Zf),rd=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Hc=n,i.Jc=r,i}return(0,c.__extends)(e,t),e.prototype._apply=function(t){return new Jh(t.firestore,t.converter,oo(t._query,this.Hc,this.Jc))},e}(Zf),id=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Yc=n,i.Xc=r,i}return(0,c.__extends)(e,t),e.prototype._apply=function(t){var e=ad(t,this.type,this.Yc,this.Xc);return new Jh(t.firestore,t.converter,function(t,e){return new Yi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)}(t._query,e))},e}(Zf),od=function(t){function e(e,n,r){var i=this;return(i=t.call(this)||this).type=e,i.Yc=n,i.Xc=r,i}return(0,c.__extends)(e,t),e.prototype._apply=function(t){var e=ad(t,this.type,this.Yc,this.Xc);return new Jh(t.firestore,t.converter,function(t,e){return new Yi(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)}(t._query,e))},e}(Zf);function ad(t,e,n,r){if(n[0]=(0,l.getModularInstance)(n[0]),n[0]instanceof Kf)return function(t,e,n,r,i){if(!r)throw new Nr(Ar.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],a=0,s=ro(t);a<s.length;a++){var u=s[a];if(u.field.isKeyField())o.push(_i(e,r.key));else{var c=r.data.field(u.field);if(oi(c))throw new Nr(Ar.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c){var l=u.field.canonicalString();throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+l+"' (used as the orderBy) does not exist.")}o.push(c)}}return new Ki(o,i)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var i=Tf(t.firestore);return function(t,e,n,r,i,o){var a=t.explicitOrderBy;if(i.length>a.length)throw new Nr(Ar.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var s=[],u=0;u<i.length;u++){var c=i[u];if(a[u].field.isKeyField()){if("string"!=typeof c)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!no(t)&&-1!==c.indexOf("/"))throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var l=t.path.child(Xr.fromString(c));if(!hi.isDocumentKey(l))throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+l+"' is not because it contains an odd number of segments.");var h=new hi(l);s.push(_i(e,h))}else{var f=Df(n,r,c);s.push(f)}}return new Ki(s,o)}(t._query,t.firestore._databaseId,i,e,n,r)}function sd(t,e,n){if("string"==typeof(n=(0,l.getModularInstance)(n))){if(""===n)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!no(e)&&-1!==n.indexOf("/"))throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(Xr.fromString(n));if(!hi.isDocumentKey(r))throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return _i(t,new hi(r))}if(n instanceof $h)return _i(t,n._key);throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Gh(n)+".")}function ud(t,e){if(!Array.isArray(t)||0===t.length)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function cd(t,e,n){if(!n.isEqual(e))throw new Nr(Ar.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}var ld=function(){function t(){}return t.prototype.convertValue=function(t,e){switch(void 0===e&&(e="none"),fi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return ri(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(ii(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 10:return this.convertObject(t.mapValue,e);default:throw Mr()}},t.prototype.convertObject=function(t,e){var n=this,r={};return zr(t.fields,(function(t,i){r[t]=n.convertValue(i,e)})),r},t.prototype.convertGeoPoint=function(t){return new gf(ri(t.latitude),ri(t.longitude))},t.prototype.convertArray=function(t,e){var n=this;return(t.values||[]).map((function(t){return n.convertValue(t,e)}))},t.prototype.convertServerTimestamp=function(t,e){switch(e){case"previous":var n=ai(t);return null==n?null:this.convertValue(n,e);case"estimate":return this.convertTimestamp(si(t));default:return null}},t.prototype.convertTimestamp=function(t){var e=ni(t);return new Wr(e.seconds,e.nanos)},t.prototype.convertDocumentKey=function(t,e){var n=Xr.fromString(t);Fr(Ja(n));var r=new Dh(n.get(1),n.get(3)),i=new hi(n.popFirst(5));return r.isEqual(e)||Dr("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),i},t}();function hd(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var fd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return(0,c.__extends)(e,t),e.prototype.convertBytes=function(t){return new pf(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new $h(this.firestore,null,e)},e}(ld),dd=function(){function t(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=Tf(t)}return t.prototype.set=function(t,e,n){this._verifyNotCommitted();var r=pd(t,this._firestore),i=hd(r.converter,e,n),o=Ef(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(o.toMutation(r._key,Po.none())),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this._verifyNotCommitted();var o,a=pd(t,this._firestore);return o="string"==typeof(e=(0,l.getModularInstance)(e))||e instanceof df?Rf(this._dataReader,"WriteBatch.update",a._key,e,n,r):xf(this._dataReader,"WriteBatch.update",a._key,e),this._mutations.push(o.toMutation(a._key,Po.exists(!0))),this},t.prototype.delete=function(t){this._verifyNotCommitted();var e=pd(t,this._firestore);return this._mutations=this._mutations.concat(new Ho(e._key,Po.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new Nr(Ar.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();function pd(t,e){if((t=(0,l.getModularInstance)(t)).firestore!==e)throw new Nr(Ar.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var vd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return(0,c.__extends)(e,t),e.prototype.convertBytes=function(t){return new pf(t)},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return new $h(this.firestore,null,e)},e}(ld);function gd(t,e,n){t=zh(t,$h);var r=zh(t.firestore,uf),i=hd(t.converter,e,n);return _d(r,[Ef(Tf(r),"setDoc",t._key,i,null!==t.converter,n).toMutation(t._key,Po.none())])}function yd(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=zh(t,$h);var o=zh(t.firestore,uf),a=Tf(o);return _d(o,[("string"==typeof(e=(0,l.getModularInstance)(e))||e instanceof df?Rf(a,"updateDoc",t._key,e,n,r):xf(a,"updateDoc",t._key,e)).toMutation(t._key,Po.exists(!0))])}function md(t){for(var e,n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];t=(0,l.getModularInstance)(t);var a={includeMetadataChanges:!1},s=0;"object"!=typeof i[s]||af(i[s])||(a=i[s],s++);var u,h,f,d={includeMetadataChanges:a.includeMetadataChanges};if(af(i[s])){var p=i[s];i[s]=null===(e=p.next)||void 0===e?void 0:e.bind(p),i[s+1]=null===(n=p.error)||void 0===n?void 0:n.bind(p),i[s+2]=null===(r=p.complete)||void 0===r?void 0:r.bind(p)}if(t instanceof $h)h=zh(t.firestore,uf),f=$i(t._key.path),u={next:function(e){i[s]&&i[s](bd(h,t,e))},error:i[s+1],complete:i[s+2]};else{var v=zh(t,Jh);h=zh(v.firestore,uf),f=v._query;var g=new vd(h);u={next:function(t){i[s]&&i[s](new Yf(h,g,v,t))},error:i[s+1],complete:i[s+2]},Jf(t._query)}return function(t,e,n,r){var i=this,o=new gh(r),a=new Il(e,o,n);return t.asyncQueue.enqueueAndForget((function(){return(0,c.__awaiter)(i,void 0,void 0,(function(){var e;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return e=yl,[4,Nh(t)];case 1:return[2,e.apply(void 0,[n.sent(),a])]}}))}))})),function(){o.Wo(),t.asyncQueue.enqueueAndForget((function(){return(0,c.__awaiter)(i,void 0,void 0,(function(){var e;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return e=ml,[4,Nh(t)];case 1:return[2,e.apply(void 0,[n.sent(),a])]}}))}))}))}}(cf(h),f,d,u)}function _d(t,e){return function(t,e){var n=this,r=new Is;return t.asyncQueue.enqueueAndForget((function(){return(0,c.__awaiter)(n,void 0,void 0,(function(){var n;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:return n=Ml,[4,Ah(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(cf(t),e)}function bd(t,e,n){var r=n.docs.get(e._key),i=new vd(t);return new zf(t,i,e._key,r,new Gf(n.hasPendingWrites,n.fromCache),e.converter)}var wd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this)._firestore=e,r}return(0,c.__extends)(e,t),e.prototype.get=function(e){var n=this,r=pd(e,this._firestore),i=new vd(this._firestore);return t.prototype.get.call(this,e).then((function(t){return new zf(n._firestore,i,r._key,t._document,new Gf(!1,!1),r.converter)}))},e}(function(){function t(t,e){this._firestore=t,this._transaction=e,this._dataReader=Tf(t)}return t.prototype.get=function(t){var e=this,n=pd(t,this._firestore),r=new fd(this._firestore);return this._transaction.lookup([n._key]).then((function(t){if(!t||1!==t.length)return Mr();var i=t[0];if(i.isFoundDocument())return new Kf(e._firestore,r,i.key,i,n.converter);if(i.isNoDocument())return new Kf(e._firestore,r,n._key,null,n.converter);throw Mr()}))},t.prototype.set=function(t,e,n){var r=pd(t,this._firestore),i=hd(r.converter,e,n),o=Ef(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,o),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,a=pd(t,this._firestore);return o="string"==typeof(e=(0,l.getModularInstance)(e))||e instanceof df?Rf(this._dataReader,"Transaction.update",a._key,e,n,r):xf(this._dataReader,"Transaction.update",a._key,e),this._transaction.update(a._key,o),this},t.prototype.delete=function(t){var e=pd(t,this._firestore);return this._transaction.delete(e._key),this},t}());function Id(){if("undefined"==typeof Uint8Array)throw new Nr(Ar.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function Td(){if("undefined"==typeof atob)throw new Nr(Ar.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var Ed=function(){function t(t){this._delegate=t}return t.fromBase64String=function(e){return Td(),new t(pf.fromBase64String(e))},t.fromUint8Array=function(e){return Id(),new t(pf.fromUint8Array(e))},t.prototype.toBase64=function(){return Td(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return Id(),this._delegate.toUint8Array()},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),Sd=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){ff(t=zh(t,uf));var n=cf(t),r=t._freezeSettings(),i=new ph;return hf(n,i,new fh(i,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t._delegate,{forceOwnership:e})},t.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){ff(t=zh(t,uf));var e=cf(t),n=t._freezeSettings(),r=new ph;return hf(e,r,new dh(r,n.cacheSizeBytes))}(t._delegate)},t.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t._initialized&&!t._terminated)throw new Nr(Ar.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new Is;return t._queue.enqueueAndForgetEvenWhileRestricted((function(){return(0,c.__awaiter)(e,void 0,void 0,(function(){var e;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return Ss.yt()?(e=t+"main",[4,Ss.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(Mu(t._databaseId,t._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}}))}))})),n.promise}(t._delegate)},t}(),Cd=function(){function t(t,e,n){var r=this;this._delegate=e,this.Zc=n,this.INTERNAL={delete:function(){return r.terminate()}},t instanceof Dh||(this.tu=t)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(t){var e=this._delegate._getSettings();t.merge||e.host===t.host||Or("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&delete(t=Object.assign(Object.assign({},e),t)).merge,this._delegate._setSettings(t)},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),function(t,e,n,r){var i;void 0===r&&(r={});var o=(t=zh(t,Xh))._getSettings();if("firestore.googleapis.com"!==o.host&&o.host!==e&&Or("Host has been set in both settings() and useEmulator(), emulator host will be used"),t._setSettings(Object.assign(Object.assign({},o),{host:e+":"+n,ssl:!1})),r.mockUserToken){var a,s;if("string"==typeof r.mockUserToken)a=r.mockUserToken,s=dc.MOCK_USER;else{a=(0,l.createMockUserToken)(r.mockUserToken,null===(i=t._app)||void 0===i?void 0:i.options.projectId);var u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new Nr(Ar.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");s=new dc(u)}t._credentials=new Fh(new Lh(a,s))}}(this._delegate,t,e,n)},t.prototype.enableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return(0,c.__awaiter)(e,void 0,void 0,(function(){var e,n;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return[4,Sh(t)];case 1:return e=r.sent(),[4,kh(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!0),function(t){var e=Ur(t);return e.Or.delete(0),jc(e)}(n))]}}))}))}))}(cf(zh(this._delegate,uf)))},t.prototype.disableNetwork=function(){return function(t){var e=this;return t.asyncQueue.enqueue((function(){return(0,c.__awaiter)(e,void 0,void 0,(function(){var e,n;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return[4,Sh(t)];case 1:return e=r.sent(),[4,kh(t)];case 2:return n=r.sent(),[2,(e.setNetworkEnabled(!1),function(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return(e=Ur(t)).Or.add(0),[4,qc(e)];case 1:return n.sent(),e.Br.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(cf(zh(this._delegate,uf)))},t.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&Kh("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Zc.enableMultiTabIndexedDbPersistence(this):this.Zc.enableIndexedDbPersistence(this,n)},t.prototype.clearPersistence=function(){return this.Zc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.tu&&(this.tu._removeServiceInstance("firestore"),this.tu._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new Is;return t.asyncQueue.enqueueAndForget((function(){return(0,c.__awaiter)(e,void 0,void 0,(function(){var e;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return e=Bl,[4,Ah(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(cf(zh(this._delegate,uf)))},t.prototype.onSnapshotsInSync=function(t){return function(t,e){return function(t,e){var n=this,r=new gh(e);return t.asyncQueue.enqueueAndForget((function(){return(0,c.__awaiter)(n,void 0,void 0,(function(){var e;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return e=function(t,e){Ur(t).Gr.add(e),e.next()},[4,Nh(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.Wo(),t.asyncQueue.enqueueAndForget((function(){return(0,c.__awaiter)(n,void 0,void 0,(function(){var e;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return e=function(t,e){Ur(t).Gr.delete(e)},[4,Nh(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}}))}))}))}}(cf(t=zh(t,uf)),af(e)?e:{next:e})}(this._delegate,t)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.tu)throw new Nr(Ar.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.tu},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new qd(this,tf(this._delegate,t))}catch(t){throw Rd(t,"collection()","Firestore.collection()")}},t.prototype.doc=function(t){try{return new xd(this,ef(this._delegate,t))}catch(t){throw Rd(t,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(t){try{return new Fd(this,function(t,e){if(t=zh(t,Xh),Vh("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Jh(t,null,function(t){return new Yi(Xr.emptyPath(),t)}(e))}(this._delegate,t))}catch(t){throw Rd(t,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(t){var e=this;return function(t,e){return function(t,e){var n=this,r=new Is;return t.asyncQueue.enqueueAndForget((function(){return(0,c.__awaiter)(n,void 0,void 0,(function(){var n;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:return[4,function(t){return Eh(t).then((function(t){return t.datastore}))}(t)];case 1:return n=i.sent(),new _h(t.asyncQueue,n,e,r).run(),[2]}}))}))})),r.promise}(cf(t),(function(n){return e(new wd(t,n))}))}(this._delegate,(function(n){return t(new Ad(e,n))}))},t.prototype.batch=function(){var t=this;return cf(this._delegate),new Nd(new dd(this._delegate,(function(e){return _d(t._delegate,e)})))},t.prototype.loadBundle=function(t){throw new Nr(Ar.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(t){throw new Nr(Ar.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),kd=function(t){function e(e){var n=this;return(n=t.call(this)||this).firestore=e,n}return(0,c.__extends)(e,t),e.prototype.convertBytes=function(t){return new Ed(new pf(t))},e.prototype.convertReference=function(t){var e=this.convertDocumentKey(t,this.firestore._databaseId);return xd.eu(e,this.firestore,null)},e}(ld);var Ad=function(){function t(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new kd(t)}return t.prototype.get=function(t){var e=this,n=Vd(t);return this._delegate.get(n).then((function(t){return new Ld(e._firestore,new zf(e._firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,n.converter))}))},t.prototype.set=function(t,e,n){var r=Vd(t);return n?(Bh("Transaction.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a=Vd(t);return 2===arguments.length?this._delegate.update(a,e):(r=this._delegate).update.apply(r,(0,c.__spreadArray)([a,e,n],i)),this},t.prototype.delete=function(t){var e=Vd(t);return this._delegate.delete(e),this},t}(),Nd=function(){function t(t){this._delegate=t}return t.prototype.set=function(t,e,n){var r=Vd(t);return n?(Bh("WriteBatch.set",n),this._delegate.set(r,e,n)):this._delegate.set(r,e),this},t.prototype.update=function(t,e,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a=Vd(t);return 2===arguments.length?this._delegate.update(a,e):(r=this._delegate).update.apply(r,(0,c.__spreadArray)([a,e,n],i)),this},t.prototype.delete=function(t){var e=Vd(t);return this._delegate.delete(e),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),Pd=function(){function t(t,e,n){this._firestore=t,this._userDataWriter=e,this._delegate=n}return t.prototype.fromFirestore=function(t,e){var n=new Qf(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new Md(this._firestore,n),null!=e?e:{})},t.prototype.toFirestore=function(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)},t.nu=function(e,n){var r=t.su,i=r.get(e);i||(i=new WeakMap,r.set(e,i));var o=i.get(n);return o||(o=new t(e,new kd(e),n),i.set(n,o)),o},t}();Pd.su=new WeakMap;var xd=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new kd(t)}return t.iu=function(e,n,r){if(e.length%2!=0)throw new Nr(Ar.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new $h(n._delegate,r,new hi(e)))},t.eu=function(e,n,r){return new t(n,new $h(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new qd(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(t){try{return new qd(this.firestore,tf(this._delegate,t))}catch(t){throw Rd(t,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(t){return(t=(0,l.getModularInstance)(t))instanceof $h&&nf(this._delegate,t)},t.prototype.set=function(t,e){e=Bh("DocumentReference.set",e);try{return e?gd(this._delegate,t,e):gd(this._delegate,t)}catch(t){throw Rd(t,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?yd(this._delegate,t):yd.apply(void 0,(0,c.__spreadArray)([this._delegate,t,e],n))}catch(t){throw Rd(t,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return _d(zh((t=this._delegate).firestore,uf),[new Ho(t._key,Po.none())]);var t},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Dd(e),i=Od(e,(function(e){return new Ld(t.firestore,new zf(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate.converter))}));return md(this._delegate,r,i)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=zh(t,$h);var e=zh(t.firestore,uf),n=cf(e),r=new vd(e);return function(t,e){var n=this,r=new Is;return t.asyncQueue.enqueueAndForget((function(){return(0,c.__awaiter)(n,void 0,void 0,(function(){var n;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return(0,c.__awaiter)(this,void 0,void 0,(function(){var r,i;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(t,e){var n=Ur(t);return n.persistence.runTransaction("read document","readonly",(function(t){return n.Mn.mn(t,e)}))}(t,e)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new Nr(Ar.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=hl(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,Ch(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._key).then((function(n){return new zf(e,r,t._key,n,new Gf(null!==n&&n.hasLocalMutations,!0),t.converter)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=zh(t,$h);var e=zh(t.firestore,uf);return Ph(cf(e),t._key,{source:"server"}).then((function(n){return bd(e,t,n)}))}(this._delegate):function(t){t=zh(t,$h);var e=zh(t.firestore,uf);return Ph(cf(e),t._key).then((function(n){return bd(e,t,n)}))}(this._delegate)).then((function(t){return new Ld(e.firestore,new zf(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate.converter))}))},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Pd.nu(this.firestore,e)):this._delegate.withConverter(null))},t}();function Rd(t,e,n){return t.message=t.message.replace(e,n),t}function Dd(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!af(r))return r}return{}}function Od(t,e){var n,r,i;return{next:function(t){i.next&&i.next(e(t))},error:null===(n=(i=af(t[0])?t[0]:af(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var Ld=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"ref",{get:function(){return new xd(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(t){return this._delegate.data(t)},t.prototype.get=function(t,e){return this._delegate.get(t,e)},t.prototype.isEqual=function(t){return $f(this._delegate,t._delegate)},t}(),Md=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return(0,c.__extends)(e,t),e.prototype.data=function(t){return this._delegate.data(t)},e}(Ld),Fd=function(){function t(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new kd(t)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,td(this._delegate,function(t,e,n){var r=e,i=Hf("where",t);return new ed(i,r,n)}(e,n,r)))}catch(e){throw Rd(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,td(this._delegate,function(t,e){void 0===e&&(e="asc");var n=e,r=Hf("orderBy",t);return new nd(r,n)}(e,n)))}catch(e){throw Rd(e,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,td(this._delegate,function(t){return Qh("limit",t),new rd("limit",t,"F")}(e)))}catch(e){throw Rd(e,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,td(this._delegate,function(t){return Qh("limitToLast",t),new rd("limitToLast",t,"L")}(e)))}catch(e){throw Rd(e,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,td(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new id("startAt",t,!0)}.apply(void 0,e)))}catch(e){throw Rd(e,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,td(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new id("startAfter",t,!1)}.apply(void 0,e)))}catch(e){throw Rd(e,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,td(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new od("endBefore",t,!0)}.apply(void 0,e)))}catch(e){throw Rd(e,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,td(this._delegate,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new od("endAt",t,!1)}.apply(void 0,e)))}catch(e){throw Rd(e,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(t){return rf(this._delegate,t._delegate)},t.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){t=zh(t,Jh);var e=zh(t.firestore,uf),n=cf(e),r=new vd(e);return function(t,e){var n=this,r=new Is;return t.asyncQueue.enqueueAndForget((function(){return(0,c.__awaiter)(n,void 0,void 0,(function(){var n;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:return n=function(t,e,n){return(0,c.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,s;return(0,c.__generator)(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,$u(t,e,!0)];case 1:return s=u.sent(),r=new Nl(e,s.Bn),i=r._o(s.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return a=u.sent(),s=hl(a,"Failed to execute query '"+e+" against cache"),n.reject(s),[3,3];case 3:return[2]}}))}))},[4,Ch(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}}))}))})),r.promise}(n,t._query).then((function(n){return new Yf(e,r,t,n)}))}(this._delegate):"server"===(null==t?void 0:t.source)?function(t){t=zh(t,Jh);var e=zh(t.firestore,uf),n=cf(e),r=new vd(e);return xh(n,t._query,{source:"server"}).then((function(n){return new Yf(e,r,t,n)}))}(this._delegate):function(t){t=zh(t,Jh);var e=zh(t.firestore,uf),n=cf(e),r=new vd(e);return Jf(t._query),xh(n,t._query).then((function(n){return new Yf(e,r,t,n)}))}(this._delegate)).then((function(t){return new jd(e.firestore,new Yf(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}))},t.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Dd(e),i=Od(e,(function(e){return new jd(t.firestore,new Yf(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}));return md(this._delegate,r,i)},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Pd.nu(this.firestore,e)):this._delegate.withConverter(null))},t}(),Ud=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new Md(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),jd=function(){function t(t,e){this._firestore=t,this._delegate=e}return Object.defineProperty(t.prototype,"query",{get:function(){return new Fd(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var t=this;return this._delegate.docs.map((function(e){return new Md(t._firestore,e)}))},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(t){var e=this;return this._delegate.docChanges(t).map((function(t){return new Ud(e._firestore,t)}))},t.prototype.forEach=function(t,e){var n=this;this._delegate.forEach((function(r){t.call(e,new Md(n._firestore,r))}))},t.prototype.isEqual=function(t){return $f(this._delegate,t._delegate)},t}(),qd=function(t){function e(e,n){var r=this;return(r=t.call(this,e,n)||this).firestore=e,r._delegate=n,r}return(0,c.__extends)(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return t?new xd(this.firestore,t):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(t){try{return new xd(this.firestore,void 0===t?ef(this._delegate):ef(this._delegate,t))}catch(t){throw Rd(t,"doc()","CollectionReference.doc()")}},e.prototype.add=function(t){var e=this;return function(t,e){var n=zh(t.firestore,uf),r=ef(t),i=hd(t.converter,e);return _d(n,[Ef(Tf(t.firestore),"addDoc",r._key,i,null!==t.converter,{}).toMutation(r._key,Po.exists(!1))]).then((function(){return r}))}(this._delegate,t).then((function(t){return new xd(e.firestore,t)}))},e.prototype.isEqual=function(t){return nf(this._delegate,t._delegate)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(Pd.nu(this.firestore,t)):this._delegate.withConverter(null))},e}(Fd);function Vd(t){return zh(t,$h)}var Bd=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._delegate=new(df.bind.apply(df,(0,c.__spreadArray)([void 0],t)))}return t.documentId=function(){return new t(Jr.keyField().canonicalString())},t.prototype.isEqual=function(t){return(t=(0,l.getModularInstance)(t))instanceof df&&this._delegate._internalPath.isEqual(t._internalPath)},t}(),Kd=function(){function t(t){this._delegate=t}return t.serverTimestamp=function(){var e=new kf("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new Sf("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Af("arrayUnion",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Nf("arrayRemove",t)}.apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(t){return new Pf("increment",t)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(t){return this._delegate.isEqual(t._delegate)},t}();function Wd(t){return function(t,e){var n=cf(t=zh(t,uf)),r=new sf;return function(t,e,n,r){var i=this,o=function(t,e){return function(t,e){return new yh(t,e)}(function(t,e){if(t instanceof Uint8Array)return vh(t,e);if(t instanceof ArrayBuffer)return vh(new Uint8Array(t),e);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof t?(new TextEncoder).encode(t):t),e)}(n,xc(e));t.asyncQueue.enqueueAndForget((function(){return(0,c.__awaiter)(i,void 0,void 0,(function(){var e;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return e=lh,[4,Ah(t)];case 1:return e.apply(void 0,[n.sent(),o,r]),[2]}}))}))}))}(n,t._databaseId,e,r),r}(this._delegate,t)}function Hd(t){var e,n,r=this;return(e=this._delegate,n=t,function(t,e){var n=this;return t.asyncQueue.enqueue((function(){return(0,c.__awaiter)(n,void 0,void 0,(function(){var n;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return n=function(t,e){var n=Ur(t);return n.persistence.runTransaction("Get named query","readonly",(function(t){return n.Ke.getNamedQuery(t,e)}))},[4,Ch(t)];case 1:return[2,n.apply(void 0,[r.sent(),e])]}}))}))}))}(cf(e=zh(e,uf)),n).then((function(t){return t?new Jh(e,null,t.query):null}))).then((function(t){return t?new Fd(r,t):null}))}var Gd,zd,Qd=n(909),Yd={Firestore:Cd,GeoPoint:gf,Timestamp:Wr,Blob:Ed,Transaction:Ad,WriteBatch:Nd,DocumentReference:xd,DocumentSnapshot:Ld,Query:Fd,QueryDocumentSnapshot:Md,QuerySnapshot:jd,CollectionReference:qd,FieldPath:Bd,FieldValue:Kd,setLogLevel:function(t){var e;e=t,Pr.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};(function(t,e){t.INTERNAL.registerComponent(new Qd.Component("firestore",(function(t){return function(t,e){return new Cd(t,new uf(t,e),new Sd)}(t.getProvider("app").getImmediate(),t.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},Yd)))})(Gd=u.default),Gd.registerVersion("@firebase/firestore","2.4.1"),(zd=Cd).prototype.loadBundle=Wd,zd.prototype.namedQuery=Hd;var Xd={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},$d=function(t){function e(n,r,i){var o=t.call(this,r)||this;return Object.setPrototypeOf(o,e.prototype),o.code=n,o.details=i,o}return(0,c.__extends)(e,t),e}(Error);var Jd=function(){function t(t,e){var n=this;this.auth=null,this.messaging=null,this.auth=t.getImmediate({optional:!0}),this.messaging=e.getImmediate({optional:!0}),this.auth||t.get().then((function(t){return n.auth=t}),(function(){})),this.messaging||e.get().then((function(t){return n.messaging=t}),(function(){}))}return t.prototype.getAuthToken=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){var t;return(0,c.__generator)(this,(function(e){switch(e.label){case 0:if(!this.auth)return[2,void 0];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return(t=e.sent())?[2,t.accessToken]:[2,void 0];case 3:return e.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getInstanceIdToken=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){return(0,c.__generator)(this,(function(t){switch(t.label){case 0:if(!this.messaging||!("Notification"in self)||"granted"!==Notification.permission)return[2,void 0];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.messaging.getToken()];case 2:return[2,t.sent()];case 3:return t.sent(),[2,void 0];case 4:return[2]}}))}))},t.prototype.getContext=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return t=n.sent(),[4,this.getInstanceIdToken()];case 2:return e=n.sent(),[2,{authToken:t,instanceIdToken:e}]}}))}))},t}();function Zd(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}var tp=function(){function t(){}return t.prototype.encode=function(t){var e=this;if(null==t)return null;if(t instanceof Number&&(t=t.valueOf()),"number"==typeof t&&isFinite(t))return t;if(!0===t||!1===t)return t;if("[object String]"===Object.prototype.toString.call(t))return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map((function(t){return e.encode(t)}));if("function"==typeof t||"object"==typeof t)return Zd(t,(function(t){return e.encode(t)}));throw new Error("Data cannot be encoded in JSON: "+t)},t.prototype.decode=function(t){var e=this;if(null==t)return t;if(t["@type"])switch(t["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var n=Number(t.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+t);return n;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map((function(t){return e.decode(t)})):"function"==typeof t||"object"==typeof t?Zd(t,(function(t){return e.decode(t)})):t},t}();var ep=function(){function t(t,e,n,r,i,o){var a=this;void 0===i&&(i="us-central1"),this.app_=t,this.appCheckProvider=r,this.fetchImpl=o,this.serializer=new tp,this.emulatorOrigin=null,this.INTERNAL={delete:function(){return Promise.resolve(a.deleteService())}},this.contextProvider=new Jd(e,n),this.cancelAllRequests=new Promise((function(t){a.deleteService=function(){return t()}}));try{var s=new URL(i);this.customDomain=s.origin,this.region="us-central1"}catch(t){this.customDomain=null,this.region=i}}return Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!1,configurable:!0}),t.prototype._url=function(t){var e=this.app_.options.projectId;return null!==this.emulatorOrigin?this.emulatorOrigin+"/"+e+"/"+this.region+"/"+t:null!==this.customDomain?this.customDomain+"/"+t:"https://"+this.region+"-"+e+".cloudfunctions.net/"+t},t.prototype.useEmulator=function(t,e){this.emulatorOrigin="http://"+t+":"+e},t.prototype.useFunctionsEmulator=function(t){this.emulatorOrigin=t},t.prototype.httpsCallable=function(t,e){var n=this;return function(r){return n.call(t,r,e||{})}},t.prototype.postJSON=function(t,e,n){return(0,c.__awaiter)(this,void 0,void 0,(function(){var r,i,o;return(0,c.__generator)(this,(function(a){switch(a.label){case 0:return n["Content-Type"]="application/json",[4,this.getAppCheckToken()];case 1:null!==(r=a.sent())&&(n["X-Firebase-AppCheck"]=r),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,this.fetchImpl(t,{method:"POST",body:JSON.stringify(e),headers:n})];case 3:return i=a.sent(),[3,5];case 4:return a.sent(),[2,{status:0,json:null}];case 5:o=null,a.label=6;case 6:return a.trys.push([6,8,,9]),[4,i.json()];case 7:return o=a.sent(),[3,9];case 8:return a.sent(),[3,9];case 9:return[2,{status:i.status,json:o}]}}))}))},t.prototype.getAppCheckToken=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){var t;return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return(t=this.appCheckProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:return[2,e.sent().token];case 2:return[2,null]}}))}))},t.prototype.call=function(t,e,n){return(0,c.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,s,u,l,h,f,d,p;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:return r=this._url(t),e=this.serializer.encode(e),i={data:e},o={},[4,this.contextProvider.getContext()];case 1:return(a=c.sent()).authToken&&(o.Authorization="Bearer "+a.authToken),a.instanceIdToken&&(o["Firebase-Instance-ID-Token"]=a.instanceIdToken),s=n.timeout||7e4,u=function(t){var e,n=new Promise((function(n,r){e=setTimeout((function(){r(new $d("deadline-exceeded","deadline-exceeded"))}),t)}));return{timer:e,promise:n}}(s),l=u.timer,h=u.promise,[4,Promise.race([np(l,this.postJSON(r,i,o)),h,np(l,this.cancelAllRequests)])];case 2:if(!(f=c.sent()))throw new $d("cancelled","Firebase Functions instance was deleted.");if(d=function(t,e,n){var r=function(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),i=r,o=void 0;try{var a=e&&e.error;if(a){var s=a.status;if("string"==typeof s){if(!Xd[s])return new $d("internal","internal");r=Xd[s],i=s}var u=a.message;"string"==typeof u&&(i=u),void 0!==(o=a.details)&&(o=n.decode(o))}}catch(t){}return"ok"===r?null:new $d(r,i,o)}(f.status,f.json,this.serializer))throw d;if(!f.json)throw new $d("internal","Response is not valid JSON object.");if(void 0===(p=f.json.data)&&(p=f.json.result),void 0===p)throw new $d("internal","Response is missing data field.");return[2,{data:this.serializer.decode(p)}]}}))}))},t}();function np(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return[4,e];case 1:return n=r.sent(),clearTimeout(t),[2,n]}}))}))}var rp,ip,op;rp=u.default,ip=fetch.bind(self),op={Functions:ep},rp.INTERNAL.registerComponent(new Qd.Component("functions",(function(t,e){var n=e.instanceIdentifier,r=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),o=t.getProvider("app-check-internal"),a=t.getProvider("messaging");return new ep(r,i,a,o,n,ip)}),"PUBLIC").setServiceProps(op).setMultipleInstances(!0)),u.default.registerVersion("@firebase/functions","0.6.16");var ap,sp=n(676),up="0.4.32",cp=1e4,lp="w:0.4.32",hp="FIS_v2",fp=36e5,dp=((ap={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',ap["not-registered"]="Firebase Installation is not registered.",ap["installation-not-found"]="Firebase Installation not found.",ap["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',ap["app-offline"]="Could not process request. Application offline.",ap["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",ap),pp=new l.ErrorFactory("installations","Installations",dp);function vp(t){return t instanceof l.FirebaseError&&t.code.includes("request-failed")}function gp(t){return"https://firebaseinstallations.googleapis.com/v1/projects/"+t.projectId+"/installations"}function yp(t){return{token:t.token,requestStatus:2,expiresIn:(e=t.expiresIn,Number(e.replace("s","000"))),creationTime:Date.now()};var e}function mp(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:return[4,e.json()];case 1:return n=i.sent(),r=n.error,[2,pp.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})]}}))}))}function _p(t){var e=t.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function bp(t,e){var n=e.refreshToken,r=_p(t);return r.append("Authorization",function(t){return"FIS_v2 "+t}(n)),r}function wp(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return[4,t()];case 1:return(e=n.sent()).status>=500&&e.status<600?[2,t()]:[2,e]}}))}))}function Ip(t,e){var n=e.fid;return(0,c.__awaiter)(this,void 0,void 0,(function(){var e,r,i,o,a,s;return(0,c.__generator)(this,(function(u){switch(u.label){case 0:return e=gp(t),r=_p(t),i={fid:n,authVersion:hp,appId:t.appId,sdkVersion:lp},o={method:"POST",headers:r,body:JSON.stringify(i)},[4,wp((function(){return fetch(e,o)}))];case 1:return(a=u.sent()).ok?[4,a.json()]:[3,3];case 2:return s=u.sent(),[2,{fid:s.fid||n,registrationStatus:2,refreshToken:s.refreshToken,authToken:yp(s.authToken)}];case 3:return[4,mp("Create Installation",a)];case 4:throw u.sent()}}))}))}function Tp(t){return new Promise((function(e){setTimeout(e,t)}))}var Ep=/^[cdef][\w-]{21}$/;function Sp(){try{var t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;var e=function(t){return(e=t,btoa(String.fromCharCode.apply(String,(0,c.__spreadArray)([],(0,c.__read)(e)))).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var e}(t);return Ep.test(e)?e:""}catch(t){return""}}function Cp(t){return t.appName+"!"+t.appId}var kp=new Map;function Ap(t,e){var n=Cp(t);Np(n,e),function(t,e){var n=xp();n&&n.postMessage({key:t,fid:e});Rp()}(n,e)}function Np(t,e){var n,r,i=kp.get(t);if(i)try{for(var o=(0,c.__values)(i),a=o.next();!a.done;a=o.next()){(0,a.value)(e)}}catch(t){n={error:t}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}var Pp=null;function xp(){return!Pp&&"BroadcastChannel"in self&&((Pp=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(t){Np(t.data.key,t.data.fid)}),Pp}function Rp(){0===kp.size&&Pp&&(Pp.close(),Pp=null)}var Dp,Op="firebase-installations-store",Lp=null;function Mp(){return Lp||(Lp=(0,sp.openDb)("firebase-installations-database",1,(function(t){switch(t.oldVersion){case 0:t.createObjectStore(Op)}}))),Lp}function Fp(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a;return(0,c.__generator)(this,(function(s){switch(s.label){case 0:return n=Cp(t),[4,Mp()];case 1:return r=s.sent(),i=r.transaction(Op,"readwrite"),[4,(o=i.objectStore(Op)).get(n)];case 2:return a=s.sent(),[4,o.put(e,n)];case 3:return s.sent(),[4,i.complete];case 4:return s.sent(),a&&a.fid===e.fid||Ap(t,e.fid),[2,e]}}))}))}function Up(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:return e=Cp(t),[4,Mp()];case 1:return n=i.sent(),[4,(r=n.transaction(Op,"readwrite")).objectStore(Op).delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function jp(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s;return(0,c.__generator)(this,(function(u){switch(u.label){case 0:return n=Cp(t),[4,Mp()];case 1:return r=u.sent(),i=r.transaction(Op,"readwrite"),[4,(o=i.objectStore(Op)).get(n)];case 2:return a=u.sent(),void 0!==(s=e(a))?[3,4]:[4,o.delete(n)];case 3:return u.sent(),[3,6];case 4:return[4,o.put(s,n)];case 5:u.sent(),u.label=6;case 6:return[4,i.complete];case 7:return u.sent(),!s||a&&a.fid===s.fid||Ap(t,s.fid),[2,s]}}))}))}function qp(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:return[4,jp(t,(function(n){var r=function(t){return Kp(t||{fid:Sp(),registrationStatus:0})}(n),i=function(t,e){if(0===e.registrationStatus){if(!navigator.onLine)return{installationEntry:e,registrationPromise:Promise.reject(pp.create("app-offline"))};var n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()};return{installationEntry:n,registrationPromise:function(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,7]),[4,Ip(t,e)];case 1:return n=i.sent(),[2,Fp(t,n)];case 2:return vp(r=i.sent())&&409===r.customData.serverCode?[4,Up(t)]:[3,4];case 3:return i.sent(),[3,6];case 4:return[4,Fp(t,{fid:e.fid,registrationStatus:0})];case 5:i.sent(),i.label=6;case 6:throw r;case 7:return[2]}}))}))}(t,n)}}return 1===e.registrationStatus?{installationEntry:e,registrationPromise:Vp(t)}:{installationEntry:e}}(t,r);return e=i.registrationPromise,i.installationEntry}))];case 1:return""!==(n=i.sent()).fid?[3,3]:(r={},[4,e]);case 2:return[2,(r.installationEntry=i.sent(),r)];case 3:return[2,{installationEntry:n,registrationPromise:e}]}}))}))}function Vp(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e,n,r,i;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return[4,Bp(t)];case 1:e=o.sent(),o.label=2;case 2:return 1!==e.registrationStatus?[3,5]:[4,Tp(100)];case 3:return o.sent(),[4,Bp(t)];case 4:return e=o.sent(),[3,2];case 5:return 0!==e.registrationStatus?[3,7]:[4,qp(t)];case 6:return n=o.sent(),r=n.installationEntry,(i=n.registrationPromise)?[2,i]:[2,r];case 7:return[2,e]}}))}))}function Bp(t){return jp(t,(function(t){if(!t)throw pp.create("installation-not-found");return Kp(t)}))}function Kp(t){return 1===(e=t).registrationStatus&&e.registrationTime+cp<Date.now()?{fid:t.fid,registrationStatus:0}:t;var e}function Wp(t,e){var n=t.appConfig,r=t.platformLoggerProvider;return(0,c.__awaiter)(this,void 0,void 0,(function(){var t,i,o,a,s,u,l;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:return t=function(t,e){var n=e.fid;return gp(t)+"/"+n+"/authTokens:generate"}(n,e),i=bp(n,e),(o=r.getImmediate({optional:!0}))&&i.append("x-firebase-client",o.getPlatformInfoString()),a={installation:{sdkVersion:lp}},s={method:"POST",headers:i,body:JSON.stringify(a)},[4,wp((function(){return fetch(t,s)}))];case 1:return(u=c.sent()).ok?[4,u.json()]:[3,3];case 2:return l=c.sent(),[2,yp(l)];case 3:return[4,mp("Generate Auth Token",u)];case 4:throw c.sent()}}))}))}function Hp(t,e){return void 0===e&&(e=!1),(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return[4,jp(t.appConfig,(function(r){if(!zp(r))throw pp.create("not-registered");var i=r.authToken;if(!e&&function(t){return 2===t.requestStatus&&!function(t){var e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+fp}(t)}(i))return r;if(1===i.requestStatus)return n=function(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:return[4,Gp(t.appConfig)];case 1:n=i.sent(),i.label=2;case 2:return 1!==n.authToken.requestStatus?[3,5]:[4,Tp(100)];case 3:return i.sent(),[4,Gp(t.appConfig)];case 4:return n=i.sent(),[3,2];case 5:return 0===(r=n.authToken).requestStatus?[2,Hp(t,e)]:[2,r]}}))}))}(t,e),r;if(!navigator.onLine)throw pp.create("app-offline");var o=function(t){var e={requestStatus:1,requestTime:Date.now()};return(0,c.__assign)((0,c.__assign)({},t),{authToken:e})}(r);return n=function(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,8]),[4,Wp(t,e)];case 1:return n=o.sent(),i=(0,c.__assign)((0,c.__assign)({},e),{authToken:n}),[4,Fp(t.appConfig,i)];case 2:return o.sent(),[2,n];case 3:return!vp(r=o.sent())||401!==r.customData.serverCode&&404!==r.customData.serverCode?[3,5]:[4,Up(t.appConfig)];case 4:return o.sent(),[3,7];case 5:return i=(0,c.__assign)((0,c.__assign)({},e),{authToken:{requestStatus:0}}),[4,Fp(t.appConfig,i)];case 6:o.sent(),o.label=7;case 7:throw r;case 8:return[2]}}))}))}(t,o),o}))];case 1:return r=o.sent(),n?[4,n]:[3,3];case 2:return i=o.sent(),[3,4];case 3:i=r.authToken,o.label=4;case 4:return[2,i]}}))}))}function Gp(t){return jp(t,(function(t){if(!zp(t))throw pp.create("not-registered");var e,n=t.authToken;return 1===(e=n).requestStatus&&e.requestTime+cp<Date.now()?(0,c.__assign)((0,c.__assign)({},t),{authToken:{requestStatus:0}}):t}))}function zp(t){return void 0!==t&&2===t.registrationStatus}function Qp(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return[4,qp(t)];case 1:return(e=n.sent().registrationPromise)?[4,e]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))}function Yp(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o;return(0,c.__generator)(this,(function(a){switch(a.label){case 0:return n=function(t,e){var n=e.fid;return gp(t)+"/"+n}(t,e),r=bp(t,e),i={method:"DELETE",headers:r},[4,wp((function(){return fetch(n,i)}))];case 1:return(o=a.sent()).ok?[3,3]:[4,mp("Delete Installation",o)];case 2:throw a.sent();case 3:return[2]}}))}))}function Xp(t,e){var n=t.appConfig;return function(t,e){xp();var n=Cp(t),r=kp.get(n);r||(r=new Set,kp.set(n,r)),r.add(e)}(n,e),function(){!function(t,e){var n=Cp(t),r=kp.get(n);r&&(r.delete(e),0===r.size&&kp.delete(n),Rp())}(n,e)}}function $p(t){return pp.create("missing-app-config-values",{valueName:t})}!function(t){t.INTERNAL.registerComponent(new Qd.Component("installations",(function(t){var e=t.getProvider("app").getImmediate(),n={appConfig:function(t){var e,n;if(!t||!t.options)throw $p("App Configuration");if(!t.name)throw $p("App Name");try{for(var r=(0,c.__values)(["projectId","apiKey","appId"]),i=r.next();!i.done;i=r.next()){var o=i.value;if(!t.options[o])throw $p(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e),platformLoggerProvider:t.getProvider("platform-logger")};return{app:e,getId:function(){return function(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:return[4,qp(t.appConfig)];case 1:return e=i.sent(),n=e.installationEntry,(r=e.registrationPromise)?r.catch(console.error):Hp(t).catch(console.error),[2,n.fid]}}))}))}(n)},getToken:function(t){return function(t,e){return void 0===e&&(e=!1),(0,c.__awaiter)(this,void 0,void 0,(function(){return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return[4,Qp(t.appConfig)];case 1:return n.sent(),[4,Hp(t,e)];case 2:return[2,n.sent().token]}}))}))}(n,t)},delete:function(){return function(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return[4,jp(e=t.appConfig,(function(t){if(!t||0!==t.registrationStatus)return t}))];case 1:if(!(n=r.sent()))return[3,6];if(1!==n.registrationStatus)return[3,2];throw pp.create("delete-pending-registration");case 2:if(2!==n.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw pp.create("app-offline");case 3:return[4,Yp(e,n)];case 4:return r.sent(),[4,Up(e)];case 5:r.sent(),r.label=6;case 6:return[2]}}))}))}(n)},onIdChange:function(t){return Xp(n,t)}}}),"PUBLIC")),t.registerVersion("@firebase/installations",up)}(u.default);var Jp,Zp=((Dp={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',Dp["only-available-in-window"]="This method is available in a Window context.",Dp["only-available-in-sw"]="This method is available in a service worker context.",Dp["permission-default"]="The notification permission was not granted and dismissed instead.",Dp["permission-blocked"]="The notification permission was not granted and blocked instead.",Dp["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",Dp["failed-service-worker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",Dp["token-subscribe-failed"]="A problem occurred while subscribing the user to FCM: {$errorInfo}",Dp["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",Dp["token-unsubscribe-failed"]="A problem occurred while unsubscribing the user from FCM: {$errorInfo}",Dp["token-update-failed"]="A problem occurred while updating the user from FCM: {$errorInfo}",Dp["token-update-no-token"]="FCM returned no token when updating the user to push.",Dp["use-sw-after-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",Dp["invalid-sw-registration"]="The input to useServiceWorker() must be a ServiceWorkerRegistration.",Dp["invalid-bg-handler"]="The input to setBackgroundMessageHandler() must be a function.",Dp["invalid-vapid-key"]="The public VAPID key must be a string.",Dp["use-vapid-key-after-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",Dp),tv=new l.ErrorFactory("messaging","Messaging",Zp),ev="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",nv="google.c.a.c_id";function rv(t){var e=new Uint8Array(t);return btoa(String.fromCharCode.apply(String,(0,c.__spreadArray)([],(0,c.__read)(e)))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function iv(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(e),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}!function(t){t.PUSH_RECEIVED="push-received",t.NOTIFICATION_CLICKED="notification-clicked"}(Jp||(Jp={}));var ov="fcm_token_details_db",av="fcm_token_object_Store";function sv(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e,n,r=this;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:return"databases"in indexedDB?[4,indexedDB.databases()]:[3,2];case 1:if(e=i.sent(),!e.map((function(t){return t.name})).includes(ov))return[2,null];i.label=2;case 2:return n=null,[4,(0,sp.openDb)(ov,5,(function(e){return(0,c.__awaiter)(r,void 0,void 0,(function(){var r,i,o,a;return(0,c.__generator)(this,(function(s){switch(s.label){case 0:return e.oldVersion<2?[2]:e.objectStoreNames.contains(av)?[4,(r=e.transaction.objectStore(av)).index("fcmSenderId").get(t)]:[2];case 1:return i=s.sent(),[4,r.clear()];case 2:if(s.sent(),!i)return[2];if(2===e.oldVersion){if(!(o=i).auth||!o.p256dh||!o.endpoint)return[2];n={token:o.fcmToken,createTime:null!==(a=o.createTime)&&void 0!==a?a:Date.now(),subscriptionOptions:{auth:o.auth,p256dh:o.p256dh,endpoint:o.endpoint,swScope:o.swScope,vapidKey:"string"==typeof o.vapidKey?o.vapidKey:rv(o.vapidKey)}}}else(3===e.oldVersion||4===e.oldVersion)&&(n={token:(o=i).fcmToken,createTime:o.createTime,subscriptionOptions:{auth:rv(o.auth),p256dh:rv(o.p256dh),endpoint:o.endpoint,swScope:o.swScope,vapidKey:rv(o.vapidKey)}});return[2]}}))}))}))];case 3:return i.sent().close(),[4,(0,sp.deleteDb)(ov)];case 4:return i.sent(),[4,(0,sp.deleteDb)("fcm_vapid_details_db")];case 5:return i.sent(),[4,(0,sp.deleteDb)("undefined")];case 6:return i.sent(),[2,uv(n)?n:null]}}))}))}function uv(t){if(!t||!t.subscriptionOptions)return!1;var e=t.subscriptionOptions;return"number"==typeof t.createTime&&t.createTime>0&&"string"==typeof t.token&&t.token.length>0&&"string"==typeof e.auth&&e.auth.length>0&&"string"==typeof e.p256dh&&e.p256dh.length>0&&"string"==typeof e.endpoint&&e.endpoint.length>0&&"string"==typeof e.swScope&&e.swScope.length>0&&"string"==typeof e.vapidKey&&e.vapidKey.length>0}var cv="firebase-messaging-store",lv=null;function hv(){return lv||(lv=(0,sp.openDb)("firebase-messaging-database",1,(function(t){switch(t.oldVersion){case 0:t.createObjectStore(cv)}}))),lv}function fv(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:return e=vv(t),[4,hv()];case 1:return[4,i.sent().transaction(cv).objectStore(cv).get(e)];case 2:return(n=i.sent())?[2,n]:[3,3];case 3:return[4,sv(t.appConfig.senderId)];case 4:return(r=i.sent())?[4,dv(t,r)]:[3,6];case 5:return i.sent(),[2,r];case 6:return[2]}}))}))}function dv(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r,i;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return n=vv(t),[4,hv()];case 1:return r=o.sent(),[4,(i=r.transaction(cv,"readwrite")).objectStore(cv).put(e,n)];case 2:return o.sent(),[4,i.complete];case 3:return o.sent(),[2,e]}}))}))}function pv(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:return e=vv(t),[4,hv()];case 1:return n=i.sent(),[4,(r=n.transaction(cv,"readwrite")).objectStore(cv).delete(e)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function vv(t){return t.appConfig.appId}function gv(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s;return(0,c.__generator)(this,(function(u){switch(u.label){case 0:return[4,bv(t)];case 1:n=u.sent(),r=wv(e),i={method:"POST",headers:n,body:JSON.stringify(r)},u.label=2;case 2:return u.trys.push([2,5,,6]),[4,fetch(_v(t.appConfig),i)];case 3:return[4,u.sent().json()];case 4:return o=u.sent(),[3,6];case 5:throw a=u.sent(),tv.create("token-subscribe-failed",{errorInfo:a});case 6:if(o.error)throw s=o.error.message,tv.create("token-subscribe-failed",{errorInfo:s});if(!o.token)throw tv.create("token-subscribe-no-token");return[2,o.token]}}))}))}function yv(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s;return(0,c.__generator)(this,(function(u){switch(u.label){case 0:return[4,bv(t)];case 1:n=u.sent(),r=wv(e.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)},u.label=2;case 2:return u.trys.push([2,5,,6]),[4,fetch(_v(t.appConfig)+"/"+e.token,i)];case 3:return[4,u.sent().json()];case 4:return o=u.sent(),[3,6];case 5:throw a=u.sent(),tv.create("token-update-failed",{errorInfo:a});case 6:if(o.error)throw s=o.error.message,tv.create("token-update-failed",{errorInfo:s});if(!o.token)throw tv.create("token-update-no-token");return[2,o.token]}}))}))}function mv(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a;return(0,c.__generator)(this,(function(s){switch(s.label){case 0:return[4,bv(t)];case 1:n=s.sent(),r={method:"DELETE",headers:n},s.label=2;case 2:return s.trys.push([2,5,,6]),[4,fetch(_v(t.appConfig)+"/"+e,r)];case 3:return[4,s.sent().json()];case 4:if((i=s.sent()).error)throw o=i.error.message,tv.create("token-unsubscribe-failed",{errorInfo:o});return[3,6];case 5:throw a=s.sent(),tv.create("token-unsubscribe-failed",{errorInfo:a});case 6:return[2]}}))}))}function _v(t){return"https://fcmregistrations.googleapis.com/v1/projects/"+t.projectId+"/registrations"}function bv(t){var e=t.appConfig,n=t.installations;return(0,c.__awaiter)(this,void 0,void 0,(function(){var t;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return[4,n.getToken()];case 1:return t=r.sent(),[2,new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e.apiKey,"x-goog-firebase-installations-auth":"FIS "+t})]}}))}))}function wv(t){var e=t.p256dh,n=t.auth,r=t.endpoint,i=t.vapidKey,o={web:{endpoint:r,auth:n,p256dh:e}};return i!==ev&&(o.web.applicationPubKey=i),o}function Iv(t,e,n){return(0,c.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a;return(0,c.__generator)(this,(function(s){switch(s.label){case 0:if("granted"!==Notification.permission)throw tv.create("permission-blocked");return[4,Cv(e,n)];case 1:return r=s.sent(),[4,fv(t)];case 2:return i=s.sent(),o={vapidKey:n,swScope:e.scope,endpoint:r.endpoint,auth:rv(r.getKey("auth")),p256dh:rv(r.getKey("p256dh"))},i?[3,3]:[2,Sv(t,o)];case 3:if(u=i.subscriptionOptions,l=(c=o).vapidKey===u.vapidKey,h=c.endpoint===u.endpoint,f=c.auth===u.auth,d=c.p256dh===u.p256dh,l&&h&&f&&d)return[3,8];s.label=4;case 4:return s.trys.push([4,6,,7]),[4,mv(t,i.token)];case 5:return s.sent(),[3,7];case 6:return a=s.sent(),console.warn(a),[3,7];case 7:return[2,Sv(t,o)];case 8:return Date.now()>=i.createTime+6048e5?[2,Ev({token:i.token,createTime:Date.now(),subscriptionOptions:o},t,e)]:[2,i.token];case 9:return[2]}var u,c,l,h,f,d}))}))}function Tv(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:return[4,fv(t)];case 1:return(n=i.sent())?[4,mv(t,n.token)]:[3,4];case 2:return i.sent(),[4,pv(t)];case 3:i.sent(),i.label=4;case 4:return[4,e.pushManager.getSubscription()];case 5:return(r=i.sent())?[2,r.unsubscribe()]:[2,!0]}}))}))}function Ev(t,e,n){return(0,c.__awaiter)(this,void 0,void 0,(function(){var r,i,o;return(0,c.__generator)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,5]),[4,yv(e,t)];case 1:return r=a.sent(),i=(0,c.__assign)((0,c.__assign)({},t),{token:r,createTime:Date.now()}),[4,dv(e,i)];case 2:return a.sent(),[2,r];case 3:return o=a.sent(),[4,Tv(e,n)];case 4:throw a.sent(),o;case 5:return[2]}}))}))}function Sv(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:return[4,gv(t,e)];case 1:return n=i.sent(),r={token:n,createTime:Date.now(),subscriptionOptions:e},[4,dv(t,r)];case 2:return i.sent(),[2,r.token]}}))}))}function Cv(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return[4,t.pushManager.getSubscription()];case 1:return(n=r.sent())?[2,n]:[2,t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:iv(e)})]}}))}))}function kv(t){return"object"==typeof t&&!!t&&nv in t}function Av(t){return new Promise((function(e){setTimeout(e,t)}))}var Nv=function(){function t(t){var e=this;this.firebaseDependencies=t,this.isOnBackgroundMessageUsed=null,this.vapidKey=null,this.bgMessageHandler=null,self.addEventListener("push",(function(t){t.waitUntil(e.onPush(t))})),self.addEventListener("pushsubscriptionchange",(function(t){t.waitUntil(e.onSubChange(t))})),self.addEventListener("notificationclick",(function(t){t.waitUntil(e.onNotificationClick(t))}))}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.setBackgroundMessageHandler=function(t){if(this.isOnBackgroundMessageUsed=!1,!t||"function"!=typeof t)throw tv.create("invalid-bg-handler");this.bgMessageHandler=t},t.prototype.onBackgroundMessage=function(t){var e=this;return this.isOnBackgroundMessageUsed=!0,this.bgMessageHandler=t,function(){e.bgMessageHandler=null}},t.prototype.getToken=function(){var t,e;return(0,c.__awaiter)(this,void 0,void 0,(function(){var n;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return this.vapidKey?[3,2]:[4,fv(this.firebaseDependencies)];case 1:n=r.sent(),this.vapidKey=null!==(e=null===(t=null==n?void 0:n.subscriptionOptions)||void 0===t?void 0:t.vapidKey)&&void 0!==e?e:ev,r.label=2;case 2:return[2,Iv(this.firebaseDependencies,self.registration,this.vapidKey)]}}))}))},t.prototype.deleteToken=function(){return Tv(this.firebaseDependencies,self.registration)},t.prototype.requestPermission=function(){throw tv.create("only-available-in-window")},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw tv.create("use-vapid-key-after-get-token");if("string"!=typeof t||0===t.length)throw tv.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(){throw tv.create("only-available-in-window")},t.prototype.onMessage=function(){throw tv.create("only-available-in-window")},t.prototype.onTokenRefresh=function(){throw tv.create("only-available-in-window")},t.prototype.onPush=function(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e,n,r,i;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return(e=function(t){var e=t.data;if(!e)return null;try{return e.json()}catch(t){return null}}(t))?[4,Dv()]:(console.debug("FirebaseMessaging: failed to get parsed MessagePayload from the PushEvent. Skip handling the push."),[2]);case 1:return function(t){return t.some((function(t){return"visible"===t.visibilityState&&!t.url.startsWith("chrome-extension://")}))}(n=o.sent())?[2,Rv(n,e)]:(r=!1,e.notification?[4,Ov(Pv(e))]:[3,3]);case 2:o.sent(),r=!0,o.label=3;case 3:return!0===r&&!1===this.isOnBackgroundMessageUsed?[2]:(this.bgMessageHandler&&(i=function(t){var e={from:t.from,collapseKey:t.collapse_key,messageId:t.fcm_message_id};return function(t,e){if(e.notification){t.notification={};var n=e.notification.title;n&&(t.notification.title=n);var r=e.notification.body;r&&(t.notification.body=r);var i=e.notification.image;i&&(t.notification.image=i)}}(e,t),function(t,e){e.data&&(t.data=e.data)}(e,t),function(t,e){if(e.fcmOptions){t.fcmOptions={};var n=e.fcmOptions.link;n&&(t.fcmOptions.link=n);var r=e.fcmOptions.analytics_label;r&&(t.fcmOptions.analyticsLabel=r)}}(e,t),e}(e),"function"==typeof this.bgMessageHandler?this.bgMessageHandler(i):this.bgMessageHandler.next(i)),[4,Av(1e3)]);case 4:return o.sent(),[2]}}))}))},t.prototype.onSubChange=function(t){var e,n;return(0,c.__awaiter)(this,void 0,void 0,(function(){var r;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:return t.newSubscription?[3,2]:[4,Tv(this.firebaseDependencies,self.registration)];case 1:return i.sent(),[2];case 2:return[4,fv(this.firebaseDependencies)];case 3:return r=i.sent(),[4,Tv(this.firebaseDependencies,self.registration)];case 4:return i.sent(),[4,Iv(this.firebaseDependencies,self.registration,null!==(n=null===(e=null==r?void 0:r.subscriptionOptions)||void 0===e?void 0:e.vapidKey)&&void 0!==n?n:ev)];case 5:return i.sent(),[2]}}))}))},t.prototype.onNotificationClick=function(t){var e,n;return(0,c.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,s;return(0,c.__generator)(this,(function(u){switch(u.label){case 0:return(r=null===(n=null===(e=t.notification)||void 0===e?void 0:e.data)||void 0===n?void 0:n.FCM_MSG)?t.action?[2]:(t.stopImmediatePropagation(),t.notification.close(),(i=function(t){var e,n,r,i=null!==(n=null===(e=t.fcmOptions)||void 0===e?void 0:e.link)&&void 0!==n?n:null===(r=t.notification)||void 0===r?void 0:r.click_action;if(i)return i;return kv(t.data)?self.location.origin:null}(r))?(o=new URL(i,self.location.href),a=new URL(self.location.origin),o.host!==a.host?[2]:[4,xv(o)]):[2]):[2];case 1:return(s=u.sent())?[3,4]:[4,self.clients.openWindow(i)];case 2:return s=u.sent(),[4,Av(3e3)];case 3:return u.sent(),[3,6];case 4:return[4,s.focus()];case 5:s=u.sent(),u.label=6;case 6:return s?(r.messageType=Jp.NOTIFICATION_CLICKED,r.isFirebaseMessaging=!0,[2,s.postMessage(r)]):[2]}}))}))},t}();function Pv(t){var e,n=(0,c.__assign)({},t.notification);return n.data=((e={}).FCM_MSG=t,e),n}function xv(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e,n,r,i,o,a,s;return(0,c.__generator)(this,(function(u){switch(u.label){case 0:return[4,Dv()];case 1:e=u.sent();try{for(n=(0,c.__values)(e),r=n.next();!r.done;r=n.next())if(i=r.value,o=new URL(i.url,self.location.href),t.host===o.host)return[2,i]}catch(t){a={error:t}}finally{try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}}return[2,null]}}))}))}function Rv(t,e){var n,r;e.isFirebaseMessaging=!0,e.messageType=Jp.PUSH_RECEIVED;try{for(var i=(0,c.__values)(t),o=i.next();!o.done;o=i.next()){o.value.postMessage(e)}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}function Dv(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function Ov(t){var e,n=t.actions,r=Notification.maxActions;return n&&r&&n.length>r&&console.warn("This browser only supports "+r+" actions. The remaining actions will not be displayed."),self.registration.showNotification(null!==(e=t.title)&&void 0!==e?e:"",t)}var Lv=function(){function t(t){var e=this;this.firebaseDependencies=t,this.vapidKey=null,this.onMessageCallback=null,navigator.serviceWorker.addEventListener("message",(function(t){return e.messageEventListener(t)}))}return Object.defineProperty(t.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),t.prototype.messageEventListener=function(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e,n;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return(e=t.data).isFirebaseMessaging?(this.onMessageCallback&&e.messageType===Jp.PUSH_RECEIVED&&("function"==typeof this.onMessageCallback?this.onMessageCallback(function(t){return delete t.messageType,delete t.isFirebaseMessaging,t}(Object.assign({},e))):this.onMessageCallback.next(Object.assign({},e))),kv(n=e.data)&&"1"===n["google.c.a.e"]?[4,this.logEvent(e.messageType,n)]:[3,2]):[2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},t.prototype.getVapidKey=function(){return this.vapidKey},t.prototype.getSwReg=function(){return this.swRegistration},t.prototype.getToken=function(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return"default"!==Notification.permission?[3,2]:[4,Notification.requestPermission()];case 1:e.sent(),e.label=2;case 2:if("granted"!==Notification.permission)throw tv.create("permission-blocked");return[4,this.updateVapidKey(null==t?void 0:t.vapidKey)];case 3:return e.sent(),[4,this.updateSwReg(null==t?void 0:t.serviceWorkerRegistration)];case 4:return e.sent(),[2,Iv(this.firebaseDependencies,this.swRegistration,this.vapidKey)]}}))}))},t.prototype.updateVapidKey=function(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){return(0,c.__generator)(this,(function(e){return t?this.vapidKey=t:this.vapidKey||(this.vapidKey=ev),[2]}))}))},t.prototype.updateSwReg=function(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return t||this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:e.sent(),e.label=2;case 2:if(!t&&this.swRegistration)return[2];if(!(t instanceof ServiceWorkerRegistration))throw tv.create("invalid-sw-registration");return this.swRegistration=t,[2]}}))}))},t.prototype.registerDefaultSw=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=this,[4,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"})];case 1:return t.swRegistration=n.sent(),this.swRegistration.update().catch((function(){})),[3,3];case 2:throw e=n.sent(),tv.create("failed-service-worker-registration",{browserErrorMessage:e.message});case 3:return[2]}}))}))},t.prototype.deleteToken=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:t.sent(),t.label=2;case 2:return[2,Tv(this.firebaseDependencies,this.swRegistration)]}}))}))},t.prototype.requestPermission=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){var t;return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return"granted"===Notification.permission?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(t=e.sent()))return[2];throw"denied"===t?tv.create("permission-blocked"):tv.create("permission-default")}}))}))},t.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw tv.create("use-vapid-key-after-get-token");if("string"!=typeof t||0===t.length)throw tv.create("invalid-vapid-key");this.vapidKey=t},t.prototype.useServiceWorker=function(t){if(!(t instanceof ServiceWorkerRegistration))throw tv.create("invalid-sw-registration");if(this.swRegistration)throw tv.create("use-sw-after-get-token");this.swRegistration=t},t.prototype.onMessage=function(t){var e=this;return this.onMessageCallback=t,function(){e.onMessageCallback=null}},t.prototype.setBackgroundMessageHandler=function(){throw tv.create("only-available-in-sw")},t.prototype.onBackgroundMessage=function(){throw tv.create("only-available-in-sw")},t.prototype.onTokenRefresh=function(){return function(){}},t.prototype.logEvent=function(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return n=function(t){switch(t){case Jp.NOTIFICATION_CLICKED:return"notification_open";case Jp.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(t),[4,this.firebaseDependencies.analyticsProvider.get()];case 1:return r.sent().logEvent(n,{message_id:e["google.c.a.c_id"],message_name:e["google.c.a.c_l"],message_time:e["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)}),[2]}}))}))},t}();function Mv(t){return tv.create("missing-app-config-values",{valueName:t})}var Fv={isSupported:Uv};function Uv(){return self&&"ServiceWorkerGlobalScope"in self?"indexedDB"in self&&null!==indexedDB&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):"indexedDB"in window&&null!==indexedDB&&navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}u.default.INTERNAL.registerComponent(new Qd.Component("messaging",(function(t){var e=t.getProvider("app").getImmediate(),n={app:e,appConfig:function(t){var e,n;if(!t||!t.options)throw Mv("App Configuration Object");if(!t.name)throw Mv("App Name");var r=t.options;try{for(var i=(0,c.__values)(["projectId","apiKey","appId","messagingSenderId"]),o=i.next();!o.done;o=i.next()){var a=o.value;if(!r[a])throw Mv(a)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return{appName:t.name,projectId:r.projectId,apiKey:r.apiKey,appId:r.appId,senderId:r.messagingSenderId}}(e),installations:t.getProvider("installations").getImmediate(),analyticsProvider:t.getProvider("analytics-internal")};if(!Uv())throw tv.create("unsupported-browser");return self&&"ServiceWorkerGlobalScope"in self?new Nv(n):new Lv(n)}),"PUBLIC").setServiceProps(Fv));var jv="firebasestorage.googleapis.com",qv=function(t){function e(n,r){var i=t.call(this,Vv(n),"Firebase Storage: "+r+" ("+Vv(n)+")")||this;return i.customData={serverResponse:null},i._baseMessage=i.message,Object.setPrototypeOf(i,e.prototype),i}return(0,c.__extends)(e,t),e.prototype._codeEquals=function(t){return Vv(t)===this.code},Object.defineProperty(e.prototype,"serverResponse",{get:function(){return this.customData.serverResponse},set:function(t){this.customData.serverResponse=t,this.customData.serverResponse?this.message=this._baseMessage+"\n"+this.customData.serverResponse:this.message=this._baseMessage},enumerable:!1,configurable:!0}),e}(l.FirebaseError);function Vv(t){return"storage/"+t}function Bv(){return new qv("unknown","An unknown error occurred, please check the error payload for server response.")}function Kv(){return new qv("canceled","User canceled the upload/download.")}function Wv(){return new qv("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function Hv(t){return new qv("invalid-argument",t)}function Gv(){return new qv("app-deleted","The Firebase app was deleted.")}function zv(t){return new qv("invalid-root-operation","The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Qv(t,e){return new qv("invalid-format","String does not match format '"+t+"': "+e)}function Yv(t){throw new qv("internal-error","Internal error: "+t)}var Xv={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},$v=function(t,e){this.data=t,this.contentType=e||null};function Jv(t,e){switch(t){case Xv.RAW:return new $v(Zv(e));case Xv.BASE64:case Xv.BASE64URL:return new $v(tg(t,e));case Xv.DATA_URL:return new $v((n=new eg(e)).base64?tg(Xv.BASE64,n.rest):function(t){var e;try{e=decodeURIComponent(t)}catch(t){throw Qv(Xv.DATA_URL,"Malformed data URL.")}return Zv(e)}(n.rest),function(t){return new eg(t).contentType}(e))}var n;throw Bv()}function Zv(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|63&r);else if(55296==(64512&r))if(n<t.length-1&&56320==(64512&t.charCodeAt(n+1)))r=65536|(1023&r)<<10|1023&t.charCodeAt(++n),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r);else e.push(239,191,189);else 56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function tg(t,e){switch(t){case Xv.BASE64:var n=-1!==e.indexOf("-"),r=-1!==e.indexOf("_");if(n||r)throw Qv(t,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case Xv.BASE64URL:var i=-1!==e.indexOf("+"),o=-1!==e.indexOf("/");if(i||o)throw Qv(t,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/")}var a;try{a=atob(e)}catch(e){throw Qv(t,"Invalid character found")}for(var s=new Uint8Array(a.length),u=0;u<a.length;u++)s[u]=a.charCodeAt(u);return s}var eg=function(t){this.base64=!1,this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(null===e)throw Qv(Xv.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n=e[1]||null;null!=n&&(this.base64=(r=n,i=";base64",r.length>=i.length&&r.substring(r.length-i.length)===i),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=t.substring(t.indexOf(",")+1);var r,i};var ng,rg={STATE_CHANGED:"state_changed"},ig={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function og(t){switch(t){case"running":case"pausing":case"canceling":return ig.RUNNING;case"paused":return ig.PAUSED;case"success":return ig.SUCCESS;case"canceled":return ig.CANCELED;case"error":default:return ig.ERROR}}!function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"}(ng||(ng={}));var ag=function(){function t(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=ng.NO_ERROR,this.sendPromise_=new Promise((function(e){t.xhr_.addEventListener("abort",(function(){t.errorCode_=ng.ABORT,e()})),t.xhr_.addEventListener("error",(function(){t.errorCode_=ng.NETWORK_ERROR,e()})),t.xhr_.addEventListener("load",(function(){e()}))}))}return t.prototype.send=function(t,e,n,r){if(this.sent_)throw Yv("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),void 0!==r)for(var i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},t.prototype.getErrorCode=function(){if(!this.sent_)throw Yv("cannot .getErrorCode() before sending");return this.errorCode_},t.prototype.getStatus=function(){if(!this.sent_)throw Yv("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return-1}},t.prototype.getResponseText=function(){if(!this.sent_)throw Yv("cannot .getResponseText() before sending");return this.xhr_.responseText},t.prototype.abort=function(){this.xhr_.abort()},t.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)},t.prototype.addUploadProgressListener=function(t){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",t)},t.prototype.removeUploadProgressListener=function(t){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",t)},t}();var sg=function(){function t(){}return t.prototype.createConnection=function(){return new ag},t}(),ug=function(){function t(t,e){this.bucket=t,this.path_=e}return Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRoot",{get:function(){return 0===this.path.length},enumerable:!1,configurable:!0}),t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},t.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},t.makeFromBucketSpec=function(e,n){var r;try{r=t.makeFromUrl(e,n)}catch(n){return new t(e,"")}if(""===r.path)return r;throw new qv("invalid-default-bucket","Invalid default bucket '"+e+"'.")},t.makeFromUrl=function(e,n){var r=null,i="([A-Za-z0-9.\\-_]+)";var o=new RegExp("^gs://"+i+"(/(.*))?$","i");function a(t){t.path_=decodeURIComponent(t.path)}for(var s=n.replace(/[.]/g,"\\."),u=[{regex:o,indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp("^https?://"+s+"/v[A-Za-z0-9_]+/b/"+i+"/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:a},{regex:new RegExp("^https?://"+(n===jv?"(?:storage.googleapis.com|storage.cloud.google.com)":n)+"/"+i+"/([^?#]*)","i"),indices:{bucket:1,path:2},postModify:a}],c=0;c<u.length;c++){var l=u[c],h=l.regex.exec(e);if(h){var f=h[l.indices.bucket],d=h[l.indices.path];d||(d=""),r=new t(f,d),l.postModify(r);break}}if(null==r)throw function(t){return new qv("invalid-url","Invalid URL '"+t+"'.")}(e);return r},t}(),cg=function(){function t(t){this.promise_=Promise.reject(t)}return t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){},t}();function lg(t){return"string"==typeof t||t instanceof String}function hg(t){return fg()&&t instanceof Blob}function fg(){return"undefined"!=typeof Blob}function dg(t,e,n,r){if(r<e)throw Hv("Invalid value for '"+t+"'. Expected "+e+" or greater.");if(r>n)throw Hv("Invalid value for '"+t+"'. Expected "+n+" or less.")}function pg(t,e){var n=e.match(/^(\w+):\/\/.+/),r=e;return null==(null==n?void 0:n[1])&&(r="https://"+e),r+"/v0"+t}function vg(t){var e=encodeURIComponent,n="?";for(var r in t){if(t.hasOwnProperty(r))n=n+(e(r)+"="+e(t[r]))+"&"}return n=n.slice(0,-1)}var gg=function(){function t(t,e,n,r,i,o,a,s,u,c,l){var h=this;this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=a,this.errorCallback_=s,this.progressCallback_=c,this.timeout_=u,this.pool_=l,this.promise_=new Promise((function(t,e){h.resolve_=t,h.reject_=e,h.start_()}))}return t.prototype.start_=function(){var t=this;function e(e,n){var r,i=t.resolve_,o=t.reject_,a=n.connection;if(n.wasSuccessCode)try{var s=t.callback_(a,a.getResponseText());!function(t){return void 0!==t}(s)?i():i(s)}catch(t){o(t)}else null!==a?((r=Bv()).serverResponse=a.getResponseText(),t.errorCallback_?o(t.errorCallback_(a,r)):o(r)):n.canceled?o(r=t.appDelete_?Gv():Kv()):o(r=new qv("retry-limit-exceeded","Max retry time for operation exceeded, please try again."))}this.canceled_?e(0,new yg(!1,null,!0)):this.backoffId_=function(t,e,n){var r=1,i=null,o=!1,a=0;function s(){return 2===a}var u=!1;function l(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];u||(u=!0,e.apply(null,t))}function h(e){i=setTimeout((function(){i=null,t(f,s())}),e)}function f(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!u)if(t)l.call.apply(l,(0,c.__spreadArray)([null,t],e));else{var i;s()||o?l.call.apply(l,(0,c.__spreadArray)([null,t],e)):(r<64&&(r*=2),1===a?(a=2,i=0):i=1e3*(r+Math.random()),h(i))}}var d=!1;function p(t){d||(d=!0,u||(null!==i?(t||(a=2),clearTimeout(i),h(0)):t||(a=1)))}return h(0),setTimeout((function(){o=!0,p(!0)}),n),p}((function(e,n){if(n)e(!1,new yg(!1,null,!0));else{var r=t.pool_.createConnection();t.pendingConnection_=r,null!==t.progressCallback_&&r.addUploadProgressListener(i),r.send(t.url_,t.method_,t.body_,t.headers_).then((function(){null!==t.progressCallback_&&r.removeUploadProgressListener(i),t.pendingConnection_=null;var n=r.getErrorCode()===ng.NO_ERROR,o=r.getStatus();if(n&&!t.isRetryStatusCode_(o)){var a=-1!==t.successCodes_.indexOf(o);e(!0,new yg(a,r))}else{var s=r.getErrorCode()===ng.ABORT;e(!1,new yg(!1,null,s))}}))}function i(e){var n=e.loaded,r=e.lengthComputable?e.total:-1;null!==t.progressCallback_&&t.progressCallback_(n,r)}}),e,this.timeout_)},t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&function(t){t(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()},t.prototype.isRetryStatusCode_=function(t){var e=t>=500&&t<600,n=-1!==[408,429].indexOf(t),r=-1!==this.additionalRetryCodes_.indexOf(t);return e||n||r},t}(),yg=function(t,e,n){this.wasSuccessCode=t,this.connection=e,this.canceled=!!n};function mg(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function _g(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=mg();if(void 0!==n){for(var r=new n,i=0;i<t.length;i++)r.append(t[i]);return r.getBlob()}if(fg())return new Blob(t);throw new qv("unsupported-environment","This browser doesn't seem to support creating Blobs")}var bg=function(){function t(t,e){var n=0,r="";hg(t)?(this.data_=t,n=t.size,r=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=r}return t.prototype.size=function(){return this.size_},t.prototype.type=function(){return this.type_},t.prototype.slice=function(e,n){if(hg(this.data_)){var r=function(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}(this.data_,e,n);return null===r?null:new t(r)}return new t(new Uint8Array(this.data_.buffer,e,n-e),!0)},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(fg()){var r=e.map((function(e){return e instanceof t?e.data_:e}));return new t(_g.apply(null,r))}var i=e.map((function(t){return lg(t)?Jv(Xv.RAW,t).data:t.data_})),o=0;i.forEach((function(t){o+=t.byteLength}));var a=new Uint8Array(o),s=0;return i.forEach((function(t){for(var e=0;e<t.length;e++)a[s++]=t[e]})),new t(a,!0)},t.prototype.uploadData=function(){return this.data_},t}();function wg(t){var e;try{e=JSON.parse(t)}catch(t){return null}return function(t){return"object"==typeof t&&!Array.isArray(t)}(e)?e:null}function Ig(t){var e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function Tg(t,e){return e}var Eg=function(t,e,n,r){this.server=t,this.local=e||t,this.writable=!!n,this.xform=r||Tg},Sg=null;function Cg(){if(Sg)return Sg;var t=[];t.push(new Eg("bucket")),t.push(new Eg("generation")),t.push(new Eg("metageneration")),t.push(new Eg("name","fullPath",!0));var e=new Eg("name");e.xform=function(t,e){return function(t){return!lg(t)||t.length<2?t:Ig(t)}(e)},t.push(e);var n=new Eg("size");return n.xform=function(t,e){return void 0!==e?Number(e):e},t.push(n),t.push(new Eg("timeCreated")),t.push(new Eg("updated")),t.push(new Eg("md5Hash",null,!0)),t.push(new Eg("cacheControl",null,!0)),t.push(new Eg("contentDisposition",null,!0)),t.push(new Eg("contentEncoding",null,!0)),t.push(new Eg("contentLanguage",null,!0)),t.push(new Eg("contentType",null,!0)),t.push(new Eg("metadata","customMetadata",!0)),Sg=t}function kg(t,e,n){for(var r={type:"file"},i=n.length,o=0;o<i;o++){var a=n[o];r[a.local]=a.xform(r,e[a.server])}return function(t,e){Object.defineProperty(t,"ref",{get:function(){var n=t.bucket,r=t.fullPath,i=new ug(n,r);return e._makeStorageReference(i)}})}(r,t),r}function Ag(t,e,n){var r=wg(e);return null===r?null:kg(t,r,n)}function Ng(t,e){for(var n={},r=e.length,i=0;i<r;i++){var o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}function Pg(t,e,n){var r=wg(n);return null===r?null:function(t,e,n){var r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n.prefixes)for(var i=0,o=n.prefixes;i<o.length;i++){var a=o[i].replace(/\/$/,""),s=t._makeStorageReference(new ug(e,a));r.prefixes.push(s)}if(n.items)for(var u=0,c=n.items;u<c.length;u++){var l=c[u];s=t._makeStorageReference(new ug(e,l.name)),r.items.push(s)}return r}(t,e,r)}var xg=function(t,e,n,r){this.url=t,this.method=e,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]};function Rg(t){if(!t)throw Bv()}function Dg(t,e){return function(n,r){var i=Ag(t,r,e);return Rg(null!==i),i}}function Og(t,e){return function(n,r){var i=Ag(t,r,e);return Rg(null!==i),function(t,e,n){var r=wg(e);if(null===r)return null;if(!lg(r.downloadTokens))return null;var i=r.downloadTokens;if(0===i.length)return null;var o=encodeURIComponent;return i.split(",").map((function(e){var r=t.bucket,i=t.fullPath;return pg("/b/"+o(r)+"/o/"+o(i),n)+vg({alt:"media",token:e})}))[0]}(i,r,t.host)}}function Lg(t){return function(e,n){var r,i,o;return 401===e.getStatus()?r=e.getResponseText().includes("Firebase App Check token is invalid")?new qv("unauthorized-app","This app does not have permission to access Firebase Storage on this project."):new qv("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===e.getStatus()?(o=t.bucket,r=new qv("quota-exceeded","Quota for bucket '"+o+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===e.getStatus()?(i=t.path,r=new qv("unauthorized","User does not have permission to access '"+i+"'.")):r=n,r.serverResponse=n.serverResponse,r}}function Mg(t){var e=Lg(t);return function(n,r){var i,o=e(n,r);return 404===n.getStatus()&&(i=t.path,o=new qv("object-not-found","Object '"+i+"' does not exist.")),o.serverResponse=r.serverResponse,o}}function Fg(t,e,n){var r=pg(e.fullServerUrl(),t.host),i=t.maxOperationRetryTime,o=new xg(r,"GET",Dg(t,n),i);return o.errorHandler=Mg(e),o}function Ug(t,e,n,r,i){var o={};e.isRoot?o.prefix="":o.prefix=e.path+"/",n&&n.length>0&&(o.delimiter=n),r&&(o.pageToken=r),i&&(o.maxResults=i);var a=pg(e.bucketOnlyServerUrl(),t.host),s=t.maxOperationRetryTime,u=new xg(a,"GET",function(t,e){return function(n,r){var i=Pg(t,e,r);return Rg(null!==i),i}}(t,e.bucket),s);return u.urlParams=o,u.errorHandler=Lg(e),u}function jg(t,e,n){var r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=function(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}(null,e)),r}var qg=function(t,e,n,r){this.current=t,this.total=e,this.finalized=!!n,this.metadata=r||null};function Vg(t,e){var n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(t){Rg(!1)}return Rg(!!n&&-1!==(e||["active"]).indexOf(n)),n}var Bg=262144;function Kg(t,e,n,r,i,o,a,s){var u=new qg(0,0);if(a?(u.current=a.current,u.total=a.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw new qv("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.");var c=u.total-u.current,l=c;i>0&&(l=Math.min(l,i));var h=u.current,f=h+l,d={"X-Goog-Upload-Command":l===c?"upload, finalize":"upload","X-Goog-Upload-Offset":""+u.current},p=r.slice(h,f);if(null===p)throw Wv();var v=e.maxUploadRetryTime,g=new xg(n,"POST",(function(t,n){var i,a=Vg(t,["active","final"]),s=u.current+l,c=r.size();return i="final"===a?Dg(e,o)(t,n):null,new qg(s,c,"final"===a,i)}),v);return g.headers=d,g.body=p.uploadData(),g.progressCallback=s||null,g.errorHandler=Lg(t),g}var Wg=function(t,e,n){if(function(t){return"function"==typeof t}(t)||null!=e||null!=n)this.next=t,this.error=e,this.complete=n;else{var r=t;this.next=r.next,this.error=r.error,this.complete=r.complete}};function Hg(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Promise.resolve().then((function(){return t.apply(void 0,e)}))}}var Gg=function(){function t(t,e,n){var r=this;void 0===n&&(n=null),this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=t,this._blob=e,this._metadata=n,this._mappings=Cg(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=function(t){r._request=void 0,r._chunkMultiplier=1,t._codeEquals("canceled")?(r._needToFetchStatus=!0,r.completeTransitions_()):(r._error=t,r._transition("error"))},this._metadataErrorHandler=function(t){r._request=void 0,t._codeEquals("canceled")?r.completeTransitions_():(r._error=t,r._transition("error"))},this._promise=new Promise((function(t,e){r._resolve=t,r._reject=e,r._start()})),this._promise.then(null,(function(){}))}return t.prototype._makeProgressCallback=function(){var t=this,e=this._transferred;return function(n){return t._updateProgress(e+n)}},t.prototype._shouldDoResumable=function(t){return t.size()>262144},t.prototype._start=function(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())},t.prototype._resolveToken=function(t){var e=this;Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then((function(n){var r=n[0],i=n[1];switch(e._state){case"running":t(r,i);break;case"canceling":e._transition("canceled");break;case"pausing":e._transition("paused")}}))},t.prototype._createResumable=function(){var t=this;this._resolveToken((function(e,n){var r=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a=jg(e,r,i),s={name:a.fullPath},u=pg(o,t.host),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":""+r.size(),"X-Goog-Upload-Header-Content-Type":a.contentType,"Content-Type":"application/json; charset=utf-8"},l=Ng(a,n),h=t.maxUploadRetryTime,f=new xg(u,"POST",(function(t){var e;Vg(t);try{e=t.getResponseHeader("X-Goog-Upload-URL")}catch(t){Rg(!1)}return Rg(lg(e)),e}),h);return f.urlParams=s,f.headers=c,f.body=l,f.errorHandler=Lg(e),f}(t._ref.storage,t._ref._location,t._mappings,t._blob,t._metadata),i=t._ref.storage._makeRequest(r,e,n);t._request=i,i.getPromise().then((function(e){t._request=void 0,t._uploadUrl=e,t._needToFetchStatus=!1,t.completeTransitions_()}),t._errorHandler)}))},t.prototype._fetchStatus=function(){var t=this,e=this._uploadUrl;this._resolveToken((function(n,r){var i=function(t,e,n,r){var i=t.maxUploadRetryTime,o=new xg(n,"POST",(function(t){var e=Vg(t,["active","final"]),n=null;try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(t){Rg(!1)}n||Rg(!1);var i=Number(n);return Rg(!isNaN(i)),new qg(i,r.size(),"final"===e)}),i);return o.headers={"X-Goog-Upload-Command":"query"},o.errorHandler=Lg(e),o}(t._ref.storage,t._ref._location,e,t._blob),o=t._ref.storage._makeRequest(i,n,r);t._request=o,o.getPromise().then((function(e){e=e,t._request=void 0,t._updateProgress(e.current),t._needToFetchStatus=!1,e.finalized&&(t._needToFetchMetadata=!0),t.completeTransitions_()}),t._errorHandler)}))},t.prototype._continueUpload=function(){var t=this,e=Bg*this._chunkMultiplier,n=new qg(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((function(i,o){var a;try{a=Kg(t._ref._location,t._ref.storage,r,t._blob,e,t._mappings,n,t._makeProgressCallback())}catch(e){return t._error=e,void t._transition("error")}var s=t._ref.storage._makeRequest(a,i,o);t._request=s,s.getPromise().then((function(e){t._increaseMultiplier(),t._request=void 0,t._updateProgress(e.current),e.finalized?(t._metadata=e.metadata,t._transition("success")):t.completeTransitions_()}),t._errorHandler)}))},t.prototype._increaseMultiplier=function(){Bg*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)},t.prototype._fetchMetadata=function(){var t=this;this._resolveToken((function(e,n){var r=Fg(t._ref.storage,t._ref._location,t._mappings),i=t._ref.storage._makeRequest(r,e,n);t._request=i,i.getPromise().then((function(e){t._request=void 0,t._metadata=e,t._transition("success")}),t._metadataErrorHandler)}))},t.prototype._oneShotUpload=function(){var t=this;this._resolveToken((function(e,n){var r=function(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"},s=function(){for(var t="",e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();a["Content-Type"]="multipart/related; boundary="+s;var u=jg(e,r,i),c="--"+s+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+Ng(u,n)+"\r\n--"+s+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",l="\r\n--"+s+"--",h=bg.getBlob(c,r,l);if(null===h)throw Wv();var f={name:u.fullPath},d=pg(o,t.host),p=t.maxUploadRetryTime,v=new xg(d,"POST",Dg(t,n),p);return v.urlParams=f,v.headers=a,v.body=h.uploadData(),v.errorHandler=Lg(e),v}(t._ref.storage,t._ref._location,t._mappings,t._blob,t._metadata),i=t._ref.storage._makeRequest(r,e,n);t._request=i,i.getPromise().then((function(e){t._request=void 0,t._metadata=e,t._updateProgress(t._blob.size()),t._transition("success")}),t._errorHandler)}))},t.prototype._updateProgress=function(t){var e=this._transferred;this._transferred=t,this._transferred!==e&&this._notifyObservers()},t.prototype._transition=function(t){if(this._state!==t)switch(t){case"canceling":case"pausing":this._state=t,void 0!==this._request&&this._request.cancel();break;case"running":var e="paused"===this._state;this._state=t,e&&(this._notifyObservers(),this._start());break;case"paused":this._state=t,this._notifyObservers();break;case"canceled":this._error=Kv(),this._state=t,this._notifyObservers();break;case"error":case"success":this._state=t,this._notifyObservers()}},t.prototype.completeTransitions_=function(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=og(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:t,metadata:this._metadata,task:this,ref:this._ref}},enumerable:!1,configurable:!0}),t.prototype.on=function(t,e,n,r){var i=this,o=new Wg(e,n,r);return this._addObserver(o),function(){i._removeObserver(o)}},t.prototype.then=function(t,e){return this._promise.then(t,e)},t.prototype.catch=function(t){return this.then(null,t)},t.prototype._addObserver=function(t){this._observers.push(t),this._notifyObserver(t)},t.prototype._removeObserver=function(t){var e=this._observers.indexOf(t);-1!==e&&this._observers.splice(e,1)},t.prototype._notifyObservers=function(){var t=this;this._finishPromise(),this._observers.slice().forEach((function(e){t._notifyObserver(e)}))},t.prototype._finishPromise=function(){if(void 0!==this._resolve){var t=!0;switch(og(this._state)){case ig.SUCCESS:Hg(this._resolve.bind(null,this.snapshot))();break;case ig.CANCELED:case ig.ERROR:Hg(this._reject.bind(null,this._error))();break;default:t=!1}t&&(this._resolve=void 0,this._reject=void 0)}},t.prototype._notifyObserver=function(t){switch(og(this._state)){case ig.RUNNING:case ig.PAUSED:t.next&&Hg(t.next.bind(t,this.snapshot))();break;case ig.SUCCESS:t.complete&&Hg(t.complete.bind(t))();break;case ig.CANCELED:case ig.ERROR:t.error&&Hg(t.error.bind(t,this._error))();break;default:t.error&&Hg(t.error.bind(t,this._error))()}},t.prototype.resume=function(){var t="paused"===this._state||"pausing"===this._state;return t&&this._transition("running"),t},t.prototype.pause=function(){var t="running"===this._state;return t&&this._transition("pausing"),t},t.prototype.cancel=function(){var t="running"===this._state||"pausing"===this._state;return t&&this._transition("canceling"),t},t}(),zg=function(){function t(t,e){this._service=t,this._location=e instanceof ug?e:ug.makeFromUrl(e,t.host)}return t.prototype.toString=function(){return"gs://"+this._location.bucket+"/"+this._location.path},t.prototype._newRef=function(e,n){return new t(e,n)},Object.defineProperty(t.prototype,"root",{get:function(){var t=new ug(this._location.bucket,"");return this._newRef(this._service,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._location.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._location.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return Ig(this._location.path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this._service},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=function(t){if(0===t.length)return null;var e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this._location.path);if(null===e)return null;var n=new ug(this._location.bucket,e);return new t(this._service,n)},enumerable:!1,configurable:!0}),t.prototype._throwIfRoot=function(t){if(""===this._location.path)throw zv(t)},t}();function Qg(t){var e={prefixes:[],items:[]};return Yg(t,e).then((function(){return e}))}function Yg(t,e,n){return(0,c.__awaiter)(this,void 0,void 0,(function(){var r,i,o;return(0,c.__generator)(this,(function(a){switch(a.label){case 0:return[4,Xg(t,{pageToken:n})];case 1:return r=a.sent(),(i=e.prefixes).push.apply(i,r.prefixes),(o=e.items).push.apply(o,r.items),null==r.nextPageToken?[3,3]:[4,Yg(t,e,r.nextPageToken)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function Xg(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:return null!=e&&"number"==typeof e.maxResults&&dg("options.maxResults",1,1e3,e.maxResults),n=e||{},r=Ug(t.storage,t._location,"/",n.pageToken,n.maxResults),[4,t.storage.makeRequestWithTokens(r)];case 1:return[2,i.sent().getPromise()]}}))}))}function $g(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return t._throwIfRoot("updateMetadata"),n=function(t,e,n,r){var i=pg(e.fullServerUrl(),t.host),o=Ng(n,r),a=t.maxOperationRetryTime,s=new xg(i,"PATCH",Dg(t,r),a);return s.headers={"Content-Type":"application/json; charset=utf-8"},s.body=o,s.errorHandler=Mg(e),s}(t.storage,t._location,e,Cg()),[4,t.storage.makeRequestWithTokens(n)];case 1:return[2,r.sent().getPromise()]}}))}))}function Jg(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return t._throwIfRoot("getDownloadURL"),e=function(t,e,n){var r=pg(e.fullServerUrl(),t.host),i=t.maxOperationRetryTime,o=new xg(r,"GET",Og(t,n),i);return o.errorHandler=Mg(e),o}(t.storage,t._location,Cg()),[4,t.storage.makeRequestWithTokens(e)];case 1:return[2,n.sent().getPromise().then((function(t){if(null===t)throw new qv("no-download-url","The given file does not have any download URLs.");return t}))]}}))}))}function Zg(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return t._throwIfRoot("deleteObject"),e=function(t,e){var n=pg(e.fullServerUrl(),t.host),r=t.maxOperationRetryTime,i=new xg(n,"DELETE",(function(t,e){}),r);return i.successCodes=[200,204],i.errorHandler=Mg(e),i}(t.storage,t._location),[4,t.storage.makeRequestWithTokens(e)];case 1:return[2,n.sent().getPromise()]}}))}))}function ty(t,e){var n=function(t,e){var n=e.split("/").filter((function(t){return t.length>0})).join("/");return 0===t.length?n:t+"/"+n}(t._location.path,e),r=new ug(t._location.bucket,n);return new zg(t.storage,r)}function ey(t){return/^[A-Za-z]+:\/\//.test(t)}function ny(t,e){if(t instanceof oy){var n=t;if(null==n._bucket)throw new qv("no-default-bucket","No default bucket found. Did you set the 'storageBucket' property when initializing the app?");var r=new zg(n,n._bucket);return null!=e?ny(r,e):r}return void 0!==e?ty(t,e):t}function ry(t,e){if(e&&ey(e)){if(t instanceof oy)return new zg(t,e);throw Hv("To use ref(service, url), the first argument must be a Storage instance.")}return ny(t,e)}function iy(t,e){var n=null==e?void 0:e.storageBucket;return null==n?null:ug.makeFromBucketSpec(n,t)}var oy=function(){function t(t,e,n,r,i,o){this.app=t,this._authProvider=e,this._appCheckProvider=n,this._pool=r,this._url=i,this._firebaseVersion=o,this._bucket=null,this._host=jv,this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?ug.makeFromBucketSpec(i,this._host):iy(this._host,this.app.options)}return Object.defineProperty(t.prototype,"host",{get:function(){return this._host},set:function(t){this._host=t,null!=this._url?this._bucket=ug.makeFromBucketSpec(this._url,t):this._bucket=iy(t,this.app.options)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._maxUploadRetryTime},set:function(t){dg("time",0,Number.POSITIVE_INFINITY,t),this._maxUploadRetryTime=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._maxOperationRetryTime},set:function(t){dg("time",0,Number.POSITIVE_INFINITY,t),this._maxOperationRetryTime=t},enumerable:!1,configurable:!0}),t.prototype._getAuthToken=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){var t,e;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return this._overrideAuthToken?[2,this._overrideAuthToken]:(t=this._authProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:if(null!==(e=n.sent()))return[2,e.accessToken];n.label=2;case 2:return[2,null]}}))}))},t.prototype._getAppCheckToken=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){var t;return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return(t=this._appCheckProvider.getImmediate({optional:!0}))?[4,t.getToken()]:[3,2];case 1:return[2,e.sent().token];case 2:return[2,null]}}))}))},t.prototype._delete=function(){return this._deleted||(this._deleted=!0,this._requests.forEach((function(t){return t.cancel()})),this._requests.clear()),Promise.resolve()},t.prototype._makeStorageReference=function(t){return new zg(this,t)},t.prototype._makeRequest=function(t,e,n){var r=this;if(this._deleted)return new cg(Gv());var i=function(t,e,n,r,i,o){var a=vg(t.urlParams),s=t.url+a,u=Object.assign({},t.headers);return function(t,e){e&&(t["X-Firebase-GMPID"]=e)}(u,e),function(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}(u,n),function(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(null!=e?e:"AppManager")}(u,o),function(t,e){null!==e&&(t["X-Firebase-AppCheck"]=e)}(u,r),new gg(s,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i)}(t,this._appId,e,n,this._pool,this._firebaseVersion);return this._requests.add(i),i.getPromise().then((function(){return r._requests.delete(i)}),(function(){return r._requests.delete(i)})),i},t.prototype.makeRequestWithTokens=function(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e,n,r;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:return[4,Promise.all([this._getAuthToken(),this._getAppCheckToken()])];case 1:return e=i.sent(),n=e[0],r=e[1],[2,this._makeRequest(t,n,r)]}}))}))},t}();function ay(t,e,n){return function(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new Gg(t,new bg(e),n)}(t=(0,l.getModularInstance)(t),e,n)}function sy(t){return function(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return t._throwIfRoot("getMetadata"),e=Fg(t.storage,t._location,Cg()),[4,t.storage.makeRequestWithTokens(e)];case 1:return[2,n.sent().getPromise()]}}))}))}(t=(0,l.getModularInstance)(t))}function uy(t,e){return ry(t=(0,l.getModularInstance)(t),e)}function cy(t,e,n,r){void 0===r&&(r={}),function(t,e,n,r){void 0===r&&(r={}),t.host="http://"+e+":"+n;var i=r.mockUserToken;i&&(t._overrideAuthToken="string"==typeof i?i:(0,l.createMockUserToken)(i,t.app.options.projectId))}(t,e,n,r)}var ly=function(){function t(t,e,n){this._delegate=t,this.task=e,this.ref=n}return Object.defineProperty(t.prototype,"bytesTransferred",{get:function(){return this._delegate.bytesTransferred},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._delegate.state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalBytes",{get:function(){return this._delegate.totalBytes},enumerable:!1,configurable:!0}),t}(),hy=function(){function t(t,e){this._delegate=t,this._ref=e,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}return Object.defineProperty(t.prototype,"snapshot",{get:function(){return new ly(this._delegate.snapshot,this,this._ref)},enumerable:!1,configurable:!0}),t.prototype.then=function(t,e){var n=this;return this._delegate.then((function(e){if(t)return t(new ly(e,n,n._ref))}),e)},t.prototype.on=function(t,e,n,r){var i=this,o=void 0;return e&&(o="function"==typeof e?function(t){return e(new ly(t,i,i._ref))}:{next:e.next?function(t){return e.next(new ly(t,i,i._ref))}:void 0,complete:e.complete||void 0,error:e.error||void 0}),this._delegate.on(t,o,n||void 0,r||void 0)},t}(),fy=function(){function t(t,e){this._delegate=t,this._service=e}return Object.defineProperty(t.prototype,"prefixes",{get:function(){var t=this;return this._delegate.prefixes.map((function(e){return new dy(e,t._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){var t=this;return this._delegate.items.map((function(e){return new dy(e,t._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextPageToken",{get:function(){return this._delegate.nextPageToken||null},enumerable:!1,configurable:!0}),t}(),dy=function(){function t(t,e){this._delegate=t,this.storage=e}return Object.defineProperty(t.prototype,"name",{get:function(){return this._delegate.name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._delegate.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._delegate.fullPath},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this._delegate.toString()},t.prototype.child=function(e){return new t(function(t,e){return ty(t,e)}(this._delegate,e),this.storage)},Object.defineProperty(t.prototype,"root",{get:function(){return new t(this._delegate.root,this.storage)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this._delegate.parent;return null==e?null:new t(e,this.storage)},enumerable:!1,configurable:!0}),t.prototype.put=function(t,e){return this._throwIfRoot("put"),new hy(ay(this._delegate,t,e),this)},t.prototype.putString=function(t,e,n){void 0===e&&(e=Xv.RAW),this._throwIfRoot("putString");var r=Jv(e,t),i=(0,c.__assign)({},n);return null==i.contentType&&null!=r.contentType&&(i.contentType=r.contentType),new hy(new Gg(this._delegate,new bg(r.data,!0),i),this)},t.prototype.listAll=function(){var t=this;return function(t){return Qg(t=(0,l.getModularInstance)(t))}(this._delegate).then((function(e){return new fy(e,t.storage)}))},t.prototype.list=function(t){var e=this;return function(t,e){return Xg(t=(0,l.getModularInstance)(t),e)}(this._delegate,t||void 0).then((function(t){return new fy(t,e.storage)}))},t.prototype.getMetadata=function(){return sy(this._delegate)},t.prototype.updateMetadata=function(t){return function(t,e){return $g(t=(0,l.getModularInstance)(t),e)}(this._delegate,t)},t.prototype.getDownloadURL=function(){return function(t){return Jg(t=(0,l.getModularInstance)(t))}(this._delegate)},t.prototype.delete=function(){return this._throwIfRoot("delete"),function(t){return Zg(t=(0,l.getModularInstance)(t))}(this._delegate)},t.prototype._throwIfRoot=function(t){if(""===this._delegate._location.path)throw zv(t)},t}(),py=function(){function t(t,e){this.app=t,this._delegate=e}return Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._delegate.maxOperationRetryTime},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._delegate.maxUploadRetryTime},enumerable:!1,configurable:!0}),t.prototype.ref=function(t){if(ey(t))throw Hv("ref() expected a child path but got a URL, use refFromURL instead.");return new dy(uy(this._delegate,t),this)},t.prototype.refFromURL=function(t){if(!ey(t))throw Hv("refFromURL() expected a full URL but got a child path, use ref() instead.");try{ug.makeFromUrl(t,this._delegate.host)}catch(t){throw Hv("refFromUrl() expected a valid full URL but got an invalid one.")}return new dy(uy(this._delegate,t),this)},t.prototype.setMaxUploadRetryTime=function(t){this._delegate.maxUploadRetryTime=t},t.prototype.setMaxOperationRetryTime=function(t){this._delegate.maxOperationRetryTime=t},t.prototype.useEmulator=function(t,e,n){void 0===n&&(n={}),cy(this._delegate,t,e,n)},t}();function vy(t,e){var n=e.instanceIdentifier,r=t.getProvider("app").getImmediate(),i=t.getProvider("auth-internal"),o=t.getProvider("app-check-internal");return new py(r,new oy(r,i,o,new sg,n,u.default.SDK_VERSION))}!function(t){var e={TaskState:ig,TaskEvent:rg,StringFormat:Xv,Storage:oy,Reference:dy};t.INTERNAL.registerComponent(new Qd.Component("storage",vy,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion("@firebase/storage","0.7.1")}(u.default);var gy,yy,my,_y="0.4.18",by=_y,wy="FB-PERF-TRACE-MEASURE",Iy="_wt_",Ty="_fcp",Ey="_fid",Sy="@firebase/performance/config",Cy="@firebase/performance/configexpire",ky="Performance",Ay=((gy={})["trace started"]="Trace {$traceName} was started before.",gy["trace stopped"]="Trace {$traceName} is not running.",gy["nonpositive trace startTime"]="Trace {$traceName} startTime should be positive.",gy["nonpositive trace duration"]="Trace {$traceName} duration should be positive.",gy["no window"]="Window is not available.",gy["no app id"]="App id is not available.",gy["no project id"]="Project id is not available.",gy["no api key"]="Api key is not available.",gy["invalid cc log"]="Attempted to queue invalid cc event",gy["FB not default"]="Performance can only start when Firebase app instance is the default one.",gy["RC response not ok"]="RC response is not ok",gy["invalid attribute name"]="Attribute name {$attributeName} is invalid.",gy["invalid attribute value"]="Attribute value {$attributeValue} is invalid.",gy["invalid custom metric name"]="Custom metric name {$customMetricName} is invalid",gy["invalid String merger input"]="Input for String merger is invalid, contact support team to resolve.",gy),Ny=new l.ErrorFactory("performance",ky,Ay),Py=new h.Logger(ky);Py.logLevel=h.LogLevel.INFO;var xy,Ry=function(){function t(t){if(this.window=t,!t)throw Ny.create("no window");this.performance=t.performance,this.PerformanceObserver=t.PerformanceObserver,this.windowLocation=t.location,this.navigator=t.navigator,this.document=t.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=t.localStorage),t.perfMetrics&&t.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=t.perfMetrics.onFirstInputDelay)}return t.prototype.getUrl=function(){return this.windowLocation.href.split("?")[0]},t.prototype.mark=function(t){this.performance&&this.performance.mark&&this.performance.mark(t)},t.prototype.measure=function(t,e,n){this.performance&&this.performance.measure&&this.performance.measure(t,e,n)},t.prototype.getEntriesByType=function(t){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(t):[]},t.prototype.getEntriesByName=function(t){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(t):[]},t.prototype.getTimeOrigin=function(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)},t.prototype.requiredApisAvailable=function(){return fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled?!!(0,l.isIndexedDBAvailable)()||(Py.info("IndexedDB is not supported by current browswer"),!1):(Py.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)},t.prototype.setupObserver=function(t,e){this.PerformanceObserver&&new this.PerformanceObserver((function(t){for(var n=0,r=t.getEntries();n<r.length;n++){var i=r[n];e(i)}})).observe({entryTypes:[t]})},t.getInstance=function(){return void 0===yy&&(yy=new t(my)),yy},t}();function Dy(t,e){var n=t.length-e.length;if(n<0||n>1)throw Ny.create("invalid String merger input");for(var r=[],i=0;i<t.length;i++)r.push(t.charAt(i)),e.length>i&&r.push(e.charAt(i));return r.join("")}var Oy,Ly,My=function(){function t(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=Dy("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=Dy("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}return t.prototype.getAppId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.appId;if(!t)throw Ny.create("no app id");return t},t.prototype.getProjectId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.projectId;if(!t)throw Ny.create("no project id");return t},t.prototype.getApiKey=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.apiKey;if(!t)throw Ny.create("no api key");return t},t.prototype.getFlTransportFullUrl=function(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)},t.getInstance=function(){return void 0===xy&&(xy=new t),xy},t}();function Fy(){return Oy}!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.VISIBLE=1]="VISIBLE",t[t.HIDDEN=2]="HIDDEN"}(Ly||(Ly={}));var Uy=["firebase_","google_","ga_"],jy=new RegExp("^[a-zA-Z]\\w*$");function qy(){var t=Ry.getInstance().navigator;return"serviceWorker"in t?t.serviceWorker.controller?2:3:1}function Vy(){switch(Ry.getInstance().document.visibilityState){case"visible":return Ly.VISIBLE;case"hidden":return Ly.HIDDEN;default:return Ly.UNKNOWN}}function By(){var t=Ry.getInstance().navigator.connection;switch(t&&t.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}var Ky="0.0.1",Wy=!0,Hy="FIREBASE_INSTALLATIONS_AUTH";function Gy(t){var e=function(){var t=Ry.getInstance().localStorage;if(!t)return;var e=t.getItem(Cy);if(!(e&&(n=e,Number(n)>Date.now())))return;var n;var r=t.getItem(Sy);if(!r)return;try{return JSON.parse(r)}catch(t){return}}();return e?(Qy(e),Promise.resolve()):function(t){return(e=My.getInstance().installationsService.getToken(),e.then((function(t){})),e).then((function(e){var n="https://firebaseremoteconfig.googleapis.com/v1/projects/"+My.getInstance().getProjectId()+"/namespaces/fireperf:fetch?key="+My.getInstance().getApiKey(),r=new Request(n,{method:"POST",headers:{Authorization:Hy+" "+e},body:JSON.stringify({app_instance_id:t,app_instance_id_token:e,app_id:My.getInstance().getAppId(),app_version:by,sdk_version:Ky})});return fetch(r).then((function(t){if(t.ok)return t.json();throw Ny.create("RC response not ok")}))})).catch((function(){Py.info(zy)}));var e}(t).then(Qy).then((function(t){return function(t){var e=Ry.getInstance().localStorage;if(!t||!e)return;e.setItem(Sy,JSON.stringify(t)),e.setItem(Cy,String(Date.now()+60*My.getInstance().configTimeToLive*60*1e3))}(t)}),(function(){}))}var zy="Could not fetch config, will use default configs";function Qy(t){if(!t)return t;var e=My.getInstance(),n=t.entries||{};return void 0!==n.fpr_enabled?e.loggingEnabled="true"===String(n.fpr_enabled):e.loggingEnabled=Wy,n.fpr_log_source&&(e.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(e.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(e.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),e.logTraceAfterSampling=Yy(e.tracesSamplingRate),e.logNetworkAfterSampling=Yy(e.networkRequestsSamplingRate),t}function Yy(t){return Math.random()<=t}var Xy,$y=1;function Jy(){return $y=2,Xy=Xy||function(){var t=Ry.getInstance().document;return new Promise((function(e){if(t&&"complete"!==t.readyState){var n=function(){"complete"===t.readyState&&(t.removeEventListener("readystatechange",n),e())};t.addEventListener("readystatechange",n)}else e()}))}().then((function(){return(t=My.getInstance().installationsService.getId()).then((function(t){Oy=t})),t;var t})).then((function(t){return Gy(t)})).then((function(){return Zy()}),(function(){return Zy()}))}function Zy(){$y=3}var tm,em=1e4,nm=3,rm=[],im=!1;function om(t){setTimeout((function(){var t,e;if(0!==nm)return rm.length?(t=rm.splice(0,1e3),e=t.map((function(t){return{source_extension_json_proto3:t.message,event_time_ms:String(t.eventTime)}})),void function(t,e){return function(t){var e=My.getInstance().getFlTransportFullUrl();return fetch(e,{method:"POST",body:JSON.stringify(t)})}(t).then((function(t){return t.ok||Py.info("Call to Firebase backend failed."),t.json()})).then((function(t){var n=Number(t.nextRequestWaitMillis),r=em;isNaN(n)||(r=Math.max(n,r));var i=t.logResponseDetails;Array.isArray(i)&&i.length>0&&"RETRY_REQUEST_LATER"===i[0].responseAction&&(rm=(0,c.__spreadArray)((0,c.__spreadArray)([],e),rm),Py.info("Retry transport request later.")),nm=3,om(r)}))}({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:My.getInstance().logSource,log_event:e},t).catch((function(){rm=(0,c.__spreadArray)((0,c.__spreadArray)([],t),rm),nm--,Py.info("Tries left: "+nm+"."),om(em)}))):om(em)}),t)}function am(t){if(!t.eventTime||!t.message)throw Ny.create("invalid cc log");rm=(0,c.__spreadArray)((0,c.__spreadArray)([],rm),[t])}function sm(t,e){tm||(tm=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];am({message:t.apply(void 0,e),eventTime:Date.now()})}}(lm)),tm(t,e)}function um(t){var e=My.getInstance();!e.instrumentationEnabled&&t.isAuto||(e.dataCollectionEnabled||t.isAuto)&&Ry.getInstance().requiredApisAvailable()&&(t.isAuto&&Vy()!==Ly.VISIBLE||(3===$y?cm(t):Jy().then((function(){return cm(t)}),(function(){return cm(t)}))))}function cm(t){if(Fy()){var e=My.getInstance();e.loggingEnabled&&e.logTraceAfterSampling&&setTimeout((function(){return sm(t,1)}),0)}}function lm(t,e){return 0===e?(r={url:(n=t).url,http_method:n.httpMethod||0,http_response_code:200,response_payload_bytes:n.responsePayloadBytes,client_start_time_us:n.startTimeUs,time_to_response_initiated_us:n.timeToResponseInitiatedUs,time_to_response_completed_us:n.timeToResponseCompletedUs},i={application_info:hm(),network_request_metric:r},JSON.stringify(i)):function(t){var e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};0!==Object.keys(t.counters).length&&(e.counters=t.counters);var n=t.getAttributes();0!==Object.keys(n).length&&(e.custom_attributes=n);var r={application_info:hm(),trace_metric:e};return JSON.stringify(r)}(t);var n,r,i}function hm(){return{google_app_id:My.getInstance().getAppId(),app_instance_id:Fy(),web_app_info:{sdk_version:by,page_url:Ry.getInstance().getUrl(),service_worker_status:qy(),visibility_state:Vy(),effective_connection_type:By()},application_process_state:0}}var fm=["_fp",Ty,Ey];var dm=function(){function t(t,e,n){void 0===e&&(e=!1),this.name=t,this.isAuto=e,this.state=1,this.customAttributes={},this.counters={},this.api=Ry.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark="FB-PERF-TRACE-START-"+this.randomId+"-"+this.name,this.traceStopMark="FB-PERF-TRACE-STOP-"+this.randomId+"-"+this.name,this.traceMeasure=n||"FB-PERF-TRACE-MEASURE-"+this.randomId+"-"+this.name,n&&this.calculateTraceMetrics())}return t.prototype.start=function(){if(1!==this.state)throw Ny.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2},t.prototype.stop=function(){if(2!==this.state)throw Ny.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),um(this)},t.prototype.record=function(t,e,n){if(t<=0)throw Ny.create("nonpositive trace startTime",{traceName:this.name});if(e<=0)throw Ny.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*e),this.startTimeUs=Math.floor(1e3*t),n&&n.attributes&&(this.customAttributes=(0,c.__assign)({},n.attributes)),n&&n.metrics)for(var r=0,i=Object.keys(n.metrics);r<i.length;r++){var o=i[r];isNaN(Number(n.metrics[o]))||(this.counters[o]=Number(Math.floor(n.metrics[o])))}um(this)},t.prototype.incrementMetric=function(t,e){void 0===e&&(e=1),void 0===this.counters[t]?this.putMetric(t,e):this.putMetric(t,this.counters[t]+e)},t.prototype.putMetric=function(t,e){if(i=t,o=this.name,0===i.length||i.length>100||!(o&&o.startsWith(Iy)&&fm.indexOf(i)>-1)&&i.startsWith("_"))throw Ny.create("invalid custom metric name",{customMetricName:t});var n,r,i,o;this.counters[t]=(n=e,(r=Math.floor(n))<n&&Py.info("Metric value should be an Integer, setting the value as : "+r+"."),r)},t.prototype.getMetric=function(t){return this.counters[t]||0},t.prototype.putAttribute=function(t,e){var n,r=!(0===(n=t).length||n.length>40||Uy.some((function(t){return n.startsWith(t)}))||!n.match(jy)),i=function(t){return 0!==t.length&&t.length<=100}(e);if(r&&i)this.customAttributes[t]=e;else{if(!r)throw Ny.create("invalid attribute name",{attributeName:t});if(!i)throw Ny.create("invalid attribute value",{attributeValue:e})}},t.prototype.getAttribute=function(t){return this.customAttributes[t]},t.prototype.removeAttribute=function(t){void 0!==this.customAttributes[t]&&delete this.customAttributes[t]},t.prototype.getAttributes=function(){return(0,c.__assign)({},this.customAttributes)},t.prototype.setStartTime=function(t){this.startTimeUs=t},t.prototype.setDuration=function(t){this.durationUs=t},t.prototype.calculateTraceMetrics=function(){var t=this.api.getEntriesByName(this.traceMeasure),e=t&&t[0];e&&(this.durationUs=Math.floor(1e3*e.duration),this.startTimeUs=Math.floor(1e3*(e.startTime+this.api.getTimeOrigin())))},t.createOobTrace=function(e,n,r){var i=Ry.getInstance().getUrl();if(i){var o=new t(Iy+i,!0),a=Math.floor(1e3*Ry.getInstance().getTimeOrigin());o.setStartTime(a),e&&e[0]&&(o.setDuration(Math.floor(1e3*e[0].duration)),o.putMetric("domInteractive",Math.floor(1e3*e[0].domInteractive)),o.putMetric("domContentLoadedEventEnd",Math.floor(1e3*e[0].domContentLoadedEventEnd)),o.putMetric("loadEventEnd",Math.floor(1e3*e[0].loadEventEnd)));if(n){var s=n.find((function(t){return"first-paint"===t.name}));s&&s.startTime&&o.putMetric("_fp",Math.floor(1e3*s.startTime));var u=n.find((function(t){return"first-contentful-paint"===t.name}));u&&u.startTime&&o.putMetric(Ty,Math.floor(1e3*u.startTime)),r&&o.putMetric(Ey,Math.floor(1e3*r))}um(o)}},t.createUserTimingTrace=function(e){um(new t(e,!1,e))},t}();function pm(t){var e=t;if(e&&void 0!==e.responseStart){var n=Ry.getInstance().getTimeOrigin(),r=Math.floor(1e3*(e.startTime+n)),i=e.responseStart?Math.floor(1e3*(e.responseStart-e.startTime)):void 0,o=Math.floor(1e3*(e.responseEnd-e.startTime));!function(t){var e=My.getInstance();if(e.instrumentationEnabled){var n=t.url,r=e.logEndPointUrl.split("?")[0],i=e.flTransportEndpointUrl.split("?")[0];n!==r&&n!==i&&e.loggingEnabled&&e.logNetworkAfterSampling&&setTimeout((function(){return sm(t,0)}),0)}}({url:e.name&&e.name.split("?")[0],responsePayloadBytes:e.transferSize,startTimeUs:r,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:o})}}function vm(){Fy()&&(setTimeout((function(){return function(){var t=Ry.getInstance(),e=t.getEntriesByType("navigation"),n=t.getEntriesByType("paint");if(t.onFirstInputDelay){var r=setTimeout((function(){dm.createOobTrace(e,n),r=void 0}),5e3);t.onFirstInputDelay((function(t){r&&(clearTimeout(r),dm.createOobTrace(e,n,t))}))}else dm.createOobTrace(e,n)}()}),0),setTimeout((function(){return function(){for(var t=Ry.getInstance(),e=t.getEntriesByType("resource"),n=0,r=e;n<r.length;n++){pm(r[n])}t.setupObserver("resource",pm)}()}),0),setTimeout((function(){return function(){for(var t=Ry.getInstance(),e=t.getEntriesByType("measure"),n=0,r=e;n<r.length;n++){gm(r[n])}t.setupObserver("measure",gm)}()}),0))}function gm(t){var e=t.name;e.substring(0,wy.length)!==wy&&dm.createUserTimingTrace(e)}var ym=function(){function t(t){this.app=t,Ry.getInstance().requiredApisAvailable()&&(0,l.validateIndexedDBOpenable)().then((function(t){t&&(im||(om(5500),im=!0),Jy().then(vm,vm))})).catch((function(t){Py.info("Environment doesn't support IndexedDB: "+t)}))}return t.prototype.trace=function(t){return new dm(t)},Object.defineProperty(t.prototype,"instrumentationEnabled",{get:function(){return My.getInstance().instrumentationEnabled},set:function(t){My.getInstance().instrumentationEnabled=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataCollectionEnabled",{get:function(){return My.getInstance().dataCollectionEnabled},set:function(t){My.getInstance().dataCollectionEnabled=t},enumerable:!1,configurable:!0}),t}();!function(t){var e=function(t,e){if("[DEFAULT]"!==t.name)throw Ny.create("FB not default");if("undefined"==typeof window)throw Ny.create("no window");return function(t){my=t}(window),My.getInstance().firebaseAppInstance=t,My.getInstance().installationsService=e,new ym(t)};t.INTERNAL.registerComponent(new Qd.Component("performance",(function(t){var n=t.getProvider("app").getImmediate(),r=t.getProvider("installations").getImmediate();return e(n,r)}),"PUBLIC")),t.registerVersion("@firebase/performance",_y)}(u.default);var mm,_m,bm="https://www.googletagmanager.com/gtag/js";!function(t){t.EVENT="event",t.SET="set",t.CONFIG="config"}(mm||(mm={})),function(t){t.ADD_SHIPPING_INFO="add_shipping_info",t.ADD_PAYMENT_INFO="add_payment_info",t.ADD_TO_CART="add_to_cart",t.ADD_TO_WISHLIST="add_to_wishlist",t.BEGIN_CHECKOUT="begin_checkout",t.CHECKOUT_PROGRESS="checkout_progress",t.EXCEPTION="exception",t.GENERATE_LEAD="generate_lead",t.LOGIN="login",t.PAGE_VIEW="page_view",t.PURCHASE="purchase",t.REFUND="refund",t.REMOVE_FROM_CART="remove_from_cart",t.SCREEN_VIEW="screen_view",t.SEARCH="search",t.SELECT_CONTENT="select_content",t.SELECT_ITEM="select_item",t.SELECT_PROMOTION="select_promotion",t.SET_CHECKOUT_OPTION="set_checkout_option",t.SHARE="share",t.SIGN_UP="sign_up",t.TIMING_COMPLETE="timing_complete",t.VIEW_CART="view_cart",t.VIEW_ITEM="view_item",t.VIEW_ITEM_LIST="view_item_list",t.VIEW_PROMOTION="view_promotion",t.VIEW_SEARCH_RESULTS="view_search_results"}(_m||(_m={}));var wm,Im=new h.Logger("@firebase/analytics");function Tm(t,e,n,r,i,o){return(0,c.__awaiter)(this,void 0,void 0,(function(){var a,s,u,l;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:a=r[i],c.label=1;case 1:return c.trys.push([1,7,,8]),a?[4,e[a]]:[3,3];case 2:return c.sent(),[3,6];case 3:return[4,Promise.all(n)];case 4:return s=c.sent(),(u=s.find((function(t){return t.measurementId===i})))?[4,e[u.appId]]:[3,6];case 5:c.sent(),c.label=6;case 6:return[3,8];case 7:return l=c.sent(),Im.error(l),[3,8];case 8:return t(mm.CONFIG,i,o),[2]}}))}))}function Em(t,e,n,r,i){return(0,c.__awaiter)(this,void 0,void 0,(function(){var o,a,s,u,l,h,f,d;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:return c.trys.push([0,4,,5]),o=[],i&&i.send_to?(a=i.send_to,Array.isArray(a)||(a=[a]),[4,Promise.all(n)]):[3,2];case 1:for(s=c.sent(),u=function(t){var n=s.find((function(e){return e.measurementId===t})),r=n&&e[n.appId];if(!r)return o=[],"break";o.push(r)},l=0,h=a;l<h.length&&(f=h[l],"break"!==u(f));l++);c.label=2;case 2:return 0===o.length&&(o=Object.values(e)),[4,Promise.all(o)];case 3:return c.sent(),t(mm.EVENT,r,i||{}),[3,5];case 4:return d=c.sent(),Im.error(d),[3,5];case 5:return[2]}}))}))}function Sm(t,e,n,r,i){var o=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(o=window[i]),window[i]=function(t,e,n,r){return function(i,o,a){return(0,c.__awaiter)(this,void 0,void 0,(function(){var s;return(0,c.__generator)(this,(function(u){switch(u.label){case 0:return u.trys.push([0,6,,7]),i!==mm.EVENT?[3,2]:[4,Em(t,e,n,o,a)];case 1:return u.sent(),[3,5];case 2:return i!==mm.CONFIG?[3,4]:[4,Tm(t,e,n,r,o,a)];case 3:return u.sent(),[3,5];case 4:t(mm.SET,o),u.label=5;case 5:return[3,7];case 6:return s=u.sent(),Im.error(s),[3,7];case 7:return[2]}}))}))}}(o,t,e,n),{gtagCore:o,wrappedGtag:window[i]}}var Cm=((wm={})["already-exists"]="A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",wm["already-initialized"]="Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",wm["interop-component-reg-failed"]="Firebase Analytics Interop Component failed to instantiate: {$reason}",wm["invalid-analytics-context"]="Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",wm["indexeddb-unavailable"]="IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",wm["fetch-throttle"]="The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",wm["config-fetch-failed"]="Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",wm["no-api-key"]='The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',wm["no-app-id"]='The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',wm),km=new l.ErrorFactory("analytics","Analytics",Cm),Am=new(function(){function t(t,e){void 0===t&&(t={}),void 0===e&&(e=1e3),this.throttleMetadata=t,this.intervalMillis=e}return t.prototype.getThrottleMetadata=function(t){return this.throttleMetadata[t]},t.prototype.setThrottleMetadata=function(t,e){this.throttleMetadata[t]=e},t.prototype.deleteThrottleMetadata=function(t){delete this.throttleMetadata[t]},t}());function Nm(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}function Pm(t){var e;return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r,i,o,a,s,u;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:return n=t.appId,r=t.apiKey,i={method:"GET",headers:Nm(r)},o="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),[4,fetch(o,i)];case 1:if(200===(a=c.sent()).status||304===a.status)return[3,6];s="",c.label=2;case 2:return c.trys.push([2,4,,5]),[4,a.json()];case 3:return u=c.sent(),(null===(e=u.error)||void 0===e?void 0:e.message)&&(s=u.error.message),[3,5];case 4:return c.sent(),[3,5];case 5:throw km.create("config-fetch-failed",{httpStatus:a.status,responseMessage:s});case 6:return[2,a.json()]}}))}))}function xm(t,e,n,r){var i=e.throttleEndTimeMillis,o=e.backoffCount;return void 0===r&&(r=Am),(0,c.__awaiter)(this,void 0,void 0,(function(){var e,a,s,u,h,f,d;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:e=t.appId,a=t.measurementId,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,Rm(n,i)];case 2:return c.sent(),[3,4];case 3:if(s=c.sent(),a)return Im.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID "+a+' provided in the "measurementId" field in the local Firebase config. ['+s.message+"]"),[2,{appId:e,measurementId:a}];throw s;case 4:return c.trys.push([4,6,,7]),[4,Pm(t)];case 5:return u=c.sent(),r.deleteThrottleMetadata(e),[2,u];case 6:if(!function(t){if(!(t instanceof l.FirebaseError&&t.customData))return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(h=c.sent())){if(r.deleteThrottleMetadata(e),a)return Im.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID "+a+' provided in the "measurementId" field in the local Firebase config. ['+h.message+"]"),[2,{appId:e,measurementId:a}];throw h}return f=503===Number(h.customData.httpStatus)?(0,l.calculateBackoffMillis)(o,r.intervalMillis,30):(0,l.calculateBackoffMillis)(o,r.intervalMillis),d={throttleEndTimeMillis:Date.now()+f,backoffCount:o+1},r.setThrottleMetadata(e,d),Im.debug("Calling attemptFetch again in "+f+" millis"),[2,xm(t,d,n,r)];case 7:return[2]}}))}))}function Rm(t,e){return new Promise((function(n,r){var i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener((function(){clearTimeout(o),r(km.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}var Dm=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))},t}();function Om(t,e,n,r,i,o){return(0,c.__awaiter)(this,void 0,void 0,(function(){var a,s,u,h,f,d,p;return(0,c.__generator)(this,(function(v){switch(v.label){case 0:return(a=function(t,e,n){return void 0===e&&(e=Am),(0,c.__awaiter)(this,void 0,void 0,(function(){var r,i,o,a,s,u,l=this;return(0,c.__generator)(this,(function(h){if(r=t.options,i=r.appId,o=r.apiKey,a=r.measurementId,!i)throw km.create("no-app-id");if(!o){if(a)return[2,{measurementId:a,appId:i}];throw km.create("no-api-key")}return s=e.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},u=new Dm,setTimeout((function(){return(0,c.__awaiter)(l,void 0,void 0,(function(){return(0,c.__generator)(this,(function(t){return u.abort(),[2]}))}))}),void 0!==n?n:6e4),[2,xm({appId:i,apiKey:o,measurementId:a},s,u,e)]}))}))}(t)).then((function(e){n[e.measurementId]=e.appId,t.options.measurementId&&e.measurementId!==t.options.measurementId&&Im.warn("The measurement ID in the local Firebase config ("+t.options.measurementId+") does not match the measurement ID fetched from the server ("+e.measurementId+"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")})).catch((function(t){return Im.error(t)})),e.push(a),s=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){var t;return(0,c.__generator)(this,(function(e){switch(e.label){case 0:return(0,l.isIndexedDBAvailable)()?[3,1]:(Im.warn(km.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),[2,!1]);case 1:return e.trys.push([1,3,,4]),[4,(0,l.validateIndexedDBOpenable)()];case 2:return e.sent(),[3,4];case 3:return t=e.sent(),Im.warn(km.create("indexeddb-unavailable",{errorInfo:t}).message),[2,!1];case 4:return[2,!0]}}))}))}().then((function(t){return t?r.getId():void 0})),[4,Promise.all([a,s])];case 1:return u=v.sent(),h=u[0],f=u[1],function(){for(var t=window.document.getElementsByTagName("script"),e=0,n=Object.values(t);e<n.length;e++){var r=n[e];if(r.src&&r.src.includes(bm))return r}return null}()||function(t,e){var n=document.createElement("script");n.src=bm+"?l="+t+"&id="+e,n.async=!0,document.head.appendChild(n)}(o,h.measurementId),i("js",new Date),(p={}).origin="firebase",p.update=!0,d=p,null!=f&&(d.firebase_id=f),i(mm.CONFIG,h.measurementId,d),[2,h.measurementId]}}))}))}var Lm,Mm,Fm={},Um=[],jm={},qm="dataLayer",Vm="gtag",Bm=!1;function Km(t){if(Bm)throw km.create("already-initialized");t.dataLayerName&&(qm=t.dataLayerName),t.gtagName&&(Vm=t.gtagName)}function Wm(t,e){!function(){var t=[];if((0,l.isBrowserExtension)()&&t.push("This is a browser extension environment."),(0,l.areCookiesEnabled)()||t.push("Cookies are not available."),t.length>0){var e=t.map((function(t,e){return"("+(e+1)+") "+t})).join(" "),n=km.create("invalid-analytics-context",{errorInfo:e});Im.warn(n.message)}}();var n=t.options.appId;if(!n)throw km.create("no-app-id");if(!t.options.apiKey){if(!t.options.measurementId)throw km.create("no-api-key");Im.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '+t.options.measurementId+' provided in the "measurementId" field in the local Firebase config.')}if(null!=Fm[n])throw km.create("already-exists",{id:n});if(!Bm){!function(t){var e=[];Array.isArray(window[t])?e=window[t]:window[t]=e}(qm);var r=Sm(Fm,Um,jm,qm,Vm),i=r.wrappedGtag,o=r.gtagCore;Mm=i,Lm=o,Bm=!0}return Fm[n]=Om(t,Um,jm,e,Lm,qm),{app:t,logEvent:function(t,e,r){(function(t,e,n,r,i){return(0,c.__awaiter)(this,void 0,void 0,(function(){var o,a;return(0,c.__generator)(this,(function(s){switch(s.label){case 0:return i&&i.global?(t(mm.EVENT,n,r),[2]):[3,1];case 1:return[4,e];case 2:o=s.sent(),a=(0,c.__assign)((0,c.__assign)({},r),{send_to:o}),t(mm.EVENT,n,a),s.label=3;case 3:return[2]}}))}))})(Mm,Fm[n],t,e,r).catch((function(t){return Im.error(t)}))},setCurrentScreen:function(t,e){(function(t,e,n,r){return(0,c.__awaiter)(this,void 0,void 0,(function(){var i;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return r&&r.global?(t(mm.SET,{screen_name:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:i=o.sent(),t(mm.CONFIG,i,{update:!0,screen_name:n}),o.label=3;case 3:return[2]}}))}))})(Mm,Fm[n],t,e).catch((function(t){return Im.error(t)}))},setUserId:function(t,e){(function(t,e,n,r){return(0,c.__awaiter)(this,void 0,void 0,(function(){var i;return(0,c.__generator)(this,(function(o){switch(o.label){case 0:return r&&r.global?(t(mm.SET,{user_id:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:i=o.sent(),t(mm.CONFIG,i,{update:!0,user_id:n}),o.label=3;case 3:return[2]}}))}))})(Mm,Fm[n],t,e).catch((function(t){return Im.error(t)}))},setUserProperties:function(t,e){(function(t,e,n,r){return(0,c.__awaiter)(this,void 0,void 0,(function(){var i,o,a,s,u;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:if(!r||!r.global)return[3,1];for(i={},o=0,a=Object.keys(n);o<a.length;o++)s=a[o],i["user_properties."+s]=n[s];return t(mm.SET,i),[2,Promise.resolve()];case 1:return[4,e];case 2:u=c.sent(),t(mm.CONFIG,u,{update:!0,user_properties:n}),c.label=3;case 3:return[2]}}))}))})(Mm,Fm[n],t,e).catch((function(t){return Im.error(t)}))},setAnalyticsCollectionEnabled:function(t){(function(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return[4,t];case 1:return n=r.sent(),window["ga-disable-"+n]=!e,[2]}}))}))})(Fm[n],t).catch((function(t){return Im.error(t)}))},INTERNAL:{delete:function(){return delete Fm[n],Promise.resolve()}}}}var Hm="analytics";function Gm(){return(0,c.__awaiter)(this,void 0,void 0,(function(){return(0,c.__generator)(this,(function(t){switch(t.label){case 0:if((0,l.isBrowserExtension)())return[2,!1];if(!(0,l.areCookiesEnabled)())return[2,!1];if(!(0,l.isIndexedDBAvailable)())return[2,!1];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(0,l.validateIndexedDBOpenable)()];case 2:return[2,t.sent()];case 3:return t.sent(),[2,!1];case 4:return[2]}}))}))}!function(t){t.INTERNAL.registerComponent(new Qd.Component(Hm,(function(t){return Wm(t.getProvider("app").getImmediate(),t.getProvider("installations").getImmediate())}),"PUBLIC").setServiceProps({settings:Km,EventName:_m,isSupported:Gm})),t.INTERNAL.registerComponent(new Qd.Component("analytics-internal",(function(t){try{return{logEvent:t.getProvider(Hm).getImmediate().logEvent}}catch(t){throw km.create("interop-component-reg-failed",{reason:t})}}),"PRIVATE")),t.registerVersion("@firebase/analytics","0.6.18")}(u.default);var zm,Qm=function(){function t(t,e,n,r){this.client=t,this.storage=e,this.storageCache=n,this.logger=r}return t.prototype.isCachedDataFresh=function(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-e,r=n<=t;return this.logger.debug("Config fetch cache check. Cache age millis: "+n+". Cache max age millis (minimumFetchIntervalMillis setting): "+t+". Is cache hit: "+r+"."),r},t.prototype.fetch=function(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e,n,r,i,o;return(0,c.__generator)(this,(function(a){switch(a.label){case 0:return[4,Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()])];case 1:return e=a.sent(),n=e[0],(r=e[1])&&this.isCachedDataFresh(t.cacheMaxAgeMillis,n)?[2,r]:(t.eTag=r&&r.eTag,[4,this.client.fetch(t)]);case 2:return i=a.sent(),o=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===i.status&&o.push(this.storage.setLastSuccessfulFetchResponse(i)),[4,Promise.all(o)];case 3:return a.sent(),[2,i]}}))}))},t}(),Ym=((zm={})["registration-window"]="Undefined window object. This SDK only supports usage in a browser environment.",zm["registration-project-id"]="Undefined project identifier. Check Firebase app initialization.",zm["registration-api-key"]="Undefined API key. Check Firebase app initialization.",zm["registration-app-id"]="Undefined app identifier. Check Firebase app initialization.",zm["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",zm["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",zm["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",zm["storage-delete"]="Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",zm["fetch-client-network"]="Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",zm["fetch-timeout"]='The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',zm["fetch-throttle"]='The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',zm["fetch-client-parse"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",zm["fetch-status"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",zm),Xm=new l.ErrorFactory("remoteconfig","Remote Config",Ym);var $m=function(){function t(t,e,n,r,i,o){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=o}return t.prototype.fetch=function(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e,n,r,i,o,a,s,u,l,h,f,d,p,v,g,y,m,_,b;return(0,c.__generator)(this,(function(c){switch(c.label){case 0:return[4,Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()])];case 1:e=c.sent(),n=e[0],r=e[1],i=window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com",o=i+"/v1/projects/"+this.projectId+"/namespaces/"+this.namespace+":fetch?key="+this.apiKey,a={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":t.eTag||"*"},s={sdk_version:this.sdkVersion,app_instance_id:n,app_instance_id_token:r,app_id:this.appId,language_code:(void 0===w&&(w=navigator),w.languages&&w.languages[0]||w.language)},u={method:"POST",headers:a,body:JSON.stringify(s)},l=fetch(o,u),h=new Promise((function(e,n){t.signal.addEventListener((function(){var t=new Error("The operation was aborted.");t.name="AbortError",n(t)}))})),c.label=2;case 2:return c.trys.push([2,5,,6]),[4,Promise.race([l,h])];case 3:return c.sent(),[4,l];case 4:return f=c.sent(),[3,6];case 5:throw d=c.sent(),p="fetch-client-network","AbortError"===d.name&&(p="fetch-timeout"),Xm.create(p,{originalErrorMessage:d.message});case 6:if(v=f.status,g=f.headers.get("ETag")||void 0,200!==f.status)return[3,11];_=void 0,c.label=7;case 7:return c.trys.push([7,9,,10]),[4,f.json()];case 8:return _=c.sent(),[3,10];case 9:throw b=c.sent(),Xm.create("fetch-client-parse",{originalErrorMessage:b.message});case 10:y=_.entries,m=_.state,c.label=11;case 11:if("INSTANCE_STATE_UNSPECIFIED"===m?v=500:"NO_CHANGE"===m?v=304:"NO_TEMPLATE"!==m&&"EMPTY_CONFIG"!==m||(y={}),304!==v&&200!==v)throw Xm.create("fetch-status",{httpStatus:v});return[2,{status:v,eTag:g,config:y}]}var w}))}))},t}(),Jm=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(t){this.listeners.push(t)},t.prototype.abort=function(){this.listeners.forEach((function(t){return t()}))},t}(),Zm=["1","true","t","yes","y","on"],t_=function(){function t(t,e){void 0===e&&(e=""),this._source=t,this._value=e}return t.prototype.asString=function(){return this._value},t.prototype.asBoolean=function(){return"static"!==this._source&&Zm.indexOf(this._value.toLowerCase())>=0},t.prototype.asNumber=function(){if("static"===this._source)return 0;var t=Number(this._value);return isNaN(t)&&(t=0),t},t.prototype.getSource=function(){return this._source},t}(),e_=function(){function t(t,e,n,r,i){this.app=t,this._client=e,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}return t.prototype.setLogLevel=function(t){switch(t){case"debug":this._logger.logLevel=h.LogLevel.DEBUG;break;case"silent":this._logger.logLevel=h.LogLevel.SILENT;break;default:this._logger.logLevel=h.LogLevel.ERROR}},Object.defineProperty(t.prototype,"fetchTimeMillis",{get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastFetchStatus",{get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"},enumerable:!1,configurable:!0}),t.prototype.activate=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){var t,e,n;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return[4,Promise.all([this._storage.getLastSuccessfulFetchResponse(),this._storage.getActiveConfigEtag()])];case 1:return t=r.sent(),e=t[0],n=t[1],e&&e.config&&e.eTag&&e.eTag!==n?[4,Promise.all([this._storageCache.setActiveConfig(e.config),this._storage.setActiveConfigEtag(e.eTag)])]:[2,!1];case 2:return r.sent(),[2,!0]}}))}))},t.prototype.ensureInitialized=function(){var t=this;return this._initializePromise||(this._initializePromise=this._storageCache.loadFromStorage().then((function(){t._isInitializationComplete=!0}))),this._initializePromise},t.prototype.fetch=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r=this;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:t=new Jm,setTimeout((function(){return(0,c.__awaiter)(r,void 0,void 0,(function(){return(0,c.__generator)(this,(function(e){return t.abort(),[2]}))}))}),this.settings.fetchTimeoutMillis),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,this._client.fetch({cacheMaxAgeMillis:this.settings.minimumFetchIntervalMillis,signal:t})];case 2:return i.sent(),[4,this._storageCache.setLastFetchStatus("success")];case 3:return i.sent(),[3,6];case 4:return e=i.sent(),n=function(t,e){return t instanceof l.FirebaseError&&-1!==t.code.indexOf(e)}(e,"fetch-throttle")?"throttle":"failure",[4,this._storageCache.setLastFetchStatus(n)];case 5:throw i.sent(),e;case 6:return[2]}}))}))},t.prototype.fetchAndActivate=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){return(0,c.__generator)(this,(function(t){switch(t.label){case 0:return[4,this.fetch()];case 1:return t.sent(),[2,this.activate()]}}))}))},t.prototype.getAll=function(){var t=this;return function(t,e){void 0===t&&(t={});void 0===e&&(e={});return Object.keys((0,c.__assign)((0,c.__assign)({},t),e))}(this._storageCache.getActiveConfig(),this.defaultConfig).reduce((function(e,n){return e[n]=t.getValue(n),e}),{})},t.prototype.getBoolean=function(t){return this.getValue(t).asBoolean()},t.prototype.getNumber=function(t){return this.getValue(t).asNumber()},t.prototype.getString=function(t){return this.getValue(t).asString()},t.prototype.getValue=function(t){this._isInitializationComplete||this._logger.debug('A value was requested for key "'+t+'" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.');var e=this._storageCache.getActiveConfig();return e&&void 0!==e[t]?new t_("remote",e[t]):this.defaultConfig&&void 0!==this.defaultConfig[t]?new t_("default",String(this.defaultConfig[t])):(this._logger.debug('Returning static value for key "'+t+'". Define a default or remote value if this is unintentional.'),new t_("static"))},t}();function n_(t,e){var n=t.target.error||void 0;return Xm.create(e,{originalErrorMessage:n&&n.message})}var r_="app_namespace_store";var i_=function(){function t(t,e,n,r){void 0===r&&(r=new Promise((function(t,e){var n=indexedDB.open("firebase_remote_config",1);n.onerror=function(t){e(n_(t,"storage-open"))},n.onsuccess=function(e){t(e.target.result)},n.onupgradeneeded=function(t){var e=t.target.result;switch(t.oldVersion){case 0:e.createObjectStore(r_,{keyPath:"compositeKey"})}}}))),this.appId=t,this.appName=e,this.namespace=n,this.openDbPromise=r}return t.prototype.getLastFetchStatus=function(){return this.get("last_fetch_status")},t.prototype.setLastFetchStatus=function(t){return this.set("last_fetch_status",t)},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.get("last_successful_fetch_timestamp_millis")},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.set("last_successful_fetch_timestamp_millis",t)},t.prototype.getLastSuccessfulFetchResponse=function(){return this.get("last_successful_fetch_response")},t.prototype.setLastSuccessfulFetchResponse=function(t){return this.set("last_successful_fetch_response",t)},t.prototype.getActiveConfig=function(){return this.get("active_config")},t.prototype.setActiveConfig=function(t){return this.set("active_config",t)},t.prototype.getActiveConfigEtag=function(){return this.get("active_config_etag")},t.prototype.setActiveConfigEtag=function(t){return this.set("active_config_etag",t)},t.prototype.getThrottleMetadata=function(){return this.get("throttle_metadata")},t.prototype.setThrottleMetadata=function(t){return this.set("throttle_metadata",t)},t.prototype.deleteThrottleMetadata=function(){return this.delete("throttle_metadata")},t.prototype.get=function(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e,n=this;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise((function(r,i){var o=e.transaction([r_],"readonly").objectStore(r_),a=n.createCompositeKey(t);try{var s=o.get(a);s.onerror=function(t){i(n_(t,"storage-get"))},s.onsuccess=function(t){var e=t.target.result;r(e?e.value:void 0)}}catch(t){i(Xm.create("storage-get",{originalErrorMessage:t&&t.message}))}}))]}}))}))},t.prototype.set=function(t,e){return(0,c.__awaiter)(this,void 0,void 0,(function(){var n,r=this;return(0,c.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.openDbPromise];case 1:return n=i.sent(),[2,new Promise((function(i,o){var a=n.transaction([r_],"readwrite").objectStore(r_),s=r.createCompositeKey(t);try{var u=a.put({compositeKey:s,value:e});u.onerror=function(t){o(n_(t,"storage-set"))},u.onsuccess=function(){i()}}catch(t){o(Xm.create("storage-set",{originalErrorMessage:t&&t.message}))}}))]}}))}))},t.prototype.delete=function(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e,n=this;return(0,c.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.openDbPromise];case 1:return e=r.sent(),[2,new Promise((function(r,i){var o=e.transaction([r_],"readwrite").objectStore(r_),a=n.createCompositeKey(t);try{var s=o.delete(a);s.onerror=function(t){i(n_(t,"storage-delete"))},s.onsuccess=function(){r()}}catch(t){i(Xm.create("storage-delete",{originalErrorMessage:t&&t.message}))}}))]}}))}))},t.prototype.createCompositeKey=function(t){return[this.appId,this.appName,this.namespace,t].join()},t}(),o_=function(){function t(t){this.storage=t}return t.prototype.getLastFetchStatus=function(){return this.lastFetchStatus},t.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.lastSuccessfulFetchTimestampMillis},t.prototype.getActiveConfig=function(){return this.activeConfig},t.prototype.loadFromStorage=function(){return(0,c.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r,i,o;return(0,c.__generator)(this,(function(a){switch(a.label){case 0:return t=this.storage.getLastFetchStatus(),e=this.storage.getLastSuccessfulFetchTimestampMillis(),n=this.storage.getActiveConfig(),[4,t];case 1:return(r=a.sent())&&(this.lastFetchStatus=r),[4,e];case 2:return(i=a.sent())&&(this.lastSuccessfulFetchTimestampMillis=i),[4,n];case 3:return(o=a.sent())&&(this.activeConfig=o),[2]}}))}))},t.prototype.setLastFetchStatus=function(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)},t.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)},t.prototype.setActiveConfig=function(t){return this.activeConfig=t,this.storage.setActiveConfig(t)},t}();function a_(t,e){return new Promise((function(n,r){var i=Math.max(e-Date.now(),0),o=setTimeout(n,i);t.addEventListener((function(){clearTimeout(o),r(Xm.create("fetch-throttle",{throttleEndTimeMillis:e}))}))}))}var s_,u_=function(){function t(t,e){this.client=t,this.storage=e}return t.prototype.fetch=function(t){return(0,c.__awaiter)(this,void 0,void 0,(function(){var e;return(0,c.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.storage.getThrottleMetadata()];case 1:return e=n.sent()||{backoffCount:0,throttleEndTimeMillis:Date.now()},[2,this.attemptFetch(t,e)]}}))}))},t.prototype.attemptFetch=function(t,e){var n=e.throttleEndTimeMillis,r=e.backoffCount;return(0,c.__awaiter)(this,void 0,void 0,(function(){var e,i,o;return(0,c.__generator)(this,(function(a){switch(a.label){case 0:return[4,a_(t.signal,n)];case 1:a.sent(),a.label=2;case 2:return a.trys.push([2,5,,7]),[4,this.client.fetch(t)];case 3:return e=a.sent(),[4,this.storage.deleteThrottleMetadata()];case 4:return a.sent(),[2,e];case 5:if(!function(t){if(!(t instanceof l.FirebaseError&&t.customData))return!1;var e=Number(t.customData.httpStatus);return 429===e||500===e||503===e||504===e}(i=a.sent()))throw i;return o={throttleEndTimeMillis:Date.now()+(0,l.calculateBackoffMillis)(r),backoffCount:r+1},[4,this.storage.setThrottleMetadata(o)];case 6:return a.sent(),[2,this.attemptFetch(t,o)];case 7:return[2]}}))}))},t}(),c_="@firebase/remote-config";(s_=u.default).INTERNAL.registerComponent(new Qd.Component("remoteConfig",(function(t,e){var n=e.instanceIdentifier,r=t.getProvider("app").getImmediate(),i=t.getProvider("installations").getImmediate();if("undefined"==typeof window)throw Xm.create("registration-window");var o=r.options,a=o.projectId,s=o.apiKey,u=o.appId;if(!a)throw Xm.create("registration-project-id");if(!s)throw Xm.create("registration-api-key");if(!u)throw Xm.create("registration-app-id");n=n||"firebase";var c=new i_(u,r.name,n),l=new o_(c),f=new h.Logger(c_);f.logLevel=h.LogLevel.ERROR;var d=new $m(i,s_.SDK_VERSION,n,a,s,u),p=new u_(d,c),v=new Qm(p,c,l,f),g=new e_(r,v,l,c,f);return g.ensureInitialized(),g}),"PUBLIC").setMultipleInstances(!0)),s_.registerVersion(c_,"0.1.43");n(224);var l_="8.10.1";u.default.registerVersion("firebase",l_,"app"),u.default.SDK_VERSION=l_;console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the module builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nCommonJS Modules:\nconst firebase = require('firebase/app');\nrequire('firebase/<PACKAGE>');\n\nES Modules:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n\nTypescript:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n"),u.default.registerVersion("firebase","8.10.1");0===u.default.apps.length&&(u.default.initializeApp({apiKey:"AIzaSyArvXAou1wdX2sQNQLqhZD9SBWiUxjbdgA",authDomain:"dentino-web.firebaseapp.com",projectId:"dentino-web",storageBucket:"dentino-web.appspot.com",messagingSenderId:"200524047422",appId:"1:200524047422:web:1aa6f9958a256203019d6f",measurementId:"G-X177X5LRXL"}),u.default.analytics());var h_=u.default.firestore();function f_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function d_(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?f_(Object(r),!0).forEach((function(n){t(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f_(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var p_=function(){var t=o(s().mark((function t(e){var n,r,i,o,a,c;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.email,r=e.message,i=e.names,o=e.phone,a=h_.collection("consultasRecibidas"),c=a.doc(),t.next=5,c.set({email:n,message:r,names:i,phone:o,fecha:(s=new Date,u.default.firestore.Timestamp.fromDate(s))});case 5:case"end":return t.stop()}var s}),t)})));return function(e){return t.apply(this,arguments)}}(),v_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"contactForm",n=document.getElementById(e);n.addEventListener("submit",function(){var e=o(s().mark((function e(i){var o,a,u,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.preventDefault(),(o=document.createElement("div")).classList.add("spinner"),(a=document.createElement("div")).innerHTML='<i class="fas fa-check-circle"></i>',a.innerHTML+='<div class="success-message__message">Se ha enviado tu consulta, pronto nos pondremos en contacto contigo</div>',a.classList.add("success-message"),(u=n.parentNode).replaceChild(o,n),c=r(i.target).reduce((function(e,n){return d_(d_({},e),{},t({},n.name,n.value))}),{}),e.prev=10,e.next=13,p_(c);case 13:u.replaceChild(a,o),e.next=21;break;case 16:e.prev=16,e.t0=e.catch(10),alert("Error al enviar el formulario"),console.log({err:e.t0}),u.replaceChild(n,o);case 21:case"end":return e.stop()}}),e,null,[[10,16]])})));return function(t){return e.apply(this,arguments)}}())},g_=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.openMenuId,n=void 0===e?"btnOpenMenu":e,r=t.closeMenuId,i=void 0===r?"btnCloseMenu":r,o=t.menuId,a=void 0===o?"mainMenu":o,s=t.openMenuClassName,u=void 0===s?"navigation__list--mobile":s,c=t.closedMenuClassName,l=void 0===c?"navigation__list--hidden":c,h=document.getElementById(n),f=document.getElementById(i),d=document.getElementById(a);h.addEventListener("click",(function(){d.classList.remove(l),d.classList.add(u)})),f.addEventListener("click",(function(){d.classList.remove(u),d.classList.add(l)})),window.addEventListener("popstate",(function(){d.classList.contains(u)&&(d.classList.remove(u),d.classList.add(l))}))},y_=function(){var t=document.getElementById("aboutUs"),e=document.getElementById("specialties"),n=document.getElementById("branches"),r=document.getElementById("customerStories"),i=document.getElementById("contactFormSection"),o=new IntersectionObserver((function(t){!function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.25,r=function(r){var i=document.getElementById(r);t.intersectionRatio>=n?i.classList.add(e):i.classList.remove(e)},i=function(t){document.getElementById(t).classList.remove(e)};switch(t.target.id){case"aboutUs":r("linknosotros"),i("linkespecialidades"),i("linksedes"),i("linktestimonios"),i("linkcontacto");break;case"specialties":r("linkespecialidades"),i("linknosotros"),i("linksedes"),i("linktestimonios"),i("linkcontacto");break;case"branches":r("linksedes"),i("linkespecialidades"),i("linknosotros"),i("linktestimonios"),i("linkcontacto");break;case"customerStories":r("linktestimonios"),i("linkespecialidades"),i("linksedes"),i("linknosotros"),i("linkcontacto");break;case"contactFormSection":r("linkcontacto"),i("linkespecialidades"),i("linksedes"),i("linktestimonios"),i("linknosotros")}}(t[0],"navigation__item--active",.75)}),{rootMargin:"0px",threshold:.75});o.observe(t),o.observe(e),o.observe(n),o.observe(r),o.observe(i)};function m_(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function __(t,e,n){return function(t,e){if(t!==e)throw new TypeError("Private static access of wrong provenance")}(t,e),n}function b_(t,e,n){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return n}var w_=new WeakSet,I_=new WeakSet,T_=new WeakSet,E_=new WeakSet,S_=new WeakSet,C_=new WeakSet,k_=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),C_.add(this),S_.add(this),E_.add(this),T_.add(this),I_.add(this),w_.add(this),this.stories=e,this.previousSlider=0,this.activeSlider=1,this.nextSlider=2}var e,n,r;return e=t,(n=[{key:"initSlider",value:function(){var e=this;this.sliderElement=document.getElementById("customerStoriesSlider"),this.sliderControl=document.getElementById("sliderControl"),this.sliderControls=this.stories.map((function(t,n){var r=b_(e,w_,P_).call(e,n);return e.sliderControl.appendChild(r),r})),this.sliderItems=this.stories.map((function(n){var r=__(t,t,N_).call(t,n);return e.sliderElement.appendChild(r),r})),b_(this,S_,O_).call(this),b_(this,C_,L_).call(this),b_(this,E_,D_).call(this),b_(this,I_,x_).call(this)}},{key:"moveSlider",value:function(){this.activeSlider++,this.previousSlider++,this.nextSlider++,this.activeSlider>=this.sliderItems.length&&(this.activeSlider=0),this.previousSlider>=this.sliderItems.length&&(this.previousSlider=0),this.nextSlider>=this.sliderItems.length&&(this.nextSlider=0)}},{key:"moveSliderTo",value:function(t){this.activeSlider=t,this.previousSlider=t-1,this.nextSlider=t+1,this.activeSlider>=this.sliderItems.length&&(this.activeSlider=0),this.previousSlider<0&&(this.previousSlider=2),this.nextSlider>=this.sliderItems.length&&(this.nextSlider=0)}}])&&m_(e.prototype,n),r&&m_(e,r),t}();function A_(t){Array.from(t.classList).forEach((function(e){t.classList.remove(e)}))}function N_(t){var e=document.createElement("div"),n=document.createElement("p"),r=document.createElement("div");return e.classList.add("customer-stories__item"),n.classList.add("customer-stories__message"),r.classList.add("customer-stories__customer-name"),n.textContent=t.message,r.textContent=t.author,e.appendChild(n),e.appendChild(r),e}function P_(t){var e=this,n=document.createElement("div");return n.classList.add("customer-stories__control"),n.addEventListener("click",(function(){b_(e,T_,R_).call(e),e.moveSliderTo(t),b_(e,S_,O_).call(e),b_(e,C_,L_).call(e),b_(e,E_,D_).call(e),b_(e,I_,x_).call(e)})),n}function x_(){var t=this;this.interval=setInterval((function(){b_(t,S_,O_).call(t),t.moveSlider(),b_(t,C_,L_).call(t),b_(t,E_,D_).call(t)}),5e3)}function R_(){clearInterval(this.interval)}function D_(){var t=this;this.sliderControls.forEach((function(e,n){n===t.activeSlider?e.classList.add("customer-stories__control--active"):e.classList.remove("customer-stories__control--active")}))}function O_(){__(k_,k_,A_).call(k_,this.sliderItems[this.activeSlider]),__(k_,k_,A_).call(k_,this.sliderItems[this.previousSlider]),__(k_,k_,A_).call(k_,this.sliderItems[this.nextSlider])}function L_(){this.sliderItems[this.activeSlider].classList.add("customer-stories__item"),this.sliderItems[this.activeSlider].classList.add("customer-stories__item--active"),this.sliderItems[this.previousSlider].classList.add("customer-stories__item"),this.sliderItems[this.previousSlider].classList.add("customer-stories__item--left"),this.sliderItems[this.nextSlider].classList.add("customer-stories__item"),this.sliderItems[this.nextSlider].classList.add("customer-stories__item--right")}var M_=k_,F_=[{message:"Feliz con la atencin personalizada y extremos cuidados en mi tratamiento gracias al uso de los protocolos de bioseguridad en cada intervencin clnica.",author:"Sebastian Martinez"},{message:"Estoy muy satisfecha con el diagnstico y tratamiento dental que llevo en Dentino, he vuelto a sonrer con mucha confianza.",author:"Eliana Caro"},{message:"En Dentino encontr diversos profesionales especializados en cada rea, mi problema dental me generaba muchas complicaciones pero los doctores supieron cmo ayudarme y estoy muy feliz.",author:"Sergio Mendez"}];document.addEventListener("readystatechange",(function(){"complete"==document.readyState&&(v_("contactForm"),g_(),y_(),new M_(F_).initSlider())}))}()}();